(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36323],{12:(e,t,a)=>{"use strict";a.d(t,{W:()=>o});var n=a(61872),s=a(21443),r=a(45586),l=a(33571),i=a(36323);function o(e){let t=(0,i.eu)(),{updateBlockData:a}=(0,r.P6)({blockId:e}),o=(0,i.y6)();return(0,l.useCallback)(async function(r,l){let i=(0,n.L5)({files:r,blockType:"code-project"}),c=await (0,s.Z)({blockId:e,source:i,movedFile:null==l?void 0:l.moveFile});return c.transformedSource&&(i=c.transformedSource),t&&e===t.id&&o({...t,hasSourceBeenEdited:!0,source:i}),a({blockId:e,data:{hasSourceBeenEdited:!0,source:i,lastEditedAt:new Date().toISOString()}}),c},[e,t,a,o])}},688:(e,t,a)=>{"use strict";a.d(t,{$p:()=>l,mU:()=>r,vA:()=>s});let n=new Map;function s(e,t){let a=n.get(e);a&&a.abort();let s=new AbortController;n.set(e,s);let r=s.signal;return r.onabort=()=>{n.delete(e),null==t||t()},r}function r(e){let t=n.get(e);t&&(t.abort(),n.delete(e))}function l(e){n.delete(e)}},940:(e,t,a)=>{"use strict";a.d(t,{e:()=>D,Y:()=>L});var n=a(97667),s=a(33571),r=a(74118),l=a(95393);let i=s.memo(function(e){let{value:t,animate:a,onAnimationComplete:r}=e,{truncatedValue:i,duration:o,delayConstant:c,n:d}=(0,s.useMemo)(()=>{let e=.015,a=.03,n=Math.min(t.length,40);if(.045*n>300){let t=300/n;e=e/.045*t,a=a/.045*t}return{truncatedValue:t.length>40?t.slice(0,40)+"...":t,duration:e,delayConstant:a,n}},[t]);return(0,n.jsx)("div",{className:"truncate",children:i.split("").map((e,t)=>(0,n.jsx)(l.P.span,{animate:a?"animate":void 0,"aria-hidden":"true",initial:a?"initial":void 0,onAnimationComplete:()=>{t===d-1&&(null==r||r())},transition:{duration:o,ease:"easeIn",delay:t*c,staggerChildren:c},variants:{initial:{opacity:0,x:-100},animate:{opacity:1,x:0}},children:e},t))})});var o=a(71543),c=a(32136),d=a(66692),u=a(27693),m=a(99997),h=a(25887),p=a(28819);function x(e){let{isAuthor:t,className:a}=e,s=(0,u.k)(),{chatId:l}=(0,r.xz)(),{user:x}=(0,o.J)(),{title:f,isNew:g,authorId:v,canWriteToChat:j}=(0,c.tZ)(),{chatPrivacy:b}=(0,c.kM)(),y=g&&!!f,w=t||(null==x?void 0:x.id)===v;return l&&f?(0,n.jsx)("h1",{className:(0,p.cn)("flex min-w-0 items-center gap-1.5 text-sm text-gray-900",a),children:w?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.$,{className:"!h-auto flex-1 truncate rounded-sm p-0 text-sm font-medium text-gray-900",name:"Rename Chat",onClick:()=>{w&&l&&(0,h.D)({type:"updateChatTitle",data:{chatId:l}})},tooltip:l?s("chatOptionsDropdown.renameChat"):void 0,variant:"link",children:(0,n.jsx)("div",{"aria-label":f,className:"truncate","data-testid":"chat-title",children:(0,n.jsx)(i,{animate:y,value:f},"".concat(l,"-").concat(y))})}),(0,n.jsx)(m.i,{chatId:l,privacy:b})]}):(0,n.jsxs)("div",{className:"flex min-w-0 items-center gap-2 truncate","data-testid":"chat-title",children:[(0,n.jsx)("span",{className:"font-medium truncate max-w-96",children:f}),(0,n.jsx)("span",{className:"text-gray-500",children:j?"Team Chat":"View Only"})]})}):(0,n.jsx)("div",{})}var f=a(85984),g=a(40767),v=a(90962),j=a(73655),b=a(83195),y=a(63072),w=a(2783),N=a(63476),k=a(80155),C=a(43809),S=a(56033),M=a(92903),I=a(35501),A=a.n(I);function D(e){let{isAuthor:t}=e,{project:a}=(0,c.tZ)(),{activeScope:s,user:r}=(0,j.k6)(),{expectUser:l}=(0,o.J)(),{planSlug:i}=(0,b.N)(!0,null==s?void 0:s.id),d=null==r?void 0:r.isAdminMode,m="v0-level0"!==i||d||(null==r?void 0:r.isVercelian),{reassignPending:h,handleReassignProject:p}=(0,y.Z)(),I=(0,u.k)();if(!(0,N.x)())return null;let D=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.X,{className:"hidden sm:mr-1 sm:flex"}),(0,n.jsx)(S.Y,{className:"sm:mr-1"}),(0,n.jsx)(M.$,{})]}),L=l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.ScopeSwitcher,{className:"hidden sm:flex",variant:"header"}),(0,n.jsx)(M.$,{className:"hidden sm:block"})]}):null,z=(0,n.jsxs)("button",{disabled:h,className:"flex min-w-0 items-center justify-start gap-1 text-sm font-medium text-gray-500 underline-offset-2 transition-all hover:text-gray-900 hover:underline",children:[a?null:(0,n.jsx)(g.F,{className:"size-3 shrink-0"}),(0,n.jsx)("div",{className:"truncate",children:(null==a?void 0:a.name)||(0,n.jsx)("span",{children:I("chatHeader.project")})})]}),E=t&&((null==a?void 0:a.name)||m)&&(0,n.jsxs)("div",{"aria-label":"Breadcrumb",className:"@[30rem]/chat-header:flex hidden min-w-0 items-center text-gray-500",children:[(0,n.jsx)(v.o,{quickCreate:!0,handleProjectSelect:p,align:"start",variant:a?"split":void 0,className:"mx-1 max-w-[140px]",triggerButton:a?(0,n.jsx)(A(),{href:"/chat/projects/".concat(a.projectId),className:"flex min-w-0 items-center justify-start gap-1 text-sm font-medium text-gray-500 underline-offset-2 transition-all hover:text-gray-900 hover:underline",children:z}):z,disabled:h}),(0,n.jsx)(M.$,{})]}),P=(0,n.jsx)(x,{className:"ml-1",isAuthor:t});return(0,n.jsxs)("header",{className:"bg-background @container/chat-header relative z-20 flex h-14 w-full shrink-0 items-center justify-between gap-4 px-3 sm:h-11 sm:px-2",children:[(0,n.jsxs)("nav",{className:"flex w-full min-w-0 flex-1 items-center",children:[D,L,E,P]}),l?(0,n.jsx)(w.xs,{isAuthor:t}):(0,n.jsx)(f._,{})]})}let L=new Intl.ListFormat("en",{style:"long",type:"conjunction"})},992:(e,t,a)=>{"use strict";a.d(t,{C:()=>eR});var n=a(97667),s=a(60914),r=a(80672),l=a(27831),i=a(16979),o=a(90332),c=a(80574),d=a(19434),u=a(93187),m=a(33571),h=a(53849),p=a(57560),x=a(141),f=a(94282),g=a(70073);let v=new Map,j=(0,x.G)(v,()=>({isOpen:(0,p.eU)(!1),selectedEnvironment:(0,p.eU)(null),newBranchName:(0,p.eU)(null),newBranchNameError:(0,p.eU)(null),stageIntent:(0,p.eU)(null),newDomain:(0,p.eU)(null),passingState:(0,p.eU)(null),deployWarning:(0,p.eU)(null),hasDeployableChanges:(0,p.eU)(!1),domainError:(0,p.eU)(null),domainErrorRedirect:(0,p.eU)(null),asyncActionLoading:(0,p.eU)(null),activeBlockVersionNumber:(0,p.eU)(null),deployStartTimestamp:(0,p.eU)(null)})),b=new Map,y=(0,x.G)(b,e=>{let t=j(e),a=(0,g.jP)(e),n=(0,p.eU)(e=>["not-deployed","deployed","git-pushed-no-deploy","failed"].includes(e(a.deploymentState))&&!e(a.isStreaming)),s=(0,p.eU)(e=>e(n)&&"deploy"!==e(t.asyncActionLoading)),r=(0,p.eU)(e=>"preview"===e(t.selectedEnvironment)?e(n)&&!!e(t.newBranchName):e(n)&&"pushing"!==e(t.asyncActionLoading));return{...t,externalMeta:a.externalMeta,deploymentState:a.deploymentState,isAbleToDeploy:s,isAbleToPushChanges:r,stage:(0,p.eU)(e=>{var n;let s=e(a.externalMeta);if(s.error&&s.error!==u.p2)return"error";if(e(t.deployWarning))return"deploy-warning";let r=e(t.stageIntent);return r||((null==(n=s.deployment)?void 0:n.id)?"deployment":"create")}),statusDotVariant:(0,p.eU)(e=>{if(e(t.passingState))return null;if(e(t.hasDeployableChanges))switch(e(a.deploymentState)){case"not-deployed":case"deployed":return"success";case"failed":return"error"}return null}),buttonVariant:(0,p.eU)(e=>{let n=e(t.passingState);if(n)switch(n){case"passing-deployed":return"secondary";case"passing-error":return"red"}let s=e(a.deploymentState);if(e(t.hasDeployableChanges)&&"failed"===s)return"primary";if("error"===s)return"secondary";switch(s){case"deployed":case"not-deployed":return"primary";default:return"secondary"}}),isNewDomainValid:(0,p.eU)(e=>{let a=e(t.newDomain);return!!a&&/^[a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?$/.test(a)}),asyncActionLoadingLabel:(0,p.eU)(e=>{let a=e(t.asyncActionLoading);return a?({deploy:"Deploying","assigning-domain":"Assigning Domain",pushing:"Pushing","auto-fixing-errors":"Auto-fixing Errors","auto-fixing-warning":"Auto-fixing Warning"})[a]:null})}});function w(e){let t=j(e);return{setIsOpen:e=>f.M.set(t.isOpen,e),setStageIntent:e=>f.M.set(t.stageIntent,e),setAsyncActionLoading:e=>f.M.set(t.asyncActionLoading,e),updateNewBranchName:e=>{let a=null==e?void 0:e.replace(/\s+/g,"-");f.M.set(t.newBranchName,null!=a?a:null),f.M.set(t.newBranchNameError,null)},setActiveBlockVersionNumber:e=>{f.M.set(t.activeBlockVersionNumber,e)},setDeployStartTimestamp:e=>{f.M.set(t.deployStartTimestamp,e)},setSelectedEnvironment:e=>f.M.set(t.selectedEnvironment,e),setNewBranchNameError:e=>f.M.set(t.newBranchNameError,e),clearBranchNameError:()=>f.M.set(t.newBranchNameError,null),triggerPassingState:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;return f.M.set(t.passingState,e),setTimeout(()=>{f.M.set(t.passingState,null)},a)},setDeployWarning:e=>f.M.set(t.deployWarning,e),setHasDeployableChanges:e=>f.M.set(t.hasDeployableChanges,e),setNewDomain:e=>f.M.set(t.newDomain,e),setDomainError:e=>f.M.set(t.domainError,e),setDomainErrorRedirect:e=>f.M.set(t.domainErrorRedirect,e)}}var N=a(62069),k=a.n(N),C=a(19243),S=a(98791);let M=(0,s.F)("group relative flex h-7 min-w-[98px] !cursor-pointer items-center justify-center overflow-hidden whitespace-nowrap rounded-[6px] border px-2 pr-2.5 font-medium",{variants:{variant:{primary:"text-background border-gray-900 bg-gray-900 hover:border-gray-800 hover:bg-gray-800",secondary:"bg-subtle hover:border-alpha-400 border-gray-200 text-gray-900 hover:bg-gray-200",blue:"border-blue-600 bg-blue-600 text-blue-600",red:"border-red-600 bg-red-600 text-red-600"}}});function I(e){let{chatId:t,...a}=e,s=y(t),i=(0,r.useAtomValue)(s.buttonVariant);return(0,n.jsx)("div",{className:"text-label-14 relative",children:(0,n.jsx)("button",{className:(0,d.cn)(M({variant:i}),a.className),style:{...(0,l.iA)(["background","color","border-color"]),...a.style},...a,children:(0,n.jsx)(A,{chatId:t})})})}function A(e){let{chatId:t}=e,a=y(t),s=(0,r.useAtomValue)(a.deploymentState),l=(0,r.useAtomValue)(a.passingState),o=(0,r.useAtomValue)(a.hasDeployableChanges),d=(0,r.useAtomValue)(a.deployStartTimestamp),{error:p}=(0,r.useAtomValue)(a.externalMeta),x=function(e,t){let a=(0,m.useRef)({value:e,prev:void 0}),n=a.current.value;return k()(e,n)||(a.current={value:e,prev:n}),a.current.prev}(s);(0,m.useEffect)(()=>{if("building"===x||!d)return;let e={msSinceDeployClick:Date.now()-d};"building"===s&&(0,C.u)("DeployStartedBuild",e)},[x,s,d]);let f=(0,m.useMemo)(()=>{if(p&&p!==u.p2)return(0,n.jsxs)("span",{className:"flex items-center gap-1 text-red-700",children:[(0,n.jsx)(i.V,{}),"Deploy"]});if(l)switch(l){case"passing-deployed":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.m,{state:"ready"}),"Ready"]});case"passing-error":return(0,n.jsx)("span",{className:"text-background flex items-center justify-center",children:(0,n.jsx)(i.V,{})})}switch(s){case"not-deployed":case"deployed":case"failed":if(!o&&"failed"===s)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.m,{state:"error"}),"Failed"]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D,{}),"Deploy"]});case"deploying":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.y,{size:16}),"Deploy"]});case"queued":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.m,{state:"queued"}),"Queued"]});case"building":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.m,{state:"building"}),"Building"]})}},[s,p,o,l]);return(0,n.jsx)(h._r,{...h.fG.buttonContent,children:(0,n.jsx)("span",{className:"flex items-center justify-center gap-1.5",children:f})})}function D(){return(0,n.jsx)(o.h,{size:14,className:"translate-y-[-0.5px]"})}(0,s.F)("border-muted h-3 min-h-3 w-3 min-w-3 rounded-full border-[1.5px]",{variants:{variant:{success:"bg-blue-600",error:"bg-red-600"}}});var L=a(91211),z=a(93660),E=a(66692),P=a(25296),T=a(35501),F=a.n(T);function R(e){let{link:t,children:a,className:s}=e;return(0,n.jsxs)("div",{className:(0,d.cn)("flex flex-row justify-between gap-3 px-3 pb-3",t&&"pl-1.5"),children:[t?(0,n.jsx)(E.$,{variant:"ghost",size:"sm",className:"shrink-0",asChild:!0,children:(0,n.jsx)(F(),{href:t.href,target:"_blank",className:"text-label-14 flex items-center gap-2",children:t.label})}):null,(0,n.jsx)("span",{className:(0,d.cn)("flex flex-1 items-center justify-end gap-3",t?"":"[&>*]:flex-1",s),children:a})]})}function U(e){let{children:t,className:a,key:s}=e;return(0,n.jsx)("div",{className:(0,d.cn)("flex w-full flex-col overflow-hidden p-4",a),children:t},s)}var V=a(44557),B=a(81614),_=a(7722),O=a(61182),H=a(70158),$=a(99066),q=a(13729),W=a(70676);let G=(0,W.createServerReference)("401eb49dac6f2c935a5223073e9220016c20be6f05",W.callServer,void 0,W.findSourceMapURL,"assignVercelAlias");var Z=a(86943),Y=a(36259),K=a(36323),J=a(77635),Q=a(20630),X=a(71543),ee=a(25887),et=a(48985),ea=a(37707);function en(e){let{chatId:t}=e,a=(0,H.useRouter)(),n=y(t),s=(0,r.useAtomValue)(n.externalMeta),{user:l}=(0,X.J)(),{mutate:i}=(0,Q.B)(["chat","externalMeta"],{chatId:t}),{submit:o}=(0,$.yI)(),c=(0,K.eu)(),d=(0,J.S)({chatId:t,activeBlock:c}),{setIsOpen:h,setStageIntent:p,setNewDomain:x,setDeployWarning:f,setDomainError:g,setDomainErrorRedirect:v,setAsyncActionLoading:j,setDeployStartTimestamp:b}=w(t),N=(0,r.useAtomValue)(n.asyncActionLoading),k=(0,r.useAtomValue)(n.isAbleToDeploy),S=(0,r.useAtomValue)(n.isAbleToPushChanges),M=(0,r.useAtomValue)(n.isNewDomainValid),I=(0,r.useAtomValue)(n.newDomain),A=(0,r.useAtomValue)(n.newBranchName),D=(0,r.useAtomValue)(n.deployWarning),{deployment:L,git:z}=s,{gbs:E}=(0,ea.D)(),P=(0,m.useMemo)(()=>{var e;return null!=(e=null!=A?A:null==z?void 0:z.ref)?e:"main"},[A,z]),T=(0,m.useMemo)(()=>({...ei,...L,...el(l)}),[L,l]),F=(0,m.useMemo)(()=>({...ec,...z,...eo(P)}),[z,P]),R=(0,m.useCallback)(async e=>{let{blockId:t,fromGitProject:a}=e;if(D)return{set:!1,skippedDeployWarning:D.commonDeployError};try{let e=await (0,Y.i)({blockId:t,fromGitProject:a});if(!("warning"in e))return{set:!1};return f({...e,from:"deploy"}),{set:!0}}catch(e){return{set:!1,skippedDeployWarning:void 0}}},[D,f]),U=async()=>{try{await d()}catch(e){q.o.error("Unable to create project")}},V=async()=>{try{b(Date.now());let e=null==c?void 0:c.id;if(!k||!e||!l)return void q.o.error("Unable to deploy");let t=await R({blockId:e,fromGitProject:!1});if(t.set)return;await i({serverMutate:(async()=>{await U(),await es({blockId:e,skippedDeployWarning:t.skippedDeployWarning}),f(null)})(),optimisticData:{git:void 0,error:void 0,deployment:T}})}catch(e){q.o.error("An error occurred while deploying")}},B=async()=>{try{let e=null==c?void 0:c.id;if(!S||!e||!l)return void q.o.error("Unable to push changes");let t=await R({blockId:e,fromGitProject:!0});if(t.set)return;await i({serverMutate:(async()=>{await U(),await er({blockId:e,branch:P,skippedDeployWarning:t.skippedDeployWarning,onProductionBranch:null==z?void 0:z.onProductionBranch,gitBidirectionalSyncOn:!!E}),f(null)})(),optimisticData:{error:void 0,deployment:{...T,git:F},git:F}})}catch(e){if(e instanceof Error)return void q.o.error(e.message);q.o.error("An error occurred while pushing changes")}},_=async()=>{if(!L)return void q.o.error("No deployment found");if(!M||!I)return void g("Invalid domain");try{g(null),v(null),await i({serverMutate:(async()=>{let e=await G({deploymentId:L.id,alias:I,vercelProjectId:L.project.id});if(!e.success){let t=e.errorCode||u.dD,a=Z.jW[t]||e.errorMessage;g(a||"Failed to assign domain"),e.redirectTo&&v(e.redirectTo),q.o.error(a||"Failed to assign domain");return}q.o.success("Domain assigned successfully"),p(null),x(null),g(null),v(null)})(),optimisticData:{...s,deployment:{...L}}})}catch(t){let e=t instanceof Error?t.message:"An error occurred while assigning domain";g(e),q.o.error(e)}},O=(0,m.useCallback)(()=>{h(!1),(0,ee.D)({type:"feedback",data:{feedback:"I'm having trouble loading my deployment. \nChat: ".concat(t," \nError: ").concat(s.error),sentiment:"bad"}})},[h,t,s.error]),W=(0,m.useCallback)(()=>{a.refresh()},[a]),et=async()=>{D&&(c&&(0,C.u)("FixDeployWarning",{blockId:c.id,warning:D.warning}),eu(),await o({action:"fix-with-v0",type:"fix-with-v0",input:"An error occurred during deployment. Please fix:\n\n".concat(ed(D.prompt),"\n")}),f(null))},en=async e=>{eu(),await o({action:"fix-with-v0",type:"fix-with-v0",input:"An error occurred during deployment. Please fix:\n\n".concat(ed(e))})},eu=(0,m.useCallback)(()=>{setTimeout(()=>{h(!1)},2e3)},[h]);function em(e,t){return async function(){for(var a=arguments.length,n=Array(a),s=0;s<a;s++)n[s]=arguments[s];if(e===N)return q.o.error("Unable to perform deployment action");j(e);try{return await t(...n)}finally{j(null)}}}return{handleRetry:W,handleReport:O,handleDeploy:em("deploy",V),handlePushChanges:em("pushing",B),handleAssignDomain:em("assigning-domain",_),handleFixDeployWarning:em("auto-fixing-warning",et),handleFixWithV0:em("auto-fixing-errors",en)}}async function es(e){let{blockId:t,skippedDeployWarning:a}=e,n=await fetch("/chat/b/".concat(t,"/deploy"),{method:"POST",body:JSON.stringify({skippedDeployWarning:a})}),s=await n.json();return n.ok?s:{error:s.error}}async function er(e){let t,{blockId:a,skippedDeployWarning:n,branch:s,onProductionBranch:r,gitBidirectionalSyncOn:l}=e;t=l&&!r?await fetch("/chat/b/".concat(a,"/deploy"),{method:"POST",body:JSON.stringify({skippedDeployWarning:n,target:r?"production":"preview"})}):await (0,et.k)({blockId:a,skippedDeployWarning:n,branch:s});let i=await t.json();if(!t.ok){var o;throw Error(null!=(o=i.errorMsg)?o:"An error occurred while pushing changes")}return i}let el=e=>({readyState:"INITIALIZING",createdAt:0,creator:e?{uid:e.id,username:e.username,avatar:e.avatar}:void 0}),ei={id:"loading",inspectorUrl:"",name:"",projectId:"",customAlias:{alias:V.h5,uid:"",created:"",redirect:null,updatedAt:0},screenshotUrl:null,project:void 0,automaticAliases:[],filteredAliases:[],git:void 0,meta:{},url:V.h5,ownerId:"",readyState:"INITIALIZING",createdAt:0,bestDomain:V.h5},eo=e=>({ref:e,sha:V.h5,commitMessage:V.h5}),ec={ownerName:"",repoName:"",ref:"",sha:"",commitMessage:"",type:"github",prId:null,repoId:0,refs:[],onProductionBranch:!0,gitConnected:!0,gitAutoCommitPush:!1};function ed(e){return e.includes("```")?e:" ```\n".concat(e,"\n``` ")}function eu(e){let{chatId:t}=e,a=y(t),s="auto-fixing-warning"===(0,r.useAtomValue)(a.asyncActionLoading),{handleFixDeployWarning:l}=en({chatId:t}),i=(0,m.useCallback)(()=>{l()},[l]),o=(0,m.useMemo)(()=>({disabled:s,isLoading:s,loadingText:"Fixing warning"}),[s]);return(0,n.jsx)(E.$,{size:"sm",variant:"default",onClick:i,disabled:o.disabled,children:(0,n.jsxs)(O.V,{isLoading:o.isLoading,loading:o.loadingText,children:["Fix with ",(0,n.jsx)(_.e,{invert:!o.disabled})]})})}function em(e){let{chatId:t,deploymentId:a,variant:s="default"}=e,l=y(t),i="auto-fixing-errors"===(0,r.useAtomValue)(l.asyncActionLoading),{data:o}=(0,Q.B)(["deployment","errors"],{deploymentId:a}),{handleFixWithV0:c}=en({chatId:t}),d=(0,m.useMemo)(()=>!!o.fullErrorText,[o]),u=(0,m.useCallback)(()=>{o.fullErrorText&&c(o.fullErrorText)},[o.fullErrorText,c]),h=(0,m.useMemo)(()=>{let e="Collecting errors";d&&(e="Auto-fixing errors");let t=!d||i;return{onClick:u,isLoading:t,loadingText:e,disabled:t}},[u,d,i]);return(0,n.jsx)(E.$,{size:"sm",onClick:h.onClick,disabled:h.disabled,variant:s,children:(0,n.jsxs)(O.V,{isLoading:h.isLoading,loading:h.loadingText,children:["Fix with"," ",(0,n.jsx)(_.e,{invert:"default"===s&&!h.disabled,loading:h.disabled})]})})}function eh(e){let{chatId:t,variant:a="default",...s}=e,l=y(t),i=(0,r.useAtomValue)(l.externalMeta),o=(0,r.useAtomValue)(l.deployWarning),c=(0,r.useAtomValue)(l.isAbleToPushChanges),d=(0,r.useAtomValue)(l.isAbleToDeploy),u=(0,r.useAtomValue)(l.hasDeployableChanges),h=(0,r.useAtomValue)(l.selectedEnvironment),p=(0,r.useAtomValue)(l.asyncActionLoading),x=(0,r.useAtomValue)(l.asyncActionLoadingLabel),f=(0,r.useAtomValue)(l.activeBlockVersionNumber),{handlePushChanges:g,handleDeploy:v}=en({chatId:t}),j=(0,m.useMemo)(()=>{var e;let t=!!(null==(e=i.deployment)?void 0:e.id),a=!!(null==o?void 0:o.warning),{git:n}=i,s="Deploy to Production";if("preview"===h&&(s="Deploy to Branch"),t&&(s="Redeploy v".concat(f),u&&(s="Deploy Changes")),a&&(s="Deploy"),n){let e="pushing"===p;return{onClick:g,disabled:!c||e,text:s,isLoading:e,loadingText:x}}{let e="deploy"===p;return{onClick:v,disabled:!d||e,text:s,isLoading:e,loadingText:x}}},[i,null==o?void 0:o.warning,h,f,u,p,c,g,x,d,v]);return(0,n.jsx)(E.$,{size:"sm",onClick:j.onClick,disabled:j.disabled,variant:a,onSubmit:function(e){e.preventDefault(),j.onClick()},...s,children:(0,n.jsx)(O.V,{isLoading:j.isLoading,loading:j.loadingText,children:j.text})})}function ep(e){let{chatId:t}=e,a=y(t),s=(0,r.useAtomValue)(a.deploymentState),l=(0,r.useAtomValue)(a.hasDeployableChanges),{deployment:o,git:c,error:d}=(0,r.useAtomValue)(a.externalMeta),{handleRetry:p}=en({chatId:t}),{setStageIntent:x}=w(t),f=(0,m.useMemo)(()=>{if(d&&d!==u.p2)return{content:(0,n.jsx)(U,{children:(0,n.jsx)(B.p,{title:"Failed to load deployment",variant:"error",icon:(0,n.jsx)(i.V,{}),children:"There was an error loading your deployment."})}),actions:(0,n.jsx)(R,{children:(0,n.jsx)(E.$,{size:"sm",onClick:p,children:"Reload"})})};if(!o)return{content:(0,n.jsx)(U,{children:(0,n.jsx)(ex,{})}),actions:null};let e=(null==c?void 0:c.onProductionBranch)||!c,a=o.inspectorUrl?{href:o.inspectorUrl,label:"View on Vercel"}:void 0,r=(0,n.jsxs)(R,{link:a,className:"".concat(l&&"flex-row-reverse"),children:[(0,n.jsx)(eh,{variant:l?"default":"secondary",chatId:t}),(0,n.jsx)(em,{variant:l?"secondary":"default",chatId:t,deploymentId:o.id})]}),m=(0,n.jsxs)(R,{link:a,children:[e?(0,n.jsx)(E.$,{size:"sm",onClick:()=>x("assign-domain"),variant:"secondary",children:"Add a Domain"}):null,(0,n.jsx)(eh,{chatId:t})]}),h=null;return"failed"===s&&(h=r),"deployed"===s&&(h=m),{content:(0,n.jsx)(U,{children:(0,n.jsx)(V.Sn,{deploymentId:o.id,stopFetch:!0})}),actions:h}},[d,o,c,l,t,s,p,x]);return(0,n.jsxs)("div",{className:"flex flex-col",children:[f.content,(0,n.jsx)(h._r,{...h.fG.popoverContent,children:f.actions})]})}function ex(){return(0,n.jsx)(B.p,{title:"No deployment found",icon:(0,n.jsx)(P.q,{}),children:"This chat has not been deployed yet."})}var ef=a(49848),eg=a(41199);function ev(e){let{chatId:t}=e,a=y(t),{handleAssignDomain:s}=en({chatId:t}),{setNewDomain:l,setStageIntent:i,setDomainError:o,setDomainErrorRedirect:c}=w(t),{deployment:d}=(0,r.useAtomValue)(a.externalMeta),u=(0,r.useAtomValue)(a.newDomain),h=(0,r.useAtomValue)(a.asyncActionLoading),p=(0,r.useAtomValue)(a.asyncActionLoadingLabel),x=(0,r.useAtomValue)(a.domainError),f=(0,r.useAtomValue)(a.domainErrorRedirect),g="assigning-domain"===h,v=(0,m.useMemo)(()=>x?f?(0,n.jsx)(F(),{href:f,children:x}):x:null,[x,f]);return d?(0,n.jsxs)("form",{id:"assign-domain-form",onSubmit:function(e){e.preventDefault(),s()},children:[(0,n.jsxs)(U,{className:"gap-4",children:[(0,n.jsx)(eg.M,{title:"Add a Custom Domain",children:"Assign a custom vercel.app subdomain to make your project more memorable."}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsx)(ef.p,{placeholder:d.bestDomain?d.bestDomain.replace(/\.(vercel\.app)$/,""):"your-domain.vercel.app",value:null!=u?u:"",onChange:e=>{l(e.target.value),o(null),c(null)},disabled:g,className:"pr-0",style:{maskImage:"linear-gradient(to right, black calc(100% - 48px), transparent)"},error:v,suffix:(0,n.jsx)("span",{className:"text-label-14 pr-2 text-gray-500",children:".vercel.app"})})})]}),(0,n.jsxs)(R,{children:[(0,n.jsx)(E.$,{size:"sm",variant:"outline",onClick:()=>i(null),disabled:g,type:"button",children:"Cancel"}),(0,n.jsx)(E.$,{size:"sm",type:"submit",form:"assign-domain-form",disabled:g,children:(0,n.jsx)(O.V,{isLoading:g,loading:p,children:"Add Domain"})})]})]}):(0,n.jsx)(U,{children:(0,n.jsx)(ex,{})})}var ej=a(62903),eb=a(28819),ey=a(3447),ew=a.n(ey);let eN=e=>{let{label:t,direction:a="column",value:s,onChange:r,className:l,children:i,...o}=e;return(0,n.jsxs)("div",{className:(0,eb.cn)("space-y-2",l),children:[t&&(0,n.jsx)("div",{className:"text-sm font-medium",children:t}),(0,n.jsx)(ej.z,{value:null!=s?s:void 0,onValueChange:r,className:(0,eb.cn)("gap-2","row"===a?"flex":"flex flex-col"),...o,children:i})]})};eN.Item=function(e){let{title:t,description:a,value:s,Icon:r,disabled:l}=e;return(0,n.jsxs)("label",{htmlFor:s,className:(0,eb.cn)("flex w-full cursor-pointer items-center justify-between rounded-md border border-gray-200 p-3 text-gray-900 transition-colors",!l&&"hover:bg-gray-50",ew().choiceBoxItem),children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[r&&(0,n.jsx)("div",{"data-icon":!0,className:"text-gray-500",children:r}),(0,n.jsxs)("div",{className:"text-label-14 flex flex-col gap-1 font-medium",children:[(0,n.jsx)("span",{"data-title":!0,children:t}),(0,n.jsx)("span",{className:"font-normal text-gray-500","data-description":!0,children:a})]})]}),(0,n.jsx)(ej.C,{value:s,id:s,disabled:l})]})};var ek=a(23423),eC=a(92597),eS=a(6902);function eM(e){let{chatId:t}=e,a=y(t),{git:s}=(0,r.useAtomValue)(a.externalMeta),l=(0,r.useAtomValue)(a.newBranchName),i=(0,r.useAtomValue)(a.selectedEnvironment),{setSelectedEnvironment:o,updateNewBranchName:c}=w(t),d=!!(0,r.useAtomValue)(a.asyncActionLoading),u=(0,m.useMemo)(()=>(null==s?void 0:s.ref)?s.onProductionBranch?(o("production"),{shouldForce:!0,previewDisabled:!0,productionDisabled:!1,branchName:s.ref,branchInputDisabled:!0}):(o("preview"),c(s.ref),{shouldForce:!0,previewDisabled:!1,productionDisabled:!0,branchName:s.ref,branchInputDisabled:!0}):{shouldForce:!1,previewDisabled:!1,productionDisabled:!1,branchName:l,branchInputDisabled:!1},[null==s?void 0:s.ref,null==s?void 0:s.onProductionBranch,l,o,c]),p=u.previewDisabled||d,x=u.productionDisabled||d,f=u.branchInputDisabled||d,g=u.branchName,{gbs:v}=(0,ea.D)();return(0,m.useEffect)(()=>{x||o("production")},[]),(0,n.jsxs)("form",{children:[(0,n.jsx)(U,{children:v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eN,{value:i,onChange:e=>{o(e)},className:"flex flex-col gap-2",children:[(0,n.jsx)(eN.Item,{disabled:x,Icon:(0,n.jsx)(P.q,{}),title:"Production",description:u.productionDisabled?"Only main can be to deployed to production.":"Make your changes live to all users.",value:"production"}),(0,n.jsx)(eN.Item,{disabled:p,Icon:(0,n.jsx)(eC.S,{}),title:"Preview",description:s?"Test your changes on a branch before going live.":"Connect to GitHub to create preview deployments.",value:"preview"})]}),(0,n.jsx)(h._r,{...h.fG.popoverContent,renderKey:null!=i?i:"",children:"preview"===i?(0,n.jsxs)("div",{className:"flex flex-col gap-2 pt-3",children:[(0,n.jsx)(eS.Label,{htmlFor:"branch-name",children:"Branch name"}),(0,n.jsx)(ef.p,{prefix:u.shouldForce?(0,n.jsx)("span",{className:"text-gray-500",children:(0,n.jsx)(ek.C,{})}):void 0,disabled:f,id:"branch-name",placeholder:"your-branch-name",value:null!=g?g:"",onChange:e=>c(e.target.value)})]}):null})]}):(0,n.jsx)(eg.M,{title:"Deploy to Vercel",children:"Publish the latest version of your app. This will make your changes live and accessible to all users."})}),(0,n.jsx)(R,{children:(0,n.jsx)(eh,{chatId:t})})]})}var eI=a(17773),eA=a(15941);function eD(e){let{chatId:t}=e,a=y(t),s=(0,r.useAtomValue)(a.deployWarning),l=(0,m.useMemo)(()=>{if(!s)return{content:(0,n.jsx)(B.p,{title:"No deployment warnings",variant:"success",icon:(0,n.jsx)(eI.J,{}),children:"The source has been checked and no deployment warnings were found."}),actions:(0,n.jsx)(eh,{chatId:t})};let{isSecurityRisk:e,warning:a}=s;return{content:(0,n.jsx)(U,{children:(0,n.jsx)(B.p,{title:e?"Security Risk Found":"Deployment Warning",variant:e?"error":"warning",icon:e?(0,n.jsx)(i.V,{}):(0,n.jsx)(eA.N,{}),children:a})}),actions:(0,n.jsxs)(R,{children:[(0,n.jsx)(eu,{chatId:t}),(0,n.jsx)(eh,{variant:"secondary",chatId:t})]})}},[t,s]);return(0,n.jsx)(h._r,{...h.fG.popoverContent,children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[l.content,l.actions]})})}function eL(e){let{chatId:t}=e,{handleRetry:a,handleReport:s}=en({chatId:t});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U,{children:(0,n.jsx)(B.p,{title:"Failed to load deployment",variant:"error",icon:(0,n.jsx)(i.V,{}),children:"An issue occurred with our servers or your network connection. Please reload or report the problem if it persists."})}),(0,n.jsxs)(R,{children:[(0,n.jsx)(E.$,{size:"sm",onClick:s,variant:"secondary",children:"Report"}),(0,n.jsx)(E.$,{size:"sm",onClick:a,children:"Reload"})]})]})}function ez(e){let{chatId:t}=e,a=y(t),s=(0,r.useAtomValue)(a.stage),l=(0,m.useMemo)(()=>{switch(s){case"create":return(0,n.jsx)(eM,{chatId:t});case"deployment":return(0,n.jsx)(ep,{chatId:t});case"assign-domain":return(0,n.jsx)(ev,{chatId:t});case"deploy-warning":return(0,n.jsx)(eD,{chatId:t});case"error":return(0,n.jsx)(eL,{chatId:t})}},[t,s]);return(0,n.jsx)(h._r,{...h.fG.popoverContent,children:(0,n.jsx)("div",{className:"flex flex-col",children:l})})}var eE=a(7104),eP=a(79463),eT=a(45586),eF=a(38383);function eR(e){let{chatId:t}=e;return(0,n.jsx)(m.Suspense,{fallback:(0,n.jsx)(eU,{}),children:(0,n.jsx)(eV,{chatId:t})})}function eU(){return(0,n.jsx)(z.E,{className:"h-7 w-[98px] rounded-[6px]"})}function eV(e){let{chatId:t}=e;!function(e){let{chatId:t}=e,[a,n]=(0,m.useState)(void 0),{data:s}=(0,Q.B)(["chat","externalMeta"],{chatId:t},{refreshInterval:a});(0,m.useEffect)(()=>{var e,t;let a,r=null==(e=s.deployment)?void 0:e.readyState,l=null==(t=s.deployment)?void 0:t.id;if(!r||!l)return;let{setDeploymentStatus:i}=(0,eE.t1)(l);i({error:void 0,deployment:s.deployment}),["QUEUED","BUILDING","INITIALIZING","NOTREADY"].includes(r)&&(a=2e3),n(a)},[s,n])}({chatId:t}),function(e){let{chatId:t}=e,a=(0,K.eu)(),{getBlockCreatedAt:n}=(0,eP.y)(),{currentBlockIndex:s}=(0,eT.P6)({blockId:null==a?void 0:a.id,searchAll:!0}),l=y(t),{deployment:i}=(0,r.useAtomValue)(l.externalMeta),{setActiveBlockVersionNumber:o,setHasDeployableChanges:c}=w(t),d=e=>e?new Date(e).getTime():0,u=(0,m.useMemo)(()=>!!a&&(d(a.lastEditedAt)>d(null==i?void 0:i.createdAt)||d(n(a.id))>d(null==i?void 0:i.createdAt)),[a,i,n]),h=(0,m.useMemo)(()=>s+1,[s]);(0,m.useLayoutEffect)(()=>{let e=requestAnimationFrame(()=>{c(u),o(h)});return()=>cancelAnimationFrame(e)},[u,c,o,h])}({chatId:t}),function(e){let{chatId:t}=e,a=y(t),{deployment:n}=(0,r.useAtomValue)(a.externalMeta),s=(0,r.useAtomValue)(a.isOpen),l=(0,r.useAtomValue)(a.deploymentState),{triggerPassingState:i}=w(t),o=(0,eF.Z)(l),c=(0,m.useCallback)(()=>{!s&&(null==n?void 0:n.id)&&q.o.deployment({id:n.id})},[s,null==n?void 0:n.id]);(0,m.useEffect)(()=>{(null==n?void 0:n.id)&&o&&(["queued","failed","error","not-deployed","deploying"].includes(o)&&"building"===l&&c(),"building"===o&&"failed"===l&&(i("passing-error",3e3),c()),"building"===o&&"deployed"===l&&(i("passing-deployed"),c()))},[null==n?void 0:n.id,o,l,c,i])}({chatId:t});let a=y(t),s=w(t),l=(0,r.useAtomValue)(a.isOpen);return(0,n.jsxs)(L.AM,{open:l,onOpenChange:s.setIsOpen,children:[(0,n.jsx)(L.Wv,{asChild:!0,children:(0,n.jsx)(I,{chatId:t})}),(0,n.jsx)(L.hl,{className:"w-[440px] max-w-[100vw] origin-top-right",align:"end",alignOffset:1,children:(0,n.jsx)(ez,{chatId:t})})]})}},1221:(e,t,a)=>{"use strict";function n(e){return!!e&&"limited"in e&&!0===e.limited}function s(e){var t;return!!e&&"limitedBy"in e&&(null==(t=e.limitedBy)?void 0:t.length)===1&&e.limitedBy.includes("mfa")}function r(e){let{slug:t,push:a}=e;a(i({slug:t}).toString())}function l(e){let{push:t}=e;t("https://vercel.com/account/settings/authentication#two-factor-authentication")}function i(e){let{slug:t,path:a}=e;a||(a="/?scope=".concat(t));let n=new URL(a,"https://".concat("v0.dev").replaceAll("v0chat-","v0-")).toString(),s=new URLSearchParams;s.append("next",n);let r="/api/v0/redirect-to-v0?".concat(s.toString()),l=new URL("https://vercel.com/login/scope/".concat(t));return l.searchParams.append("missingScope","1"),l.searchParams.append("next",r),l.toString()}function o(e){let{chatId:t,projectId:a,scopeSlug:n,lastUserInput:s}=e,r=(e,t)=>{let a=new URLSearchParams;for(let[e,n]of Object.entries(t))n&&a.set(e,n);return 0===a.size?e:"".concat(e,"?").concat(a.toString())};return t?r("/chat/".concat(t),{scope:n}):a?r("/project/".concat(a),{scope:n}):s?r("/chat",{q:s,scope:n,pid:a}):void 0}a.d(t,{kb:()=>o,ol:()=>i,qm:()=>r,s0:()=>s,sJ:()=>n,v2:()=>l})},1332:(e,t,a)=>{"use strict";a.d(t,{o:()=>i});var n=a(97667),s=a(25296),r=a(80381),l=a(28819);function i(e){let{knowledgeSource:t,className:a}=e;switch(null==t?void 0:t.toLowerCase()){case"nextjs.org":return(0,n.jsx)(r.default,{alt:"Next.js Logo",className:a,height:16,src:"/chat-static/citation/nextjs.svg",width:16});case"vercel.com":case"sdk.vercel.ai":return(0,n.jsx)(r.default,{alt:"Vercel Logo",className:a,height:16,src:"/chat-static/citation/vercel.svg",width:16});case"turbo.build":return(0,n.jsx)(r.default,{alt:"Turbopack Logo",className:a,height:16,src:"/chat-static/citation/turbo.svg",width:16});case"flags-sdk.dev":return(0,n.jsx)(r.default,{alt:"Vercel Logo",className:a,height:16,src:"/chat-static/citation/flags.svg",width:16});case"svelte.dev":case"kit.svelte.dev":return(0,n.jsx)(r.default,{alt:"Svelte Logo",className:(0,l.cn)(a,"rounded-none"),height:16,src:"/chat-static/citation/svelte.svg",width:16});case"docs.stripe.com":return(0,n.jsx)(r.default,{alt:"Stripe Logo",className:(0,l.cn)(a,"rounded-none"),height:12,src:"/chat-static/citation/stripe.svg",width:12});case"remix.run":return(0,n.jsx)(r.default,{alt:"Remix Logo",className:(0,l.cn)(a,"rounded-none"),height:12,src:"/chat-static/citation/remix.svg",width:12});case"vuejs.org":return(0,n.jsx)(r.default,{alt:"Vue Logo",className:(0,l.cn)(a,"rounded-none"),height:16,src:"/chat-static/citation/vue.svg",width:16});case"react.dev":return(0,n.jsx)(r.default,{alt:"React Logo",className:(0,l.cn)(a,"rounded-none"),height:16,src:"/chat-static/citation/react.svg",width:16});case"typescriptlang.org":return(0,n.jsx)(r.default,{alt:"Typescript Logo",className:(0,l.cn)(a),height:16,src:"/chat-static/citation/ts.svg",width:16});case"github.com":return(0,n.jsx)(r.default,{alt:"Github Logo",className:a,height:16,src:"/chat-static/citation/github.svg",width:16});case"ui.shadcn.com":return(0,n.jsx)(r.default,{alt:"shadcn/ui Logo",className:(0,l.cn)(a),height:16,src:"/chat-static/citation/shadcn-ui.svg",width:16});case"radix-ui.com":return(0,n.jsx)(r.default,{alt:"Radix UI Logo",className:(0,l.cn)(a,"size-3.5 translate-x-0.5 rounded-none"),height:14,src:"/chat-static/citation/radix-ui.svg",width:14});case"orm.drizzle.team":return(0,n.jsx)(r.default,{alt:"Drizzle Logo",className:(0,l.cn)(a,"dark:invert"),height:22,src:"/chat-static/citation/drizzle.svg",width:22});case"supabase.com":return(0,n.jsx)(r.default,{alt:"Supabase Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/supabase.svg",width:14});case"www.prisma.io":return(0,n.jsx)(r.default,{alt:"Prisma Logo",className:(0,l.cn)(a,"dark:invert"),height:14,src:"/chat-static/citation/prisma.svg",width:14});case"playwright.dev":return(0,n.jsx)(r.default,{alt:"Playwright Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/playwright.svg",width:14});case"neon.tech":return(0,n.jsx)(r.default,{alt:"Neon Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/neon.svg",width:14});case"upstash.com":return(0,n.jsx)(r.default,{alt:"Upstash Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/upstash.svg",width:14});default:return(0,n.jsx)(s.q,{className:(0,l.cn)(a,"rounded-none"),size:16})}}},1731:(e,t,a)=>{"use strict";a.d(t,{G:()=>f,X:()=>x});var n=a(97667),s=a(1221),r=a(99339),l=a(27693),i=a(93660),o=a(33571),c=a(14187),d=a(28819),u=a(74162),m=a(64935),h=a(40445),p=a(70158);function x(e){let{scope:t,user:a,showEmail:i=!1,trigger:o=!1,children:d,showAvatar:p=!0,showName:x=!1,skeleton:f}=e,v=(0,s.sJ)(t),j=v&&(0,s.s0)(t),b=(0,h.W)(t),{scopePlan:y,scopeMembershipRole:w,hasV0Seat:N,accessRequested:k,isLoading:C}=(0,u.f)({scope:t,user:a}),S=(0,l.k)(),M=(0,n.jsx)(g,{authRequired:v,isMfaLimited:j,emailToShow:i?null==a?void 0:a.email:void 0,isLoading:C,role:w,scopeSlug:b?t.username:t.slug,scopePlan:y,v0Access:N,accessRequested:k});if(o){let e=y&&"v0-level0"===y;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.AvatarUser,{size:"xs",className:"mr-1.5 block size-5",rounded:!0,teamId:b?void 0:t.id,userId:null==a?void 0:a.id}),(0,n.jsxs)("div",{className:"flex min-w-0 flex-1 items-center truncate text-start text-sm font-medium leading-[20px] text-gray-900",children:[(0,n.jsx)("div",{className:"max-w-64 truncate",children:b?S("sidebar.personal"):t.name}),e?(0,n.jsx)(c.dS,{type:y,includeSuffix:!1,className:"bg-alpha-400 ml-1.5 h-[18px] rounded-full border-none px-1.5"}):null]}),(0,n.jsx)(m.R,{className:"mx-1 !text-gray-500"})]})}return!y&&b&&f?f:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[p&&(0,n.jsx)(r.AvatarUser,{teamId:b?void 0:t.id,userId:null==a?void 0:a.id}),(0,n.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start",children:[(0,n.jsx)("div",{className:"w-full truncate text-start text-sm font-medium leading-[20px] text-gray-900",children:b&&!x?S("sidebar.personal"):t.name}),M]}),d]})}function f(e){let{variant:t}=e;return(0,n.jsxs)("div",{className:(0,d.cn)("flex w-full justify-between gap-2",{"p-1.5":"list-item"===t,"py-0.5":"indicator"===t}),children:[(0,n.jsx)(i.E,{className:"size-8 rounded-lg"}),(0,n.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start justify-between pb-px pt-0.5",children:[(0,n.jsx)(i.E,{className:"h-3 w-24 rounded-lg"}),(0,n.jsx)(i.E,{className:"h-3 w-12 rounded-lg"})]})]})}function g(e){let{authRequired:t,isMfaLimited:a,isLoading:r,scopeSlug:u,scopePlan:m,role:h,v0Access:x,accessRequested:f,emailToShow:g}=e,v=(0,l.k)(),j=(0,p.useRouter)(),b=x&&m,y=(0,o.useMemo)(()=>t?a?"2FA Required":"Authentication Required":g||(b?(0,n.jsx)(c.U3,{type:m}):"OWNER"===h?v("billingPlans.startTeamPlan"):f?v("billingPlans.accessRequested"):v("billingPlans.requestAccess")),[t,g,b,a,m,h,v,f]),w="h-4 w-full truncate text-start text-[13px] font-medium leading-[16px] text-gray-500";return r?(0,n.jsx)(i.E,{className:"h-4 w-20 rounded-lg "}):t?(0,n.jsx)("button",{onClick:()=>{if(a)return void(0,s.v2)({push:j.push});(0,s.qm)({slug:u,push:j.push})},className:(0,d.cn)(w,"hover:underline"),children:y}):(0,n.jsx)("div",{className:w,children:y})}},2230:(e,t,a)=>{"use strict";a.d(t,{$Q:()=>c,bD:()=>u,mO:()=>l,nV:()=>i,sP:()=>d,sx:()=>o});var n=a(97667),s=a(33571),r=a(44606);let l=()=>{let e=r.A;return(0,s.useContext)(e)};function i(){return(0,s.createContext)({})}function o(e){let{context:t,getAtoms:a}=e;return e=>{let{children:r,routes:l}=e,i=(0,s.useMemo)(()=>({routes:l,getAtoms:a}),[l]);return(0,n.jsx)(t.Provider,{value:i,children:r})}}let c=e=>{let t=r.P[e];return(0,s.useContext)(t)};function d(e){return(0,s.createContext)({})}function u(e){return t=>{let{children:a,promises:r,params:l}=t,i=(0,s.useMemo)(()=>({promises:r,params:l,serverContextCreationTime:Date.now()}),[r,l]);return(0,n.jsx)(e.Provider,{value:i,children:a})}}},2783:(e,t,a)=>{"use strict";a.d(t,{uH:()=>Y,xb:()=>K,xs:()=>J});var n=a(97667),s=a(28819),r=a(57085),l=a(32136),i=a(35501),o=a.n(i),c=a(45738),d=a(74118),u=a(19243),m=a(43573),h=a(94177),p=a(43447),x=a(31818),f=a(61112),g=a(32376),v=a(68618),j=a(39929),b=a(66692),y=a(27693),w=a(95820),N=a(69114),k=a(73655),C=a(19003),S=a(33571),M=a(51368),I=a(60574),A=a(36323),D=a(74905),L=a(76727),z=a(40209),E=a(99066),P=a(25951),T=a(25905),F=a(92071),R=a(25887),U=a(57560),V=a(80672),B=a(56508),_=a(992),O=a(67964),H=a(96151),$=a(940),q=a(63476),W=a(73641),G=a(54116),Z=a(89547);let Y=(0,U.eU)(!1),K=(0,U.eU)("overview");function J(e){let{isAuthor:t}=e,{canWriteToChat:a}=(0,l.tZ)(),s=(0,A.eu)(),r=(0,D.s)(),{chatPrivacy:i}=(0,l.kM)(),o=(0,W.x)(),c=(0,q.x)(),{messages:u,activeForkKey:m}=(0,d.Pk)(),{getBlockShared:h}=(0,T.L)(),p=(0,S.useMemo)(()=>u.filter(e=>null==m?void 0:m.includes(e.id)).some(e=>{var t;return(0,L.sY)(null!=(t=e.content)?t:"",e.id).length>0}),[u,m]),x=(0,S.useMemo)(()=>!a&&("public"===i||"unlisted"===i||"team"===i),[a,i]),f=(0,S.useMemo)(()=>s&&(0,F.q)(s),[s]),g=(0,S.useMemo)(()=>!!s&&h(s.id),[s,h]),v=(0,S.useMemo)(()=>!!(a&&!r),[a,r]),j=(0,S.useMemo)(()=>{if(x&&!r&&s)return(0,n.jsx)(H.y,{blockId:s.id})},[x,r,s]),b=(0,S.useMemo)(()=>{if(s)return(0,n.jsx)(B.C,{})},[s]),y=(0,S.useMemo)(()=>{if(s&&o&&f&&!g)return(0,n.jsx)(_.C,{chatId:o})},[s,o,f,g]),w=(0,S.useMemo)(()=>{if(s&&o&&f&&!g)return(0,n.jsx)(Z.y,{chatId:o,activeBlock:s})},[s,o,f,g]),N=(0,S.useMemo)(()=>{if(x&&s&&!r)return(0,n.jsx)(O.ForkBlockButton,{blockId:s.id,isAuthor:t,page:"chat"})},[s,r,x,t]),k=(0,S.useMemo)(()=>{if(!s&&!r&&p)return(0,n.jsx)(et,{})},[s,r,p]);return c?(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(X,{isAuthor:t}),(0,n.jsx)(ee,{}),(0,n.jsx)(Q,{}),(0,n.jsx)(C.w,{isAuthor:t})]}),j,v?(0,n.jsxs)(n.Fragment,{children:[w,b,y]}):null,N,k,(0,n.jsx)(G.s,{})]}):null}function Q(){let{project:e,title:t,canWriteToChat:a}=(0,l.tZ)(),[s,r]=(0,V.useAtom)(Y),i=window.location.pathname.includes("/projects/"),{submit:o}=(0,E.yI)(),{vercelProjectWithDashboard:c}=(0,P.Ok)(null==e?void 0:e.projectId),{refetchLinks:d}=(0,z.d)({source:"settings"},async e=>{r(!1),e.forEach(e=>{(0,u.u)("AddIntegration",{integrationSlug:e.integrationName,chatId:e.chatId||"",source:e.source})}),i||await o({action:"new",attachments:[],input:"The integration".concat(e.length>1?"s":""," ").concat($.Y.format(e.map(e=>e.integrationName))," ").concat(e.length>1?"have":"has"," been added to the [Vercel Project](").concat(null==c?void 0:c.project.url,")."),type:"added-integration",workflowState:"add-starter-integration",revalidateVercelEnvAndIntegrations:!0})});return(0,q.x)()&&a?(0,n.jsx)(M.b,{v0ProjectId:null==e?void 0:e.projectId,chatTitle:t,isSheetOpen:s,onOpenChange:r,initiatePolling:d}):null}function X(e){let{isAuthor:t}=e,a=(0,W.x)(),{data:r}=(0,N.r)(),i=(0,S.useMemo)(()=>null==r?void 0:r.find(e=>e.chatId===a),[r,a]),{title:c,project:d,canWriteToChat:x}=(0,l.tZ)(),k=null==d?void 0:d.projectId,C=(0,y.k)(),{setData:M}=(0,N.m)(),{vercelProjectWithDashboard:I}=(0,P.Ok)(null==d?void 0:d.projectId),A=null==I?void 0:I.dashboardProject;return x?(0,n.jsxs)(j.DropdownMenu,{children:[(0,n.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsxs)(b.$,{size:"sm",className:"size-7 rounded-md",variant:"ghost",children:[(0,n.jsx)(m.a,{}),(0,n.jsx)("span",{className:"sr-only",children:C("chatOptionsDropdown.moreOptions")})]})}),(0,n.jsx)(j.DropdownMenuContent,{align:"end",children:(0,n.jsxs)(j.DropdownMenuGroup,{children:[(null==A?void 0:A.link)&&(0,n.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,n.jsxs)("a",{href:"https://github.com/".concat(A.link.org,"/").concat(A.link.repo),target:"_blank",rel:"noopener noreferrer",children:[(0,n.jsx)(f.P,{}),(0,n.jsx)("span",{className:"flex-1",children:C("chatOptionsDropdown.viewOnGitHub")}),(0,n.jsx)(g.i,{})]})}),(0,n.jsx)(j.DropdownMenuItem,{className:(0,s.cn)("md:hidden",!k&&"hidden"),asChild:!0,children:(0,n.jsxs)(o(),{href:"/chat/projects/".concat(k),children:[(0,n.jsx)(v.z,{}),(0,n.jsx)("span",{children:C("chatOptionsDropdown.viewProject")})]})}),(0,n.jsxs)(j.DropdownMenuItem,{onClick:()=>{a&&((0,u.u)("RenameChat",{targetChatId:a}),(0,R.D)({type:"updateChatTitle",data:{chatId:a}}))},children:[(0,n.jsx)(h.Y,{}),(0,n.jsx)("span",{children:C("chatOptionsDropdown.renameChat")})]}),a&&(0,n.jsx)(w.$,{chat:{chatId:a,title:c||"",favorite:!!i,updatedAt:(null==i?void 0:i.updatedAt)||null},setChatHistoryData:M}),(0,n.jsxs)(j.DropdownMenuItem,{onClick:()=>{a&&(0,R.D)({type:"deleteChat",data:{chatId:a}})},variant:"destructive",children:[(0,n.jsx)(p.l,{}),(0,n.jsx)("span",{children:C("chatOptionsDropdown.deleteChat")})]})]})})]}):null}function ee(){let e=(0,W.x)(),{user:t}=(0,k.k6)();return(null==t?void 0:t.isAdminMode)&&e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.v,{chatId:e,className:"sm:hidden md:flex"}),(0,n.jsx)(r.Z,{className:"hidden md:flex"})]}):null}function et(){let{reopenLastBlock:e}=(0,I.e)();return(0,n.jsx)(b.$,{variant:"ghost",size:"sm",onClick:()=>e(),title:"Reopen last block",className:"size-7 rounded-md",children:(0,n.jsx)(x.U,{})})}},2995:(e,t,a)=>{"use strict";a.d(t,{bA:()=>v,xG:()=>b,rX:()=>x,Dr:()=>g,sW:()=>f,Wq:()=>y});var n=a(97667),s=a(59479),r=a.n(s),l=a(48882);function i(e){let{size:t=2,height:a,className:s}=e;return(0,n.jsxs)("span",{className:(0,l.A)(r().loading,s),"data-geist-loading-dots":"","data-version":"v1",style:{"--loading-dots-height":a?o(a):void 0,"--loading-dots-size":2!==t?o(t):void 0},children:[(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{})]})}let o=e=>"number"==typeof e?"".concat(e,"px"):e;var c=a(19434),d=a(52356),u=a(39929),m=a(35501),h=a.n(m),p=a(32376);function x(e){let{className:t,children:a,...s}=e;return(0,n.jsx)(u.DropdownMenuGroup,{className:(0,c.cn)("flex flex-col gap-0.5",t),...s,children:a})}function f(e){let{label:t,Icon:a,children:s}=e;return(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-4 text-gray-500",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[a,(0,n.jsx)("span",{className:"text-nowrap text-sm font-normal text-gray-900",children:t})]}),s]})}function g(e){let{className:t,children:a,clickable:s=!0,...r}=e;return(0,n.jsx)(u.DropdownMenuItem,{className:(0,c.cn)(!s&&"hover:!bg-transparent",t),onSelect:e=>e.preventDefault(),...r,children:a})}function v(e){let{action:t,disabled:a,...s}=e;return(0,n.jsx)(g,{asChild:!0,disabled:a,children:(0,n.jsx)("form",{action:t,children:(0,n.jsx)(j,{...s})})})}function j(e){let{label:t,Icon:a,children:s}=e,{pending:r}=(0,d.useFormStatus)();return(0,n.jsx)("button",{type:"submit",className:"w-full",children:(0,n.jsx)(f,{label:t,Icon:a&&r?(0,n.jsx)("div",{className:"flex size-4 items-center justify-center",children:(0,n.jsx)(i,{size:4})}):a,children:s})})}function b(e){let{href:t,external:a=!1,onClick:s,label:r,Icon:l,sameTab:i=!0,children:o,className:c}=e;return(0,n.jsx)(g,{className:c,onSelect:e=>{e.preventDefault(),null==s||s()},asChild:!0,children:(0,n.jsx)(h(),{href:t,target:i?void 0:"_blank",children:(0,n.jsxs)(f,{label:r,Icon:l,children:[o||null,a&&!o?(0,n.jsx)(p.i,{}):null]})})})}function y(e){let{children:t}=e;return(0,n.jsx)("div",{className:"flex h-8 items-center px-1.5",children:(0,n.jsx)("span",{className:"text-[13px] font-medium leading-[16px] text-gray-500",children:t})})}},3447:e=>{e.exports={choiceBoxItem:"choice-box_choiceBoxItem__WMz4O"}},3974:(e,t,a)=>{"use strict";a.d(t,{o:()=>r});var n=a(97667),s=a(28819);function r(e){let{className:t,children:a,bottomBorder:r,onePixelShorter:l}=e;return(0,n.jsx)("div",{className:(0,s.cn)("flex w-full shrink-0 items-center pl-3 pr-2 text-[13px] font-medium text-gray-500",l?"h-[calc(2.25rem-1px)]":"h-9",r&&"border-alpha-200 border-b",t),"data-slot":"block-tab-header",children:a})}},4608:(e,t,a)=>{"use strict";a.d(t,{i:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40bca689a700fa36e6d763310fb9f7b5cda5fbd4e1",n.callServer,void 0,n.findSourceMapURL,"createPaymentMethodAction")},4842:(e,t,a)=>{"use strict";a.d(t,{Q:()=>c,w:()=>d});var n=a(97667),s=a(77831),r=a(20125),l=a(28819),i=a(18858),o=a(27693);let c="scroll-down-button";function d(e){let{scrollToBottom:t,hidden:a,className:d,...u}=e,m=(0,o.k)(),{showBannerLimit:h,showBannerGeneral:p}=(0,i.f)();return(0,n.jsx)("div",{id:c,"aria-hidden":a,className:(0,l.cn)("animate-in fade-in slide-in-from-bottom absolute inset-x-0 -top-12 z-10 m-auto flex w-fit items-center justify-center group-has-[[data-slot=prompt-actions-container]]/form-container:-top-20",a&&"animate-out fade-out slide-out-to-bottom fill-mode-forwards pointer-events-none",(h||p)&&"-top-16",d),...u,children:(0,n.jsx)(r.Tooltip,{content:!a&&(0,n.jsx)(r.TooltipContent,{side:"top",sideOffset:14,children:m("scrollDownButton.scrollToBottom")}),children:(0,n.jsx)("button",{className:(0,l.cn)("animate-slowBounce shadow-base bg-background hover:bg-muted flex size-7 items-center justify-center rounded-full text-gray-500 drop-shadow-md",a&&"hidden"),onClick:e=>{e.stopPropagation(),t()},type:"button",children:(0,n.jsx)(s.D3D,{className:"size-5"})})})})}},4868:(e,t,a)=>{"use strict";a.d(t,{Switch:()=>i});var n=a(97667),s=a(33571),r=a(29105),l=a(28819);let i=s.forwardRef((e,t)=>{let{className:a,thumbClassName:s,asDiv:i,children:o,...c}=e,d=(0,n.jsx)(r.zi,{className:(0,l.cn)("bg-background pointer-events-none block size-[calc(theme(spacing.4)_-2px)] rounded-full shadow-sm ring-0 transition-transform data-[state=checked]:translate-x-[theme(spacing.4)] data-[state=unchecked]:translate-x-0 dark:bg-black",s),children:o});return(0,n.jsx)(r.bL,{className:(0,l.cn)("focus-visible:ring-offset-background peer inline-flex h-4 w-8 shrink-0 cursor-pointer items-center rounded-full border outline-none ring-blue-600 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=unchecked]:bg-gray-100",a),...c,asChild:i,ref:t,children:i?(0,n.jsx)("div",{children:d}):d})});i.displayName=r.bL.displayName},5052:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,F:()=>i});var n=a(97667),s=a(33571),r=a(79673),l=a(19434);let i=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,n.jsxs)(r.bL,{className:(0,l.cn)("relative overflow-hidden",a),ref:t,...i,children:[(0,n.jsx)(r.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,n.jsx)(o,{}),(0,n.jsx)(r.OK,{})]})});i.displayName=r.bL.displayName;let o=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...i}=e;return(0,n.jsx)(r.VM,{className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),orientation:s,ref:t,...i,children:(0,n.jsx)(r.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=r.VM.displayName},5628:e=>{e.exports={circle:"gauge_circle__8qHPe",content:"gauge_content__Ha_5u",animate:"gauge_animate__l7E7z",arc:"gauge_arc__vkhZw",arcSecondary:"gauge_arcSecondary__KCzRC",fadeIn:"gauge_fadeIn__gi7G_"}},5759:(e,t,a)=>{"use strict";a.d(t,{$:()=>s,N:()=>r});var n=a(37758);function s(e){let t=[...new Set(Object.values(n.Bi).flat())];return e.filter(e=>{let a=e.toUpperCase();return t.some(e=>a.includes(e.toUpperCase()))})}function r(e){let t=new Set;for(let[a,s]of Object.entries(n.Jc))for(let n of s)if(e.includes(n)){t.add(a);break}for(let[a,s]of Object.entries(n.Tb))for(let n of s)if(e.includes(n)){t.add(a);break}return Array.from(t)}},6447:(e,t,a)=>{"use strict";a.d(t,{X:()=>s,z:()=>r});var n=a(19243);function s(e){let t=r(e),a=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(a),l=document.createElement("a");return l.download="output.txt",l.href=s,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s),(0,n.u)("DownloadOutputExecutable",{output:t})}let r=e=>{if(!e)return"No output.";if("error"in e)return"Errored output. "+e.error;if(!Array.isArray(e.stdout)||!Array.isArray(e.stderr))return"Malformed output.";if(0===e.stdout.length&&0===e.stderr.length)return"Empty output.";let t=e.stdout.map(e=>e.map(e=>JSON.stringify(e,void 0,2)).join(" ")).join("\n"),a=e.stderr.map(e=>e.map(e=>JSON.stringify(e,void 0,2)).join(" ")).join("\n");return 0===e.stderr.length?t:0===e.stdout.length?"# stderr\n\n"+a:"# stdout\n\n"+t+"\n\n# stderr\n\n"+a}},6680:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var n=a(97667),s=a(75486),r=a(23503);function l(){return(0,n.jsxs)(s.Fc,{variant:"default",className:"relative flex flex-row gap-1 rounded-md border-none bg-gray-100 px-2 py-1.5",children:[(0,n.jsx)("div",{className:"absolute left-[9px] top-[9px] text-gray-500",children:(0,n.jsx)(r.$,{className:"h-4 w-4"})}),(0,n.jsx)(s.TN,{className:"ml-6 text-gray-800",children:"Viewers will have access to all code and assets present in the chat."})]})}},6902:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Label:()=>c});var n=a(97667),s=a(33571),r=a(31136),l=a(60914),i=a(28819);let o=(0,l.F)("text-[13px] leading-none text-gray-500 peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.b,{className:(0,i.cn)(o(),a),ref:t,...s})});c.displayName=r.b.displayName},7107:(e,t,a)=>{"use strict";a.d(t,{P:()=>o,x:()=>i});var n=a(96763),s=a(84002);function r(){let e=(0,n._)(["https://www.braintrust.dev/app/Vercel/p/",'/logs?search={"filter":["(metadata.chatId="','"+AND+metadata.messageId="','")"]}'],["https://www.braintrust.dev/app/Vercel/p/",'/logs?search={"filter":["(metadata.chatId=\\"','\\"+AND+metadata.messageId=\\"','\\")"]}']);return r=function(){return e},e}function l(){let e=(0,n._)(["https://www.braintrust.dev/app/Vercel/p/",'/logs?search={"filter":["metadata.chatId="','""]}'],["https://www.braintrust.dev/app/Vercel/p/",'/logs?search={"filter":["metadata.chatId=\\"','\\""]}']);return l=function(){return e},e}function i(e,t){let a=e.slice(0,t),n=(a.match(/[^\\]```/g)||[]).length%2;return a+(1===n?"```":"")+(e.length>t?"...":"")}function o(e){let{chatId:t,messageId:a}=e;return a?String.raw(r(),s.env.BRAINTRUST_PROJECT_NAME||"dev-1-q-and-a",t,a):String.raw(l(),s.env.BRAINTRUST_PROJECT_NAME||"dev-1-q-and-a",t)}},7722:(e,t,a)=>{"use strict";a.d(t,{a:()=>d,e:()=>c});var n=a(97667),s=a(20393),r=a(27831),l=a(19434),i=a(33571);function o(e){let{width:t=40,height:a,className:s,...r}=e;return(0,n.jsxs)("svg",{className:(0,l.cn)("text-pink",s),fill:"none",height:a,viewBox:"0 0 40 20",width:t,xmlns:"http://www.w3.org/2000/svg",...r,children:[(0,n.jsx)("path",{d:"M23.3919 0H32.9188C36.7819 0 39.9136 3.13165 39.9136 6.99475V16.0805H36.0006V6.99475C36.0006 6.90167 35.9969 6.80925 35.9898 6.71766L26.4628 16.079C26.4949 16.08 26.5272 16.0805 26.5595 16.0805H36.0006V19.7762H26.5595C22.6964 19.7762 19.4788 16.6139 19.4788 12.7508V3.68923H23.3919V12.7508C23.3919 12.9253 23.4054 13.0977 23.4316 13.2668L33.1682 3.6995C33.0861 3.6927 33.003 3.68923 32.9188 3.68923H23.3919V0Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M13.7688 19.0956L0 3.68759H5.53933L13.6231 12.7337V3.68759H17.7535V17.5746C17.7535 19.6705 15.1654 20.6584 13.7688 19.0956Z",fill:"currentColor"})]})}function c(e){let{size:t=20,loading:a=!1,invert:i}=e,c={width:t,height:.5*t,minWidth:t,minHeight:.5*t},u={...c,gridArea:"1 / 1",transform:"translateX(-1px)",...(0,r.iA)(["opacity"],{duration:500})};return(0,n.jsxs)("span",{"aria-hidden":!0,className:(0,l.cn)("grid grid-cols-1 grid-rows-1 overflow-visible"),style:{...c,filter:i?"invert(1) brightness(2)":"invert(0)"},children:[(0,n.jsx)(d,{style:{...(0,s.o)(a),...u}}),(0,n.jsx)(o,{style:{...(0,s.o)(!a),...u},className:(0,l.cn)("h-full min-w-[20px] text-gray-900")})]})}function d(e){let{...t}=e,a=(0,i.useId)(),s="v-clip-".concat(a);return(0,n.jsxs)("svg",{fill:"none",height:"18",viewBox:"15.5 41.5 100 41",width:"40",xmlns:"http://www.w3.org/2000/svg",...t,className:(0,l.cn)("v0-loader",t.className),children:[(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:s,children:(0,n.jsx)("rect",{height:"98",width:"128",x:"0",y:"46"})})}),(0,n.jsxs)("g",{clipPath:"url(#".concat(s,")"),children:[(0,n.jsx)("path",{className:"bg",d:"M 15 38 C 18.011 41.4115 41.0275 67.4845 48.5 77.3 c 5.9 6.8 5.8 6.7 5.8 -1.6 C 54.3 69.651 54.3 42.8741 54.3 42.8741"}),(0,n.jsx)("path",{className:"fg",d:"M 15 38 C 18.011 41.4115 41.0275 67.4845 48.5 77.3 c 5.9 6.8 5.8 6.7 5.8 -1.6 C 54.3 69.651 54.3 42.8741 54.3 42.8741",id:"v",pathLength:"1"})]}),(0,n.jsx)("path",{className:"bg",d:"M 102.9 48.5 L 75.7 75.2"}),(0,n.jsx)("path",{className:"fg",d:"M 102.9 48.5 L 75.7 75.2",id:"o-slash",pathLength:"1"}),(0,n.jsx)("path",{className:"bg",d:"M73.4653 41.7309L97.3029 41.7309C101.815 41.7309 109.905 46.2887 109.905 54.1283V77.1615"}),(0,n.jsx)("path",{className:"fg",d:"M73.4653 41.7309L97.3029 41.7309C101.815 41.7309 109.905 46.2887 109.905 54.1283V77.1615",id:"o-top",pathLength:"0.99"}),(0,n.jsx)("path",{className:"bg",d:"M104.996 81.8855L81.0314 81.8855C75.5619 81.8855 68.5885 76.5073 68.5885 69.1236L68.5885 46.2209"}),(0,n.jsx)("path",{className:"fg",d:"M104.996 81.8855L81.0314 81.8855C75.5619 81.8855 68.5885 76.5073 68.5885 69.1236L68.5885 46.2209",id:"o-bottom",pathLength:"0.99"})]})}},7909:(e,t,a)=>{"use strict";a.d(t,{b:()=>ee,n:()=>et});var n=a(97667),s=a(51056),r=a(45326),l=a(69938),i=a(59299),o=a(21486),c=a(49872),d=a(14237),u=a(99658),m=a(10828),h=a(59968),p=a(43917),x=a(75479),f=a(47466),g=a(97097),v=a(8369),j=a(82893),b=a(78166),y=a(66621),w=a(71573),N=a(53023),k=a(43666),C=a(30101),S=a(62111),M=a(35911),I=a(20842),A=a(45420),D=a(6545),L=a(1054),z=a(645),E=a(4581),P=a(5669),T=a(31549),F=a(68817),R=a(10417),U=a(72718),V=a(47545),B=a(81167),_=a(29034),O=a(19457),H=a(66247),$=a(69087),q=a(20876),W=a(4773),G=a(56446),Z=a(47715),Y=a(33284),K=a(71449),J=a(85720),Q=a(8563),X=a(50709);let ee={"icon-alarm-clock":s.A,"icon-apple":r.A,"icon-app-window-mac":l.A,"icon-atom":i.A,"icon-bar-chart":o.A,"icon-blocks":c.A,"icon-book-text":d.A,"icon-briefcase":u.A,"icon-bug":m.A,"icon-calendar":h.A,"icon-camera":p.A,"icon-code":x.A,"icon-fingerprint":f.A,"icon-flame":g.A,"icon-flask-conical":v.A,"icon-folder-closed":j.A,"icon-gamepad":b.A,"icon-github":y.A,"icon-gitlab":w.A,"icon-globe":N.A,"icon-heart":k.A,"icon-home":C.A,"icon-image":S.A,"icon-key-square":M.A,"icon-laptop":I.A,"icon-layers":A.A,"icon-lightbulb":D.A,"icon-link":L.A,"icon-lock":z.A,"icon-mail":E.A,"icon-message-square-text":P.A,"icon-palette":T.A,"icon-paint-roller":F.A,"icon-pie-chart":R.A,"icon-rocket":U.A,"icon-scroll-text":V.A,"icon-settings":B.A,"icon-shield-check":_.A,"icon-smartphone":O.A,"icon-siren":H.A,"icon-sprout":$.A,"icon-square-function":q.A,"icon-traffic-cone":W.A,"icon-trending-down":G.A,"icon-trending-up":Z.A,"icon-trophy":Y.A,"icon-user":K.A,"icon-wand-sparkles":J.A,"icon-wrench":Q.A,"icon-zap":X.A};function et(e){let{name:t}=e,a=ee[t];return(0,n.jsx)(a,{})}},8026:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var n=a(97667),s=a(28819),r=a(7909);function l(e){let{icon:t,size:a="sm",variant:l="default",className:i}=e;return(0,n.jsx)("div",{className:(0,s.cn)("bg-background-subtle relative flex size-8 shrink-0 items-center justify-center text-gray-500 after:absolute after:inset-0 after:mix-blend-darken dark:after:mix-blend-lighten",{"size-5 rounded-sm after:rounded-sm [&>svg]:size-2.5 text-base after:border":"xs"===a,"size-8 rounded-lg after:rounded-lg [&>svg]:size-4 text-base after:border":"sm"===a,"size-12 rounded-xl after:rounded-xl [&>svg]:size-4 text-xl shadow-sm":"lg"===a},"menu-item"===l&&"size-4 bg-transparent text-gray-600 after:hidden group-hover:text-gray-900 group-focus:text-gray-900 [&>svg]:size-4",i),children:(0,n.jsx)(r.n,{name:t})})}},8599:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});var n=a(97667),s=a(99647),r=a(81657);function l(e){return(0,n.jsx)(s.Dp,{variants:{hover:{rotate:60},tap:{rotate:360,interruptible:!1,transition:{duration:1,ease:[.27,.34,.22,.97]}},idle:{rotate:0}},children:(0,n.jsx)(r.g,{"aria-hidden":!0,...e})})}a(33571)},8689:(e,t,a)=>{"use strict";a.d(t,{o:()=>i});var n=a(97667),s=a(33571),r=a(28819),l=a(65744);let i=(0,s.forwardRef)((e,t)=>{let{maxHeight:a=384,minHeight:i=42,className:o,resizeFunctionRef:c,...d}=e,u=(0,s.useRef)(null);(0,s.useImperativeHandle)(t,()=>u.current);let m=(0,s.useCallback)(()=>{let e=u.current;if(!e)return;e.style.height="".concat(i,"px");let t=e.scrollHeight;e.style.height="".concat(Math.max(i,Math.min(t,a)),"px")},[a,i]);(0,s.useImperativeHandle)(c,()=>m);let h=(0,s.useCallback)(e=>{var t;m(),u.current&&(null==(t=d.onChange)||t.call(d,e))},[d,m]);return(0,s.useEffect)(()=>{let e=new MutationObserver(m);return u.current&&e.observe(u.current,{characterData:!0,subtree:!0}),()=>e.disconnect()},[h,m]),(0,l.wY)({ref:u,onResize:m}),(0,s.useEffect)(()=>{m()},[m]),(0,n.jsx)("textarea",{...d,className:(0,r.cn)("resize-none overflow-auto",o),autoComplete:"off",onChange:h,"data-1p-ignore":!0,"data-dashlane-disabled-on-field":!0,ref:u,style:{...d.style,minHeight:"".concat(i,"px"),maxHeight:"".concat(a,"px")}})});i.displayName="ResizableTextArea"},9285:(e,t,a)=>{"use strict";a.d(t,{Cy:()=>r,J:()=>s,Ln:()=>l,Mu:()=>n});function n(e){return s(e,!0)}function s(e,t){return Math.floor(.297*("string"==typeof e?e.length:e.charCount)+1379.14*!t)}function r(e){return Math.round(4*e*(1/.9))}function l(e){return Math.round(1334*(("number"==typeof e?e:e.size)/1048576))}},9592:(e,t,a)=>{"use strict";a.d(t,{F:()=>l,w:()=>r});var n=a(25603),s=a(13653);function r(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{data:t,mutate:a}=(0,n.Ay)("showOnboardingModal",null,{fallbackData:e});return{showOnboardingModal:t,setShowOnboardingModal:a}}function l(e){return(0,s.k)("showOnboardingModal",e)}},10034:(e,t,a)=>{"use strict";a.d(t,{Cj:()=>I,pj:()=>L,pw:()=>D});var n=a(97667),s=a(92871),r=a(66692),l=a(89385),i=a(28819),o=a(80574),c=a(18249),d=a(41956),u=a(87501),m=a(2079),h=a(57157),p=a(35806),x=a(25502),f=a(95352),g=a(80381),v=a(33571),j=a(71543),b=a(16983),y=a(74260),w=a(51311),N=a(98523),k=a(33578);let C=(0,w.default)(()=>Promise.all([a.e(40831),a.e(5213),a.e(11544)]).then(a.bind(a,11544)).then(e=>e.Table),{loadableGenerated:{webpack:()=>[11544]}});function S(e){var t,a;return(null==(t=e.contentType)?void 0:t.startsWith("video/"))&&!(null==(a=e.name)?void 0:a.endsWith(".ts"))}function M(e){var t;return null==(t=e.contentType)?void 0:t.startsWith("audio/")}function I(e){let{attachments:t,className:a}=e,s=(0,v.useRef)(null);return(null==t?void 0:t.length)?(0,n.jsx)("div",{className:(0,i.cn)("flex w-full items-center gap-2 overflow-x-auto",a),ref:s,children:t.map(e=>(0,n.jsx)(D,{attachment:e},e.url))}):null}function A(e){var t;let{attachment:a}=e,s=null==(t=a.contentType)?void 0:t.startsWith("image/"),r=S(a),l=M(a);return s?(0,n.jsx)(f._,{}):r?(0,n.jsx)(x.C,{}):l?(0,n.jsx)(p.M,{}):"text/csv"===a.contentType?(0,n.jsx)(m.i,{}):(0,n.jsx)(u.Z,{})}function D(e){var t,a;let{className:s,attachment:c,...u}=e,m=null==(t=c.contentType)?void 0:t.startsWith("image/"),p=S(c),[x,f]=(0,v.useState)(800*!!p),[y,w]=(0,v.useState)(600*!!p),[N,k]=(0,v.useState)(!1),[C,M]=(0,v.useState)(null),{content:I,isLoading:D}=(0,l.k)(C),{user:z}=(0,j.J)(),{setShowSignInDialog:E}=(0,b.AO)(),T=(0,d.al)(),F=P(c),R=c.name?(0,i.QY)(c.name,50):"",U=c.name?(0,i.QY)(c.name,20):"";"figma"===c.v0Type&&(U=U.split(".png")[0]),(0,v.useEffect)(()=>{I&&(0,v.startTransition)(()=>{k(!0)})},[I]);let V=(0,n.jsx)(A,{attachment:c});!m&&D?V=(0,n.jsx)(o.y,{}):m&&(V=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.default,{alt:null!=(a=c.name)?a:"Image Preview",className:(0,i.cn)("border-alpha-400 aspect-square rounded-sm border object-cover","figma"===c.v0Type?"invisible":""),fill:!0,onLoad:e=>{let t=e.target,a=t.naturalWidth/t.naturalHeight,n=.8*window.innerWidth,s=.8*window.innerHeight,r=s*a,l=s;a>1&&(r=n,l=n/a),f(r),w(l)},src:c.url}),"figma"===c.v0Type?(0,n.jsx)(h.Y,{}):null]}));let B=(0,n.jsxs)(r.$,{className:(0,i.cn)("h-14 w-full basis-[210px] gap-2 py-2 pl-2 pr-3 text-left ",F||m?"hover:bg-gray-200 focus:bg-gray-200 focus-visible:bg-gray-200":"hover:bg-background focus:bg-background focus-visible:bg-background cursor-default",s),onClick:e=>z?F||m?void(!I&&(e.preventDefault(),M(c.url))):(e.preventDefault(),!1):(e.preventDefault(),E({prompt:!1,customMessage:"A Vercel account is required to view attachments"}),!1),title:c.name,tooltip:T?void 0:R,variant:"secondary",...u,children:[(0,n.jsx)("div",{className:"flex size-10 shrink-0 -translate-x-px items-center justify-center overflow-hidden rounded-sm bg-gray-100 text-gray-500 transition-colors",children:V}),(0,n.jsxs)("div",{className:"grid flex-1 -translate-x-px gap-1 py-0.5 text-sm leading-none text-gray-900 ",children:[(0,n.jsx)("div",{className:"overflow-hidden text-ellipsis font-medium",children:U}),(0,n.jsx)("div",{className:"line-clamp-1 aspect-auto font-normal text-gray-500",children:c.size?(0,i.v7)(c.size):c.contentType})]})]});return(0,n.jsx)(L,{setOpen:k,attachment:c,open:N,triggerButton:B,width:x,height:y,content:I})}function L(e){var t;let{attachment:a,open:s,setOpen:r,triggerButton:l,width:o,height:d,content:u}=e,m=null==(t=a.contentType)?void 0:t.startsWith("image/"),h=S(a),p=M(a),x=P(a),f=(0,v.useRef)(null),g=a.name?(0,i.QY)(a.name,50):"";return"figma"===a.v0Type&&(g=g.replace(".png","")),(0,n.jsxs)(c.lG,{onOpenChange:e=>{if(r(e),e){var t;null==(t=f.current)||t.focus()}},open:s,children:[l?(0,n.jsx)(c.zM,{asChild:!0,children:l}):null,(0,n.jsxs)(c.Cf,{className:(0,i.cn)("w-full max-w-[90vw] auto-rows-min gap-2 rounded-xl p-0 lg:max-w-4xl [&>button:last-child]:invisible",(m||h)&&"aspect-[--aspect-ratio] h-[--height] max-h-[80vh] w-[--width] max-w-[90vw] border-none bg-transparent lg:w-auto",p&&"w-full bg-transparent lg:max-w-4xl",!m&&!h&&!p&&"w-full"),style:{"--width":"".concat(o,"px"),"--height":"".concat(d,"px"),"--aspect-ratio":"".concat(o/d)},children:[(0,n.jsx)(c.L3,{className:"sr-only",children:a.name}),(0,n.jsx)(c.rr,{className:"sr-only",children:a.name}),(0,n.jsx)("button",{className:"absolute -left-full",ref:f}),(0,n.jsx)(v.Suspense,{children:m||h||p?(0,n.jsx)(E,{attachment:a,caption:g,height:d,width:o,isVideo:h,isAudio:p}):u&&s&&x&&(0,n.jsx)(z,{attachment:a,content:u,onClose:()=>r(!1)})})]})]},a.url)}function z(e){let{attachment:t,onClose:a,content:r}=e;switch(t.contentType){case"application/zip":return(0,n.jsxs)("div",{className:"relative max-h-[80vh] overflow-y-auto",children:[(0,n.jsx)("div",{className:"flex items-center justify-between p-4 pb-0 text-sm font-medium text-gray-600",children:(0,n.jsx)("span",{children:t.name})}),(0,n.jsx)("div",{className:"flex gap-2 p-4 text-gray-500",children:"v0 does not support previewing ZIP files at this time."})]});case"text/csv":return(0,n.jsxs)("div",{className:"relative max-h-[80vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 pb-0 text-sm font-medium text-gray-600",children:[(0,n.jsx)("span",{children:t.name}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(N.C,{allowClose:!0,allowCopyCode:!0,allowDownloadCode:!0,caller:"inline",closeHandler:a,fileName:t.name,value:r,isTabbed:!1,closed:!1,originalCode:void 0,blockId:"attachment-preview-".concat(t.name)})})]}),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(C,{source:r})})]});default:var l,i;let o=(0,y.SR)((null==(l=t.name)?void 0:l.split(".").pop())||(null==(i=t.contentType)?void 0:i.split("/")[1])||"plaintext");return(0,n.jsxs)("div",{className:"relative max-h-[80vh] overflow-y-auto",children:[(0,n.jsx)("div",{className:"absolute left-10 top-0 z-10 flex h-14 items-center text-sm font-medium text-gray-600",children:t.name}),(0,n.jsx)(s.N,{allowClose:!0,caller:"inline",className:"rounded-xl border-none [&>div:last-child]:!pt-0 [&_code]:!whitespace-pre",closeHandler:a,showQuickEditAnimation:!1,fileName:t.name,headerClassName:"h-14 border-none px-4 bg-background/70",language:o,showLineNumbers:!0,value:r,wrapLongLines:!0,originalCode:void 0,blockId:"attachment-preview-".concat(t.name),closed:!0})]})}}function E(e){var t;let{attachment:a,width:s,height:r,caption:l,isVideo:i,isAudio:o}=e;return(0,n.jsxs)(n.Fragment,{children:[i?(0,n.jsxs)("video",{className:"bg-alpha-950 rounded-lg object-contain",controls:!0,children:[(0,n.jsx)("source",{src:a.url,type:a.contentType}),"Your browser does not support the video tag."]}):o?(0,n.jsxs)("audio",{className:"rounded-lg object-contain",controls:!0,children:[(0,n.jsx)("source",{src:a.url,type:a.contentType}),"Your browser does not support the audio tag."]}):(0,n.jsx)(g.default,{alt:null!=(t=a.name)?t:"Image Preview",className:"bg-alpha-950 rounded-lg object-contain",height:r,src:a.url,width:s}),(0,n.jsx)("div",{className:"line-clamp-1 max-w-3xl text-sm text-gray-500",children:l})]})}let P=e=>{var t,a;let n=new Set(["pdf","doc","docx","xls","xlsx"]),s=(null==(t=e.contentType)?void 0:t.split("/")[1])||"none",r=(null==(a=e.name)?void 0:a.split(".").pop())||"none";return k.lg.includes(r)&&(s="plain"),!n.has(s)}},10037:(e,t,a)=>{"use strict";a.d(t,{KI:()=>r,RN:()=>s});let n={"icon-alarm-clock":{tags:["alarm","clock","time"]},"icon-apple":{tags:["apple","fruit","brand"]},"icon-app-window-mac":{tags:["app","window","mac"]},"icon-atom":{tags:["atom","science","molecule"]},"icon-bar-chart":{tags:["bar-chart","data","analytics"]},"icon-blocks":{tags:["blocks","building","structure"]},"icon-book-text":{tags:["book","text","reading"]},"icon-briefcase":{tags:["briefcase","work","portfolio"]},"icon-bug":{tags:["bug","issue","error"]},"icon-calendar":{tags:["calendar","date","event"]},"icon-camera":{tags:["camera","photo","picture"]},"icon-code":{tags:["code","development","programming"]},"icon-fingerprint":{tags:["fingerprint","security","authentication"]},"icon-flame":{tags:["flame","fire","heat"]},"icon-flask-conical":{tags:["flask","science","experiment"]},"icon-folder-closed":{tags:["folder","closed","directory"]},"icon-gamepad":{tags:["gamepad","gaming","controller"]},"icon-github":{tags:["github","code","repository"]},"icon-gitlab":{tags:["gitlab","code","repository"]},"icon-globe":{tags:["globe","world","internet"]},"icon-heart":{tags:["heart","love","favorite"]},"icon-home":{tags:["home","house","dashboard"]},"icon-image":{tags:["image","picture","photo"]},"icon-key-square":{tags:["key","security","access"]},"icon-laptop":{tags:["laptop","computer","device"]},"icon-layers":{tags:["layers","stack","structure"]},"icon-lightbulb":{tags:["lightbulb","idea","innovation"]},"icon-link":{tags:["link","connection","hyperlink"]},"icon-lock":{tags:["lock","security","protection"]},"icon-mail":{tags:["mail","email","communication"]},"icon-message-square-text":{tags:["message","text","chat"]},"icon-palette":{tags:["palette","color","art"]},"icon-paint-roller":{tags:["paint","roller","art"]},"icon-pie-chart":{tags:["pie-chart","data","analytics"]},"icon-rocket":{tags:["rocket","launch","space"]},"icon-scroll-text":{tags:["scroll","text","document"]},"icon-settings":{tags:["settings","gear","preferences"]},"icon-shield-check":{tags:["shield","check","security"]},"icon-smartphone":{tags:["smartphone","mobile","device"]},"icon-siren":{tags:["siren","alert","alarm"]},"icon-sprout":{tags:["sprout","growth","nature"]},"icon-square-function":{tags:["function","math","calculation"]},"icon-traffic-cone":{tags:["traffic","cone","warning"]},"icon-trending-down":{tags:["trending-down","decrease","statistics"]},"icon-trending-up":{tags:["trending-up","increase","statistics"]},"icon-trophy":{tags:["trophy","award","achievement"]},"icon-user":{tags:["user","person","profile"]},"icon-wand-sparkles":{tags:["wand","magic","sparkles"]},"icon-wrench":{tags:["wrench","tool","repair"]},"icon-zap":{tags:["zap","lightning","electricity"]}},s=Object.keys(n);function r(e){return e&&e in n?e:"icon-flask-conical"}},10838:(e,t,a)=>{"use strict";a.d(t,{g:()=>l});var n=a(25603),s=a(25951),r=a(33571);function l(e){let{vercelProjectId:t,v0ProjectId:a,refreshInterval:l=0}=e,{refetchVercelProject:i}=(0,s.Ok)(a),o=new URLSearchParams;o.set("projectId",null!=t?t:"");let{data:c,error:d,isLoading:u,mutate:m}=(0,n.Ay)(t?"/chat/api/integrations/marketplace/connections?".concat(o.toString()):void 0,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch integration connections data");return t.json()},{refreshInterval:l,revalidateOnReconnect:!0,keepPreviousData:!0}),{data:h,error:p,isLoading:x,mutate:f}=(0,n.Ay)(t?"/chat/api/integrations/marketplace/storage?".concat(o.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch storage stores");return t.json()},{refreshInterval:l,revalidateOnReconnect:!0,keepPreviousData:!0}),g=(0,r.useMemo)(()=>({marketplaceStores:(null==h?void 0:h.marketplaceStores)||[],nativeStores:(null==h?void 0:h.nativeStores)||[]}),[null==h?void 0:h.marketplaceStores,null==h?void 0:h.nativeStores]);return{connections:{data:(0,r.useMemo)(()=>(null==c?void 0:c.integrations)||[],[null==c?void 0:c.integrations]),isLoading:u,error:d||null,refetch:async()=>await Promise.all([m(),i()])},stores:{data:g,isLoading:x,error:p||null,refetch:async()=>{await Promise.all([f(),i()])}},isLoading:u||x,error:d||p||null,refetch:async()=>await Promise.all([m(),f(),i()])}}},11322:(e,t,a)=>{"use strict";a.d(t,{G4:()=>l});var n=a(97667);let s="0 0 ".concat(16," ").concat(16),r={top:"text-top",bottom:"text-bottom",middle:"middle",initial:null},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{color:a="currentColor",size:l,width:i,height:o,viewBox:c=s}=t;return function(t){let s=Math.random().toString(36).slice(2,11),{size:d,color:u=a||"currentColor",align:m="initial",className:h,width:p,height:x,style:f,...g}=t,v=r[m],j=l||16,b=e.replace(/__ADD_ID__/g,s);return(0,n.jsx)("svg",{className:h,dangerouslySetInnerHTML:{__html:b},"data-testid":"geist-icon",height:j,strokeLinejoin:"round",style:{...f,verticalAlign:v||void 0,width:i||p||d,height:o||x||d,color:u},viewBox:c,width:j,...g},s)}}},11472:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});var n=a(25603),s=a(71543),r=a(33571);function l(){let{expectUser:e}=(0,s.J)(),{data:t,mutate:a}=(0,n.Ay)("scopes",async()=>{if(!e)return;let t=await fetch("/chat/api/scopes");return await t.json()},{dedupingInterval:6e4});return{scopes:t,isScopesReady:!!t,refreshScopes:(0,r.useCallback)(()=>{a(void 0,!0)},[a])}}},11946:(e,t,a)=>{"use strict";a.d(t,{ak:()=>p,jO:()=>f,x3:()=>x});var n=a(97667),s=a(25603),r=a(66692),l=a(33571),i=a(27693),o=a(74260),c=a(18513),d=a(13729),u=a(28963),m=a(49848),h=a(12);function p(){let{data:e,mutate:t}=(0,s.Ay)("showNewFileDialog",null,{fallbackData:!1}),{data:a,mutate:n}=(0,s.Ay)("newFileDialogData",null,{fallbackData:{folderName:""}});return{newFileDialogData:a,setNewFileDialogData:n,showNewFileDialog:e,setShowNewFileDialog:t}}async function x(e,t,a,n,s,r){let l="".concat(a.folderName,"/").concat(n);a.folderName||(l=n);let i=n.split(".").pop(),c={source:s,meta:{file:l},blockId:e,lang:(0,o.SR)(i),isDeleted:!1,isEdit:!1,isMerged:!1,isMoved:!1,isRecovered:!1,isLocked:!1,isFixed:!1,isQuickEdit:!1,isTerminated:!1,isAttachmentQuickEdit:!1,isUserEdit:!0};if(!(await r([...t,c])).success)throw Error("Failed")}function f(e){let{blockId:t,sourceFiles:a,onSuccess:s}=e,{newFileDialogData:o,showNewFileDialog:f,setShowNewFileDialog:g}=p(),v=(0,h.W)(t),[j,b]=(0,l.useState)(!1),[y,w]=(0,l.useState)(""),N=(0,i.k)();(0,l.useEffect)(()=>{f&&w("")},[f]);let k=(0,l.useCallback)(async e=>{e.preventDefault();try{b(!0),await x(t,a,o,y,"",v),null==s||s()}catch(e){d.o.error(N("fileTreeActions.newFileNotificationError"))}finally{b(!1)}},[t,a,o,s,N,v,y]);return(0,n.jsxs)(u.Modal,{onOpenChange:g,open:f,responsive:!1,children:[(0,n.jsx)(u.ModalHeader,{children:(0,n.jsx)(u.ModalTitle,{children:N("fileTreeActions.newFile")})}),(0,n.jsx)(u.ModalContent,{children:(0,n.jsx)("form",{className:"flex flex-col gap-6",onSubmit:k,children:(0,n.jsx)(m.p,{onChange:e=>w(e.target.value),disabled:j,value:y})})}),(0,n.jsxs)(u.ModalFooter,{children:[(0,n.jsx)(u.ModalClose,{asChild:!0,children:(0,n.jsx)(r.$,{size:"sm",variant:"secondary",children:N("fileTreeActions.cancel")})}),(0,n.jsx)(r.$,{"data-testid":"confirm-delete-message",disabled:j,onClick:k,size:"sm",children:j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.IconSpinner,{className:"size-4"}),N("fileTreeActions.creating")]}):N("fileTreeActions.create")})]})]})}},12079:(e,t,a)=>{"use strict";a.d(t,{H:()=>s});var n=a(97667);function s(){return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsxs)("g",{id:"Icon",children:[(0,n.jsx)("path",{fill:"currentcolor",fillRule:"evenodd",clipRule:"evenodd",d:"M13.7497 10.75L13.7497 11.5L13.7497 13.2494C13.7497 14.2159 12.9662 14.9994 11.9997 14.9994L2.75 14.9994C1.7835 14.9994 1 14.2159 1 13.2494L1 4C1 3.0335 1.7835 2.25 2.75 2.25L4.49966 2.25L5.24966 2.25L5.24966 3.75L4.49966 3.75L2.75 3.75C2.61193 3.75 2.5 3.86193 2.5 4L2.5 13.2494C2.5 13.3875 2.61193 13.4994 2.75 13.4994L11.9997 13.4994C12.1377 13.4994 12.2497 13.3875 12.2497 13.2494L12.2497 11.5L12.2497 10.75L13.7497 10.75Z"}),(0,n.jsx)("path",{fill:"none",stroke:"currentcolor",d:"M7 8V3C7 2.44772 7.44772 2 8 2H13C13.5523 2 14 2.44772 14 3V8C14 8.55228 13.5523 9 13 9H8C7.44772 9 7 8.55228 7 8Z",strokeWidth:"1.5"})]})})}},12160:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});var n=a(86943);function s(e){var t,a,s;let r={isLlmError:!1,isRetried:!1,errorCategory:void 0};if("string"==typeof e)r.isLlmError=e.startsWith(n.EQ),r.isRetried=e.endsWith(n.oP),r.errorCategory=null!=(a=e.split(":")[1])?a:"default";else if(null==(t=e.finishReason)?void 0:t.includes("provider_server_error")){let t=e.finishReason.startsWith("retry_provider_server_error"),a=t||!!e.finishReason.startsWith("provider_server_error");r.isLlmError=a,r.isRetried=t,a&&(r.errorCategory=null!=(s=e.finishReason.split(":")[1])?s:"default")}return r}},12507:(e,t,a)=>{"use strict";a.d(t,{z:()=>c});var n=a(9592),s=a(16983),r=a(93187),l=a(13729),i=a(1221),o=a(25887);function c(e,t,a,c){if(e instanceof Error)switch(e.message){case r.Xu:return l.o.error("Please accept v0 terms and try again."),(0,n.F)(!0),!0;case r.NL:return l.o.error("You are blocked from sending messages."),null==t||t.push("/"),!0;case r.gz:return!0;case r.Z3:case r.Wg:return(0,o.D)({type:"upgradePlan"}),!0;case r.FD:return l.o.error("Message cannot be empty."),!0;case r.jd:return l.o.error("You do not have access to this project."),!0;case r.mB:return!0;case r.Jk:return l.o.error("Invalid attachment type."),!0;case r.TK:return l.o.error("Unable to process request. Please edit your message and try again."),!0;case r.kR:return l.o.error("An error occurred while processing your message. Start a new chat, retry, or edit your message."),!0;case r._Z:return l.o.error("You've reached the maximum number of image attachments allowed for a single chat."),!0;case r.RK:case r.PO:case r.oW:case r.Og:return l.o.error("Invalid message ID. Start a new chat or edit and retry your last message."),!0;case r.H7:return l.o.error("No active plan. Ensure you have accepted v0 terms and have an active subscription to continue."),null==t||t.push("/subscription?from=chat"),!0;case r.p2:return l.o.error("The resource you are looking for could not be found."),!0;case r.kU:return l.o.error("Too many requests. Please try again later."),!0;case r.zZ:return(0,s.Dt)({prompt:!1,customMessage:"Please sign in to continue."}),!0;case r.hB:return l.o.error("You are not authorized to perform this action."),!0;case r.Nr:return l.o.error("You are uploading too many files. Please try again later."),!0;case r.Nr:return l.o.error("Missing file name."),!0;case r.Jf:return l.o.error("You have reached the daily limit for assigning custom subdomains."),!0;case r.tK:case r.zi:case r.cL:case r.R2:l.o.error("Invalid fork key. Please start a new chat.");case r.rU:return!0;case r.Qx:return l.o.error("Unexpected error. Please try again later."),!0;case r.ti:return l.o.error("Failed to start your v0 plan. Please try again later."),!0;case r.L_:return l.o.error("This subdomain is already assigned to this block."),!0;case r.iY:return l.o.error("Your non-image attachment(s) exceed the limits for this chat. Please try again with fewer or smaller attachments."),!0;case r.XR:return l.o.warning("Payment is processing. Please try again later."),!0;case r.MM:return(0,s.Dt)({prompt:!1,customMessage:"You're out of free messages. Sign in or sign up to continue."}),!0;case r.QV:return(null==c?void 0:c.userPlan)==="v0-level0"?(0,o.D)({type:"upgradePlan"}):(0,o.D)({type:"buyMoreCredits",data:{onSuccess:()=>{null==t||t.refresh()}}}),!0;case r.Ki:if(t&&(null==c?void 0:c.scopeSlug)){let e=(0,i.kb)(c);t.push((0,i.ol)({slug:c.scopeSlug,path:e}))}else l.o.error("Please re-authentiate for full access."),null==t||t.refresh();return!0;case r.dD:default:return l.o.error(a||"An unexpected error occurred."),!0}return!1}},12747:(e,t,a)=>{"use strict";a.d(t,{O:()=>m,t:()=>h});var n=a(97667),s=a(52356),r=a(61852),l=a(80889),i=a(62519),o=a(75171),c=a(33571),d=a(41956);function u(e){let{id:t}=e,a=(0,r.E)(t);return(0,n.jsx)("span",{ref:a})}function m(e){let{label:t,idPrefix:a}=e,[s,r]=(0,c.useState)(!1),m=(0,d.al)(),{refs:h,floatingStyles:p,context:x}=(0,l.we)({placement:m?"top":"top-start",middleware:[(0,i.BN)({padding:6}),(0,i.cY)(4),(0,i.UU)({padding:6})],open:s,onOpenChange:r,whileElementsMounted:o.ll}),f=(0,l.Mk)(x,{handleClose:(0,l.iB)({buffer:1})}),{getReferenceProps:g,getFloatingProps:v}=(0,l.bv)([f]),j="".concat(a).concat(t);return"vercel_knowledge_base"===t?null:(0,n.jsxs)("span",{ref:h.setReference,...g(),className:"-mt-1 ml-0.5 inline-flex size-4 align-text-top",children:[(0,n.jsx)("a",{className:"bg-alpha-200 hover:bg-alpha-400 focus:bg-alpha-400 inline-block size-4 select-none rounded-full text-center font-mono text-[10px] leading-4 text-gray-700 no-underline transition-colors focus:text-black",href:"#def-".concat(j),id:"ref-".concat(j),onBlur:()=>r(!1),onFocus:()=>r(!0),tabIndex:0,children:t}),s?(0,n.jsx)("span",{ref:h.setFloating,style:p,...v(),className:"bg-background shadow-base z-10 select-none rounded-md p-2 text-xs",children:(0,n.jsx)(u,{id:j})}):null]})}function h(e){let{id:t,children:a}=e,{containers:n}=(0,r.W)(),l=n[t];return l?(0,s.createPortal)(a,l):null}},13089:(e,t,a)=>{"use strict";a.d(t,{Dh:()=>o,UY:()=>i,zU:()=>c});var n=a(57560),s=a(94282),r=a(141);let l=(0,r.e)(null,()=>({dialogOpen:(0,n.eU)(null),visibleDialogType:(0,n.eU)(null),visibilityTimeout:(0,n.eU)(null)})),i=(0,r.e)(null,()=>({...l()})),o=e=>{let t=l(),a=s.M.get(t.visibilityTimeout);a&&(clearTimeout(a),s.M.set(t.visibilityTimeout,null)),s.M.set(t.dialogOpen,e),s.M.set(t.visibleDialogType,e.type)},c=()=>{let e=l(),t=s.M.get(e.visibilityTimeout);t&&clearTimeout(t),s.M.set(e.visibleDialogType,null),s.M.set(e.visibilityTimeout,setTimeout(()=>{s.M.set(e.dialogOpen,null)},300))}},13263:(e,t,a)=>{"use strict";a.d(t,{U:()=>o});var n=a(97667),s=a(17773),r=a(99647),l=a(70770),i=a(33571);function o(e){let{isCopied:t,size:a,className:o,customIcon:c}=e,[d,u]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t&&u(!0)},[t]),(0,n.jsx)("span",{"aria-hidden":!0,className:o,children:(0,n.jsx)(r.kd,{children:t?(0,n.jsx)(r.eJ,{children:(0,n.jsx)(s.J,{size:a})},"check"):(0,n.jsx)(r.eJ,{preventAnimation:!d,children:c||(0,n.jsx)(l.T,{size:a})},"copy")})})}},13443:(e,t,a)=>{"use strict";a.d(t,{C:()=>i});var n=a(15919),s=a(69893);a(2186);let r=null,l={};function i(){if("undefined"==typeof document)return;r!==document.cookie&&(r=document.cookie,l=(0,n.qg)(r));let e=l[s.E];if(e){if(!e.startsWith(s.GD))throw Error("Invalid anonId: ".concat(e));return e}}},13833:(e,t,a)=>{"use strict";function n(e){return(null==e?void 0:e.current)&&"payment"in e.current?e.current.payment:null}function s(e){return"string"==typeof e?"v0-level0"===e:"v0-level0"===e.slug}a.d(t,{DB:()=>n,_S:()=>s})},14187:(e,t,a)=>{"use strict";a.d(t,{U3:()=>o,dS:()=>c,fu:()=>i});var n=a(97667),s=a(27693),r=a(28819),l=a(92461);function i(){let e=(0,s.k)();return{"v0-level0":{color:"text-gray-500",badge:"secondary",label:e("billingPlans.planName")("Free")},"v0-level3":{color:"text-teal-700",badge:"teal",label:e("billingPlans.planName")("Premium")},"v0-team":{color:"text-blue-700",badge:"blue",label:e("billingPlans.planName")("Team")},"v0-enterprise":{color:"text-purple-700",badge:"purple",label:e("billingPlans.planName")("Enterprise")},"v0-platinum":{color:"text-orange-400",badge:"teal",label:e("billingPlans.planName")("Ultra")}}}function o(e){let{type:t}=e,a=i()[t];return(0,n.jsx)("span",{className:(0,r.cn)("text-[13px] font-medium leading-[16px]",a.color),children:a.label})}function c(e){let{type:t,className:a,includeSuffix:s=!0}=e,r=i()[t];return(0,n.jsxs)(l.E,{size:"sm",variant:r.badge,className:a,children:[r.label," ",s?(0,n.jsx)("span",{children:"Plan"}):null]})}},14397:(e,t,a)=>{"use strict";a.d(t,{x:()=>v});var n=a(97667),s=a(66692),r=a(33571),l=a(19243),i=a(99066),o=a(72059),c=a(8689),d=a(27693),u=a(38035),m=a(23680),h=a(86184),p=a(77529),x=a(19434),f=a(16983);function g(e){let{isSignedIn:t,disableAttachmentsButton:a,inputFileRef:l,isPromptFormDisabled:i,textAreaRef:o,onInputChange:c}=e,[d,u]=(0,r.useState)(!1),{setShowSignInDialog:m}=(0,f.AO)();return t?(0,n.jsx)(s.$,{asChild:!0,className:(0,x.cn)("size-8 hover:bg-gray-100 focus:bg-gray-50 focus-visible:bg-gray-100",(a||i)&&"pointer-events-none bg-gray-100 text-gray-400 ring-0"),disabled:a,size:"sm",tooltip:{content:"Attach Files",hidden:d},variant:"secondary",children:(0,n.jsxs)("label",{"data-id":"prompt-form-image-upload",htmlFor:"fileUpload",children:[(0,n.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:a,id:"fileUpload",multiple:!0,onChange:e=>{var t;c(e),null==(t=o.current)||t.focus()},onClick:()=>u(!0),ref:l,tabIndex:a?-1:0,type:"file"}),(0,n.jsx)(p.x,{}),(0,n.jsx)("span",{className:"sr-only",children:"Attach Files"})]})}):(0,n.jsxs)(s.$,{className:"size-8 text-gray-500",disabled:a,onClick:()=>{var e;m({prompt:(null==(e=o.current)?void 0:e.value)||""})},size:"sm",tooltip:"Attach Files",variant:"ghost",children:[(0,n.jsx)(p.x,{}),(0,n.jsx)("span",{className:"sr-only",children:"Attach Files"})]})}function v(e){let{handleCancel:t,initialText:a,messageId:p,type:x,content:f,initialAttachments:v,v3Submit:j}=e,{submit:b}=(0,i.yI)(),{formRef:y,onKeyDown:w}=(0,o.G)(),N=(0,r.useRef)(null),k=(0,d.k)();(0,r.useEffect)(()=>{N.current&&(N.current.focus(),N.current.selectionStart=N.current.value.length,N.current.selectionEnd=N.current.value.length)},[]),(0,r.useEffect)(()=>{if(!N.current)return;let e=e=>{"Escape"===e.key&&(t(),e.stopPropagation())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t]);let{blobs:C,uploading:S,localFileInfos:M,isDraggingFile:I,inputFileRef:A,onInputChange:D,removeFile:L}=(0,m.Ay)({isSignedIn:!0,dragContainerRef:y,saveToDrafts:!1}),[z,E]=(0,r.useState)(v||[]);return(0,n.jsxs)("form",{className:"@container/form flex w-full flex-1 flex-col gap-3 overflow-hidden",onSubmit:e=>{var n;e.preventDefault();let s=null==(n=N.current)?void 0:n.value;if(!s||""===s.trim())return;let r=s;"refinement"===x&&(r=(0,u.i_)(f,r)),N.current.value="",j?j({input:r,attachments:[...z,...C]}):Promise.all([b({action:"edit",input:r,userMessageId:p,type:x,attachments:[...z,...C]}),(0,l.u)("SubmitEditUserMessage",{messageId:p,oldText:a,newText:r})]),t()},ref:y,children:[(0,n.jsxs)("div",{className:"relative z-10 flex flex-col rounded-lg border bg-white",children:[(0,n.jsx)(c.o,{className:"w-full rounded-t-lg p-3 text-sm outline-none ring-0",defaultValue:a,id:"chat-edit-textarea",minHeight:96,name:"content",onKeyDown:w,placeholder:k("editPromptForm.editYourMessage"),ref:N}),(0,n.jsxs)(h.q6,{className:"px-3",children:[(0,n.jsx)(g,{isSignedIn:!0,disableAttachmentsButton:S,inputFileRef:A,isPromptFormDisabled:!1,textAreaRef:N,onInputChange:D}),(0,n.jsx)(h.wJ,{files:M,removeFile:L,showDropzone:I,existingAttachments:z,removeExistingAttachment:e=>{E(t=>t.filter(t=>t.url!==e))}})]})]}),(0,n.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(s.$,{onClick:t,size:"sm",type:"button",variant:"secondary",children:k("editPromptForm.cancel")}),(0,n.jsx)(s.$,{"data-testid":"edit-form-send-button",size:"sm",children:k("editPromptForm.submit")})]})})]})}},14890:(e,t,a)=>{"use strict";a.d(t,{E:()=>c});var n=a(97667),s=a(28819),r=a(35501),l=a.n(r),i=a(33571),o=a(65744);function c(e){let{className:t,innerClassName:a,children:r,avatar:c,...d}=e,[u,m]=(0,i.useState)(!1),h=(0,i.useRef)(null);return(0,o.Wr)(h,()=>m(!1),"touchstart"),(0,n.jsx)("div",{className:(0,s.cn)("group w-full gap-2",t),"data-touch-active":u,onTouchStart:()=>m(!0),"data-testid":"message",ref:h,role:"listitem",...d,children:(0,n.jsxs)("div",{className:(0,s.cn)("relative flex items-start gap-2",a),children:[d.id?(0,n.jsx)(l(),{className:"flex items-center",href:"#".concat(d.id),children:c}):c,(0,n.jsx)("div",{className:"min-w-0 flex-1 translate-y-[0.5px]",children:r})]})})}},15154:(e,t,a)=>{"use strict";a.d(t,{W:()=>s});var n=a(70676);let s=(0,n.createServerReference)("4099e15d3f6a1662f53f07715ab9950856ac2b65a9",n.callServer,void 0,n.findSourceMapURL,"doSqlExecution")},15379:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x,useRenameSourceModal:()=>f});var n=a(97667),s=a(66692),r=a(28963),l=a(25603),i=a(16292),o=a(49848),c=a(33571),d=a(13729),u=a(70676);let m=(0,u.createServerReference)("4062bd764d60e204c0cfb137d36fcc324be6a1e0d8",u.callServer,void 0,u.findSourceMapURL,"renameSource");var h=a(19243),p=a(25951);function x(e){let{projectId:t}=e,{sourceId:a,sourceName:l,setSource:u}=f(),[x,g]=(0,c.useState)(l),{projectId:v}=(0,p.M9)(),j=t||v,{revalidateSources:b}=(0,p.py)(j);return((0,c.useEffect)(()=>{g(l)},[l]),a&&j)?(0,n.jsx)(r.Modal,{onOpenChange:e=>!e&&u(null),open:!!a,children:(0,n.jsxs)("form",{action:async()=>{(0,h.u)("ClickRenameSource",{targetSourceId:a});try{await m({sourceId:a,title:x,projectId:j}),b(),d.o.success("Renamed source")}catch(e){d.o.error("Failed to rename source")}await u(null)},children:[(0,n.jsxs)(r.ModalHeader,{children:[(0,n.jsx)(r.ModalTitle,{children:"Rename Source"}),(0,n.jsx)(o.p,{autoFocus:!0,onChange:e=>g(e.target.value),required:!0,value:x})]}),(0,n.jsxs)(r.ModalFooter,{children:[(0,n.jsx)(r.ModalClose,{asChild:!0,children:(0,n.jsx)(s.$,{onClick:()=>u(null),size:"sm",variant:"secondary",children:"Cancel"})}),(0,n.jsx)(i.Q,{size:"sm",variant:"default",children:"Save"})]})]})}):null}function f(){let{data:e,mutate:t}=(0,l.Ay)("renameSourceModal",null);return{sourceId:null==e?void 0:e.sourceId,sourceName:null==e?void 0:e.sourceName,setSource:t}}},15894:(e,t,a)=>{"use strict";a.d(t,{SuggestionsSetting:()=>i,l:()=>l});var n=a(97667);a(33571);var s=a(77363),r=a(65744);let l=()=>{let[e,t]=(0,r.Mj)("v0:sg",!0);return[e,t]};function i(){let[e,t]=l();return(0,n.jsx)(s.SettingsSection,{type:"toggle",label:"Suggestions",onChange:e=>t(e),value:e,description:(0,n.jsx)("span",{children:"Get relevant in-chat suggestions to refine your project."})})}},16078:(e,t,a)=>{"use strict";a.d(t,{SoundNotificationSetting:()=>i,s:()=>l});var n=a(97667);a(33571);var s=a(77363),r=a(65744);let l=()=>{let[e,t]=(0,r.Mj)("v0:sn",!1);return[e,t]};function i(){let[e,t]=l();return(0,n.jsx)(s.SettingsSection,{type:"toggle",label:"Sound Notifications",onChange:e=>t(e),value:e,description:(0,n.jsx)("span",{children:"A new sound will play when v0 is finished responding and the window is not focused."})})}},16330:(e,t,a)=>{"use strict";a.d(t,{W:()=>u,p:()=>d});var n=a(97667);a(33571);var s=a(55274),r=a(95393),l=a(68163),i=a(28819),o=a(2285),c=a(27693);function d(e){let{text:t,children:a,isLoading:d=!1,forceOpen:m=!1,triggerClassName:h}=e,p=(0,c.k)(),x=null!=t?t:p("messages.loadingText"),f=(0,n.jsx)(l.X,{className:"!text-gray-500 transition-colors group-hover/thinking:!text-gray-900"}),g=(0,n.jsx)(o.UC,{className:"group/content data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up overflow-hidden pt-2",children:(0,n.jsx)("div",{className:"transition-[filter,opacity] duration-500 group-data-[state=closed]/content:opacity-0 group-data-[state=open]/content:opacity-100 group-data-[state=closed]/content:blur-lg group-data-[state=open]/content:blur-0",children:a})}),v=(0,n.jsxs)("div",{className:(0,i.cn)("group/thinking flex w-full min-w-0 flex-1 flex-row items-center gap-1 text-sm",h),children:[(0,n.jsx)("div",{className:"transition-colors group-hover/thinking:text-gray-900",children:x}),(0,n.jsx)("div",{className:(0,i.cn)("translate-y-[1px] transition-all group-[&[data-state=open]]/trigger:rotate-180"),children:a?f:null})]});return(0,n.jsx)(o.bL,{className:"text-gray-500 [&:not(:first-child)]:-mt-1 [&_+_.block-preview]:mt-4",type:"single","data-seg":"skip",collapsible:!0,value:m?"thinking":void 0,children:(0,n.jsxs)(o.q7,{value:"thinking",children:[(0,n.jsx)(o.l9,{className:(0,i.cn)("group/trigger w-full",!a&&"pointer-events-none -translate-y-px"),tabIndex:a?void 0:-1,children:(0,n.jsx)(s.N,{mode:"wait",children:(0,n.jsx)(r.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex",children:d?(0,n.jsx)(u,{children:v}):v},x)})}),a||m?g:null]})})}function u(e){let{children:t,className:a}=e;return(0,n.jsx)(r.P.div,{animate:{backgroundPosition:["100% 50%","-100% 50%"]},transition:{duration:1.5,repeat:Number.POSITIVE_INFINITY,ease:"linear"},style:{background:"linear-gradient(90deg, hsl(var(--gray-400)) 0%, hsl(var(--gray-400)) 35%, hsl(var(--gray-900)) 50%, hsl(var(--gray-400)) 65%, hsl(var(--gray-400)) 100%)",backgroundSize:"200% 100%",WebkitBackgroundClip:"text",backgroundClip:"text"},className:(0,i.cn)("flex items-center text-transparent",a),children:t})}},16799:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(9285),s=a(33578);function r(e){for(let t=e.length-1;t>=0;t--)if("usage"in e[t]&&e[t].usage)return e[t].usage.totalTokens;return e.reduce((e,t)=>{if("attachments"in t){var a;null==(a=t.attachments)||a.forEach(t=>{var a;let n=t.contentType;n&&(0,s.Ye)(n)?e+=1600:(n&&(0,s.Lu)(n,null==(a=t.name)?void 0:a.split(".").pop()),e+=1e3)})}let r="string"==typeof t.content?t.content:"";return e+(0,n.J)(r)},0)}},16894:(e,t,a)=>{"use strict";a.d(t,{g:()=>i});var n=a(13729),s=a(59801),r=a(22975),l=a(41416);async function i(e){let{projectName:t,chatId:a,onSuccess:i,includeSuccessToast:o=!0}=e;try{if(e.existingProjectId){let a=await (0,r.p)(e.existingProjectId,t);if("errors"in a)return{errors:a.errors};let{id:n}=a;return{id:e.existingProjectId,vercelProjectId:n}}{let{id:e,vercelProjectId:r,name:c,errors:d,success:u}=await (0,s.E)({name:t,icon:"icon-wand-sparkles"});if(d)return{errors:d};if(u&&e){if(o&&n.o.success("Project created successfully"),a){let t=await (0,l.M)({payload:{chatId:a,projectId:e}});if(null==t?void 0:t.error)return{errors:{name:["Failed to add chat to newly created project."]}}}return null==i||i(e),{id:e,vercelProjectId:r,name:c}}}return{errors:{name:["Failed to create project."]}}}catch(e){return console.error("Failed to create project:",e),o&&n.o.error("An unexpected error occurred. Please try again."),{errors:{name:["An unexpected error occurred. Please try again."]}}}}},17209:(e,t,a)=>{"use strict";a.d(t,{E:()=>K,Q:()=>Q});var n=a(97667),s=a(36323),r=a(33571),l=a(28819),i=a(19243),o=a(31693),c=a(45586),d=a(13729),u=a(19138),m=a(68163),h=a(99715),p=a(66418),x=a(25296),f=a(25883),g=a(6002),v=a(15941),j=a(25905),b=a(27693),y=a(61872),w=a(80574),N=a(66152),k=a(50904),C=a(68547),S=a(74118),M=a(20125),I=a(60574),A=a(80464),D=a(25603),L=a(76727),z=a(66692),E=a(16292),P=a(95393),T=a(55274),F=a(71543),R=a(32136),U=a(16330),V=a(70073),B=a(12),_=a(75997),O=a(40711),H=a(67121),$=a(28488),q=a(70158),W=a(70676);let G=(0,W.createServerReference)("40836625cd3683f3ec61242e2172bc37825ee6c5de",W.callServer,void 0,W.findSourceMapURL,"restoreBlock");var Z=a(12507),Y=a(37707);function K(e){let{children:t,className:a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("bg-gray-150 flex h-5 items-center gap-1 rounded-md px-1 text-[12px] text-gray-600",a),children:t})}function J(e){let{closed:t,isStreaming:a,finishReason:s,language:r,isBlob:l}=e;return l?(0,n.jsx)(p.b,{className:"size-4 text-gray-500"}):t&&!a&&"stop"===s?(0,n.jsx)(o.o,{lang:r||"plaintext",fill:"fill-gray-500"}):t&&!a&&"length"===s?(0,n.jsx)(M.Tooltip,{content:"v0 cannot output enough tokens to complete the block",children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(v.N,{})})}):t||!a||s?(0,n.jsx)(o.o,{lang:r||"plaintext",fill:"fill-gray-500"}):(0,n.jsx)(w.y,{size:16})}function Q(e){let{type:t,blockId:a,messageId:o,isStreaming:p,...v}=e,M=(0,s.I4)(),W=(0,s.eu)(),Q=(0,L.PQ)(),ee=(0,s.oQ)(),{currentBlockIndex:et,history:ea,projectBlocks:en,latestSource:es,ensureBlockSource:er,isLoadingBlockSource:el}=(0,c.P6)({blockId:a,searchAll:!0}),{getBlockShared:ei}=(0,j.L)(),{getBlockDeployed:eo}=(0,k.G)(),ec=(0,b.k)(),ed=(0,N.RQ)(a),eu=(0,C.g)({blockId:a}),{bl:em}=(0,Y.D)(),{getBlockForked:eh}=(0,A.t)(),{getBlockTemplateId:ep}=function(){let{chatId:e}=(0,S.xz)(),{data:t,mutate:a}=(0,D.Ay)(["block:template-ids",e]);return{getBlockTemplateId:(0,r.useCallback)(e=>{var a;return null!=(a=null==t?void 0:t.get(e))?a:void 0},[t]),setBlockTemplateId:(0,r.useCallback)((e,n)=>{a(new Map(null==t?void 0:t.set(e,n)))},[t,a])}}(),{restoring:ex,onRestoreBlock:ef}=function(e){let{blockId:t}=e,[a,n]=(0,r.useTransition)(),s=(0,q.useRouter)(),{scrollToBottom:l}=(0,$.r)(),i=(0,S.jo)(),{activeForkKey:o}=(0,S.Pk)(),{chatId:d}=(0,S.xz)(),{currentBlockIndex:u,history:m}=(0,c.P6)({blockId:t,searchAll:!0});return{onRestoreBlock:(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let a=null==o?void 0:o.findIndex(e=>e===m[u].messageId);if(void 0===a||a<0||!o||!d)return void H.toast.error("Could not find the message in the chat");let r=m[u].meta.project;if(!r)return void H.toast.error("Something went wrong.");n(async()=>{let{error:e,newAssistantMessageId:a}=await G({projectId:r,blockId:t,chatId:d,initialVersion:u,versionToCreate:m.length,forkKey:o});e||!a?(0,Z.z)(e)||H.toast.error("Something went wrong. Please try again."):(H.toast.success("Restored successfully"),i(()=>({isLoading:!0,isRestoring:!0})),s.push("#".concat(a)),l())})},[o,d,u,m,t,s,l,i]),restoring:a}}({blockId:a}),{pulsePreview:eg}=(0,c.DK)({blockId:a}),{messages:ev,activeForkKey:ej}=(0,S.Pk)(),eb=(0,r.useMemo)(()=>ev.find(e=>e.id===o&&"assistant"===e.role),[ev,o]),ey=null==eb?void 0:eb.finishReason,{chatId:ew}=(0,S.xz)(),eN=M&&(null==W?void 0:W.id)===a,[ek,eC]=(0,r.useState)(!1),[eS,eM]=(0,r.useState)((eN||!v.closed)&&(null==eb?void 0:eb.type)!=="sync-git"),eI=es||v.source,eA=(0,r.useCallback)(async()=>{el||await er()},[er,el]);(0,r.useEffect)(()=>eC(!0),[]);let eD="Untitled",eL=t;v.meta.project&&(eD=v.meta.project),v.meta.file&&(eL=v.meta.file||t),"local"===t&&(eD=v.meta.title),/[_-]/.test(eD)&&(eD=eD.split(/[_-]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "));let ez=en.find(e=>e.id===a),eE=null==ez?void 0:ez.latestDeploymentInfo,eP=(0,r.useRef)(null),{saveLastOpenedBlock:eT}=(0,I.e)(),{user:eF}=(0,F.J)(),{authorId:eR}=(0,R.tZ)(),eU=(0,r.useCallback)(async()=>{var e;(0,i.u)("ClickBlockPreview",{blockId:a});let{templateVersionId:n,templateCanonId:s}=null!=(e=ep(a))?e:{},r=await er().catch(()=>{d.o.error("Failed to load block source.")})||eI;if(!r)return;let l={id:a,meta:v.meta,remoteInfo:v.remoteInfo,messageId:o,type:t,language:v.language,source:r,resultId:v.resultId,closed:!!v.closed,hasSourceBeenEdited:!!(null==W?void 0:W.hasSourceBeenEdited),latestDeploymentInfo:eE,templateVersionId:n,templateCanonId:s,forkedFromBlockId:eh(a)};if(ew&&Q){let{setActiveBlock:e}=(0,V.Cs)(ew);e(l);return}ee(!0,l),eT(a),eP.current&&(ed("code"),eu(eP.current),eP.current=null,setTimeout(()=>{let e=document.querySelector('[data-active-tab="true"]');e&&e.scrollIntoView({block:"start"})},0))},[a,ep,er,v.meta,v.remoteInfo,v.language,v.resultId,v.closed,o,t,null==W?void 0:W.hasSourceBeenEdited,eE,eh,ew,Q,ee,eT,ed,eu]),eV=(0,r.useMemo)(()=>ei(a)||eo(a),[a,ei,eo]),eB=!v.closed&&!p&&("other"===ey||!ey),e_="local"===t?(0,n.jsx)(g.H,{className:"size-4 text-gray-500 [&_path]:fill-current"}):(0,n.jsx)(J,{closed:v.closed,isStreaming:p,finishReason:ey,language:v.language,isBlob:!!v.meta.url}),eO=(0,r.useCallback)(()=>{if(eN&&!eP.current)return;eU();let e=new URL(window.location.href),t=new URLSearchParams(e.search);t.delete("b"),e.search=t.toString(),window.history.replaceState({},"",e.toString())},[eN,eU]),eH=(0,B.W)(a),e$=(0,r.useMemo)(()=>"local"===t||"code-project"===t?(0,y.A2)({source:eI,blockType:t,blockId:a}):[],[eI,t,a]),eq=(0,r.useMemo)(()=>"local"===t||"code-project"===t?e$.filter(e=>!e.isMerged&&!(e.isDeleted&&e.isMoved)):[],[t,e$]),{handleRecoverFile:eW,isRecoveringFile:eG,recoveringFile:eZ}=function(e){let{blockId:t,history:a,activeForkKey:n,updateBlockData:s,sourceFiles:l,currentBlockIndex:i}=e,[o,c]=(0,r.useTransition)(),[d,u]=(0,r.useState)(null),{refresh:m}=(0,O.Z)();return{handleRecoverFile:(0,r.useCallback)(e=>{let r=null,o=i,d=new Set(n);for(;!r&&o>=0;){let n=a[o];if(o-=1,"code-project"!==n.type||!d.has(n.messageId))continue;let s=(0,_.A2)({source:n.source,blockType:"code-project",blockId:t}).find(t=>t.meta.file===e&&"...deleted..."!==t.source.replaceAll(" ","").trim());s&&(r=s.source)}if(!r)return void H.toast.error("Could not find the file to recover");let h=[...l];for(let t of h)if(t.meta.file===e){t.isDeleted=!1,t.isRecovered=!0,t.isMerged=!1,t.source=r;break}u(e),c(async()=>{try{if(!(await s(h)).success)throw Error("Failed");H.toast.success("File recovered successfully")}catch(e){H.toast.error("Failed to recover the file")}}),m()},[l,m,s,n,t,i,a]),isRecoveringFile:o,recoveringFile:d}}({blockId:a,history:ea,activeForkKey:ej,updateBlockData:eH,sourceFiles:e$,currentBlockIndex:et}),eY=o===(null==ej?void 0:ej[ej.length-1]),eK=eR&&(null==eF?void 0:eF.id)===eR;(0,r.useEffect)(()=>{(eN||eS)&&er().catch(e=>{d.o.error("Failed to load block source")})},[eN,eS,er]);let eJ=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),eM(e=>!e)},[]);if("code-project"===t){let e=Q?null:(0,n.jsxs)("div",{className:(0,l.cn)("@container/block-preview-header flex h-9 w-full items-center justify-between gap-3 p-2",eS&&"border-alpha-200 border-b"),onMouseEnter:eA,children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-900",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 whitespace-nowrap text-[13px] font-medium text-gray-800",children:[(0,n.jsx)(z.$,{onClick:eJ,variant:"ghost",className:"size-5 rounded-sm",size:"mini",children:eS?(0,n.jsx)(m.X,{}):(0,n.jsx)(h.b,{})}),"Version ",et+1]}),eV?(0,n.jsxs)(K,{className:"@[19rem]/block-preview-header:flex hidden",children:[(0,n.jsx)(x.q,{size:12})," ",ec("blockPreview.deployed")]}):null,eB?(0,n.jsx)(K,{className:"@[19rem]/block-preview-header:flex hidden",children:"STOPPED"}):null]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[eY||!eK?null:(0,n.jsx)(E.x,{variant:"ghost",className:"h-5 rounded-sm px-1.5 text-xs text-gray-600 hover:text-gray-900 [&_svg]:size-4",size:"sm",pending:ex,innerClassName:"gap-1.5",onClick:ef,children:"Restore"}),eY?(0,n.jsx)(z.$,{variant:"ghost",className:"pointer-events-none h-5 rounded-sm px-1.5 text-xs text-gray-600",size:"sm",children:"Latest"}):null,(0,n.jsx)(z.$,{variant:"secondary",disabled:eN,className:"h-5 rounded-sm px-1.5 text-xs",size:"sm",children:eN?"Viewing":"View"})]})]}),t=eq.map((e,t)=>{let a,s=!1;if(em&&t<eq.length-1&&eq[t+1].meta.file===eq[t].meta.file)return null;let i=!!(!v.closed&&(t===eq.length-1||e.isTempFile));return e.isTerminated?(a=(0,n.jsx)(f.v,{className:"size-3 text-gray-400"}),s=!0):i?(a=eB?(0,n.jsx)(f.v,{className:"size-3 text-gray-400"}):(0,n.jsx)(w.y,{size:14}),s=eB):a=e.isLoading?(0,n.jsx)(w.y,{size:14}):(0,n.jsx)(u.a,{className:"size-3 text-gray-400"}),(0,n.jsxs)(r.Fragment,{children:[(0,n.jsxs)("div",{className:"flex h-5 w-full min-w-0 items-center gap-2 text-[13px]",children:[(0,n.jsx)("div",{className:"flex size-5 shrink-0 items-center justify-center",children:a}),(0,n.jsxs)("div",{className:(0,l.cn)("group/file flex w-full min-w-0 items-center justify-between gap-2"),role:"button",tabIndex:0,onClick:t=>{if(e.isDeleted){t.stopPropagation(),eW(e.meta.file);return}eP.current=e.meta.file},children:[(0,n.jsx)("div",{className:(0,l.cn)("flex-1 cursor-pointer truncate text-left group-hover/file:underline"),children:i&&!eB||e.isLoading?(0,n.jsx)(U.W,{className:"text-[13px]",children:e.meta.file}):e.meta.file}),(0,n.jsx)(X,{file:e,isRecovering:eZ===e.meta.file&&eG,active:i,stopped:s})]})]},t),t!==eq.length-1&&(0,n.jsx)("div",{className:"flex h-3 w-5 items-center justify-center",children:(0,n.jsx)("div",{className:"h-full w-[1px] bg-gray-300"})})]},"block-edit-"+t)}),a=eS&&eq.length>0?(0,n.jsx)(P.P.div,{initial:!!ek&&{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{type:"spring",stiffness:300,damping:30},className:"bg-muted overflow-hidden",children:(0,n.jsx)("div",{className:(0,l.cn)("flex w-full flex-col overflow-hidden rounded-md py-1.5 pl-2 pr-2.5 text-left text-gray-500"),children:t})}):null;return(0,n.jsxs)("div",{"data-testid":"block-preview",className:(0,l.cn)("not-prose group/block-preview bg-background flex w-full max-w-full cursor-pointer select-none flex-col justify-between overflow-hidden rounded-md border shadow-[0px_2px_3px_-1px_hsla(0,0%,0%,0.04)] transition-all ease-in-out md:w-[400px]",eN?"ring-alpha-400 border-gray-500 ring-2":"hover:ring-alpha-400 border-alpha-400 hover:border-alpha-600",eN&&eg?"animate-pulse-border":""),onClick:eO,children:[e,(0,n.jsx)(T.N,{children:a})]})}return(0,n.jsxs)("div",{"data-testid":"block-preview",className:(0,l.cn)("not-prose bg-background flex w-full max-w-full cursor-pointer select-none items-start justify-between gap-2 rounded-[10px] border p-1.5 transition-all duration-200 ease-in-out hover:brightness-[97%] md:w-[400px]",eN?"ring-alpha-400 border-gray-500 ring-2":"border-gray-200"),onClick:eO,children:[(0,n.jsx)("div",{className:"flex size-10 shrink-0 items-center justify-center overflow-hidden rounded-sm bg-gray-100 px-3 text-gray-500 transition-all duration-200 ease-in-out",children:e_}),(0,n.jsx)("div",{className:"flex w-full min-w-0 flex-row items-center justify-between",children:(0,n.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start leading-5",children:[(0,n.jsxs)("div",{className:"@container/block-preview-header my-0 flex w-full min-w-0 max-w-full items-center justify-between gap-2 text-sm font-medium text-gray-900",children:[(0,n.jsx)("div",{className:"min-w-0 shrink truncate",children:eD}),(0,n.jsxs)("div",{className:"flex shrink-0 gap-1",children:[eY||!eK?null:(0,n.jsx)(E.x,{variant:"ghost",className:"h-5 rounded-sm px-1.5 text-xs text-gray-600 hover:text-gray-900 [&_svg]:size-4",size:"sm",pending:ex,innerClassName:"gap-1.5",onClick:ef,children:"Restore"}),eV?(0,n.jsxs)(K,{className:"@[17rem]/block-preview-header:flex hidden",children:[(0,n.jsx)(x.q,{size:12})," ",ec("blockPreview.deployed")]}):null,eB?(0,n.jsx)(K,{className:"@[17rem]/block-preview-header:flex hidden",children:"STOPPED"}):null,(0,n.jsxs)(K,{className:"font-mono",children:["v",et+1]}),"local"===t?(0,n.jsx)(K,{className:"bg-lime-100 dark:bg-lime-900",children:"LOCAL"}):null]})]}),"local"!==t?(0,n.jsxs)("p",{className:"my-0 max-w-full truncate text-sm text-gray-500 ",children:[eL,(null==W?void 0:W.hasSourceBeenEdited)?(0,n.jsx)("span",{children:" (edited)"}):null]}):(0,n.jsx)("ul",{className:"my-0 w-full max-w-full truncate text-left text-gray-500",children:eq.map((e,t)=>(0,n.jsxs)("li",{className:"flex items-center gap-1.5 truncate",children:[e.meta.file,t!==eq.length-1||v.closed?null:(0,n.jsx)("span",{children:(0,n.jsx)(w.y,{size:14})})]},t))})]})})]})}function X(e){let{file:t,active:a,stopped:s,isRecovering:r}=e,i=!t.isDeleted&&t.isRecovered?"Recovered":s?"Stopped":t.blobUrl?a?"Creating":"Added":t.isDeleted?"Deleted":t.isLocked?"Locked":t.isMoved&&t.isMovedFrom?"Moved":t.isEdit||t.isAttachmentQuickEdit?t.isFixed?a?"Fixing":"Fixed":a?"Editing":"Edited":t.isLoading?"":t.meta.isUserEdit?"Created":a?t.isFixed?"Fixing":"Generating":"Generated",o=t.isDeleted?"Recover":null;return r?(0,n.jsx)("div",{className:"flex size-5 shrink-0 items-center justify-center",children:(0,n.jsx)(w.y,{size:14})}):(0,n.jsxs)(n.Fragment,{children:[o?(0,n.jsx)("div",{className:"animate-in fade-in fade-out hidden font-mono text-xs text-gray-500 group-hover/file:block",children:o}):null,(0,n.jsx)("div",{className:(0,l.cn)("font-mono text-xs text-gray-500",o&&"block group-hover/file:hidden"),children:i})]})}},17253:(e,t,a)=>{"use strict";a.d(t,{z:()=>r});var n=a(25603),s=a(37707);function r(e){let{tbb:t}=(0,s.D)(),{data:a,error:r,isLoading:l,isValidating:i,mutate:o}=(0,n.Ay)(t?"/chat/api/plan-info":null,async e=>{let t=await fetch(e);if(!t.ok){let e=t.headers.get("content-type");if(e&&-1!==e.indexOf("application/json"))throw Error((await t.json()).message||"Failed to get plan info");throw Error("Failed to get plan info: ".concat(t.status," ").concat(t.statusText))}return t.json()},{revalidateOnFocus:!1,...e});return{planInfo:a,error:r,isLoading:l,isValidating:i,mutate:o}}},17410:(e,t,a)=>{"use strict";a.d(t,{t:()=>I,default:()=>z});var n=a(97667),s=a(33571),r=a(66692),l=a(35501),i=a.n(l),o=a(20806),c=a(81966),d=a(30014),u=a(10037),m=a(99339),h=a(47277);function p(e){var t;let{project:a,canMakeProjectUpdates:s,projectAuthorData:r}=e;return a&&r?(0,n.jsx)("header",{className:"w-full px-4 pb-2 pt-9",children:(0,n.jsx)("div",{className:"mx-auto w-full max-w-screen-md",children:(0,n.jsxs)("div",{className:"flex flex-col items-start gap-3",children:[(0,n.jsx)(d.R,{color:a.color,readOnly:!s,icon:(0,u.KI)(a.icon),projectId:a.projectId}),(0,n.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,n.jsx)(h.P,{canEditProjectName:s,initialTitle:a.name,projectId:a.projectId}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(m.AvatarUser,{size:"xs",userId:r.id}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-500",children:null!=(t=r.username)?t:"Vercel User"})]})]})]})})}):(0,n.jsx)(x,{})}function x(){return(0,n.jsx)("header",{className:"bg-background grid auto-rows-min gap-4 border-b p-4 sm:p-6",children:(0,n.jsxs)("div",{className:"mx-auto w-full",children:[(0,n.jsxs)("div",{className:"flex h-8 items-center gap-2 sm:h-auto",children:[(0,n.jsx)(c.Separator,{className:"bg-alpha-400 mr-2 h-6 sm:hidden",orientation:"vertical"}),(0,n.jsx)(r.$,{asChild:!0,className:"font-normal text-gray-500",size:"sm",variant:"link",children:(0,n.jsxs)(i(),{href:"/chat/projects",prefetch:!0,children:[(0,n.jsx)(o.n,{className:"size-4"}),(0,n.jsx)("span",{children:"All Projects"})]})})]}),(0,n.jsxs)("div",{className:"flex flex-col items-start justify-center gap-3 pt-4",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold",children:"New Project"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"You can attach resources and files to a project after it's been created."})]})]})})}var f=a(49848),g=a(7086),v=a(6902),j=a(70158),b=a(28819),y=a(74293);let w=y.z.object({name:y.z.string().min(2,"Name must be at least 2 characters").max(32,"Name cannot be longer than 32 characters"),description:y.z.string().max(5e3,"Description cannot be longer than 5000 characters").optional(),instructions:y.z.string().max(5e3,"Context cannot be longer than 5000 characters").optional()});var N=a(84031),k=a(59801),C=a(13729),S=a(16292),M=a(8689);let I=e=>{let{name:t,onChange:a,errors:s,placeholder:r="New sidebar",disabled:l=!1}=e;return(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsxs)(v.Label,{className:(0,b.cn)((null==s?void 0:s.name)&&"text-red-500"),htmlFor:"name",children:["Name",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)(f.p,{autoComplete:"off",className:(0,b.cn)((null==s?void 0:s.name)&&"border-red-500"),disabled:l,id:"name",maxLength:32,minLength:2,name:"name",onChange:a,placeholder:r,required:!0,value:t}),(null==s?void 0:s.name)&&(0,n.jsx)("p",{className:"text-xs text-red-500",children:s.name[0]})]})},A=e=>{let{description:t,onChange:a,errors:s}=e;return(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(v.Label,{className:(0,b.cn)((null==s?void 0:s.description)&&"text-red-500"),htmlFor:"description",children:"Description (optional)"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(g.T,{asChild:!0,children:(0,n.jsx)(M.o,{autoComplete:"off",className:(0,b.cn)("pb-8",(null==s?void 0:s.description)&&"border-red-500"),id:"description",maxLength:5e3,name:"description",onChange:a,placeholder:"Describe what this project is going to be used for...",value:t,minHeight:120,maxHeight:384})}),(0,n.jsx)(N.j,{className:"absolute inset-x-1 bottom-2.5",count:t.length,max:5e3,message:"Description cannot be longer than 500 characters",messageThreshold:5e3})]}),(null==s?void 0:s.description)&&(0,n.jsx)("p",{className:"text-xs text-red-500",children:s.description[0]})]})},D=e=>{let{instructions:t,onChange:a,errors:s}=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)(v.Label,{className:(0,b.cn)((null==s?void 0:s.instructions)&&"text-red-500"),htmlFor:"instructions",children:"Context (optional)"})}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(g.T,{asChild:!0,children:(0,n.jsx)(M.o,{autoComplete:"off",className:(0,b.cn)("pb-4",(null==s?void 0:s.instructions)&&"border-red-500"),id:"instructions",maxLength:5e3,name:"instructions",onChange:a,placeholder:"We're building a new sidebar for...",value:t,minHeight:120,maxHeight:384})}),(0,n.jsx)(N.j,{className:"absolute inset-x-1 bottom-2.5",count:t.length,max:5e3,message:"For larger context, consider using sources on the project page.",messageThreshold:5e3})]}),(null==s?void 0:s.instructions)&&(0,n.jsx)("p",{className:"text-xs text-red-500",children:s.instructions[0]})]}),(0,n.jsx)(v.Label,{className:"text-gray-500",children:"Guidelines or instructions the model will use to generate better responses to prompts."})]})},L=e=>{let{formData:t}=e,a=t.name.trim().length>0;return(0,n.jsx)(S.Q,{className:"self-start",disabled:!a,size:"sm",type:"submit","data-testid":"create-project-button",children:"Create Project"})};function z(e){let{randomIcon:t}=e,[a,r]=(0,s.useState)({}),[l,i]=(0,s.useState)({name:"",description:"",instructions:"",icon:t}),[o,c]=(0,s.useTransition)(),u=(0,j.useRouter)(),m=(0,s.useCallback)(e=>{let{name:t,value:a}=e.target;i(e=>({...e,[t]:a}))},[]),h=(0,s.useCallback)(e=>{e.preventDefault(),r({});let{name:t,description:a,instructions:n,icon:s}=l,i=w.safeParse({name:t,description:a,instructions:n,icon:s});if(!i.success)return void r(i.error.flatten().fieldErrors);c(async()=>{try{let{id:e,errors:l,success:i}=await (0,k.E)({name:t,description:a,instructions:n,icon:s});if(l)return void r(l);if(i&&e){C.o.success("Project created successfully"),u.push("/chat/projects/".concat(e));return}r({name:["Failed to create project. Please try again."]})}catch(e){console.error("Failed to create project:",e),C.o.error("An unexpected error occurred. Please try again."),r({name:["An unexpected error occurred. Please try again."]})}})},[l,u]);return(0,n.jsxs)("div",{className:"bg-background flex min-h-screen flex-col",children:[(0,n.jsx)(p,{canMakeProjectUpdates:!0}),(0,n.jsx)("main",{className:"bg-background flex flex-1 flex-col overflow-auto p-4 sm:p-6",children:(0,n.jsx)("div",{className:"grid w-full max-w-screen-2xl flex-1 auto-rows-min gap-4 lg:grid-cols-[600px_1fr] lg:gap-x-6 xl:gap-x-9",children:(0,n.jsxs)("form",{className:"flex flex-col gap-6",onSubmit:h,children:[(0,n.jsx)(d.R,{onSelect:e=>i(t=>({...t,icon:e})),isNewPage:!0,color:null,readOnly:!1,icon:t,projectId:""}),(0,n.jsx)(I,{errors:a,name:l.name,onChange:m}),(0,n.jsx)(A,{description:l.description,errors:a,onChange:m}),(0,n.jsx)(D,{errors:a,instructions:l.instructions,onChange:m}),(0,n.jsx)(L,{formData:l,isPending:o})]})})})]})}},17509:(e,t,a)=>{"use strict";a.d(t,{DEFAULT_CHAT_MODEL_IMAGE_CONFIG:()=>s,f:()=>l});var n=a(25603);let s={maxSizeBytes:3932160,maxDimensionsPixels:{short:8e3,long:8e3},maxPerChat:20},r={attachmentMaxSizeBytes:3932160,contextWindow:199999,image:s};function l(){let{data:e}=(0,n.Ay)("model-config");return null!=e?e:r}},18249:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>m,L3:()=>p,c7:()=>h,lG:()=>o,rr:()=>x,zM:()=>c});var n=a(97667),s=a(33571),r=a(13144),l=a(77831),i=a(19434);let o=r.bL,c=r.l9,d=r.ZL;r.bm,d.displayName=r.ZL.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-gray-950/95 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),ref:t,...s})});u.displayName=r.hJ.displayName;let m=s.forwardRef((e,t)=>{let{className:a,dialogOverlayClassName:o,children:c,style:m,showClose:h=!0,...p}=e,[x,f]=s.useState(0),g=s.useRef(null);return s.useEffect(()=>{g.current=document.body,f(e=>e+1)},[]),(0,n.jsxs)(d,{container:g.current,children:[(0,n.jsx)(u,{className:o}),(0,n.jsxs)(r.UC,{className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 rounded-[12px] bg-white px-6 py-8 outline-none duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] lg:w-full",a),ref:t,style:{boxShadow:"var(--ds-shadow-modal)",...m},...p,children:[c,h?(0,n.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(l.MKb,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}):null]})]})});m.displayName=r.UC.displayName;let h=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col items-center space-y-2 text-center",t),...a})};h.displayName="DialogHeader";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.hE,{className:(0,i.cn)("whitespace-nowrap text-2xl font-semibold tracking-tight",a),ref:t,...s})});p.displayName=r.hE.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.VY,{className:(0,i.cn)("text-zinc-600",a),ref:t,...s})});x.displayName=r.VY.displayName},18858:(e,t,a)=>{"use strict";a.d(t,{d:()=>h,f:()=>p});var n=a(79168),s=a(25603),r=a(86943),l=a(33571),i=a(83195),o=a(17253),c=a(73655),d=a(13443),u=a(37707);let m=(e,t)=>fetch("".concat(e,"?scope=").concat(t)).then(e=>e.json());function h(){var e;let{tbb:t}=(0,u.D)(),{activeScopeSlug:a}=(0,c.k6)(),n=(0,d.C)(),r=null!=(e=null!=a?a:n)?e:void 0,{data:i,mutate:o}=(0,s.Ay)(r&&!t?["/chat/api/rate-limit",r]:null,()=>{if(r)return m("/chat/api/rate-limit",r)});return[i,(0,l.useCallback)(()=>o(e=>{if(void 0!==e)return{...e,remaining:Math.max(e.remaining-1,0)}},{revalidate:!1}),[o])]}function p(){let{tbb:e}=(0,u.D)(),[t]=h(),{isTeam:a,user:d,isActiveScopeReady:m}=(0,c.k6)(),{planSlug:p}=(0,i.N)(m&&!a,null==d?void 0:d.id,!1),{planInfo:x}=(0,o.z)(),f="v0-level0"===p,{data:g,mutate:v}=(0,s.Ay)("show-upgrade-banner-limit",{fallbackData:!1}),{data:j,mutate:b}=(0,s.Ay)("show-upgrade-banner-general",{fallbackData:!1});(0,l.useLayoutEffect)(()=>{if(a||!p){v(!1),b(!1);return}let e=n.A.get(r.Dt),s=x?(x.onDemand.balance||0)+(x.balance.remaining||0):void 0,l=t&&0===t.remaining||"number"==typeof s&&s<=0,i=n.A.get(r.Uo),o=!(!l&&"1"===e)&&(t&&t.remaining<r.RD||"number"==typeof s&&s<r.DQ),c=t&&t.limit-t.remaining>=1,d=f&&"1"!==i&&c;v(o),b(d)},[t,b,v,f,a,p,d,x]);let y=(0,l.useCallback)(()=>{v(!1),n.A.set(r.Dt,"1",{expires:1})},[v]),w=(0,l.useCallback)(()=>{b(!1),n.A.set(r.Uo,"1",{expires:5})},[b]);return{showBannerLimit:g,showBannerGeneral:j,remaining:null==t?void 0:t.remaining,dismissBannerLimit:y,dismissBannerGeneral:w,userOnFree:f}}},19003:(e,t,a)=>{"use strict";a.d(t,{E:()=>b,w:()=>j});var n=a(97667),s=a(66692),r=a(74118),l=a(13729),i=a(42438),o=a(32136),c=a(28963),d=a(13263),u=a(69519),m=a(99314),h=a(27693),p=a(68160),x=a(39929),f=a(61589),g=a(25887),v=a(22447);function j(e){let{isAuthor:t,isMenuItem:a=!1,...c}=e,{chatPrivacy:d}=(0,o.kM)(),{chatId:u}=(0,r.xz)(),{copyToClipboard:p}=(0,i.j)({timeout:2e3}),f=(0,h.k)(),v=()=>{t&&u?(0,g.D)({type:"shareChat",data:{chatId:u,privacy:null!=d?d:"private"}}):("public"===d||"team"===d)&&(p(window.location.href),l.o.success("Share link copied!"))};return"private"!==d||t?a?(0,n.jsxs)(x.DropdownMenuItem,{onClick:v,...c,children:[(0,n.jsx)(m.S,{}),(0,n.jsx)("span",{children:f("shareDialog.share")})]}):(0,n.jsx)(s.$,{disabled:!1,onClick:v,className:"h-7 w-7 select-none items-center rounded-md",size:"sm",variant:"ghost",tooltip:{side:"bottom",content:"Share Chat"},children:(0,n.jsx)(m.S,{})}):null}function b(e){let{chatId:t,privacy:a}=e,r=(0,h.k)(),{title:l}=(0,o.tZ)(),{isCopied:m,copyToClipboard:x}=(0,i.j)({timeout:2e3});return t?(0,n.jsxs)(v._,{type:"shareChat",onOpenAutoFocus:e=>{e.preventDefault();let t=document.querySelector(".privacy-picker-selected");t&&t.focus()},children:[(0,n.jsxs)(c.ModalHeader,{children:[(0,n.jsx)(c.ModalTitle,{children:r("shareDialog.title")}),(0,n.jsx)("p",{className:"text-foreground text-sm",children:"Configure who has access to this chat."})]}),(0,n.jsx)(c.ModalContent,{className:"p-6",children:(0,n.jsx)(p.f,{privacy:a,chatId:t,variant:"chat"})}),(0,n.jsxs)(c.ModalFooter,{className:"bg-muted border-alpha-400 border-t !p-4",children:[(0,n.jsxs)(s.$,{onClick:()=>{x("".concat(window.location.origin,"/chat/").concat((0,f.D)(t,l)))},size:"sm",variant:"secondary",children:[(0,n.jsx)(d.U,{customIcon:(0,n.jsx)(u.N,{}),isCopied:m}),r("shareDialog.copyLink")]}),(0,n.jsx)(c.ModalClose,{asChild:!0,children:(0,n.jsx)(s.$,{tabIndex:0,size:"sm",children:r("shareDialog.done")})})]})]}):null}},19182:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createRouteFetcherForAction:()=>r});var n=a(25603);let s=new Map;function r(e){return async t=>{let a="".concat(e.method,":").concat(e.path,":").concat((0,n.WI)([t])),r=Date.now(),l=s.get(a);if(l&&l.expiry>r)return l.promise;for(let[e,t]of s.entries())t.expiry<=r&&s.delete(e);let i=e.path,o=e.path.match(/\[([^\]]+)\]/g)||[];for(let e of o){let a=e.slice(1,-1),n=t[a];if(void 0===n)throw Error("Missing required parameter: ".concat(a));i=i.replace(e,encodeURIComponent(String(n)))}if("GET"===e.method){let e=new URLSearchParams;Object.entries(t).forEach(t=>{let[a,n]=t;o.includes("[".concat(a,"]"))||void 0!==n&&e.append(a,String(n))});let a=e.toString();a&&(i+="?".concat(a))}let c=(async()=>{let a,n=e.method;if(!(a="GET"===n?await fetch(i):await fetch(i,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok){let e=await a.json().catch(()=>null);throw Error("HTTP error ".concat(a.status,": ").concat((null==e?void 0:e.error)||a.statusText))}return a.json()})();return s.set(a,{promise:c,expiry:r+500}),c}}},19676:(e,t,a)=>{"use strict";function n(e){if("user"===e.role)return!e.content&&(!e.attachments||0===e.attachments.length);let t=0===e.content.length,a=1===e.content.length&&1===e.content[0][0],n=e.content.length>0&&0===e.content[0][0]&&0===e.content[0][1].length;return t||a||n}function s(e){return"user"===e.role&&!e.content&&e.attachments&&e.attachments.length>0}function r(e){return"user"===e.role&&e.content&&e.content.startsWith("<v0_local_project_task>")}function l(e){return"user"===e.role&&e.content&&e.content.startsWith("<user_action ")}a.d(t,{Ne:()=>n,ZW:()=>s,pW:()=>l,pm:()=>r})},19716:(e,t,a)=>{"use strict";a.d(t,{Et:()=>c,d0:()=>o,jc:()=>i});var n=a(97667),s=a(33571),r=a(5594),l=a(19434);let i=r.bL,o=r.l9,c=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:i=4,...o}=e;return(0,n.jsx)(r.ZL,{children:(0,n.jsx)(r.UC,{align:s,className:(0,l.cn)("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),ref:t,sideOffset:i,...o})})});c.displayName=r.UC.displayName},20393:(e,t,a)=>{"use strict";function n(e){return e?{inert:!0}:{}}function s(e){return{opacity:+!!e,pointerEvents:e?"auto":"none"}}a.d(t,{e:()=>n,o:()=>s}),a(33571)},20630:(e,t,a)=>{"use strict";a.d(t,{B:()=>n.BG});var n=a(95734)},20717:(e,t,a)=>{"use strict";a.d(t,{t:()=>l});var n=a(33571),s=a(25603),r=a(36380);function l(e){let{data:t=[],mutate:a}=(0,s.Ay)(["consoleEvents",e],{fallbackData:[]}),{data:l,mutate:i}=(0,s.Ay)(["expandConsole",e],{fallbackData:null}),{flagNewEvent:o}=(0,r.a)(e),c=(0,n.useCallback)((e,t)=>{a(t=>[...t||[],e]),"console"!==t&&("message"in e&&e.message.includes("[Fast Refresh]")||("error"===e.method||"stderr"===e.method?o("error"):o("log")))},[a,o]);return{consoleEvents:t,appendConsoleEvent:c,appendCodeOutputEvents:(0,n.useCallback)((e,t)=>{a(t=>[...t||[],...e]),e.some(e=>"stderr"===e.method)?"console"!==t&&o("error"):"console"!==t&&o("log")},[a,o]),clearConsoleEvents:(0,n.useCallback)(()=>{a([])},[a]),expandConsole:l,setExpandConsole:i}}},21443:(e,t,a)=>{"use strict";async function n(e){let t=await fetch("/chat/api/blocks",{method:"PUT",body:JSON.stringify(e)});if(!t.ok)return{success:!1};let a=await t.json();return{success:a.success,transformedSource:a.success?a.transformedSource:void 0}}a.d(t,{Z:()=>n})},21715:(e,t,a)=>{"use strict";a.d(t,{hN:()=>b,jh:()=>w});var n=a(79168),s=a(86943),r=a(48402),l=a(74293);let i=l.z.object({id:l.z.string(),name:l.z.string(),url:l.z.string(),content:l.z.string().or(l.z.instanceof(ArrayBuffer)).optional(),status:l.z.enum(["uploading","done","compressing"]).optional(),size:l.z.number(),isImage:l.z.boolean(),isSavedDraft:l.z.boolean().optional(),v0Type:r.bZ,tokens:l.z.number().optional(),contentType:l.z.string().optional()}),o="new-chat-prompt-draft",c=l.z.object({version:l.z.literal(1),drafts:l.z.record(l.z.string(),l.z.object({message:l.z.string(),isMessageTrimmed:l.z.boolean().optional(),isExpandedDraft:l.z.boolean().optional(),quote:l.z.string().optional(),inputHeight:l.z.number().optional(),localFileInfos:l.z.array(i),fileMap:l.z.record(l.z.string(),l.z.object({name:l.z.string().optional(),contentType:l.z.string().optional(),url:l.z.string(),size:l.z.number(),isSavedDraft:l.z.boolean().optional(),v0Type:r.bZ})),updatedAt:l.z.number()}))});var d=a(33571),u=a(25603),m=a(70158),h=a(19243),p=a(73641),x=a(63476);let f="chat-prompt-drafts",g=e=>({version:1,drafts:{[e]:{message:"",localFileInfos:[],fileMap:{},updatedAt:Date.now()}}});function v(e){let t=JSON.parse(JSON.stringify(e));for(let e in t.drafts){for(let a of(t.drafts[e].fileMap={},t.drafts[e].localFileInfos))delete a.content;if(t.drafts[e].localFileInfos=t.drafts[e].localFileInfos.slice(0,3),t.drafts[e].message){let a=t.drafts[e].message.length>=100;t.drafts[e].isMessageTrimmed=a,t.drafts[e].message=a?"":t.drafts[e].message}t.drafts[e].quote&&(t.drafts[e].quote=t.drafts[e].quote.slice(0,200))}n.A.set(s.kK,JSON.stringify(t),{expires:s.Cy})}let j=e=>{let t,{chatId:a,newData:n}=e,s=a||o,r=localStorage.getItem(f);try{if((t=c.parse(JSON.parse(r||"{}"))).drafts[s]||(t.drafts[s]=g(s).drafts[s]),Object.keys(t.drafts).length>6){let{minKey:e,minValue:a}={minKey:"",minValue:1/0};for(let n in t.drafts)n!==o&&n!==s&&t.drafts[n].updatedAt<a&&(e=n,a=t.drafts[n].updatedAt);e&&delete t.drafts[e]}}catch(e){t=g(s)}t.drafts[s]={...t.drafts[s],...n},t.drafts[s].updatedAt=Date.now();try{localStorage.setItem(f,JSON.stringify(t)),v(t)}catch(e){var l,i;(0,h.u)("PromptDraftSaveError",{errorMsg:e instanceof Error?e.message:String(e),messageLength:null==(l=n.message)?void 0:l.length,quoteLength:null==(i=n.quote)?void 0:i.length})}},b=e=>{let t,{chatId:a}=e,r=localStorage.getItem(f);try{t=c.parse(JSON.parse(r||"{}")),delete t.drafts[a||o],localStorage.setItem(f,JSON.stringify(t)),v(t)}catch(e){localStorage.removeItem(f),n.A.remove(s.kK)}},y=e=>{let t=e||o,a=localStorage.getItem(f);try{let e=c.parse(JSON.parse(a||"{}"));v(e);let n=e.drafts[t];if(!n)return v(e),null;return{...n,source:"localStorage",key:t}}catch(e){return n.A.remove(s.kK),localStorage.removeItem(f),null}};function w(){let e=(0,p.x)(),t=(0,x.x)(),a=(0,m.usePathname)(),{data:n,mutate:s}=(0,u.Ay)(["chat:drafts",t?e:null]);return(0,d.useEffect)(()=>{if((null==n?void 0:n.source)==="cookie"){let a=y(t?e:void 0);s(a?{...a,isExpandedDraft:n.isMessageTrimmed}:null)}},[n,s,t,e]),{setDraft:s,draft:n,handleSavePromptDraft:(0,d.useCallback)(n=>{var s;(null==(s=n.localFileInfos)?void 0:s.some(e=>"application/zip"===e.contentType))&&(n={...n,localFileInfos:n.localFileInfos.filter(e=>"application/zip"!==e.contentType)}),a.startsWith("/chat/projects")||j({chatId:t?e:void 0,newData:n})},[t,e,a])}}},22237:(e,t,a)=>{"use strict";a.d(t,{H:()=>p,I:()=>x});var n=a(97667),s=a(74118),r=a(33571),l=a(66692),i=a(99715),o=a(55786),c=a(97396),d=a(36323),u=a(28819),m=a(43434),h=a(36863);function p(e){let t=(0,r.useRef)(["",null]);return(0,r.useMemo)(()=>{let[a,n]=t.current,s=e.reduce((e,t)=>e+"@"+t.id,"");if(a===s)return n;let r=(0,c.RA)(e);return t.current=[s,r],r},[e])}let x=(0,r.memo)(function(e){let{forkKeyOptions:t,message:a,className:p}=e,{messages:x}=(0,s.Pk)(),f=(0,s.jo)(),g=(t||[]).findIndex(e=>e&&e.some(e=>e===a.id)),v=(0,d.z6)(),{forkKeyCache:j}=(0,m.f)(),b=(0,h.F)(x),y=(0,r.useCallback)(e=>{let n=t[e];if(!n)return;let s=(0,c.K1)(n),r=s?j[s]:void 0;if(r){let e=new Set(b.current.map(e=>e.id)),t=!0;for(let a of r)e.has(a)||(t=!1);t&&(n=r)}let l=(0,c.C1)([...b.current],n);v(a.id,l),f({activeForkKey:l})},[t,f,j,v,a,b]);return!t||t.length<2?null:(0,n.jsxs)("div",{className:(0,u.cn)("flex items-center gap-0.5 text-sm font-medium",p),children:[(0,n.jsx)(l.$,{"aria-label":"Previous message version",className:"disabled:bg-background size-6 rounded-md disabled:border-none",disabled:0===g,onClick:()=>y(g-1),size:"xs",variant:"ghost",children:(0,n.jsx)(o.M,{})}),(0,n.jsxs)("span",{className:"whitespace-nowrap",children:[g+1," / ",t.length]}),(0,n.jsx)(l.$,{"aria-label":"Next message version",className:"disabled:bg-background size-6 rounded-md disabled:border-none",disabled:g===t.length-1,onClick:()=>y(g+1),size:"xs",variant:"ghost",children:(0,n.jsx)(i.b,{})})]})})},22447:(e,t,a)=>{"use strict";a.d(t,{_:()=>o});var n=a(97667),s=a(28963),r=a(80672),l=a(13089),i=a(33571);function o(e){let{type:t,children:a,forceOpen:o,...c}=e,d=(0,l.UY)(),u=(0,r.useAtomValue)(d.visibleDialogType),m=(0,r.useAtomValue)(d.dialogOpen),h=(0,i.useCallback)(e=>{e&&m?(0,l.Dh)(m):o||(0,l.zU)()},[m,o]),p=(0,i.useMemo)(()=>u===t||o,[t,u,o]);return(0,n.jsx)(s.Modal,{open:p,onOpenChange:h,...c,children:a})}},22482:(e,t,a)=>{"use strict";a.d(t,{Ip:()=>v,X3:()=>j,eD:()=>f,ie:()=>b});var n=a(97667),s=a(33571),r=a(39584),l=a(78399),i=a.n(l),o=a(28819),c=a(17773),d=a(39849),u=a(42938),m=a(31095),h=a(25563),p=a(54910),x=a(37707);function f(e){switch(e){case"error":return"!text-red-700 bg-red-50 hover:bg-red-100";case"warn":return"text-amber-700 bg-amber-50 hover:bg-amber-100";default:return"text-gray-700 hover:bg-gray-100"}}function g(e){let{value:t}=e;return Array.isArray(t)?(0,n.jsx)("div",{className:"flex flex-col gap-2 font-mono text-[13px] leading-4 text-gray-900",children:[...t].map((e,t)=>{let[a,s]=e;return a.startsWith("image/")?(0,n.jsx)("img",{alt:"Attachment ".concat(t),src:"data:".concat(a,";base64,").concat(s)},t):a.startsWith("text/")||a.startsWith("application/")?(0,n.jsx)("div",{className:"whitespace-pre-wrap",children:s},t):null})}):null}let v=(0,s.memo)(e=>{let{src:t,className:a,style:s}=e;return"string"==typeof t?(0,n.jsx)("span",{className:(0,o.cn)("whitespace-break-spaces break-all leading-[1.12] text-gray-900",a),children:(0,n.jsx)(i(),{children:t})}):(0,n.jsx)(r.Ay,{className:(0,o.cn)("leading-4 text-gray-900 [&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",a),collapsed:1,editable:!1,enableClipboard:!1,src:t,theme:"default",style:s})});v.displayName="JsonRowView";let j=(0,s.memo)(e=>{let{value:t,className:a,inline:s}=e;return(0,n.jsx)("output",{"aria-label":"Code execution output",className:(0,o.cn)("codeblock not-prose relative flex w-full flex-col overflow-y-auto font-mono text-[13px]",a),children:t?"error"in t?(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)(h.ErrorComponent,{error:Error(t.error,{cause:"code-execution-error"})})}):(0,n.jsxs)(n.Fragment,{children:[t.stdout.length?t.stdout.map((e,t)=>(0,n.jsx)(b,{inline:s,children:e.map((e,a)=>(0,n.jsx)(v,{src:e,className:"leading-normal"},"".concat(t,"-").concat(a,"-stdout")))},"".concat(t,"-stdout"))):null,t.stderr.length?t.stderr.map((e,t)=>(0,n.jsx)(b,{className:s?f("error"):void 0,inline:s,children:e.map((e,a)=>(0,n.jsx)(v,{className:(0,o.cn)("leading-normal [&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",s&&"text-red-700"),src:e,style:{color:"rgb(192,27,93)"}},"".concat(t,"-").concat(a,"-stderr")))},"".concat(t,"-stderr"))):null,t.returned?(0,n.jsx)(b,{inline:s,children:"$$attachments"in t.returned?t.returned.$$attachments.length>0?(0,n.jsx)(g,{value:t.returned.$$attachments}):null:(0,n.jsx)(v,{className:"leading-normal [&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",src:t.returned})}):null]}):null})});function b(e){let{children:t,fileName:a,isCopied:s,handleCopy:r,handleDownload:l,handleFileOpen:i,inline:h,className:f}=e,{scp:g}=(0,x.D)();return null===t?null:(0,n.jsxs)("div",{className:(0,o.cn)("border-alpha-200 group/code-output-message flex w-full flex-col gap-2 border-b p-2 text-[13px] last:border-b-0",!h&&"pl-2.5",f),children:[(0,n.jsxs)("div",{className:"relative flex w-full items-baseline gap-3",children:[!h&&(0,n.jsx)("div",{"aria-hidden":!0,className:"select-none text-pink-700 dark:text-pink-500",children:(0,n.jsx)(d.c,{size:8})}),a?(0,n.jsx)("button",{className:"codeblock not-prose line-clamp-1 font-mono text-blue-700 underline",onClick:i,children:a}):t,g&&!h&&(0,n.jsx)("div",{className:(0,o.cn)("pointer-events-none absolute inset-y-0 right-0 z-10"),children:(0,n.jsxs)(p.Kn,{className:"pointer-events-auto sticky top-3 flex -translate-y-1.5 opacity-0 group-hover:opacity-100 has-[[data-state='delayed-open']]:opacity-100 has-[[data-state='instant-open']]:opacity-100 has-[[data-state=open]]:opacity-100 md:top-5 [[data-touch-active=true]_&]:opacity-100",children:[(0,n.jsx)(p.rc,{"aria-label":"Copy",onClick:r,tooltip:"Copy",children:(0,n.jsx)("span",{"aria-hidden":!0,children:s?(0,n.jsx)(c.J,{}):(0,n.jsx)(u.Q,{className:"pointer-events-none"})})}),(0,n.jsx)(p.Sl,{className:"author-action"}),(0,n.jsx)(p.rc,{"aria-label":"Download",onClick:l,tooltip:"Download",children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(m.f,{className:"pointer-events-none"})})})]})})]}),a&&(0,n.jsx)("div",{className:"pl-5",children:t})]})}j.displayName="CodeOutput"},22975:(e,t,a)=>{"use strict";a.d(t,{p:()=>s});var n=a(70676);let s=(0,n.createServerReference)("60cbedb4ba2a510a9906bb35cdda8258ecebd943fe",n.callServer,void 0,n.findSourceMapURL,"createNewVercelProject")},23680:(e,t,a)=>{"use strict";a.d(t,{KO:()=>S,Ay:()=>k,vX:()=>w,Yh:()=>N,xH:()=>C});var n=a(33571),s=a(16983),r=a(13729),l=a(48685),i=a(57085),o=a(70158),c=a(70676);let d=(0,c.createServerReference)("40922e4bae06d7b03ebf8282275c04ec81d1a0f04d",c.callServer,void 0,c.findSourceMapURL,"importChat");var u=a(69114),m=a(33578),h=a(21715),p=a(9285),x=a(17509),f=a(19243),g=a(52520),v=a(48856),j=a(73655),b=a(86943);let y=[{mimeType:"image/gif",bytes:[71,73,70]},{mimeType:"image/png",bytes:[137,80,78,71]},{mimeType:"image/jpeg",bytes:[255,216]},{mimeType:"image/webp",bytes:[82,73,70,70]}],w=e=>new Promise((t,a)=>{let n=new Image;n.onload=()=>{t({width:n.naturalWidth,height:n.naturalHeight})},n.onerror=()=>{a(Error("Failed to load image"))},n.src=URL.createObjectURL(e)});async function N(e){let{file:t,config:n,setLocalFileInfos:s}=e;if(!(0,m.Ye)(t.type))return t;let r=n.image.maxSizeBytes;if(t.size<=r)return t;let l=(0,g.l)(),i={id:l,name:t.name,url:URL.createObjectURL(t),status:"compressing",size:t.size,isImage:t.type.startsWith("image/"),tokens:0,v0Type:t.v0Type};s(e=>[...e,i]),await new Promise(requestAnimationFrame);let{short:o,long:c}=n.image.maxDimensionsPixels,d=r/t.size+.1,u=null;for(;null===u;)try{let e=await function(e,t,n,s){return new Promise((r,l)=>{let i=new Worker(a.tu(new URL(a.p+a.u(5374),a.b)));i.onmessage=t=>{let{blob:a,error:n}=t.data;n?l(Error(n)):a&&r(new File([a],e.name,{type:a.type})),i.terminate()},i.onerror=e=>{l(Error(e.message)),i.terminate()},i.postMessage({file:e,quality:t,shortLimit:n,longLimit:s})})}(t,d,o,c);if(e.size>r)throw Error("File size still too large");(u=e).v0Type=t.v0Type}catch(e){d<=0?u=t:d-=.1}return s(e=>e.filter(e=>e.id!==l)),u}let k=e=>{let{isSignedIn:t,dragContainerRef:a,projectId:c,onFinish:y,onSuccess:k,onError:M,onUploadStart:I,disablePaste:A,disableDrag:D,saveToDrafts:L=!0}=e,z=c?"project-source":"prompt-attachment",{draft:E,handleSavePromptDraft:P}=(0,h.jh)(),T=(0,n.useRef)(null),[F,R]=(0,n.useState)(!1),[U,V]=(0,n.useState)(L&&(null==E?void 0:E.source)==="cookie"&&E.localFileInfos||[]),{user:B}=(0,j.k6)(),_=(0,x.f)(),{revalidate:O}=(0,u.m)(),[H,$]=(0,n.useState)(!1),q=(0,o.useRouter)(),{setShowSignInDialog:W}=(0,s.AO)(),[G,Z]=(0,n.useState)(new Map),Y=null!=M?M:r.o.error;(0,n.useEffect)(()=>{L&&(null==E?void 0:E.source)!=="cookie"&&(V((null==E?void 0:E.localFileInfos)||[]),Z(new Map(Object.entries((null==E?void 0:E.fileMap)||{}))))},[L,E]);let K=(0,n.useCallback)(async e=>{let a=[];try{if(!t)return void W({prompt:!1});if(G.size+e.length>b.qN[z])return void Y("You can only upload up to ".concat(b.qN[z]," files"));R(!0);let s=[],o=[];async function n(e){let t,a,n=await N({file:e,config:_,setLocalFileInfos:V}),u=(0,g.l)();if(n.name.startsWith(i.Q)&&(null==B?void 0:B.isAdminMode)&&!c){let e=await d({payload:{file:n}});return"error"in e?{status:"error",message:e.error}:(O(),r.o.success("Chat imported successfully"),q.push("/chat/".concat(e.chatId)),{status:"success"})}if("application/zip"===n.type){let e=await n.arrayBuffer();return s.push({id:u,name:n.name,size:n.size,isImage:!1,tokens:0,v0Type:"zip",url:"",contentType:"application/zip",content:e,status:"done"}),{status:"success"}}if((0,m.Ye)(n.type)){let e=_.image.maxSizeBytes,{short:t,long:a}=_.image.maxDimensionsPixels;if(n.size>e)return{status:"error",message:"".concat(n.name," is larger than ").concat((0,m.IG)(e))};let s=await w(n),r=Math.max(s.width||0,s.height||0),l=Math.min(s.width||0,s.height||0);if(r>a||l>t)return{status:"error",message:"".concat(n.name," exceeds the maximum dimensions. Long side must be less than or equal to ").concat(a,"px and short side must be less than or equal to ").concat(t,"px.")}}(0,m.Lu)(n.type,n.name.split(".").pop())&&(t=await n.text());let h=n.type.startsWith("image/")?(0,p.Ln)(n):(0,p.Mu)(t||""),x={id:u,name:n.name,url:URL.createObjectURL(n),content:t,status:"uploading",size:n.size,isImage:n.type.startsWith("image/"),tokens:h,v0Type:n.v0Type};V(e=>[...e,x]),null==I||I(x);let{pathname:j,clientPayload:b}=await S({file:n,component:z});try{a=await (0,l.Se)(j,n,{access:"public",handleUploadUrl:"/chat/api/chat/upload",clientPayload:JSON.stringify(b)})}catch(t){(0,f.u)("FileUploadError",{fileName:n.name,fileType:n.type,errorMsg:String(t)}),console.error("Failed to upload ".concat(n.name,": ").concat(String(t))),V(e=>e.filter(e=>e.id!==u));let e="Failed to upload file "+n.name;return t instanceof v.CW&&(e="File type not allowed"),{status:"error",message:e}}if(c){var y;(0,f.u)("UploadSource",{projectId:c,extension:null==(y=n.name.split(".").pop())?void 0:y.toLowerCase(),type:n.type});let e={projectId:c,filename:n.name,url:a.url},t=await fetch("/chat/api/projects/sources",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(!t.ok){let e;try{e=(await t.json()).error}catch(t){e="Failed to start file indexing"}return{status:"error",message:e}}}let k={...a,name:n.name,size:n.size,v0Type:n.v0Type};return V(e=>{let t=e.map(e=>e.id===u?{...e,status:"done",url:a.url,contentType:a.contentType}:e);return L&&P({localFileInfos:t.map(e=>({...e,isSavedDraft:!0}))}),t}),o.push(k),Z(e=>{let t=new Map(e).set(u,k);return L&&P({fileMap:Object.fromEntries(t)}),t}),s.push(x),{status:"success"}}for(let t=0;t<e.length;t+=5){let s=e.slice(t,t+5),r=await Promise.allSettled(s.map(n));a.push(...r)}let u=!1;for(let e of a){if("rejected"===e.status){u=!0,Y("Failed to upload file");continue}if("error"===e.value.status){u=!0,Y(e.value.message);continue}}u||await (null==k?void 0:k(o,s))}catch(e){Y("Unexpected error while uploading files")}R(!1),null==y||y()},[y,t,G.size,z,W,_,null==B?void 0:B.isAdminMode,c,I,O,q,L,P,k,M]),J=(0,n.useCallback)(async e=>{if($(!1),F||(e.preventDefault(),e.stopPropagation(),!e.dataTransfer))return;if(!t)return void W({prompt:!1});let{files:a,items:n}=e.dataTransfer,s=n?await C(Array.from(n)):await C(Array.from(a));s.ok&&await K(s.value)},[t,W,K,F,$]);(0,n.useEffect)(()=>{if(A)return;let e=async e=>{if(e.clipboardData){let t=e.clipboardData.items,a=[],n=async()=>{for(let e of t)if("file"===e.kind){let t=e.getAsFile();if(t){if((0,m.Ye)(t.type)){let e=_.image.maxSizeBytes;if(t.size>e)return void Y("".concat(t.name," is larger than ").concat((0,m.IG)(e)))}a.push(t)}}a.length>0&&await K(a)};await n()}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}},[_.image.maxSizeBytes,t,W,K,A]),(0,n.useEffect)(()=>{let e=document.documentElement;if(D)return;let t=(null==a?void 0:a.current)||window,n=()=>{$(!0)},s=()=>{$(!1)},r=e=>{e.preventDefault(),e.stopPropagation()};return t.addEventListener("dragenter",n),e.addEventListener("mouseleave",s),t.addEventListener("dragover",r),t.addEventListener("drop",J),()=>{t.removeEventListener("dragenter",n),e.removeEventListener("mouseleave",s),t.removeEventListener("dragover",r),t.removeEventListener("drop",J)}},[J,a,D]);let Q=async e=>{if(!e.target.files)return;let t=await C(Array.from(e.target.files));t.ok&&(await K(t.value),e.target.value="")};return{blobs:Array.from(G.values()),reset:()=>{V([]),Z(new Map),L&&P({localFileInfos:[],fileMap:{}})},uploading:F,localFileInfos:U,isDraggingFile:H,inputFileRef:T,onInputChange:Q,removeFile:e=>{V(t=>{let a=t.filter(t=>t.id!==e);return L&&P({localFileInfos:a}),a}),Z(t=>{let a=new Map(t);return a.delete(e),L&&P({fileMap:Object.fromEntries(a)}),a}),L&&P({fileMap:Object.fromEntries(Array.from(G).filter(t=>{let[a]=t;return a!==e}))})},uploadFiles:K}};async function C(e){let t=[];if(!(null==e?void 0:e.length))return{ok:!1};let a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e.isFile)return[await new Promise(t=>e.file(t))];if(e.isDirectory){let n=e.createReader(),s=await new Promise(e=>n.readEntries(e));return(await Promise.all(s.map(n=>a(n,t+e.name+"/")))).flat()}return[]},n=[];for(let a of e)if("webkitGetAsEntry"in a){let e=a.webkitGetAsEntry();e&&n.push(e)}else t.push(a);for(let e of n){let n=await a(e);t.push(...n)}let s=[];for(let e=0;e<t.length;e++){var l;let a=null==(l=t[e].name.split(".").pop())?void 0:l.toLowerCase();if(".DS_Store"!==t[e].name){if(!a)return r.o.error("Unsupported file type "+a),{ok:!1};s.push(t[e])}}return{ok:!0,value:s}}async function S(e){var t,a;let{file:n,component:s}=e,r=n.name,l=n.type,i=null==(t=n.name.split(".").pop())?void 0:t.toLowerCase();if(n.type.startsWith("image/")){let e=function(e){for(let{bytes:t,mimeType:a}of y)if(e.length>=t.length&&t.every((t,a)=>e[a]===t))return a}(new Uint8Array(await n.arrayBuffer()));l=null!=e?e:n.type,i=null!=(a=null==e?void 0:e.split("/")[1])?a:i,r=n.name.endsWith(".".concat(i))?n.name:"".concat(n.name,".").concat(i)}return{pathname:r,clientPayload:{component:s,fileType:l,extension:i}}}},23687:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(97667),s=a(55755),r=a(33571);let l=e=>{let[t,a]=r.useState(0),l=r.useRef(null);return r.useEffect(()=>{l.current=document.body,a(e=>e+1)},[]),(0,n.jsx)(s.b,{container:l.current,...e})};l.displayName=s.b.displayName},24389:(e,t,a)=>{"use strict";a.d(t,{JB:()=>r,L2:()=>d,Uf:()=>i,ej:()=>l,lu:()=>c,zz:()=>o});var n=a(97667),s=a(11322);let r=(0,s.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.93934 2.06066L8 1L9.06066 2.06066L13.9393 6.93934L15 8L13.9393 9.06066L9.06066 13.9393L8 15L6.93934 13.9393L2.06066 9.06066L1 8L2.06066 6.93934L6.93934 2.06066ZM3.12132 8L8 12.8787L12.8787 8L8 3.12132L3.12132 8Z" fill="#1D4ED8"/>'),l=(0,s.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.47141 3.13809L6.94281 2.66669L6 1.72388L5.5286 2.19528L2.19526 5.52861C1.93491 5.78896 1.93491 6.21107 2.19526 6.47142L5.5286 9.80476L6 10.2762L6.94281 9.33335L6.47141 8.86195L4.35948 6.75002H9.66667C10.0497 6.75002 10.429 6.82546 10.7828 6.97204C11.1367 7.11861 11.4582 7.33345 11.7291 7.60429C11.9999 7.87513 12.2147 8.19666 12.3613 8.55053C12.5079 8.90439 12.5833 9.28366 12.5833 9.66669C12.5833 10.0497 12.5079 10.429 12.3613 10.7828C12.2147 11.1367 11.9999 11.4582 11.7291 11.7291C11.4582 11.9999 11.1367 12.2148 10.7828 12.3613C10.429 12.5079 10.0497 12.5834 9.66667 12.5834H7.33333H6.58333V14.0834H7.33333H9.66667C10.2467 14.0834 10.821 13.9691 11.3569 13.7472C11.8927 13.5252 12.3796 13.1999 12.7897 12.7897C13.1998 12.3796 13.5252 11.8927 13.7471 11.3569C13.9691 10.821 14.0833 10.2467 14.0833 9.66669C14.0833 9.08668 13.9691 8.51235 13.7471 7.9765C13.5252 7.44065 13.1998 6.95376 12.7897 6.54363C12.3796 6.13351 11.8927 5.80818 11.3569 5.58622C10.821 5.36426 10.2467 5.25002 9.66667 5.25002H4.35948L6.47141 3.13809Z" fill="currentColor"/>'),i=(0,s.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5304 2.13629L10.0001 1.60596L8.93942 2.66662L9.46975 3.19695L11.5228 5.24995H6.33341C5.16204 5.24995 4.03865 5.71528 3.21036 6.54356C2.38207 7.37185 1.91675 8.49524 1.91675 9.66662C1.91675 10.2466 2.03099 10.8209 2.25295 11.3568C2.47491 11.8927 2.80023 12.3795 3.21036 12.7897C4.03865 13.618 5.16204 14.0833 6.33341 14.0833H8.66675H9.41675V12.5833H8.66675H6.33341C5.55987 12.5833 4.818 12.276 4.27102 11.729C4.00018 11.4582 3.78534 11.1366 3.63877 10.7828C3.49219 10.4289 3.41675 10.0496 3.41675 9.66662C3.41675 8.89307 3.72404 8.1512 4.27102 7.60422C4.818 7.05724 5.55987 6.74995 6.33341 6.74995H11.5228L9.46975 8.80295L8.93942 9.33328L10.0001 10.3939L10.5304 9.86361L13.8637 6.53028C14.1566 6.23739 14.1566 5.76251 13.8637 5.46962L10.5304 2.13629Z" fill="currentColor"/>'),o=(0,s.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M1.78027 1.78009L2.29198 3.24697L6.04198 13.997L6.59312 15.5769L7.40575 14.1142L9.76699 9.86393C9.78966 9.82312 9.82331 9.78948 9.86412 9.76681L14.1144 7.40556L15.5771 6.59293L13.9972 6.04179L3.24716 2.29179L1.78027 1.78009ZM11.9232 6.90695L9.13565 8.45557C8.84998 8.61428 8.61446 8.8498 8.45575 9.13547L6.90714 11.923L4.21998 4.2198L11.9232 6.90695Z" fill="currentColor"/>'),c=e=>{let{size:t="medium"}=e,a="small"===t?14:16;return(0,n.jsxs)("span",{className:"flex w-min items-center gap-0.5 font-mono leading-none",style:{height:a},children:[(0,n.jsx)("span",{className:"mt-[2px]",style:{fontSize:a+4},children:""}),(0,n.jsx)("span",{style:{fontSize:a-2},children:"/"})]})},d=(0,s.G4)('<path d="M6.79322 9.2069V6.31034H4.37943V7.27586V8.24138H1.00012L1 7.5V1H4.37943V2.93103H10.8967C10.8967 2.93103 15.0001 2.93103 15.0001 7.27586C15.0001 7.27586 12.8277 6.31034 10.1725 6.31034V9.2069M6.79322 9.2069H10.1725M6.79322 9.2069V15M10.1725 9.2069V15" stroke="currentColor" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>')},24405:(e,t,a)=>{"use strict";a.d(t,{N:()=>I,e:()=>D});var n=a(97667),s=a(33571),r=a(13729),l=a(25603);function i(){var e;let{data:t,error:a,isLoading:n,mutate:r}=(0,l.Ay)("github:active-namespaces",async()=>{try{let e=new URLSearchParams({provider:"github"}),t=await fetch("/chat/api/git/search-namespaces?".concat(e.toString()));if(!t.ok)throw Error("Failed to search orgs");return await t.json()}catch(e){return[]}},{revalidateOnFocus:!0,revalidateOnMount:!0}),i=(0,s.useCallback)(()=>r(),[r]);return{userNamespace:null==t?void 0:t.userNamespace,orgNamespaces:(null==t?void 0:t.orgNamespaces)||[],revalidate:i,verifiedGitHubUser:(null==t||null==(e=t.user)?void 0:e.verified)?t.user:void 0,isLoading:n,error:a}}var o=a(77831),c=a(32136),d=a(61222),u=a.n(d),m=a(25951),h=a(66692),p=a(89129),x=a(22447),f=a(25887),g=a(28963),v=a(53849),j=a(93660),b=a(49848),y=a(6902),w=a(61182),N=a(99772),k=a(77635),C=a(80574),S=a(20630),M=a(36323);function I(e){let{chatId:t}=e,{stage:a,isSigningIn:l,isInstallingApp:d,openSignIn:k,openInstallApp:C,error:I,isCreatingRepo:D,handleCreateRepo:L,repoName:z,setRepoName:E}=function(e){var t;let{project:a,title:l}=(0,c.tZ)(e),{revalidate:d}=(0,S.B)(["chat","externalMeta"],{chatId:e},{stopFetch:!e}),h=(0,M.eu)(e),{projectId:x=null==a?void 0:a.projectId}=(0,m.M9)(),{projectName:g=null==a?void 0:a.name}=(0,m.OT)(),{refetchVercelProject:v,vercelProjectWithDashboard:j}=(0,m.Ok)(x),b=null==j||null==(t=j.dashboardProject)?void 0:t.link,{userNamespace:y,verifiedGitHubUser:w,isLoading:k,revalidate:C}=i(),[I,A]=(0,s.useState)("loading"),[D,L]=(0,s.useState)(!1),[z,E]=(0,s.useState)(!1),[P,T]=(0,s.useState)(!1),F=(0,s.useRef)(!1),[R,U]=(0,s.useState)(null),[V,B]=(0,s.useState)("v0-".concat(u()(g||l))),_=(0,s.useMemo)(()=>(null==y?void 0:y.name)&&(null==b?void 0:b.repo)?"https://github.com/".concat(y.name,"/").concat(b.repo):void 0,[null==y?void 0:y.name,null==b?void 0:b.repo]);(0,s.useEffect)(()=>{if(b){(0,f.z)(),F.current||(r.o.default("GitHub Connected",{description:"Click to view your repository",icon:(0,n.jsx)(o.ERf,{className:"h-6 w-6"}),action:_?{children:"View",onClick:()=>{window.open(_,"_blank")}}:void 0}),F.current=!0);return}if(!k){if(!w)return void A("login");if(!y)return void A("install-app");A("create-repo"),B("v0-".concat(u()(g||l)))}},[b,k,_,g,l,y,w]);let O=(0,s.useCallback)(async()=>{try{if(L(!0),!x)return void r.o.error("Chat needs to be in a project");if(!((null==y?void 0:y.name)&&y.ownerType))return void r.o.error("Repo owner not specified");let e=null==h?void 0:h.id,t=await fetch("/chat/api/git/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({owner:y.name,repoName:V,projectId:x,blockId:e})});if(!t.ok){let e=await t.json(),a="Failed to create repository.";throw"repo_alr_exists"===e.error&&(a="Repository already exists. Try a new name."),Error(a)}await Promise.all([v(),d()])}catch(t){let e=t instanceof Error?t.message:"Failed to create repository";U(e),r.o.error(e)}finally{L(!1)}},[x,null==y?void 0:y.name,null==y?void 0:y.ownerType,null==h?void 0:h.id,V,v,d]),H="/chat/git/connected",$=window.location.origin+"/chat/git/callback",q="https://vercel.com/api/registration/login-with-github?next=".concat(encodeURIComponent($)),W={next:"".concat(window.location.origin,"/github/installed")},G=(0,N.v)(JSON.stringify(W)),Z=w?"https://github.com/apps/vercel/installations/new/permissions?target_id=".concat(w.userId,"&target_type=User&state=").concat(encodeURIComponent(G)):"",Y=(0,s.useCallback)(async e=>{await C(),e()},[C]),{open:K}=(0,p.m)({url:q,onPoll:e=>{e.location.pathname===H&&Y(()=>{e.close(),E(!1)})},onClose:()=>{Y(()=>{E(!1)})}}),{open:J}=(0,p.m)({url:Z,onPoll:e=>{console.log("popupWindow",e.location.pathname,H),e.location.pathname===H&&Y(()=>{e.close(),T(!1)})},onClose:()=>{Y(()=>{T(!1)})}});return{stage:I,setStage:A,error:R,repoName:V,setRepoName:B,isCreatingRepo:D,isSigningIn:z,isInstallingApp:P,handleCreateRepo:O,openSignIn:function(){E(!0),K()},openInstallApp:function(){T(!0),J()}}}(t),P=(0,s.useMemo)(()=>{switch(a){case"loading":return{title:(0,n.jsx)(j.E,{className:"h-[26px] w-[180px]"}),description:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(j.E,{className:"h-[14px] w-full"}),(0,n.jsx)(j.E,{className:"h-[14px] w-[75%]"})]}),actions:(0,n.jsx)(A,{children:(0,n.jsx)(j.E,{className:"h-7 w-24"})})};case"login":return{title:"Sign in with GitHub",description:"To connect this project to a GitHub repository, you need to sign in with your GitHub account",actions:(0,n.jsxs)(A,{children:[(0,n.jsx)(h.$,{size:"sm",onClick:f.z,disabled:l,variant:"outline",children:"Cancel"}),(0,n.jsx)(h.$,{size:"sm",onClick:k,disabled:l,children:(0,n.jsx)(w.V,{isLoading:l,loading:"Signing in",children:"Sign in"})})]})};case"install-app":return{title:"Install GitHub App",description:"Install Vercel GitHub App on your personal GitHub account to create a repository.",actions:(0,n.jsxs)(A,{children:[(0,n.jsx)(h.$,{size:"sm",onClick:f.z,disabled:d,variant:"outline",children:"Cancel"}),(0,n.jsx)(h.$,{size:"sm",onClick:C,disabled:d,children:(0,n.jsx)(w.V,{isLoading:d,loading:"Installing App",children:"Install Vercel App"})})]})};case"create-repo":return{title:"Connect to GitHub Repository",description:(0,n.jsxs)("span",{children:["Create a new repository on GitHub to push changes to. When you deploy, v0 will commit changes to the"," ",(0,n.jsx)("code",{className:"text-label-13-mono border-alpha-400 rounded-sm border bg-gray-100 px-1.5 py-0.5",children:"main"})," ","branch."]}),content:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(y.Label,{htmlFor:"repo-name",children:"Repository Name"}),(0,n.jsx)(b.p,{id:"repo-name",placeholder:"Repository Name",value:z,onChange:e=>E(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),L())}})]}),actions:(0,n.jsxs)(A,{children:[(0,n.jsx)(h.$,{size:"sm",onClick:f.z,variant:"outline",disabled:D,children:"Cancel"}),(0,n.jsx)(h.$,{size:"sm",onClick:L,disabled:D,className:"overflow-hidden",children:(0,n.jsx)(w.V,{isLoading:D,loading:"Creating Repository",children:"Create Repository"})})]})}}},[a,k,l,C,d,z,D,L,E]);return(0,n.jsxs)(x._,{type:"connectRepo",forceOpen:l||d||D,children:[(0,n.jsxs)(g.ModalHeader,{children:[(0,n.jsx)("div",{className:"border-border material-medium mb-2 flex w-min items-center justify-center justify-self-center rounded-lg border p-2 md:justify-self-start",children:(0,n.jsx)(o.ERf,{className:"h-6 w-6"})}),(0,n.jsx)(v._r,{...v.fG.modalSection,renderKey:a,children:(0,n.jsx)(g.ModalTitle,{children:P.title})}),(0,n.jsx)(v._r,{...v.fG.modalSection,renderKey:a,children:(0,n.jsx)(g.ModalDescription,{children:P.description})})]}),(0,n.jsx)(g.ModalContent,{children:(0,n.jsx)(v._r,{...v.fG.modalSection,renderKey:"".concat(a,"-").concat(I),children:(0,n.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[P.content,I?(0,n.jsx)("div",{className:"rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:I}):null]})})}),(0,n.jsx)(g.ModalFooter,{children:(0,n.jsx)(v._r,{...v.fG.modalSection,renderKey:a,children:P.actions})})]})}function A(e){let{children:t}=e;return(0,n.jsx)("div",{className:"flex w-full justify-end gap-2",children:t})}function D(e){var t,a;let{chatId:l,activeBlock:d}=e,{project:u}=(0,c.tZ)(),{userNamespace:p}=i(),[x,g]=(0,s.useState)(!1),j=(0,k.S)({chatId:l,activeBlock:d}),b=null==(a=(0,m.Ok)(null==u?void 0:u.projectId).vercelProjectWithDashboard)||null==(t=a.dashboardProject)?void 0:t.link,y=(0,s.useCallback)(async()=>{if(b&&p)window.open("https://github.com/".concat(b.org,"/").concat(b.repo),"_blank");else try{g(!0),await j(),(0,f.D)({type:"connectRepo",data:{chatId:l}})}catch(e){r.o.error("Failed to connect to GitHub")}finally{g(!1)}},[b,p,j,l]),w=(0,s.useMemo)(()=>b?"Open GitHub":x?"Creating Project":"Connect to GitHub",[b,x]);return(0,n.jsxs)(h.$,{size:"sm",variant:"secondary",onClick:y,className:"h-7 w-7 rounded-md",tooltip:{side:"bottom",content:w},children:[(0,n.jsx)(v._r,{...v.fG.buttonContent,children:x?(0,n.jsx)(C.y,{size:16}):(0,n.jsx)(o.ERf,{})}),(0,n.jsx)("span",{className:"sr-only",children:"Eject to GitHub"})]})}},25426:(e,t,a)=>{"use strict";a.d(t,{M:()=>s});var n=a(70676);let s=(0,n.createServerReference)("7c1548f856963b8defe4992705649fb9394aa81fff",n.callServer,void 0,n.findSourceMapURL,"doExecution")},25563:(e,t,a)=>{"use strict";a.d(t,{ErrorComponent:()=>i});var n=a(97667),s=a(19243),r=a(16979),l=a(33571);function i(e){let{error:t}=e;(0,l.useEffect)(()=>{(0,s.u)("ErrorBoundaryError",{message:t.message,stack:t.stack,digest:t.digest,cause:t.cause,name:t.name})},[t]);let a=t.message.includes("#482");return(0,n.jsx)("div",{className:"mx-auto flex h-full max-w-2xl items-center justify-center px-4 text-lg font-medium text-red-600 md:text-xl lg:text-2xl",children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 text-red-600",children:[(0,n.jsx)("div",{className:"border-border bg-background flex size-8 items-center justify-center rounded-sm border p-2",children:(0,n.jsx)(r.V,{})}),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,n.jsxs)("h1",{className:"text-base font-medium",id:"error",children:["An Error Occurred"," "]}),t.message?(0,n.jsx)("h2",{className:"text-center text-sm font-normal text-gray-500",children:(0,n.jsx)("code",{className:"tracking-tight",children:t.message})}):null,a?(0,n.jsx)("h2",{className:"text-center text-sm font-normal text-gray-500",children:"This error is likely caused by a bug with your browser extensions. Please try disabling extensions and programs that modify the page."}):null]})]})})}},25887:(e,t,a)=>{"use strict";a.d(t,{Dialogs:()=>tD,z:()=>s.zU,D:()=>s.Dh});var n=a(97667),s=a(13089),r=a(80672),l=a(33571),i=a(28963),o=a(66692),c=a(22447);function d(){return(0,n.jsxs)(c._,{type:"createTeam",children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:"Create a Team on Vercel"}),(0,n.jsxs)(i.ModalDescription,{children:["You will be redirected to"," ",(0,n.jsx)("span",{className:"font-medium",children:"vercel.com"})," to create a new Vercel team. If you create a Vercel Pro team, you will be charged for the Vercel Pro subscription in addition to the v0 Team plan."]})]}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{size:"sm",variant:"secondary",onClick:s.zU,children:"Cancel"}),(0,n.jsx)(o.$,{size:"sm",asChild:!0,variant:"default",children:(0,n.jsx)("a",{href:"https://vercel.com/dashboard?createTeam=v0-checkout-page",target:"_blank",children:"Continue to Vercel"})})]})]})}var u=a(71543),m=a(13729),h=a(11472);function p(e){let{slug:t,name:a}=e,{user:r}=(0,u.J)(),{refreshScopes:d}=(0,h.b)(),[p,x]=(0,l.useTransition)(),f=(0,l.useCallback)(e=>{p||x(async()=>{if(!(await fetch("/chat/api/team/request-access/".concat(e),{method:"POST"})).ok)return void m.o.error("Failed to request access");m.o.success("Access requested"),(0,s.zU)(),d()})},[p,d]);return(0,n.jsxs)(c._,{type:"requestAccess",children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:"Request Access"}),(0,n.jsxs)(i.ModalDescription,{children:["Your account"," ",(0,n.jsx)("b",{className:"font-medium",children:(null==r?void 0:r.name)||(null==r?void 0:r.username)})," does not have permission to use v0 in"," ",(0,n.jsx)("b",{className:"font-medium",children:a||t})," Team. Request access, or switch to a different Team."]})]}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{size:"sm",variant:"secondary",onClick:s.zU,children:"Cancel"}),(0,n.jsx)(o.$,{disabled:p,onClick:()=>f(t),size:"sm",children:"Request Access"})]})]})}var x=a(17773),f=a(27693),g=a(83195),v=a(61070),j=a(35501),b=a.n(j),y=a(19243);function w(e){var t;let{id:a,name:r,slug:l}=e,d=(0,f.k)(),{planInfo:u,isLoading:m}=(0,g.N)(!0,a),h=null==u||null==(t=u.plans)?void 0:t.find(e=>"v0-team"===e.slug);if(m||!h)return null;let p=(0,v.m9)(h);return(0,n.jsxs)(c._,{type:"upgradeTeam",children:[(0,n.jsxs)(i.ModalHeader,{className:"!pb-4",children:[(0,n.jsx)(i.ModalTitle,{children:d("teamUpgradeDialog.title")}),(0,n.jsx)(i.ModalDescription,{children:d("teamUpgradeDialog.description")(r||l)})]}),(0,n.jsxs)(i.ModalContent,{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"border-alpha-200 bg-muted m-0 space-y-3 rounded-sm border !p-4",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("p",{className:"font-semibold",children:d("teamUpgradeDialog.planName")("Team")}),(0,n.jsxs)("div",{className:"inline-flex items-center gap-0.5",children:[(0,n.jsx)("p",{className:"text-xl font-semibold leading-7",children:p}),(0,n.jsx)("p",{className:"leading-5 text-gray-500",children:d("teamUpgradeDialog.userPerMonth")})]})]}),(0,n.jsx)("p",{className:"font-semibold",children:d("teamUpgradeDialog.forFastMovingTeams")}),(0,n.jsxs)("ul",{className:"space-y-3 text-sm",children:[(0,n.jsxs)("li",{className:"flex items-center gap-2",children:[(0,n.jsx)(x.J,{size:20})," ",d("teamUpgradeDialog.everythingInPremium")]}),(0,n.jsxs)("li",{className:"flex items-center gap-2",children:[(0,n.jsx)(x.J,{size:20})," ",d("teamUpgradeDialog.evenHigherLimits")]}),(0,n.jsxs)("li",{className:"flex items-center gap-2",children:[(0,n.jsx)(x.J,{size:20})," ",d("teamUpgradeDialog.centralizedBilling")]})]})]}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:d("teamUpgradeDialog.learnMore")()})]}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{size:"sm",variant:"secondary",onClick:s.zU,children:d("teamUpgradeDialog.cancel")}),(0,n.jsx)(o.$,{asChild:!0,onClick:()=>{(0,y.u)("ClickGoToUpgradeTeamPage",{teamId:a}),(0,s.zU)()},size:"sm",children:(0,n.jsx)(b(),{href:"/chat/upgrade?teamId=".concat(a),children:d("teamUpgradeDialog.startTeamPlan")})})]})]})}var N=a(70676);let k=(0,N.createServerReference)("404bf8e475e2a60c94444faa60395fd01e5472e867",N.callServer,void 0,N.findSourceMapURL,"updateChatTitle");var C=a(70158),S=a(49848),M=a(50942),I=a(69114),A=a(12507),D=a(93187),L=a(74293),z=a(84031),E=a(45437),P=a(41956),T=a(97478),F=a(61589),R=a(32136),U=a(20630);let V=L.z.object({title:L.z.string().min(1,"Title is required").max(100,"Title must be less than 100 characters")});function B(e){let{chatId:t}=e,a=(0,C.useRouter)(),[r,d]=(0,l.useTransition)(),{title:u,setMetadata:h}=(0,R.tZ)(t),[p,x]=(0,l.useState)(""),g=(0,E.cy)(),{data:v,setData:j}=(0,I.m)(),{data:b,setData:y}=(0,I.r)(),[w,N]=(0,l.useState)(""),L="string"==typeof g.id?(0,T.Kv)(g.id):null,B=l.useRef(null),_=(0,f.k)(),O=(0,P.al)(),{data:H,mutate:$}=(0,U.B)(["scoped","chats"],{});(0,l.useEffect)(()=>{let e=null==v?void 0:v.find(e=>e.chatId===t);N((null==e?void 0:e.title)||u||""),x((null==e?void 0:e.title)||u||"")},[v,u,t]),(0,l.useEffect)(()=>{setTimeout(()=>{var e,t;null==(e=B.current)||e.focus(),O||null==(t=B.current)||t.select()},0)},[O]);let q=(0,l.useCallback)(()=>{d(async()=>{try{let e=await $({serverMutate:k({chatId:t,title:p.trim()||"Untitled"}),optimisticData:{favorites:H.favorites.map(e=>e.chatId===t?{...e,title:p.trim()||"Untitled"}:e),history:H.history.map(e=>e.chatId===t?{...e,title:p.trim()||"Untitled"}:e)}}),a=null==b?void 0:b.find(e=>e.chatId===t);if("success"in e){if(a&&y(e=>e.map(e=>e.chatId===t?{...e,title:p.trim()||"Untitled"}:e)),(null==v?void 0:v.find(e=>e.chatId===t))&&j(e=>e.map(e=>e.chatId===t?{...e,title:p.trim()||"Untitled"}:e)),L===t&&h({title:p.trim()||"Untitled"}),m.o.success(_("updateChatTitleDialog.successToast")),new RegExp("/chat/.*".concat(t)).test(window.location.pathname)){let e=(0,F.D)(t,p);window.history.replaceState(null,"","/chat/".concat(e))}(0,s.zU)()}else throw Error(D.YK)}catch(e){(0,A.z)(e,a)||m.o.error("Failed to update chat title. Please try again."),y(()=>b||[]),j(()=>v||[])}})},[$,t,p,H.favorites,H.history,b,v,L,_,y,j,h,a]),W=(0,l.useCallback)(e=>{e.preventDefault();let t=V.safeParse({title:p});if(!t.success){var a;let e=t.error.flatten().fieldErrors;m.o.error((null==(a=e.title)?void 0:a[0])||"Invalid title");return}q()},[q,p]);return(0,n.jsx)(c._,{type:"updateChatTitle",children:(0,n.jsxs)("form",{onSubmit:W,children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:_("updateChatTitleDialog.title")}),(0,n.jsxs)(i.ModalDescription,{children:[(0,n.jsx)("label",{className:"sr-only",htmlFor:"newChatTitle",children:_("updateChatTitleDialog.newChatTitle")}),(0,n.jsx)(S.p,{"aria-label":_("updateChatTitleDialog.newChatTitle"),autoComplete:"off",autoFocus:!0,className:"w-full",id:"newChatTitle",maxLength:100,onChange:e=>x(e.target.value),placeholder:w||_("updateChatTitleDialog.enterNewTitle"),ref:B,value:p}),(0,n.jsx)(z.j,{className:"mt-2",count:p.length,max:100,message:"Title must be less than ".concat(100," characters")})]})]}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{onClick:s.zU,size:"sm",type:"button",variant:"secondary",children:_("updateChatTitleDialog.cancel")}),(0,n.jsx)(o.$,{disabled:r,size:"sm",type:"submit",children:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.X,{"aria-hidden":"true",className:"size-4"}),(0,n.jsx)("span",{children:_("updateChatTitleDialog.saving")})]}):_("updateChatTitleDialog.save")})]})]})})}var _=a(35441),O=a(73641);function H(e){let{chatId:t}=e,a=(0,C.useRouter)(),r=(0,O.x)(),[d,u]=(0,l.useTransition)(),{setData:h}=(0,I.m)(),p=(0,f.k)();return(0,n.jsxs)(c._,{type:"deleteChat",children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:p("deleteChatDialog.title")}),(0,n.jsx)(i.ModalDescription,{children:p("deleteChatDialog.description")})]}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{size:"sm",variant:"secondary",onClick:s.zU,children:p("deleteChatDialog.cancel")}),(0,n.jsx)(o.$,{disabled:d,onClick:()=>{u(async()=>{try{(0,y.u)("ClickDeleteChat",{targetChatId:t}),await (0,_._)({payload:{chatId:t}}),h(e=>e.filter(e=>e.chatId!==t)),(0,s.zU)(),m.o.success(p("deleteChatDialog.successToast")),r===t&&a.push("/chat")}catch(e){(0,A.z)(e)||m.o.error("Something went wrong. Please try again.")}})},size:"sm",variant:"destructive",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.X,{className:"size-4"}),p("deleteChatDialog.deleting")]}):p("deleteChatDialog.delete")})]})]})}var $=a(19003),q=a(58576),W=a(96151),G=a(71679),Z=a(68555),Y=a(89215),K=a(69519),J=a(99314),Q=a(90323),X=a(28819),ee=a(74118),et=a(47540),ea=a(74905),en=a(66152),es=a(6680);a(39929);var er=a(68160);function el(e){let{isAuthor:t,activeBlock:a}=e,{chatPrivacy:s}=(0,R.kM)(),{chatId:r}=(0,ee.xz)(),{title:d}=(0,R.tZ)(),u=(0,ea.s)(),h=(0,l.useRef)(null),p=(0,en.LX)(a.id),x="private"!==s,f=new URLSearchParams;if(f.set("b",a.id||""),"code"===p&&f.set("p","0"),!r)return null;let g="".concat(window.location.origin,"/chat/").concat((0,F.D)(r,d),"?").concat(f.toString());return(0,n.jsxs)(c._,{type:"shareBlock",children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:"Share Block"}),(0,n.jsx)("span",{children:t?(0,n.jsx)("p",{className:"text-foreground text-sm",children:"Configure who has access to this block."}):null})]}),(0,n.jsxs)(i.ModalContent,{className:"flex flex-col gap-3",children:[t?(0,n.jsx)(er.f,{privacy:s,chatId:r,variant:"block"}):null,x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q.o,{className:(0,X.cn)("transition-all"),link:g,ref:h}),(0,n.jsx)(es.$,{})]}):null]}),t&&a.id?(0,n.jsx)("div",{className:"bg-muted border-alpha-400 flex w-full items-center justify-end gap-2 border-t p-4",children:u?(0,n.jsx)(ei,{activeBlockId:a.id,isDrawer:u,link:g,title:a.meta.project||"this block"}):(0,n.jsxs)(o.$,{size:"sm",onClick:()=>{m.o.promise({promise:navigator.clipboard.writeText(g),error:"Failed to copy link",success:"Link copied",loading:"Copying link..."})},children:[(0,n.jsx)(K.N,{}),"Copy Link"]})}):null]})}function ei(e){let{activeBlockId:t,title:a,link:s,isDrawer:r}=e,l=(0,f.k)(),i=e=>{(0,y.u)("ClickBlockShare",{destination:e,blockId:t})};return navigator&&void 0!==navigator.share&&r?(0,n.jsxs)(o.$,{className:"gap-2",onClick:()=>{try{navigator.share({title:a,text:"Check out ".concat(a,"  built with v0 by Vercel\n\n").concat(s)}),i("navigator.share")}catch(e){m.o.error("Sharing is not supported on this device")}},size:"sm",type:"button",variant:"default",children:[(0,n.jsx)(J.S,{}),l("shareBlockPopover.share")]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"font-semibold",children:l("shareBlockPopover.share")}),(0,n.jsxs)("div",{className:"flex w-full items-center justify-center gap-3",children:[(0,n.jsx)(et.N,{className:"flex-1",external:!0,href:"https://x.com/intent/tweet?text=".concat(encodeURIComponent("Check out ".concat(a,"  built with @v0\n\n").concat(s))),onClick:()=>i("X  The Everything App"),tooltip:{content:l("shareBlockPopover.shareOnX"),side:"bottom"},children:(0,n.jsx)(o.$,{className:"flex w-full justify-center",type:"button",variant:"secondary",children:(0,n.jsx)(Z.B,{})})}),(0,n.jsx)(et.N,{className:"flex-1",external:!0,href:"https://www.reddit.com/submit?url=".concat(encodeURIComponent(s),"&title=").concat(encodeURIComponent("Check out ".concat(a,"  built with v0 by Vercel"))),onClick:()=>i("Reddit"),tooltip:{content:l("shareBlockPopover.shareOnReddit"),side:"bottom"},children:(0,n.jsx)(o.$,{className:"flex w-full justify-center",type:"button",variant:"secondary",children:(0,n.jsx)(G.c,{})})}),(0,n.jsx)(et.N,{className:"flex-1",external:!0,href:"https://news.ycombinator.com/submitlink?u=".concat(encodeURIComponent(s),"&t=").concat(encodeURIComponent("Check out ".concat(a,"  built with v0 by Vercel"))),onClick:()=>i("Hacker News"),tooltip:{content:l("shareBlockPopover.shareOnHackerNews"),side:"bottom"},children:(0,n.jsx)(o.$,{className:"flex w-full justify-center",type:"button",variant:"secondary",children:(0,n.jsx)(Y.P,{})})})]})]})}var eo=a(91746),ec=a(70334),ed=a(26620),eu=a(37242),em=a(7086),eh=a(72059);let ep=(0,N.createServerReference)("40925c8eec8f4aa215c0ec33e2e83c98b434caa396",N.callServer,void 0,N.findSourceMapURL,"sendGeneralFeedback");var ex=a(8689),ef=a(57560);let eg=(0,ef.eU)(""),ev=(0,ef.eU)(void 0),ej=(0,ef.eU)(void 0);function eb(e){let{feedback:t,sentiment:a}=e,o=(0,f.k)(),[d,u]=(0,r.useAtom)(eg),[m,h]=(0,r.useAtom)(ev),[p,x]=(0,r.useAtom)(ej);return(0,l.useEffect)(()=>{t&&u(t),a&&h(a)},[]),(0,n.jsxs)(c._,{type:"feedback",children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:o("feedbackDialog.title")}),(0,n.jsx)(i.ModalDescription,{children:o("feedbackDialog.description")})]}),(0,n.jsx)(i.ModalContent,{children:(0,n.jsx)(ew,{feedback:d,selectedOption:m,setFeedback:u,closeDialog:s.zU,setSelectedOption:h,setValidationError:x,validationError:p})})]})}function ey(e){let{children:t,selectedOption:a,option:s,handleOptionClick:r}=e;return(0,n.jsx)(o.$,{className:(0,X.cn)("transition-all duration-300",a===s&&"border-gray-900 hover:border-gray-900 focus:border-gray-900 focus-visible:border-gray-900"),onClick:()=>r(s),size:"sm",type:"button",variant:"secondary",children:t})}function ew(e){let{feedback:t,setFeedback:a,selectedOption:s,setSelectedOption:r,validationError:c,setValidationError:d,closeDialog:h}=e,p=(0,f.k)(),{user:x}=(0,u.J)(),g=e=>{e&&r(e),d(void 0)},{formRef:v,onKeyDown:j}=(0,eh.G)(),b=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(b.current){b.current.focus();let e=b.current.value.length;b.current.setSelectionRange(e,e)}},[]),(0,n.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:e=>(e.preventDefault(),""===t.trim())?void d(p("feedbackDialog.error.enterFeedback")):s?void(ep({feedback:t,url:location.href,sentiment:s,user:x}),h(),a(""),r("neutral"),d(void 0),m.o.success(p("feedbackDialog.successToast"))):void d(p("feedbackDialog.error.selectEmoji")),ref:v,children:[(0,n.jsx)(em.T,{asChild:!0,children:(0,n.jsx)(ex.o,{ref:b,maxHeight:224,minHeight:80,name:"feedback",onKeyDown:j,placeholder:p("feedbackDialog.yourFeedback"),spellCheck:!1,onChange:e=>a(e.target.value),value:t})}),(0,n.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,n.jsxs)("div",{className:"flex w-full items-center justify-start gap-2",children:[(0,n.jsx)(ey,{handleOptionClick:g,option:"bad",selectedOption:s,children:(0,n.jsx)(ec.A,{className:(0,X.cn)("size-4",{"dark:fill-red-400/80 fill-red-200":"bad"===s})})}),(0,n.jsx)(ey,{handleOptionClick:g,option:"neutral",selectedOption:s,children:(0,n.jsx)(ed.A,{className:(0,X.cn)("size-4",{"dark:fill-amber-500/70 fill-yellow-200":"neutral"===s})})}),(0,n.jsx)(ey,{handleOptionClick:g,option:"good",selectedOption:s,children:(0,n.jsx)(eu.A,{className:(0,X.cn)("size-4",{"dark:fill-green-500/60 fill-green-200":"good"===s})})}),(0,n.jsx)("div",{children:c&&(0,n.jsx)("div",{className:"text-sm text-red-700",role:"alert",children:c})})]}),(0,n.jsxs)(i.ModalFooter,{className:"p-0 md:p-0",children:[(0,n.jsx)(i.ModalClose,{asChild:!0,children:(0,n.jsx)(o.$,{size:"sm",type:"button",variant:"secondary",onClick:h,children:p("feedbackDialog.cancel")})}),(0,n.jsx)(o.$,{size:"sm",type:"submit",children:p("feedbackDialog.submit")})]})]})]})}var eN=a(24405),ek=a(65744);let eC=(0,N.createServerReference)("4004a8653690b8553964e3022ac1326b9fdb946c2a",N.callServer,void 0,N.findSourceMapURL,"createInvoiceTopUpPurchase"),eS=(0,N.createServerReference)("40e52e9f33ff3d5dda2e7d98159c557c54a208ecf0",N.callServer,void 0,N.findSourceMapURL,"createElementsTopUpPurchaseIntent"),eM=(0,N.createServerReference)("401ef333b7ac69651db689b48dbeab3431fe969c90",N.callServer,void 0,N.findSourceMapURL,"createCheckoutTopUpPurchaseIntent"),eI=(0,N.createServerReference)("408a7d8a1ba35888287ab1cae9c65072bede59709d",N.callServer,void 0,N.findSourceMapURL,"completeTopUpPurchaseIntent");var eA=a(88684),eD=a(73655),eL=a(37294),ez=a(90643),eE=a(16292),eP=a(16979);let eT=(0,N.createServerReference)("408098c1118ea5ddad6b68a7a0377491c031d4e1fe",N.callServer,void 0,N.findSourceMapURL,"fixPaymentMethod");var eF=a(26864),eR=a(70692),eU=a(53849),eV=a(19434),eB=a(84618),e_=a(93660);let eO=[30,60,100,250,500];function eH(e){let{user:t}=(0,eD.k6)(),a=(null==t?void 0:t.billingMode)==="test"?"test":"live";return(0,n.jsx)(ez.StripeProvider,{mode:a,children:(0,n.jsx)(e$,{...e})})}function e$(e){let{onSuccess:t,onCancel:a,role:r}=e,{activeScope:l,isActiveScopeReady:i}=(0,eD.k6)(),{toast:o}=(0,eB.dj)(),{needsToRequestCredits:c,isLoading:d,shouldInvoice:u}=function(e){let{role:t,plan:a}=e,{user:n,isTeam:s,isActiveScopeReady:r}=(0,eD.k6)(),l=t||(null==n?void 0:n.teamRole),i=a||(null==n?void 0:n.v0plan),o=!r&&(!t||!a);return r&&!s?{isLoading:o,needsToRequestCredits:!1,shouldInvoice:!1,canBuyCredits:"v0-level0"!==i}:{canBuyCredits:"v0-level0"!==i,needsToRequestCredits:"OWNER"!==l&&"BILLING"!==l,shouldInvoice:"v0-enterprise"===i,isLoading:o}}({role:r}),{planInfo:m,isLoading:h}=(0,g.N)(!0,null==l?void 0:l.id,!c),p=(0,eL.useStripe)(),x=async(e,a)=>{if(!p)throw Error("Stripe not found");if(c){(0,s.zU)(),o({title:"Request Sent",description:(0,n.jsxs)("span",{children:["Your request for ",(0,n.jsxs)("strong",{children:["$",e]})," credits has been sent to an admin."]}),duration:5e3});return}if(u){await eC({amount:e.toString()}),null==t||t(),(0,s.zU)();return}if(!a)throw Error("No payment method selected");let r=await eS({amount:e.toString(),returnUrl:window.location.href});if(!r.ok)throw Error(r.error.message);let{providerDetails:l,purchaseIntent:i}=r.value,d=await p.initCheckout({fetchClientSecret:()=>Promise.resolve(l.clientSecret)}),m=await d.confirm({redirect:"if_required",paymentMethod:a.id});if("error"===m.type){if((0,y.u)("BillingBuyMoreCreditsError",{errorMsg:m.error.message,errorCode:m.error.code||""}),"An error has occurred confirming the Checkout Session."===m.error.message){let t=await eM({amount:e.toString(),returnUrl:window.location.href});if(t.ok){window.location.href=t.value.providerDetails.clientUrl;return}}throw Error(m.error.message)}await eI({intentId:i.id}),null==t||t(),(0,s.zU)()};return!i||d?null:(0,n.jsx)(eq,{paymentMethod:null==m?void 0:m.current.paymentMethod,submit:x,onCancel:a,canBuyCredits:!c,isPaymentMethodLoading:h,shouldInvoice:u})}function eq(e){let{paymentMethod:t,submit:a,onCancel:r,canBuyCredits:d,isPaymentMethodLoading:u,shouldInvoice:m}=e,{user:h}=(0,eD.k6)(),[p,x]=(0,l.useState)(!1),[f,g]=(0,l.useState)("100"),[v,j]=(0,l.useState)(!1),[b,w]=(0,l.useState)(null),N=(0,l.useRef)(null),[k,C]=(0,l.useState)(null),[S,M]=(0,l.useState)(u);(0,l.useEffect)(()=>{v&&N.current&&setTimeout(()=>{var e;null==(e=N.current)||e.focus()},50)},[v]);let I=(0,eA.k)({paymentMethod:t,noPrefix:!0,billingDetails:h?{name:h.name,email:h.email}:void 0});(0,l.useEffect)(()=>{!u&&S&&("add-new"===I.status&&I.useExisting&&I.useExisting(),M(!1))},[I,u,S]),(0,l.useEffect)(()=>{C(null)},[I.status]);let A=()=>{if("add-new"===I.status&&I.useExisting)return void I.useExisting();null==r||r(),(0,s.zU)()},D=(0,l.useRef)(null),L="submitting"===I.status||p,z=async()=>{let e=f;f.includes(".")?1===f.split(".")[1].length&&(e="".concat(f,"0")):e="".concat(f,".00");let n=Number.parseFloat(e);if(isNaN(n)||n<10)return void w("Minimum amount is $10");if(n>5e3)return void w("Maximum amount is $5,000");try{if(x(!0),d&&!m){let e=t;if("add-new"===I.status){let t=await I.submit();if(!t)return void x(!1);e=t}else if(e){let t=await eT({paymentMethodId:e.id});t.ok||(0,y.u)("BillingFixPaymentMethodError",{errorMsg:t.error.message,errorCode:t.error.code||""})}if(!e){C("No payment method selected"),x(!1);return}try{await a(n,e)}catch(e){C(e instanceof Error?e.message:"An error occurred while processing your request")}finally{x(!1)}}else await a(n)}catch(e){if(C("An error occurred while processing your request"),"object"==typeof e&&null!==e&&"type"in e){let{type:t,code:a,decline_code:n,param:s,doc_url:r}=e;(0,y.u)("BillingNewPaymentMethodStripeError",{type:t,code:a,declineCode:n,param:s,docUrl:r})}}finally{x(!1)}};return(0,ek.ML)("keydown",e=>{"Escape"===e.key&&A(),"Enter"===e.key&&z()},D),(0,n.jsxs)(c._,{type:"buyMoreCredits",className:"h-auto max-h-[calc(100svh-theme(space.8))] overflow-auto",children:[(0,n.jsx)(i.ModalContent,{className:"md:p-0",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"md:p-6",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4 text-center",children:[(0,n.jsx)(i.ModalTitle,{children:d?"Buy More Credits":"Request More Credits"}),(0,n.jsx)("p",{className:"text-label-14 text-pretty text-gray-500",children:d?(0,n.jsxs)(n.Fragment,{children:["Adding additional credits you to pay for v0 usage beyond your monthly credit limit."," ",(0,n.jsx)("strong",{children:"Additional credits expire 1 year after purchase."})]}):(0,n.jsx)("span",{className:"p-6",children:"Send a request to team owners to purchase more credits to keep chatting with v0 outside of your monthly limits."})})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center gap-1 pb-4 pt-6",children:[(0,n.jsx)(eU._r,{renderKey:"".concat(v),exit:{y:0,scale:.98},enter:{y:0,scale:1.02},duration:.2,delay:.1,children:(0,n.jsx)("div",{className:(0,eV.cn)("flex h-[84px] items-center justify-center"),onClick:()=>{j(!0)},children:v?(0,n.jsx)(eR.U,{className:"text-heading-56 w-full text-center",initialValue:f,onChange:e=>{g(e),w(null)},min:10,max:5e3,currency:"USD",ref:N}):(0,n.jsx)("div",{className:"flex w-full items-center justify-center",children:(0,n.jsx)(eF.Ay,{className:"text-heading-56",value:""===f?10:parseFloat(f),format:{style:"currency",currency:"USD"}})})})}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[eO.map(e=>(0,n.jsxs)(o.$,{variant:"secondary",size:"sm",onClick:()=>{g(e.toString()),j(!1),w(null)},children:["$",e]},e)),(0,n.jsx)(o.$,{variant:"secondary",size:"sm",onClick:()=>{j(!0)},children:"Custom"})]})]})]}),d&&!m?(0,n.jsx)("div",{className:"grid h-fit border-y border-gray-200 bg-white p-3 py-4",ref:D,children:S?(0,n.jsx)(e_.E,{className:"h-[54px] w-full"}):I.form}):null,(0,n.jsx)(eU._r,{children:k||b?(0,n.jsxs)("div",{className:"text-label-13 flex gap-2 pl-3 pt-3 text-red-500",children:[(0,n.jsx)(eP.V,{}),k||b]}):null})]})}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{size:"sm",type:"button",variant:"secondary",onClick:A,disabled:L,children:"Cancel"}),(0,n.jsx)(eE.x,{size:"sm",type:"button",onClick:z,disabled:L,pending:L,children:d?"Confirm and Pay":"Send Request"})]})]})}let eW=(0,N.createServerReference)("4022b8bb770d5678baa281803af717b29f4115f285",N.callServer,void 0,N.findSourceMapURL,"unsubscribeAction");var eG=a(11379),eZ=a(64308),eY=a(10132),eK=a(51876),eJ=a(19002),eQ=a(45462),eX=a(75894),e0=a(59968),e1=a(69894),e5=a(52356),e2=a(65156),e3=a(81966),e6=a(93929),e7=a(74702);let e9=(0,N.createServerReference)("40265736923da79b98de4646d0777a914b02268dba",N.callServer,void 0,N.findSourceMapURL,"cancelTeam");var e4=a(40445),e8=a(3576);let te=[{text:"Too expensive",code:"expensive",icon:eG.A},{text:"Not enough variety",code:"variety",icon:eZ.A},{text:"Complicated to use",code:"complicated",icon:eY.A},{text:"Not my stack",code:"stack",icon:eK.A},{text:"Needs more components",code:"needs-components",icon:eJ.A},{text:"Output wasn't good",code:"output",icon:eQ.A},{text:"Other",code:"other",icon:eX.A}],tt=[{text:"Just wanted 1 month",code:"one-month",icon:e0.A},...te];function ta(e){let{currentPlan:t,onPlanCancelled:a,currentPlanPricingInfo:r,isOnPersonalAccount:d,updatePlanInfo:u}=e,[h,p]=(0,l.useState)("confirm"),x=(0,e7.L)(),{activeScope:f}=(0,eD.k6)(),[g,j]=(0,l.useState)(),b=e=>{e||setTimeout(()=>{p("confirm")},500),e||(0,s.zU)()},y=(0,C.useRouter)(),w=async()=>{let e=x.values.join("\n")+(g?"\n Free-form reason: ".concat(g):"");if(d){let t=await eW({reason:e});t.ok?(p("cancelled"),null==a||a(t.value)):("no_subscription"===t.error.code&&y.refresh(),m.o.error((0,n.jsx)(e2.K,{code:t.error.code,variant:"unstyled"}),{duration:5e3}),b(!1)),await u()}else{if(!f)throw Error("No active scope found");let e=(0,e4.W)(f)?null:f;if(!e)throw Error("No active team scope found");let t=await e9(e);await u(),t.ok?p("cancelled"):(m.o.error((0,n.jsx)(e2.K,{code:t.error.code,variant:"unstyled"}),{duration:5e3}),b(!1))}},N=(0,l.useMemo)(()=>"cancelled"===h?(0,n.jsxs)(i.ModalDescription,{className:"px-6 text-sm",children:[(0,n.jsxs)("span",{children:["Your increased limits remain active until the end of this calendar month's billing cycle,"," "]}),t.billingPeriodEndDate?(0,n.jsx)("span",{className:"font-medium text-black",children:(0,eV.sL)(t.billingPeriodEndDate)}):null,(0,n.jsx)("span",{children:". Following this, you'll be on our FREE plan. Enjoy the continued access!"})]}):(0,n.jsxs)("div",{children:[(0,n.jsxs)(i.ModalDescription,{className:"px-6 text-sm",children:[(0,n.jsxs)("span",{children:["Your plan and increased limits will remain active until the end of your current billing period,"," "]}),t.billingPeriodEndDate?(0,n.jsx)("span",{className:"font-medium text-black",children:(0,eV.sL)(t.billingPeriodEndDate)}):null,(0,n.jsx)("span",{children:"."})]}),(0,n.jsx)("div",{className:"px-6 text-sm",children:t.billingPeriodStartDate?(0,n.jsx)(ts,{freeformReason:g,planStartDate:new Date(t.billingPeriodStartDate).toISOString(),reasons:x,setFreeformReason:j}):null})]}),[t.billingPeriodEndDate,t.billingPeriodStartDate,g,x,h]);return(0,n.jsxs)(c._,{type:"cancelPlan",onOpenChange:b,forceOpen:"cancelled"===h,children:["confirm"===h?(0,n.jsxs)("form",{action:w,className:"grid gap-6",children:[(0,n.jsxs)(i.ModalHeader,{className:"flex flex-col justify-center gap-4 !pb-0",children:[(0,n.jsx)(i.ModalTitle,{className:"w-full text-left",children:"Are you sure you want to cancel?"}),(0,n.jsx)("div",{className:"border-border flex w-full justify-between rounded-lg border p-4",children:(0,n.jsxs)("span",{children:[(0,n.jsxs)("span",{className:"text-sm font-medium text-black",children:[r.name," Plan"]}),(0,n.jsxs)("span",{children:[" ","- ",(0,v.g7)(r),"/month"]})]})})]}),(0,n.jsx)(i.ModalContent,{className:(0,X.cn)("gap-2",{"p-0":"confirm"===h}),children:N}),(0,n.jsx)(i.ModalFooter,{className:"flex flex-col rounded-b-[12px] p-4",children:(0,n.jsxs)("div",{className:"flex w-full justify-between",children:[(0,n.jsx)(tr,{asChild:!0,onClick:()=>(0,s.zU)(),type:"button",children:(0,n.jsx)(o.$,{className:"gap-2",variant:"secondary",children:"Cancel"})}),(0,n.jsx)(tn,{})]})})]}):null,"cancelled"===h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.ModalHeader,{children:(0,n.jsxs)(i.ModalTitle,{className:"flex flex-col items-center",children:[(0,n.jsx)(e1.A,{className:"rounded-full bg-emerald-300 p-1 text-white",size:32}),(0,n.jsx)("span",{children:"Cancellation Confirmed"})]})}),(0,n.jsx)(i.ModalContent,{children:N}),(0,n.jsx)(i.ModalFooter,{children:(0,n.jsx)(o.$,{className:"w-full justify-center",onClick:()=>(0,s.zU)(),type:"button",children:"Continue"})})]}):null]})}function tn(){let{pending:e}=(0,e5.useFormStatus)();return(0,n.jsx)(eE.x,{disabled:e,pending:e,type:"submit",variant:"destructive",children:"Confirm Cancellation"})}function ts(e){let{planStartDate:t,freeformReason:a,setFreeformReason:s,reasons:r}=e,l=t&&(0,eV.wU)(t);return(0,n.jsxs)("div",{className:"mt-4 flex flex-col gap-4",children:[(0,n.jsx)(e3.Separator,{}),(0,n.jsx)("span",{className:"text-sm",children:"We'd love to know why you're cancelling. Select all that apply."}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2",children:(l?tt:te).map(e=>{let{text:t,code:a,icon:s}=e;return(0,n.jsx)(e6.a,{Icon:s,onClick:()=>r.toggle(a),selected:r.has(a),children:t},a)})}),(0,n.jsx)(em.T,{onChange:e=>s(e.target.value),placeholder:"Share with us how we can improve",value:a})]})}let tr=(0,l.forwardRef)((e,t)=>{let{asChild:a,disabled:s,...r}=e,l=a?e8.DX:o.$,{pending:i}=(0,e5.useFormStatus)();return(0,n.jsx)(l,{...r,disabled:s||i,ref:t})});tr.displayName="FormButton";var tl=a(17253),ti=a(76640),to=a(62619),tc=a(18858),td=a(86943),tu=a(17e3);let tm=(0,N.createServerReference)("7fe232f1d1b51100b5682072d071df04cd8d190ec1",N.callServer,void 0,N.findSourceMapURL,"detectUserVercelUsage"),th=(0,N.createServerReference)("7f7a3e897aab1d37a07e6bf916b8b36b5ab5c2e0a1",N.callServer,void 0,N.findSourceMapURL,"updateTeamDetails");var tp=a(6902),tx=a(99339),tf=a(66418),tg=a(14187),tv=a(37707);let tj=e=>((null==e?void 0:e.balance.remaining)||0)+((null==e?void 0:e.onDemand.balance)||0),tb={"v0-platinum":{bullets:[]},"v0-level0":{bullets:["$5 of usage credit per month","Deploy to Vercel","Create up to 200 projects"]},"v0-level3":{bullets:["$20 of usage credit per month","Pay for additional credits outside your monthly limits","Unlimited projects"]},"v0-team":{bullets:["$30 of usage credit per user per month","Centralized billing on Vercel","Purchased credits shared across your team"]},"v0-enterprise":{bullets:["Custom credit limits","Data isolation and training opt-out by default","Dedicated Customer Support"]}},ty={"v0-level0":{label:"Free",title:"For getting started.",bullets:["Generate content with v0","Share and publish chats","Up to 200 projects","Deploy apps to Vercel"]},"v0-level3":{label:"Premium",title:"For more messages.",bullets:["Everything in Free","10-20x more messages than Free","5x higher attachment size limit","Unlimited projects","Import from Figma"]},"v0-platinum":{label:"Ultra",title:"For power users.",bullets:["Everything in Premium","30-50x more messages than Free","Early access to new features"]},"v0-team":{label:"Team",title:"For collaborative teams.",bullets:["Everything in Premium","20-30x more messages than Free","Centralized Billing on vercel.com","Share chats, Blocks and projects with your team"]},"v0-enterprise":{label:"Enterprise",title:"For larger companies.",bullets:["Everything in Team","30-50x more messages than Free","Training opt-out by default","SAML SSO","Priority access for better performance and no queues","Dedicated customer support"]}};function tw(e){let{planSlug:t}=e,[a]=(0,tc.d)(),r=a&&a.remaining<=0,{activeScope:d,scopes:u,refreshScopes:h,isActiveScopeReady:p}=(0,eD.k6)(),[x,f]=(0,l.useState)("plans"),[v,j]=(0,l.useState)(void 0),w=(0,l.useMemo)(()=>null==u?void 0:u.find(e=>e.id===v),[u,v]),[N,k]=(0,l.useState)(null==w?void 0:w.avatar),M=(0,l.useRef)(null),{setPaymentDialogPlan:I}=(0,to.C)(),[D,L]=(0,l.useTransition)(),z=(0,C.useRouter)(),{planInfo:E,planSlug:P}=(0,g.N)(!0,null==d?void 0:d.id,!1),{planInfo:T,isLoading:F}=(0,tl.z)(),R=(0,l.useMemo)(()=>{var e;return"v0-team"===P?null==E||null==(e=E.plans)?void 0:e.filter(e=>"v0-team"===e.slug||"v0-enterprise"===e.slug):null==E?void 0:E.plans},[P,E]),[U,V]=(0,l.useState)(t),{tbb:B}=(0,tv.D)(),_=B?tj(T):0,O=(0,l.useMemo)(()=>{let e=B&&_<=td.zB;return"plans"===x?r?B?"You are out of monthly credits":"Message Limit Reached":B?e?"You are out of credits":"Explore More Plans":"Upgrade Plan":"Confirm your Team's Details"},[B,_,x,r]),H=(0,l.useMemo)(()=>{if("plans"===x){if(void 0===a&&!B)return(0,n.jsx)(e_.E,{className:"h-4 w-full"});let e=[];if(P){let t=td.Md[P],a=U?td.Md[U]:void 0;if(B)return(0,n.jsxs)(i.ModalDescription,{children:["You are currently on the v0 ",t," plan. Upgrade or start a new plan for monthly credit limits."]});r?(e.push("You have reached the message limit on the v0 ".concat(t," plan.")),"v0-team"===U||"v0-enterprise"===U?e.push("Start a v0 ".concat(a," plan for higher message limits.")):e.push("Upgrade ".concat(a?"to v0 ".concat(a," "):"","for higher message limits."))):e.push("You're currently on the v0 ".concat(t," plan."))}return(0,n.jsx)(i.ModalDescription,{children:e.map((e,t)=>(0,n.jsx)("p",{children:e},t))})}return"team-details"===x?(0,n.jsx)(i.ModalDescription,{children:"Edit your Team's avatar and name."}):null},[x,B,a,P,r,U]),$=(0,l.useCallback)(e=>{I(e),(0,s.zU)()},[I]),q=(0,l.useCallback)(e=>{L(async()=>{var t;if(!v)return;let a=e.get("team-name");if(!a)return void m.o.error("Team name is required");let n=e.get("team-avatar"),r=await (t=n,new Promise(e=>{let a=new FileReader;a.addEventListener("load",t=>{let{target:a}=t;(null==a?void 0:a.result)instanceof ArrayBuffer&&crypto.subtle.digest("SHA-1",a.result).then(t=>{e(function(e){let t=[],a=new DataView(e);for(let e=0;e<a.byteLength;e+=4){let n=a.getUint32(e).toString(16),s="00000000",r=(s+n).slice(-s.length);t.push(r)}return t.join("")}(t))}).catch(e=>console.error(e))}),a.readAsArrayBuffer(t)}));!0===await th({teamId:v,name:a,avatar:n,avatarSha:r})?(h(),m.o.success("Team details configured"),k(void 0),f("plans"),z.push("/chat/upgrade?teamId=".concat(v,"&premium=").concat("v0-level3"===P)),j(void 0),(0,s.zU)()):m.o.error("Failed to update team details. Please try again.")})},[v,P,h,z]),W=(0,l.useCallback)(()=>{if(U&&(0,y.u)("ClickUpgradeModalButton",{targetPlan:U}),"plans"===x&&(("v0-level3"===U||"v0-platinum"===U)&&$(U),"v0-team"===U&&L(async()=>{let e=await tm();if("error"in e){let t=Error(e.error);(0,A.z)(t)||m.o.error("Failed to start team plan. Please try again.")}else{let{type:t,recommendedTeamId:a}=e;a&&z.prefetch("/chat/upgrade?teamId=".concat(a,"&premium=").concat("v0-level3"===P?"1":"0")),"new"===t?(j(a),f("team-details")):(z.push("/chat/upgrade?teamId=".concat(a,"&premium=").concat("v0-level3"===P?"1":"0")),(0,s.zU)())}})),"team-details"===x){var e;null==(e=M.current)||e.requestSubmit()}},[x,$,P,z,U]),G=(0,l.useCallback)(e=>{if(e.size>=1048576)return void m.o.error("File size is too large. Please upload a file smaller than 1MB.");k(URL.createObjectURL(e))},[k]);return((0,l.useEffect)(()=>{if(t)return V(t);V(tC(R,P))},[R,P,t]),!R||!p||B&&F)?null:(0,n.jsxs)(c._,{type:"upgradePlan",children:[(0,n.jsxs)(i.ModalHeader,{children:[(0,n.jsx)(i.ModalTitle,{children:O}),H]}),(0,n.jsxs)(i.ModalContent,{className:"is-mobile:items-center flex flex-col gap-3 overflow-hidden","data-testid":"upgrade-modal-content",children:["plans"===x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tN,{plans:R,selectedPlan:U,setSelectedPlan:e=>V(e),children:B?(0,n.jsx)("div",{className:"mt-1 flex flex-col",children:(0,n.jsx)(tS,{currentStep:x,isPending:D,onClick:W,selectedPlan:U,currentPlan:P})}):null}),(0,n.jsxs)("p",{className:"flex gap-1 text-center text-sm text-gray-500",children:["Compare plans and options on our",(0,n.jsxs)(b(),{className:"flex items-center gap-x-1 text-blue-600",href:"/pricing",onClick:()=>(0,s.zU)(),children:["pricing page ",(0,n.jsx)(ti.A,{className:"size-3"})]}),"."]}),(0,n.jsx)(eU._r,{renderKey:U,children:B||!U||["v0-level0","v0-team","v0-enterprise"].includes(U)||P===U?null:(0,n.jsxs)("div",{className:"rounded-lg bg-blue-100 p-2 pl-3 text-sm text-blue-800",children:["v0 is a Vercel product, but has separate plans and pricing. Your"," ",(0,n.jsxs)("span",{className:"font-medium",children:["v0 ",ty[U].label]})," ","subscription is billed independently of the"," ",(0,n.jsx)(b(),{className:"inline-flex items-center gap-x-1 underline",href:"https://vercel.com/pricing",target:"_blank",children:"Vercel plans"})," ","and is non-refundable."]})})]}):null,"team-details"===x?(0,n.jsxs)("form",{action:q,className:"flex flex-col gap-6",ref:M,children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[N?(0,n.jsx)(tx.Avatar,{rounded:!0,className:"size-20",children:(0,n.jsx)(tx.AvatarImage,{alt:"Uploaded team avatar",className:"aspect-auto",src:N,title:"Uploaded team avatar"})},"uploaded-avatar-image"):(0,n.jsx)(tx.AvatarUser,{rounded:!0,className:"size-20",teamId:null==w?void 0:w.id}),(0,n.jsx)(tM,{uploading:D,onChange:G})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(tp.Label,{htmlFor:"team-name",children:"Team Name"}),(0,n.jsx)(S.p,{id:"team-name",name:"team-name",required:!0,maxLength:256,minLength:1})]})]}):null]}),B?null:(0,n.jsxs)(i.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:[(0,n.jsx)(o.$,{onClick:()=>{"team-details"===x?f("plans"):(0,s.zU)()},size:"sm",type:"button",variant:"secondary",children:"team-details"===x?"Back":"Cancel"}),(0,n.jsx)(tS,{currentStep:x,isPending:D,onClick:W,selectedPlan:U,currentPlan:P})]})]})}let tN=e=>{let{plans:t,selectedPlan:a,setSelectedPlan:s,children:r}=e,{tbb:l}=(0,tv.D)(),i=(null==t?void 0:t.filter(e=>"v0-platinum"!==e.slug))||[],o=l?tb:ty;return(0,n.jsxs)(tu.Tabs,{className:"flex w-full flex-col gap-4",onValueChange:s,value:l&&"v0-platinum"===a?"v0-level3":a,children:[(0,n.jsx)(tu.TabsList,{className:"grid-cols-".concat(i.length," grid h-fit"),children:i.map(e=>(0,n.jsx)(tu.TabsTrigger,{value:e.slug,children:e.name},e.slug))}),i.map(e=>(0,n.jsx)(tu.a,{value:e.slug,children:(0,n.jsxs)("div",{className:(0,X.cn)("bg-muted border-alpha-200 flex flex-col gap-4 rounded-sm border p-4 text-sm",{"h-72":!l}),children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("h1",{className:"text-base font-semibold",children:["v0 ",e.name]}),(0,n.jsx)(tk,{plan:e})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[!l&&e.slug in o?(0,n.jsx)("p",{className:"font-semibold",children:o[e.slug].title}):null,(0,n.jsx)("ul",{className:"flex flex-col gap-3",children:o[e.slug].bullets.map(e=>(0,n.jsxs)("li",{className:"flex items-center gap-2",children:[(0,n.jsx)(x.J,{size:20}),e]},e))})]}),r]})},e.slug))]})},tk=e=>{let{plan:t}=e,{tbb:a}=(0,tv.D)(),s="v0-enterprise"===t.slug,r="v0-team"===t.slug,l=s?void 0:(0,v.m9)(t);return a&&s?(0,n.jsx)("div",{className:"flex items-center gap-1 text-xl font-semibold",children:"Custom Pricing"}):s?null:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{className:"text-xl font-semibold",children:l}),(0,n.jsx)("span",{className:"align-text-bottom text-sm leading-7 text-gray-500",children:s?void 0:r?"/user/month":"/month"})]})},tC=(e,t)=>{if(!e||!t)return;let a=e.find(e=>e.slug===t),n=a?e.indexOf(a):0,s=e[n+1];return s?s.slug:void 0},tS=e=>{let{currentPlan:t,isPending:a,selectedPlan:s,onClick:r,currentStep:l}=e,{tbb:i}=(0,tv.D)(),c=(0,tg.fu)();if(!s)return null;if(s===t)return(0,n.jsx)(o.$,{disabled:!0,size:"sm",children:"Current Plan"});if("v0-level0"===s)return(0,n.jsx)(o.$,{className:"w-full md:w-auto",size:"sm",onClick:()=>(0,y.u)("ClickDowngradeModalButton",{targetPlan:"v0-level0"}),asChild:!0,type:"button",variant:"secondary",children:(0,n.jsx)(b(),{href:"/subscription?from=chat",children:"Downgrade Plan"})});if("v0-level3"===s&&"v0-platinum"===t)return(0,n.jsx)(o.$,{className:"w-full md:w-auto",size:"sm",onClick:()=>(0,y.u)("ClickDowngradeModalButton",{targetPlan:"v0-level3"}),asChild:!0,type:"button",variant:"secondary",children:(0,n.jsx)(b(),{href:"/subscription?from=chat",children:"Downgrade Plan"})});if("v0-enterprise"===s)return(0,n.jsx)(o.$,{onClick:()=>(0,y.u)("ClickUpgradeModalButton",{targetPlan:"v0-enterprise"}),className:"w-full md:w-auto",size:"sm",asChild:!0,type:"button",children:(0,n.jsx)(b(),{href:td.zz,children:"Contact Sales"})});if("v0-team"===s){let e=i?"Start a Team Plan":"Start a v0 ".concat(c[s].label," Plan");return(0,n.jsx)(o.$,{className:"w-full md:w-auto",disabled:a,onClick:r,size:"sm",type:"button",children:"plans"===l?e:"Continue to Payment"})}return(0,n.jsxs)(o.$,{disabled:t===s,onClick:r,size:"sm",children:["Upgrade to v0 ",c[s].label]})},tM=e=>{let{uploading:t,onChange:a}=e;return(0,n.jsx)(o.$,{asChild:!0,size:"sm",variant:"secondary",children:(0,n.jsxs)("label",{"data-id":"team-avatar-upload",htmlFor:"team-avatar",children:[(0,n.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:t,id:"team-avatar",name:"team-avatar",onChange:e=>{var t;e.preventDefault();let n=null==(t=e.target.files)?void 0:t[0];n&&a(n)},accept:"image/png,image/jpeg",type:"file"}),(0,n.jsx)(tf.b,{}),"Upload Photo"]})})};function tI(e){let{paymentMethod:t}=e,{user:a}=(0,eD.k6)(),s=(null==a?void 0:a.billingMode)==="test"?"test":"live",r=a?{name:a.name,email:a.email}:void 0;return(0,n.jsx)(ez.StripeProvider,{mode:s,children:(0,n.jsx)(tA,{paymentMethod:t,billingDetails:r})})}function tA(e){let{paymentMethod:t,billingDetails:a}=e,r=(0,eA.k)({paymentMethod:t,noPrefix:!0,billingDetails:a}),l=async()=>{if("add-new"===r.status&&await r.submit())return m.o.success("New Payment Method added."),(0,s.zU)()};return(0,n.jsxs)(c._,{type:"addPaymentMethod",children:[(0,n.jsx)(i.ModalHeader,{children:(0,n.jsx)(i.ModalTitle,{children:"Choose New Payment Method"})}),(0,n.jsx)(i.ModalContent,{children:r.form}),(0,n.jsxs)(i.ModalFooter,{children:[(0,n.jsx)(o.$,{type:"button",variant:"secondary",onClick:()=>{if("add-new"===r.status&&r.useExisting)return void r.useExisting();(0,s.zU)()},disabled:"submitting"===r.status,children:"add-new"===r.status&&t?"Back":"Cancel"}),(0,n.jsxs)(o.$,{type:"button",onClick:l,disabled:"add-new"!==r.status,children:["submitting"===r.status?(0,n.jsx)(M.X,{}):null,(0,n.jsx)("span",{children:"Add New Payment Method"})]})]})]})}function tD(){let e=(0,r.useAtomValue)((0,s.UY)().dialogOpen),t=(0,l.useMemo)(()=>{if(!e)return null;switch(e.type){case"createTeam":return(0,n.jsx)(d,{});case"requestAccess":return(0,n.jsx)(p,{...e.data});case"upgradeTeam":return(0,n.jsx)(w,{...e.data});case"deleteChat":return(0,n.jsx)(H,{...e.data});case"updateChatTitle":return(0,n.jsx)(B,{...e.data});case"shareChat":return(0,n.jsx)($.E,{...e.data});case"messageDownvote":return(0,n.jsx)(q.q,{...e.data});case"flagBlock":return(0,n.jsx)(W.k,{...e.data});case"shareBlock":return(0,n.jsx)(el,{...e.data});case"templateEdit":return(0,n.jsx)(eo.d,{...e.data});case"feedback":return(0,n.jsx)(eb,{...e.data});case"connectRepo":return(0,n.jsx)(eN.N,{...e.data});case"buyMoreCredits":return(0,n.jsx)(eH,{...e.data});case"cancelPlan":return(0,n.jsx)(ta,{...e.data});case"upgradePlan":return(0,n.jsx)(tw,{...e.data});case"addPaymentMethod":return(0,n.jsx)(tI,{...e.data});default:return null}},[e]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tz,{}),(0,n.jsx)(l.Suspense,{fallback:null,children:t})]})}function tL(e,t,a){let n=new URLSearchParams(e);null===a?n.delete(t):n.set(t,a);let s="".concat(window.location.pathname).concat(n.toString()?"?":"").concat(n.toString());window.history.replaceState({},"",s)}function tz(){let e=(0,C.useSearchParams)(),t=(0,C.useRouter)(),a=e.get("premium")?"v0-level3":null,n=e.get("buyMore")&&"0"!==e.get("buyMore");return(0,l.useEffect)(()=>{a?((0,s.Dh)({type:"upgradePlan",data:{planSlug:a}}),tL(e,"premium",null)):n&&((0,s.Dh)({type:"buyMoreCredits",data:{onSuccess:()=>(0,l.startTransition)(t.refresh)}}),tL(e,"buyMore",null))},[a,t]),null}},25905:(e,t,a)=>{"use strict";a.d(t,{L:()=>c});var n=a(74118),s=a(25603),r=a(33571),l=a(70676);let i=(0,l.createServerReference)("4064ebfd20ce57e41d26bf22424f73f73e22b67c8c",l.callServer,void 0,l.findSourceMapURL,"updateBlockShareStatus");var o=a(13729);function c(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,s.Ay)(["blocks-shared",e]),l=(0,r.useCallback)(e=>{var a;return null!=(a=null==t?void 0:t.get(e))&&a},[t]);return{getBlockShared:l,setBlockShared:(0,r.useCallback)((e,n)=>{a(new Map(null==t?void 0:t.set(e,n)));try{i({blockId:e,shared:n})}catch(e){o.o.error("Failed to update block publish status")}},[t,a]),updateBlockInSharedMap:(0,r.useCallback)((e,n)=>{a(new Map(null==t?void 0:t.set(e,n)))},[t,a])}}},25951:(e,t,a)=>{"use strict";a.d(t,{LP:()=>p,M9:()=>o,OT:()=>x,Ok:()=>h,_t:()=>c,gS:()=>u,kL:()=>d,py:()=>m});var n=a(25603),s=a(33571),r=a(79168),l=a(86943),i=a(73655);function o(){let{data:e,mutate:t}=(0,n.Ay)("project:id");return{projectId:e,setProjectId:t}}function c(){let{data:e,mutate:t}=(0,n.Ay)("projects:for-user"),a=(0,s.useCallback)(e=>{t(t=>({selectedProjectId:e,projects:(null==t?void 0:t.projects)||[]})),r.A.set(l.PR,e||"",{expires:l.Cy})},[t]);return{projects:(null==e?void 0:e.projects)||[],selectedProjectId:(null==e?void 0:e.selectedProjectId)||null,setSelectedProjectId:a}}function d(e,t){let{projectId:a}=o(),s=e||a,{data:r,isLoading:l,mutate:i,error:c}=(0,n.Ay)(s?["project:instructions",s]:null,{shouldRetryOnError:!1,revalidateIfStale:!0,revalidateOnMount:!0,fallbackData:t||""});return{instructions:r||"",updateInstructions:i,isLoading:l,error:c}}function u(e){let{projectId:t}=o(),a=e||t,{data:s,isLoading:r,mutate:l,error:i}=(0,n.Ay)(a?["project:template",a]:null,async e=>{let[t,a]=e,n=await fetch("/chat/api/projects/community?projectId=".concat(a));if(!n.ok)throw Error("Failed to fetch community project");return(await n.json()).template},{shouldRetryOnError:!1,revalidateIfStale:!0,revalidateOnMount:!0,fallbackData:void 0,refreshInterval:e=>3e3*((null==e?void 0:e.category)===null||(null==e?void 0:e.templateVersion.description)===null||(null==e?void 0:e.templateVersion.imageUrl)===null)});return{data:s,mutate:l,isLoading:r,error:i}}function m(e){let{activeScopeSlug:t}=(0,i.k6)(),{projectId:a}=o(),r=e||a,{data:l,mutate:c,error:d,isValidating:u}=(0,n.Ay)(r?["project:sources",r]:null,async()=>{if(!r)throw Error("No project ID");let e=new URLSearchParams;e.set("projectId",r);let t=await fetch("/chat/api/projects/sources?".concat(e.toString()),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to load project sources");let a=await t.json();if(!a)throw Error("Failed to load project sources");return a},{revalidateIfStale:!0,revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:!1,refreshInterval:e=>500*(null!=e&&!!e.some(e=>"processing"===e.status&&!e.isOptimistic))}),m=!!d;(0,s.useEffect)(()=>{m&&console.error("Failed to load project sources:",d)},[m,d]);let h=(0,s.useCallback)(()=>{c()},[c]);return{sources:l||[],setSources:c,revalidateSources:h,isLoading:!l&&!d&&!!r&&!!t,isValidating:u}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{revalidateOnMount:!1},{data:a,isLoading:s,mutate:r,error:l}=(0,n.Ay)(e?["project:vercel-project",e]:null,async()=>{let t=await fetch("/chat/api/projects/vercel?projectId=".concat(e));return await t.json()},{revalidateOnFocus:!1,revalidateIfStale:!0,revalidateOnMount:t.revalidateOnMount});return{vercelProjectWithDashboard:a?{project:a.project,dashboardProject:a.dashboardProject,prodBlockInfo:a.prodBlockInfo}:null,envVars:null==a?void 0:a.envVars,isLoading:s,error:l,refetchVercelProject:r}}function p(){let{data:e}=(0,n.Ay)("project:can-make-project-updates");return e||!1}function x(){let{data:e,mutate:t}=(0,n.Ay)("project:name");return{projectName:e||"Untitled Project",updateProjectName:t}}},27194:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var n=a(25603);function s(){let{data:e,error:t,isLoading:a,mutate:s}=(0,n.Ay)("/chat/api/integrations/marketplace/storage",async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch storage stores");return t.json()},{revalidateOnReconnect:!0});return{stores:{data:{marketplaceStores:(null==e?void 0:e.marketplaceStores)||[],nativeStores:(null==e?void 0:e.nativeStores)||[]},isLoading:a,error:t||null,refetch:s},isLoading:a,error:t||null,refetch:async()=>{await Promise.all([s()])}}}},28488:(e,t,a)=>{"use strict";a.d(t,{o:()=>ta,r:()=>tn});var n=a(97667),s=a(33571),r=a(1222),l=a(25603),i=a(74118),o=a(14890),c=a(68481),d=a(28819);function u(e){let{loading:t,darken:a,children:s,className:r}=e;return(0,n.jsxs)("span",{"aria-hidden":!0,className:(0,d.cn)("relative size-6 items-center justify-center overflow-visible",r),children:[(0,n.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)(m,{className:(0,d.cn)("h-full min-w-[25px] -translate-x-px transition-all duration-500",a&&"darken",t?"opacity-100":"opacity-0")})}),(0,n.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:s||(0,n.jsx)(c.g,{className:(0,d.cn)("h-full min-w-[25px] -translate-x-px text-black transition-opacity duration-500",t?"opacity-0":"opacity-100")})})]})}function m(e){let{className:t}=e,a=(0,s.useId)();return(0,n.jsxs)("svg",{className:(0,d.cn)(t,"v0-loader"),fill:"none",height:"18",viewBox:"15.5 41.5 100 41",width:"40",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"v-clip-".concat(a),children:(0,n.jsx)("rect",{height:"98",width:"128",x:"0",y:"46"})})}),(0,n.jsxs)("g",{clipPath:"url(#v-clip-".concat(a,")"),children:[(0,n.jsx)("path",{className:"bg",d:"M 15 38 C 18.011 41.4115 41.0275 67.4845 48.5 77.3 c 5.9 6.8 5.8 6.7 5.8 -1.6 C 54.3 69.651 54.3 42.8741 54.3 42.8741"}),(0,n.jsx)("path",{className:"fg",d:"M 15 38 C 18.011 41.4115 41.0275 67.4845 48.5 77.3 c 5.9 6.8 5.8 6.7 5.8 -1.6 C 54.3 69.651 54.3 42.8741 54.3 42.8741",id:"v",pathLength:"1"})]}),(0,n.jsx)("path",{className:"bg",d:"M 102.9 48.5 L 75.7 75.2"}),(0,n.jsx)("path",{className:"fg",d:"M 102.9 48.5 L 75.7 75.2",id:"o-slash",pathLength:"1"}),(0,n.jsx)("path",{className:"bg",d:"M73.4653 41.7309L97.3029 41.7309C101.815 41.7309 109.905 46.2887 109.905 54.1283V77.1615"}),(0,n.jsx)("path",{className:"fg",d:"M73.4653 41.7309L97.3029 41.7309C101.815 41.7309 109.905 46.2887 109.905 54.1283V77.1615",id:"o-top",pathLength:"0.99"}),(0,n.jsx)("path",{className:"bg",d:"M104.996 81.8855L81.0314 81.8855C75.5619 81.8855 68.5885 76.5073 68.5885 69.1236L68.5885 46.2209"}),(0,n.jsx)("path",{className:"fg",d:"M104.996 81.8855L81.0314 81.8855C75.5619 81.8855 68.5885 76.5073 68.5885 69.1236L68.5885 46.2209",id:"o-bottom",pathLength:"0.99"})]})}var h=a(13729),p=a(19243),x=a(67006),f=a(84371),g=a(72524),v=a(66692),j=a(69264),b=a(1332),y=a(49119),w=a(27693),N=a(32136),k=a(8026),C=a(10037);function S(e){let{message:t}=e,a=(0,s.useRef)(null),r=(0,s.useRef)(null),{project:l}=(0,N.tZ)(),i=(0,w.k)(),o=(0,s.useMemo)(()=>JSON.stringify(t.content).includes("footnoteReference"),[t.content]);return"assistant"===t.role&&"context"in t&&t.context&&0!==t.context.length&&o?(0,n.jsxs)("div",{ref:a,children:[!t.streaming&&(0,n.jsxs)("div",{className:"grid gap-1.5",children:[(0,n.jsx)("p",{className:"select-none pl-px text-sm leading-none text-gray-500",children:i("messageCitations.title")}),(0,n.jsx)("div",{className:"no-scrollbar flex w-full -translate-x-1 gap-2 overflow-x-auto p-1 pb-3",children:t.context.map((e,t)=>{let a=new URL(e.url).hostname,s=e.url.includes("vercel-storage")&&void 0!==l;return"ui"===e.type?null:(0,n.jsx)(v.$,{asChild:!0,className:"group/citation flex h-auto w-[210px] flex-col items-start justify-start gap-1 whitespace-normal px-2 py-1.5 text-left text-sm",variant:"secondary",children:(0,n.jsxs)("a",{className:"min-w-0",href:e.url,ref:0===t?r:null,rel:"noopener noreferrer",target:"_blank",title:e.url,children:[(0,n.jsxs)("div",{className:"flex w-full items-center gap-1.5 font-medium",children:[s?(0,n.jsx)(k.h,{size:"xs",color:l.settings.color,icon:(0,C.KI)(l.settings.icon)}):(0,n.jsx)(b.o,{className:"shrink-0",knowledgeSource:a}),(0,n.jsx)("div",{className:"truncate",children:s?e.title:a}),(0,n.jsxs)("div",{className:"relative ml-auto flex size-4 shrink-0 items-center justify-center overflow-hidden rounded-full bg-gray-200 text-xs text-gray-500",children:[t+1,(0,n.jsx)("div",{className:"absolute inset-0 flex size-4 shrink-0 items-center justify-center bg-gray-200 text-gray-900 opacity-0 transition-all group-hover/citation:opacity-100 group-focus/citation:opacity-100 group-focus-visible/citation:opacity-100",children:(0,n.jsx)(y.m,{})})]})]}),(0,n.jsx)("div",{className:"w-full truncate break-all text-xs font-normal text-gray-500",children:l&&s?l.name:(0,n.jsxs)(n.Fragment,{children:[e.title,e.description&&(0,n.jsxs)(n.Fragment,{children:[" - ",e.description]})]})})]})},t)})})]}),(0,n.jsx)(j.Cy,{citations:t.context.filter(e=>!!e).map((e,a)=>({...e,knowledgeSource:new URL(e.url).hostname,index:a+1,messageId:t.id}))})]}):null}var M=a(49019),I=a(16979),A=a(71543);function D(e){let{actions:t,message:a,finishReason:s}=e,{user:r}=(0,A.J)(),l=function(e){let t=e.length;if(!t)return null;if(1===t){if(e.includes("delete-message"))return"Please delete your message and try again.";if(e.includes("edit-message"))return"Please edit your message and try again."}let a=2===e.length,n=a&&e.includes("new-chat")&&e.includes("delete-message"),s=a&&e.includes("edit-message")&&e.includes("delete-message"),r=a&&e.includes("delete-message")&&e.includes("retry");return n?"Please start a new chat or delete your message.":s?"Please edit or delete your message and try again.":r?"Please delete or retry your message.":"Please edit, retry or delete your message."}(t);return(0,n.jsxs)("div",{className:"flex h-[34px] flex-1 items-center gap-2 rounded-md bg-red-100 p-2 text-sm text-red-600",children:[(0,n.jsx)(I.V,{}),a," ",l,(null==r?void 0:r.isAdminMode)&&s?(0,n.jsxs)("p",{className:"font-bold",children:["[ADMIN_ONLY]: ",s]}):null]})}var L=a(36323),z=a(8599),E=a(34623),P=a(45738),T=a(12160);let F={"input-too-long":{message:"Your message or the text content of your attachment(s) exceeds the maximum length.",actions:["delete-message"]},"invalid-image":{message:"The image(s) attached could not be processed.",actions:["delete-message"]},"large-image":{message:"The image(s) attached exceed the maximum size.",actions:["delete-message"]},"too-many-attachments":{message:"You have reached the limit for total attachments in a single chat.",actions:["new-chat","delete-message"]},"content-filtering":{message:"The response was blocked by the content filtering policy.",actions:["delete-message","edit-message"]},"failed-to-process-image":{message:"Unable to process image.",actions:["delete-message","retry"]},"image-exceeds-dimensions":{message:"The image(s) attached exceed the maximum width and height allowed.",actions:["delete-message"]},overloaded:{message:"We are currently experiencing high traffic. Please try again in a few minutes.",actions:[]},default:{message:"Something went wrong.",actions:["retry","edit-message","delete-message"]}};var R=a(22237),U=a(42438),V=a(13263),B=a(18858),_=a(32198),O=a(31095),H=a(12507),$=a(39929);function q(e){let{messageId:t,chatId:a}=e,{activeForkKey:r}=(0,i.Pk)(),[l,o]=(0,s.useTransition)(),c=(0,s.useCallback)(()=>{o(async()=>{if(!a)return void h.o.error("Chat ID not found.");try{let e=null==r?void 0:r.indexOf(t);if(void 0===e||-1===e||!r)return void h.o.error("Message not found in the active fork.");let n=r.slice(0,e+1),s=await (0,_.B)({payload:{chatId:a,messageIds:n}});if("error"in s)throw Error(s.error);let l=new Blob([JSON.stringify(s.messages,null,2)],{type:"application/json"}),i=URL.createObjectURL(l),o=document.createElement("a");o.href=i,o.download="".concat(a,"-").concat(new Date().toISOString(),".json"),o.click(),URL.revokeObjectURL(i)}catch(e){(0,H.z)(e)||h.o.error("Something went wrong. Please try again.")}})},[r,a,t]);return a?(0,n.jsxs)($.DropdownMenuItem,{onClick:c,disabled:l,children:[(0,n.jsx)(O.f,{}),"Export Messages"]}):null}var W=a(37707),G=a(92095),Z=a(23423),Y=a(92597),K=a(43301),J=a(35501),Q=a.n(J),X=a(99886),ee=a(28963),et=a(7086),ea=a(65744),en=a(70676);let es=(0,en.createServerReference)("40256ff0b8adbbdda8ab11ff66e4da41fbf96ed635",en.callServer,void 0,en.findSourceMapURL,"getRawMessageContent");var er=a(80574),el=a(8689);function ei(){let{data:e,mutate:t}=(0,l.Ay)("showAdminRetryDialog",null,{fallbackData:null}),{user:a}=(0,A.J)();return{showAdminRetryDialog:(null==a?void 0:a.isAdminMode)?e:null,setAdminRetryDialog:t}}let eo=e=>{let{messageId:t}=e,{setAdminRetryDialog:a}=ei();return(0,n.jsxs)($.DropdownMenuItem,{onClick:()=>a(t),children:[(0,n.jsx)(X.w,{}),"Edit Response"]})},ec=e=>{let{submit:t}=e,{showAdminRetryDialog:a,setAdminRetryDialog:r}=ei(),[l,i]=(0,ea.Mj)("admin-retry-message",""),[o,c]=(0,s.useTransition)();return a?(0,n.jsxs)(ee.Modal,{open:!!a,onOpenChange:()=>r(null),children:[(0,n.jsx)(ee.ModalHeader,{children:(0,n.jsx)(ee.ModalTitle,{children:"Retry Message (AI Team Only)"})}),(0,n.jsxs)("form",{onSubmit:e=>{l&&a&&(e.preventDefault(),r(null),t({action:"retry",forceResponse:l,assistantMessageId:a}))},children:[(0,n.jsx)(ee.ModalContent,{children:(0,n.jsx)(et.T,{asChild:!0,children:(0,n.jsx)(el.o,{value:l,onChange:e=>i(e.target.value),placeholder:"Enter your messsage here...",minHeight:80,maxHeight:192})})}),(0,n.jsxs)(ee.ModalFooter,{className:"mt-4 flex w-full items-center justify-between",children:[(0,n.jsxs)(v.$,{type:"button",variant:"secondary",onClick:()=>{c(async()=>{try{if(!a)throw Error("No message id");let e=await es({payload:{messageId:a}});if("error"in e)throw Error(e.error);if(!e.rawContent)throw Error("No raw content saved in message");i(e.rawContent)}catch(e){if(e instanceof Error)return void h.o.error(e.message);h.o.error("An error occurred")}})},disabled:o,children:["Sync Raw Content",o?(0,n.jsx)(er.y,{}):null]}),(0,n.jsx)(v.$,{type:"submit",children:"Submit"})]})]})]}):null};var ed=a(95393),eu=a(16330);function em(e){let{text:t,isLoading:a,files:s,displayFiles:r}=e,l=(0,w.k)(),i=s?s.map(e=>({file:e,component:(0,n.jsxs)("div",{className:"flex items-center font-mono text-[13px]",children:[(0,n.jsx)("span",{className:"mr-2",children:""}),e]},e)})).map((e,t)=>{let{file:s,component:r}=e;return a?(0,n.jsx)(ed.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.3+.1*t,duration:.2},children:r},s):r}):null;return(0,n.jsx)(eu.p,{text:t||l("messages.loadingText"),forceOpen:r,isLoading:a,children:i})}var eh=a(70158),ep=a(58576),ex=a(73641),ef=a(37411);let eg=(0,en.createServerReference)("40b4ddd1814f42c3e99708b1d49557d642cb9a06ff",en.callServer,void 0,en.findSourceMapURL,"permanentlySaveMessageObservability"),ev=e=>{let{parentId:t,messageId:a}=e,r=(0,ex.x)(),[l,i]=(0,s.useTransition)();return(0,n.jsxs)($.DropdownMenuItem,{disabled:l,onClick:()=>{i(async()=>{try{let e=await eg({payload:{messageId:a}});if(!("success"in e))throw Error(e.error);let n="{\n  type: 'edit-message',\n  chatId: '".concat(r,"',\n  userMessageId: '").concat(t,"',\n  assistantMessageId: '").concat(a,"',\n  description: INSERT_DESCRIPTION_HERE,\n  accessWith: 'EVAL_TEAM',\n  scorer: output => {\n    return { passed: true }\n  },\n},\n");await navigator.clipboard.writeText(n),h.o.success("Copied eval, now paste to `packages/evals/lib/chat/data.ts`")}catch(e){if(e instanceof Error)return void h.o.error(e.message);h.o.error("An error occurred")}})},children:[l?(0,n.jsx)(er.y,{}):(0,n.jsx)(ef.c,{}),(0,n.jsx)("span",{children:"Create Eval"})]})};function ej(e){let{type:t,botMessage:a,setChatState:s,...r}=e,l=(0,w.k)(),{chatId:i,messageId:o,messageText:c,leafMessageId:d,userId:u,promptMessageId:m}=(0,f.q)({messageId:a.id}),{isLoading:g,canVote:j}=(0,G.q)();if(g||!j)return null;let b=async()=>{m&&o&&c&&d&&((0,p.u)("SubmitUpvote",{messageId:o,leafMessageId:d}),h.o.success(l("botMessage.successToast")),s(e=>({messages:e.messages.map(e=>"id"in e&&e.id===o?{...e,vote:"upvote"}:e)})),await (0,x.p)({feedback:"",reasons:[],chatId:i,messageId:o,leafMessageId:d,userId:u,type:"upvote",promptMessageId:m}))};return(0,n.jsx)(v.$,{"aria-label":l("botMessage.upvote"),disabled:"upvote"===a.vote,onClick:b,tooltip:l("botMessage.upvote"),type:t,...r,children:(0,n.jsx)(E.b,{})})}function eb(e){var t;let a,{message:r,endChildren:c,isLastMessage:m,isLoading:x,isStreaming:f,forkKeyOptions:j,submit:b,setChatState:y}=e,N=(0,w.k)(),k=(0,L.oQ)(),{chatId:C}=(0,i.xz)(),{user:I}=(0,A.J)(),{isCopied:E,copyToClipboard:_}=(0,U.j)({timeout:2e3}),[O]=(0,B.d)(),H=(null==O?void 0:O.remaining)===0,{isLoading:J,canVote:X}=(0,G.q)(),{cf:ee,scp:et}=(0,W.D)(),ea=!!(m&&null===r.finishReason&&r.createdAt&&r.createdAt.getTime()>Date.now()-6e5&&Array.isArray(r.content)&&r.content.length>0&&(null==(t=r.content[0][1])?void 0:t.length)===0),{data:en,isLoading:es}=(0,l.Ay)(ea?"/chat/api/chat/latest-message?chatId=".concat(C,"&messageId=").concat(r.id):null,e=>fetch(e,{method:"GET",cache:"no-store"}).then(e=>e.json()),{refreshInterval:2e3}),el=!es&&en&&ea,ei=(0,eh.useRouter)();(0,s.useEffect)(()=>{el&&en.isFinished&&ei.refresh()},[en,ei,k,el]);let ed="flex";((x||f)&&m||J)&&(ed=r.continuingMessageId||J?"invisible":"hidden");let eu=(0,s.useId)().replace(/:/g,"");if("added-integration"===r.type&&!et||x&&m)return null;let{isLlmError:ex,errorCategory:ef="default"}=(0,T.c)(r),{message:eg,actions:eb}=F[ef],ey=eb.includes("retry"),ew="reverted-block"===r.type,eN="added-integration"===r.type,ek=!f&&!x&&Array.isArray(r.content)&&0===r.content.length,eC=ex||r.content.some(e=>!!Array.isArray(e)&&0===e[0])||ek,eS=ex||ek,eM=(0,n.jsxs)("div",{className:(0,d.cn)("flex items-center gap-1",ed),children:[ex?null:(0,n.jsx)(v.$,{className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",size:"xs",onClick:async()=>{try{var e;let t=null==(e=document.getElementById(eu))?void 0:e.querySelector("[data-seg=root]");if(!t)throw Error("Root container not found");let a=new DocumentFragment;t.childNodes.forEach(e=>{a.appendChild(e.cloneNode(!0))});let n=(0,g.l)(a,t,!1,!1,!1);await _(n),h.o.success(N("botMessage.copiedToClipboard"))}catch(e){console.error(e),h.o.error("Failed to copy message to clipboard")}},tooltip:N("botMessage.copy"),variant:"ghost",children:(0,n.jsx)(V.U,{isCopied:E})}),"message"!==r.type&&"added-integration"!==r.type&&r.type?null:(0,n.jsxs)(n.Fragment,{children:[!ex||ey?(0,n.jsx)(v.$,{className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",disabled:x||H,"aria-label":"Retry Message",onClick:async()=>{await Promise.all([b({action:"retry",assistantMessageId:r.id,revalidateVercelEnvAndIntegrations:!0}),(0,p.u)("SubmitRetryBotMessage",{messageId:r.id})])},size:"xs",tooltip:"".concat(N("botMessage.retry")).concat(H?" - ".concat(N("botMessage.limitReached")):""),variant:"ghost",children:(0,n.jsx)(z.j,{})}):null,X?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ej,{botMessage:r,className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",size:"xs",variant:"ghost",setChatState:y}),(0,n.jsx)(ep.H,{className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",messageId:r.id,tooltip:N("botMessage.downvote"),variant:"message"})]}):null,(0,n.jsx)(R.I,{forkKeyOptions:j,message:r}),ee||(null==I?void 0:I.isAdminMode)?(0,n.jsx)("div",{className:"ml-1 mr-1.5 h-4 w-px shrink-0 bg-gray-300"}):null,ee&&!(null==I?void 0:I.isAdminMode)&&(0,n.jsx)(v.$,{className:(0,d.cn)("ml-1 gap-1 border-gray-100 bg-gray-100 hover:border-gray-200 hover:bg-gray-200 focus:border-gray-200 focus:bg-gray-200 focus-visible:border-gray-200 focus-visible:bg-gray-200 has-[>svg]:pl-1.5 has-[>svg]:pr-2 [&>svg]:size-3.5"),size:"xs",variant:"secondary",tooltip:{side:"top",content:"Submit Corrections (Vercelian only)"},asChild:!0,children:(0,n.jsxs)(Q(),{href:"/chat/internal/correct/".concat(C,"/new"),children:[(0,n.jsx)(Y.S,{}),(0,n.jsx)("span",{className:"hidden sm:inline-block",children:"Correct"})]})})]}),(null==I?void 0:I.isAdminMode)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ec,{submit:b}),(0,n.jsxs)($.DropdownMenu,{children:[(0,n.jsx)($.DropdownMenuTrigger,{asChild:!0,className:"max-w-[200px]",children:(0,n.jsxs)(v.$,{className:"border-gray-100 bg-gray-100 hover:border-gray-200 hover:bg-gray-200 focus:border-gray-200 focus:bg-gray-200 focus-visible:border-gray-200 focus-visible:bg-gray-200 has-[>svg]:pl-1.5 has-[>svg]:pr-2 [&>svg]:size-3.5",size:"xs",tooltip:"View Internal (AI Team only)",variant:"secondary",children:[(0,n.jsx)(Z.C,{})," Admin"]})}),(0,n.jsx)($.DropdownMenuContent,{align:"start",side:"bottom",children:(0,n.jsxs)($.DropdownMenuGroup,{children:[(0,n.jsx)($.DropdownMenuItem,{asChild:!0,children:(0,n.jsxs)(Q(),{href:"/chat/internal/correct/".concat(C,"/new"),children:[(0,n.jsx)(Y.S,{}),"Submit Correction"]})}),(0,n.jsx)(P.WZ,{messageId:r.id}),(0,n.jsx)(P.QP,{messageId:r.id,chatId:C}),(0,n.jsx)(q,{messageId:r.id,chatId:C}),r.parentId?(0,n.jsx)(ev,{parentId:r.parentId,messageId:r.id}):null,(0,n.jsx)(eo,{messageId:r.id})]})})]})]}):null]});if(ew)return(0,n.jsx)("div",{id:eu,children:(0,n.jsx)(o.E,{avatar:(0,n.jsx)(u,{darken:eC,loading:m&&(!eC||f),className:"text-gray-500",children:(0,n.jsx)(K.Q,{})}),id:r.id,children:(0,n.jsxs)("div",{className:"prose-p:mb-2 prose-p:text-gray-500 flex min-w-0 flex-1 flex-col items-stretch gap-4",children:[(0,n.jsx)(M.P,{message:r,isLastMessage:m}),c]})})});if(m&&(f||x)&&!eC)a=(0,n.jsx)(em,{displayFiles:r.relevantFiles&&r.relevantFiles.length>0,files:r.relevantFiles,text:eN?"Thinking...":r.loadingText,isLoading:!0});else{let e=null;r.grepQueries&&r.grepQueries.length?e="Searched for ".concat(r.grepQueries.map(e=>'"'.concat(e,'"')).join(", ")):r.relevantFiles&&r.relevantFiles.length>0&&(e="Added context (".concat(r.relevantFiles.length," file").concat(1===r.relevantFiles.length?"":"s",")"));let t=e?(0,n.jsx)(em,{files:r.relevantFiles,text:e}):null;a=(0,n.jsxs)(n.Fragment,{children:[t,(0,n.jsx)(M.P,{message:r,isLastMessage:m})]})}return(0,n.jsx)("div",{id:eu,className:(0,d.cn)(f&&m&&"streaming-block"),children:(0,n.jsxs)(o.E,{avatar:eN?(0,n.jsx)("span",{className:"size-6"}):(0,n.jsx)(u,{darken:eC,loading:m&&(!eC||f)}),id:r.id,children:[el?(0,n.jsxs)("div",{className:(0,d.cn)("border-border/40 bg-card mx-1 mb-2 flex items-center gap-2 rounded-md border p-2 shadow-sm","animate-in fade-in-0 transition-all duration-200"),children:[(0,n.jsx)(er.y,{className:"text-muted-foreground h-4 w-4"}),(0,n.jsxs)("span",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"text-muted-foreground text-sm font-medium ",children:"Loading response..."}),(0,n.jsx)("span",{className:"text-muted-foreground/80 w-full text-xs",children:"It will appear here when complete"})]})]}):null,(0,n.jsxs)("div",{className:(0,d.cn)("flex min-w-0 flex-1 flex-col items-stretch gap-4",ex&&"gap-4"),children:[a,eS?(0,n.jsx)(D,{actions:eb,finishReason:r.finishReason,message:eg}):null,c,el?null:eM,(0,n.jsx)(S,{message:r}),(null==I?void 0:I.isAdminMode)?(0,n.jsxs)("div",{className:"mt-1 flex w-fit flex-wrap gap-3 whitespace-pre-wrap font-mono text-[10px] text-gray-600",children:[r.usage?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"text-gray-500",children:"Completion:"}),r.usage.completionTokens]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"text-gray-500",children:"Prompt:"}),r.usage.promptTokens]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"text-gray-500",children:"Total:"}),r.usage.totalTokens]})]}):null,r.estimatedUsage?(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"text-gray-500",children:"Estimation:"}),r.estimatedUsage]}):null,r.modelId?(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{className:"text-gray-500",children:"Model:"}),r.modelId,(0,n.jsx)("span",{children:r.thinkingMode?"-".concat(r.thinkingMode):""})]}):null]}):null]})]})})}var ey=a(76603);let ew=s.memo(function(e){let{message:t,endChildren:a,isLastMessage:s,isLoading:r,isStreaming:l,animateUser:i,forkKeyOptions:o,submit:c,setChatState:d}=e;return"user"===t.role?(0,n.jsx)(ey.RG,{animateUser:s&&i,forkKeyOptions:o,message:t},"user-message-".concat(t.id)):(0,n.jsx)(eb,{endChildren:a,forkKeyOptions:o,isLastMessage:s,isLoading:r,isStreaming:l,message:t,submit:c,setChatState:d},"bot-message-".concat(t.id))});var eN=a(82974),ek=a(86943);function eC(e){let{animate:t=!0,isRestoring:a,lastMessageType:s}=e;return(0,n.jsx)("div",{className:"group-has-[.streaming-block]/message-list:hidden","data-is-last":!0,children:(0,n.jsx)(o.E,{avatar:"added-integration"===s?(0,n.jsx)("span",{className:"size-6"}):(0,n.jsx)(u,{loading:!0}),className:(0,d.cn)("flex px-4 pt-3 duration-500",a&&"w-full",t&&"animate-slideUpAndFade"),"data-testid":"spinner-message",innerClassName:(0,d.cn)(a&&"w-full"),children:(0,n.jsx)(eu.p,{isLoading:!0,text:"added-integration"===s?"Thinking...":a?"is restoring...":void 0})})})}var eS=a(99066),eM=a(86184),eI=a(78517),eA=a(16983),eD=a(97396),eL=a(73057),ez=a(13443),eE=a(53663),eP=a(33324),eT=a(81691),eF=a(34034),eR=a(91220),eU=a(91211),eV=a(77831),eB=a(32809),e_=a(28992),eO=a(20125);let eH=["2xl","xl","lg","md","sm"],e$=function(e){let{className:t}=e;return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 13 14",fill:"none",className:t,children:(0,n.jsx)("path",{fill:"#666",fillRule:"evenodd",d:"M1 1a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm3 11.5h5v-11H4v11Zm-1 0a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-11a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v11Zm9.5-11a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM1 3a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm11.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM1 5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm11.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM1 7a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm11.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM1 9a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm11.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM1 11a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm11.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1ZM1 13a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm11.5.5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1Z",clipRule:"evenodd"})})};function eq(e){if(!e)return[];let t=eH.indexOf(e);return -1===t?eH:eH.slice(t)}function eW(e){let t,{title:a,options:s,type:r,classNames:l,breakpoint:i,icon:o,onUpdate:c}=e,u=[],m=eq(i),h="",p=0,x=!1;for(let{display:e,value:a,fallback:i}of s){let s=!1;e:for(let e=0;e<l.length;e++){for(let n of m)if(l[e].includes(n+":"+a)){if(t&&eH.indexOf(t)<eH.indexOf(n))continue;p=e,s=!0,h=a,t=n;break e}if(!t&&l[e].includes(a)){p=e,s=!0,h=a;break}}if(i&&(x=!0),"dropdown"===r){u.push((0,n.jsx)(eR.eb,{value:a||" ",className:"h-7 px-2 py-1 text-xs",children:e},a));continue}u.push((0,n.jsx)("button",{className:(0,d.cn)("rounded px-2 py-1",s?"bg-gray-200 text-black":"text-gray-700"),onClick:()=>{let e=l[p].filter(e=>e!==(t?t+":"+h:h));a&&e.push(t?t+":"+a:a),c(p,e.join(" "))},children:e},a))}return h||x?(0,n.jsx)("div",{title:a,className:"dropdown"===r?"flex-1":"",children:"dropdown"===r?(0,n.jsxs)(eR.l6,{value:h,onValueChange:e=>{e=e.trim();let a=l[p].filter(e=>e!==(t?t+":"+h:h));e&&a.push(t?t+":"+e:e),c(p,a.join(" "))},children:[(0,n.jsx)(eR.bq,{className:"h-7 w-full rounded px-2 py-1 text-xs shadow-none",children:(0,n.jsxs)("span",{className:"!inline-flex items-center gap-1.5 flex-1",children:[o,h?(0,n.jsx)(eR.yv,{}):(0,n.jsx)("span",{className:"text-gray-400",children:"Default"})]})}),(0,n.jsx)(eR.gC,{children:u})]}):(0,n.jsx)("div",{className:"inline-flex gap-1 rounded border border-gray-200 bg-white p-[2px] text-sm h-7",children:u})}):null}function eG(e){let{title:t,min:a,max:s,icon:r,value:l,onChange:i}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{title:t,className:"flex-1 relative",children:[(0,n.jsx)("span",{className:"absolute h-7 flex items-center left-2",children:r}),(0,n.jsx)("input",{type:"number",min:a,max:s,step:1,value:l,onChange:i,className:"border border-gray-200 text-xs tabular-nums px-1 py-0.5 pl-7 h-7 rounded w-full focus:border-gray-500 outline-none bg-white"})]})})}function eZ(e){return e[2]?e[2]+":"+e[0]:e[0]}function eY(e){var t,a,r,l,i,o,c,d,u,m,h;let{title:p,classNames:x,prefix:f,prefixX:g,prefixY:v,prefixT:j,prefixR:b,prefixB:y,prefixL:w,iconX:N,iconY:k,iconT:C,iconR:S,iconB:M,iconL:I,breakpoint:A,generate:D,match:L,min:z,max:E,onUpdate:P}=e,T=eq(A),F={},R={};for(let e=0;e<x.length;e++)for(let t of x[e]){for(let a of T)if(t.startsWith(a+":")){let n=t.slice(a.length+1),s=L(n);if(null!==s){let t=F[s[0]];if((null==t?void 0:t[2])&&eH.indexOf(t[2])<eH.indexOf(a))continue;F[s[0]]=[n,s[1],a],R[s[0]]=e}}let a=L(t);if(null!==a){let n=F[a[0]];(null==n?void 0:n[2])||(F[a[0]]=[t,a[1],void 0],R[a[0]]=e)}}let U=(0,ea._6)((e,t)=>{var a,n,s,r,l,i,o,c,d,u,m,h;let p,N=R[e]||0,k=new Set;(null==(a=F[e])?void 0:a[0])?(k.add(eZ(F[e])),p=F[e][2]):e===f||(e===g||e===v?p=null==(n=F[f])?void 0:n[2]:e===j||e===y?p=(null==(s=F[v||""])?void 0:s[2])||(null==(r=F[f])?void 0:r[2]):(e===b||e===w)&&(p=(null==(l=F[g||""])?void 0:l[2])||(null==(i=F[f])?void 0:i[2]))),(e===g||e===v||e===f)&&(j&&(null==(o=F[j])?void 0:o[0])&&k.add(eZ(F[j])),b&&(null==(c=F[b])?void 0:c[0])&&k.add(eZ(F[b])),y&&(null==(d=F[y])?void 0:d[0])&&k.add(eZ(F[y])),w&&(null==(u=F[w])?void 0:u[0])&&k.add(eZ(F[w])),e===f&&(g&&(null==(m=F[g])?void 0:m[0])&&k.add(eZ(F[g])),v&&(null==(h=F[v])?void 0:h[0])&&k.add(eZ(F[v]))));let C=x[N].filter(e=>!k.has(e)),S=D(e,t);C.push(p?p+":"+S:S),P(N,C.join(" "))},80),V=g?null!=(a=F[g])?a:F[f]:void 0,B=v?null!=(r=F[v])?r:F[f]:void 0,_=j?null!=(i=null!=(l=F[j])?l:v?F[v]:void 0)?i:F[f]:void 0,O=b?null!=(c=null!=(o=F[b])?o:g?F[g]:void 0)?c:F[f]:void 0,H=y?null!=(u=null!=(d=F[y])?d:v?F[v]:void 0)?u:F[f]:void 0,$=w?null!=(h=null!=(m=F[w])?m:g?F[g]:void 0)?h:F[f]:void 0,q=H!==_||$!==O,[W,G]=(0,s.useState)(q),Z=(0,n.jsx)(eG,{title:p,min:z,max:E,value:(null==(t=F[f])?void 0:t[1])||0,icon:(0,n.jsx)(eV.XI2,{className:"size-3"}),onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(f,t)}}),Y=g?(0,n.jsx)(eG,{title:"".concat(p," X"),min:z,max:E,icon:N,value:(null==V?void 0:V[1])||0,onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(g,t)}}):null,K=v?(0,n.jsx)(eG,{title:"".concat(p," Y"),min:z,max:E,icon:k,value:(null==B?void 0:B[1])||0,onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(v,t)}}):null,J=j?(0,n.jsx)(eG,{title:"".concat(p," Top"),min:z,max:E,icon:C,value:(null==_?void 0:_[1])||0,onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(j,t)}}):null,Q=b?(0,n.jsx)(eG,{title:"".concat(p," Right"),min:z,max:E,icon:S,value:(null==O?void 0:O[1])||0,onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(b,t)}}):null,X=y?(0,n.jsx)(eG,{title:"".concat(p," Bottom"),min:z,max:E,icon:M,value:(null==H?void 0:H[1])||0,onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(y,t)}}):null,ee=w?(0,n.jsx)(eG,{title:"".concat(p," Left"),min:z,max:E,icon:I,value:(null==$?void 0:$[1])||0,onChange:e=>{let t=parseInt(e.currentTarget.value);if(t<z||t>E||isNaN(t)){e.preventDefault(),t<z&&(e.currentTarget.value=z.toString()),t>E&&(e.currentTarget.value=E.toString());return}U(w,t)}}):null;return(0,n.jsxs)("div",{className:"w-full flex items-top gap-2 justify-between",children:[W?(0,n.jsxs)("div",{className:"flex flex-col gap-3 flex-1 w-full",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"flex-1",children:J}),(0,n.jsx)("span",{className:"flex-1",children:X})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"flex-1",children:ee}),(0,n.jsx)("span",{className:"flex-1",children:Q})]})]}):Y&&K?(0,n.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[Y,K]}):(0,n.jsx)("div",{className:"flex flex-1 items-center gap-3",children:Z}),j&&b&&y&&w?(0,n.jsx)(eO.Tooltip,{content:"Toggle all sides",children:(0,n.jsx)("button",{className:"flex h-7 w-7 items-center justify-center text-gray-700 rounded hover:bg-gray-100",onClick:()=>{G(!W)},children:(0,n.jsx)(eV.ZIT,{className:"size-3"})})}):null]})}function eK(e){var t;let{title:a,classNames:s,prefix:r,icon:l,generate:i,match:o,min:c,max:d,onUpdate:u}=e,m={},h={};for(let e=0;e<s.length;e++)for(let t of s[e]){let a=o(t);null!==a&&(m[a[0]]=[t,a[1]],h[a[0]]=e)}let p=(0,ea._6)((e,t)=>{var a;let n=h[e]||0,r=new Set;(null==(a=m[e])?void 0:a[0])&&r.add(m[e][0]);let l=s[n].filter(e=>!r.has(e)),o=i(e,t);l.push(o),u(n,l.join(" "))},80),x=(0,n.jsx)(eG,{title:a,min:c,max:d,value:(null==(t=m[r])?void 0:t[1])||100,icon:l,onChange:e=>{let t=Number(e.currentTarget.value);if(t<c||t>d||isNaN(t)){e.preventDefault(),t<c&&(e.currentTarget.value=c.toString()),t>d&&(e.currentTarget.value=d.toString());return}p(r,t)}});return(0,n.jsx)("div",{className:"w-full flex items-top gap-2 justify-between",children:(0,n.jsx)("div",{className:"flex flex-1 items-center gap-3",children:x})})}function eJ(e){let{title:t,children:a}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-3 px-4 py-3",children:[(0,n.jsx)("div",{className:"select-none text-xs font-semibold text-black",children:t}),a]})}let eQ=e=>{let t=e.toString(16);return 1===t.length?"0"+t:t};function eX(e){var t,a,r,l;let{title:i,classNames:o,computedColor:c,prefix:d,match:u,fallback:m,onUpdate:h}=e,p="",x=0;for(let e=0;e<o.length;e++)for(let t=0;t<o[e].length;t++){let a=u(o[e][t]);if(null!==a){p=a,x=e;break}}let f=(0,s.useRef)(),g=(0,ea._6)(e=>{let t=o[x].filter(e=>e!==p);if(e){let a="".concat(d,"[rgba(").concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")]");t.push(a)}h(x,t.join(" "))},200,{maxWait:200});if(!p&&!m)return null;let v=p.match(/\[rgba\((\d+),(\d+),(\d+),(\d+(\.\d+)?)\)\]/);!v&&p&&c&&(v=c.match(/rgba?\((\d+), ?(\d+), ?(\d+),? ?(\d+(\.\d+)?)?\)/));let j=v?{r:parseInt(v[1]),g:parseInt(v[2]),b:parseInt(v[3]),a:parseFloat(v[4]||"1")}:{r:255,g:255,b:255,a:1};return(0,n.jsx)("div",{title:i,children:(0,n.jsxs)(eU.AM,{children:[(0,n.jsx)(eU.Wv,{children:(0,n.jsx)("button",{className:"h-7 w-[100px] overflow-hidden rounded border border-gray-200 bg-white shadow-none",children:(0,n.jsxs)("span",{className:"flex items-center h-full w-full rounded p-1 gap-1",children:[(0,n.jsx)("span",{className:"block size-5 border border-gray-200 rounded-sm",style:{background:v?"rgba(".concat(j.r,",").concat(j.g,",").concat(j.b,",").concat(j.a,")"):"linear-gradient(167deg,rgb(255,255,255) 50%,rgb(209,209,209) 51%)"}}),v?(0,n.jsx)("span",{className:"text-xs text-gray-600 font-mono",children:(t=j.r,a=j.g,r=j.b,l=j.a,"#".concat(eQ(t)).concat(eQ(a)).concat(eQ(r)).concat(l<1?eQ(Math.round(255*l)):""))}):(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"Default"})]})})}),(0,n.jsx)(eU.hl,{className:"w-auto",withOverlay:!0,children:(0,n.jsxs)("div",{className:"devtools-color-picker flex flex-col gap-1 p-1",children:[(0,n.jsx)(e_.YJ,{color:f.current||j,onChange:e=>{f.current=e,g(e)}}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("button",{className:"flex h-6 w-6 items-center justify-center rounded-full text-gray-700 hover:bg-gray-100",onClick:()=>{f.current=null,g(null)},children:(0,n.jsx)(eV.Fb4,{className:"size-3"})}),(0,n.jsxs)("span",{className:"flex-1 text-right text-xs text-gray-500",children:["rgba(",j.r,", ",j.g,", ",j.b,","," ",j.a,")"]}),(0,n.jsx)("button",{className:"flex h-6 w-6 items-center justify-center rounded-full text-gray-700 hover:bg-gray-100",onClick:async()=>{if("EyeDropper"in window){let e=new EyeDropper,t=await e.open();if(t){let e=t.sRGBHex.match(/[a-f0-9]{2}/g).map(e=>parseInt(e,16));g({r:e[0],g:e[1],b:e[2],a:1})}}},children:(0,n.jsx)(eB.A,{className:"size-3"})})]})]})})]})})}function e0(e){let{value:t,htmlEncoded:a,onUpdate:s}=e,r=(0,ea._6)(e=>{if(!e&&a)return void s('{""}');s(e)},100);return(0,n.jsx)("div",{children:(0,n.jsx)("textarea",{defaultValue:t.trim(),onChange:e=>{a?(e.currentTarget.innerText=e.currentTarget.value,r(e.currentTarget.innerHTML)):r(e.currentTarget.value)},className:"p-1.5 border border-gray-200 text-xs rounded w-full focus:border-gray-500 outline-none resize-none bg-white",rows:3,spellCheck:!1})})}let e1=["0","","2","4","8"],e5=["0","px","0.5","1","1.5","2","2.5","3","3.5","4","5","6","7","8","9","10","11","12","14","16","20","24","28","32","36","40","44","48","52","56","60","64","72","80","96"],e2=["white","black","transparent","border","input","ring","background","foreground","primary","secondary","destructive","warning","muted","accent","popover","card","sidebar"];var e3=a(36863),e6=a(54545),e7=a(80672);function e9(){let[e]=(0,eF.YI)(),{dm:t}=(0,W.D)();return t&&e?(0,n.jsx)("div",{className:"absolute size-full bg-background z-10 top-0 left-0 overflow-auto pb-4",children:(0,n.jsx)(te,{})}):null}function e4(){return(0,n.jsx)("div",{className:"size-full px-4",children:(0,n.jsxs)("div",{className:"size-full border border-dashed rounded-lg flex items-center justify-center flex-col gap-4 text-center",children:[(0,n.jsx)(eP.f,{}),(0,n.jsx)("p",{className:"block w-full max-w-48 text-gray-700 text-sm",children:"Select an element on the preview to make changes"})]})})}function e8(){return(0,n.jsx)("div",{className:"size-full px-4 pb-4",children:(0,n.jsxs)("div",{className:"size-full border border-dashed rounded-lg flex items-center justify-center flex-col gap-4 text-center",children:[(0,n.jsx)(eT.a,{}),(0,n.jsx)("p",{className:"block w-full max-w-48 text-gray-700 text-sm",children:"This element can't be edited"})]})})}function te(){var e,t,a,r,l,i,o,c,d,u,m,h,p,x,f,g,v;let[j,b]=(0,s.useState)({parts:null,selected:!1}),y=(0,s.useRef)(null),w=(0,e3.F)(j),N=(0,s.useRef)([]),k=(0,s.useCallback)((e,t)=>{0===N.current.length&&t(),N.current.push([e,t])},[]),C=(0,s.useCallback)((e,t)=>{let a=Date.now();k(a,()=>{e6.u.current&&w.current.parts&&e6.u.current.inlineEdit(w.current.file,w.current.parts[e].lineNumber,w.current.parts[e].columnNumber,w.current.defined?w.current.parts[e].value.length+2:0,w.current.defined?'"'.concat(t,'"'):' className="'.concat(t,'"'),a)})},[k]),S=(0,s.useCallback)(e=>{let t=Date.now();k(t,()=>{if(!e6.u.current||!w.current.parts||!w.current.content)return;let a="string"===w.current.content.type?JSON.stringify(e).slice(1,-1):e;e6.u.current.inlineEdit(w.current.content.file,w.current.content.line,w.current.content.column,w.current.content.len,a,t)})},[k]),[,M]=(0,e7.useAtom)(eF.o8);(0,s.useEffect)(()=>{let e=e=>{let{data:t}=e;if(t&&"object"==typeof t&&t.__v0_remote__)switch(t.type){case"devtools_selected_state":y.current=e.source,b(t),t.name?M({name:t.name,file:t.file,line:t.line,column:t.column}):M(null);let a=t.version;for(;N.current.length&&N.current[0][0]<=a;)N.current.shift();if(N.current.length){let[e,t]=N.current[0];t(),N.current.shift()}break;case"devtools_copy":if(e6.u.current&&t.file){let e=e6.u.current.getContent(t.file);"string"==typeof e&&(0,U.C)(e.slice(t.start,t.end))}break;case"devtools_delete":e6.u.current&&t.file&&e6.u.current.inlineEdit(t.file,0,0,0,"",Date.now(),void 0,[t.start,t.end])}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[M]);let I=(0,s.useMemo)(()=>j.parts?j.parts.map(e=>{let{value:t}=e;return t.split(" ").map(e=>e.trim()).filter(Boolean)}):[],[j.parts]),A=(0,s.useMemo)(()=>{let e={gap:!1,space:!1,flex:!1,grid:!1,showGap:!1};return I&&I.forEach(t=>{for(let a of t)a.startsWith("gap-")?e.gap=!0:a.startsWith("space-")?e.space=!0:"flex"===a?e.flex=!0:"grid"===a&&(e.grid=!0)}),!e.space&&(e.gap||e.flex||e.grid)&&(e.showGap=!0),e},[I]);return null===j.parts?j.selected?(0,n.jsx)(e8,{}):(0,n.jsx)(e4,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"sticky top-0 bg-background px-4 py-2 mb-4 font-medium text-sm border-b z-10",children:"Design"}),(0,n.jsxs)("div",{className:"divide-y border rounded-md mx-4",children:[(0,n.jsxs)(eJ,{title:"Typography",children:[(0,n.jsx)(eW,{title:"Font Family",onUpdate:C,classNames:I,breakpoint:null==(e=j.info)?void 0:e.activeBreakpoint,type:"dropdown",icon:(0,n.jsx)(eV.N$i,{className:"size-3"}),options:[{display:(0,n.jsx)("span",{className:"text-gray-400",children:"Default"}),value:"",fallback:!0},{display:"Sans Serif",value:"font-sans"},{display:"Serif",value:"font-serif"},{display:"Monospace",value:"font-mono"}]}),(0,n.jsxs)("div",{className:"flex w-full gap-3",children:[(0,n.jsx)(eW,{title:"Weight",onUpdate:C,classNames:I,breakpoint:null==(t=j.info)?void 0:t.activeBreakpoint,type:"dropdown",icon:(0,n.jsx)(eV.Sp2,{className:"size-3"}),options:[{display:(0,n.jsx)("span",{className:"text-gray-400",children:"Default"}),value:"",fallback:!0},{display:"Thin",value:"font-thin"},{display:"Extra Light",value:"font-extralight"},{display:"Light",value:"font-light"},{display:"Regular",value:"font-normal"},{display:"Medium",value:"font-medium"},{display:"Semi Bold",value:"font-semibold"},{display:"Bold",value:"font-bold"},{display:"Extra Bold",value:"font-extrabold"},{display:"Black",value:"font-black"}]}),(0,n.jsx)(eW,{title:"Size",onUpdate:C,classNames:I,breakpoint:null==(a=j.info)?void 0:a.activeBreakpoint,icon:(0,n.jsx)(eV.sJR,{className:"size-3"}),type:"dropdown",options:[{display:(0,n.jsx)("span",{className:"text-gray-400",children:"Default"}),value:"",fallback:!0},{display:"xs",value:"text-xs"},{display:"sm",value:"text-sm"},{display:"base",value:"text-base"},{display:"lg",value:"text-lg"},{display:"xl",value:"text-xl"},{display:"2xl",value:"text-2xl"},{display:"3xl",value:"text-3xl"},{display:"4xl",value:"text-4xl"},{display:"5xl",value:"text-5xl"},{display:"6xl",value:"text-6xl"},{display:"7xl",value:"text-7xl"},{display:"8xl",value:"text-8xl"},{display:"9xl",value:"text-9xl"}]})]}),(0,n.jsxs)("div",{className:"flex w-full gap-3 flex-wrap",children:[(0,n.jsx)(eX,{title:"Text Color",fallback:!0,onUpdate:C,classNames:I,computedColor:null==(r=j.info)?void 0:r.color,prefix:"text-",match:e=>{if(!e.startsWith("text-"))return null;let t=e.slice(5);return e2.includes(t)||t&&/^[a-z]+-(|1|2|3|4|5|6|7|8|9)(00|50)$/.test(t)||t&&t.startsWith("[rgb")?e:null}}),(0,n.jsx)(eW,{title:"Transform",onUpdate:C,classNames:I,breakpoint:null==(l=j.info)?void 0:l.activeBreakpoint,options:[{display:(0,n.jsx)(eV.Fb4,{className:"size-3 stroke-1 text-gray-400"}),value:"",fallback:!0},{display:(0,n.jsx)(eV.got,{className:"size-3 stroke-2"}),value:"uppercase"},{display:(0,n.jsx)(eV.FzJ,{className:"size-3 stroke-2"}),value:"lowercase"},{display:(0,n.jsx)(eV.EQr,{className:"size-3 stroke-2"}),value:"capitalize"}]}),(0,n.jsx)(eW,{title:"Style",onUpdate:C,classNames:I,breakpoint:null==(i=j.info)?void 0:i.activeBreakpoint,options:[{display:(0,n.jsx)(eV.Fb4,{className:"size-3 stroke-1 text-gray-400"}),value:"",fallback:!0},{display:(0,n.jsx)(eV.zxT,{className:"size-3 stroke-2"}),value:"italic"},{display:(0,n.jsx)(eV.t64,{className:"size-3 stroke-2"}),value:"line-through"},{display:(0,n.jsx)(eV.qpS,{className:"size-3 stroke-2"}),value:"underline"}]})]}),(0,n.jsx)("div",{className:"flex w-full gap-3 flex-wrap",children:(0,n.jsx)(eW,{title:"Alignment",onUpdate:C,classNames:I,breakpoint:null==(o=j.info)?void 0:o.activeBreakpoint,options:[{display:(0,n.jsx)(eV.Fb4,{className:"size-3 stroke-1 text-gray-400"}),value:"",fallback:!0},{display:(0,n.jsx)(eV.VNq,{className:"size-3 stroke-2"}),value:"text-left"},{display:(0,n.jsx)(eV.L0c,{className:"size-3 stroke-2"}),value:"text-center"},{display:(0,n.jsx)(eV.Ui8,{className:"size-3 stroke-2"}),value:"text-right"},{display:(0,n.jsx)(eV.a2T,{className:"size-3 stroke-2"}),value:"text-justify"}]})})]}),(0,n.jsx)(eJ,{title:"Background",children:(0,n.jsx)("div",{className:"flex w-full gap-3",children:(0,n.jsx)(eX,{title:"Background Color",fallback:!0,onUpdate:C,classNames:I,computedColor:null==(c=j.info)?void 0:c.backgroundColor,prefix:"bg-",match:e=>{if(!e.startsWith("bg-"))return null;let t=e.slice(3);return e2.includes(t)||t&&/^[a-z]+-(|1|2|3|4|5|6|7|8|9)(00|50)$/.test(t)||t&&t.startsWith("[rgb")?e:null}})})}),j.content?(0,n.jsx)(eJ,{title:"Content",children:(0,n.jsx)(e0,{value:j.content.value,onUpdate:S,htmlEncoded:"jsxText"===j.content.type})}):null,(0,n.jsx)(eJ,{title:"Margin",children:(0,n.jsx)("div",{className:"flex w-full gap-3",children:(0,n.jsx)(eY,{title:"Margin",classNames:I,breakpoint:null==(d=j.info)?void 0:d.activeBreakpoint,prefix:"m",prefixX:"mx",prefixY:"my",prefixT:"mt",prefixR:"mr",prefixB:"mb",prefixL:"ml",iconX:(0,n.jsx)(e$,{className:"h-3"}),iconY:(0,n.jsx)(e$,{className:"h-3 rotate-90"}),iconT:(0,n.jsx)(eV.k8h,{className:"h-3"}),iconR:(0,n.jsx)(eV.hh8,{className:"h-3"}),iconB:(0,n.jsx)(eV._zK,{className:"h-3"}),iconL:(0,n.jsx)(eV.MFq,{className:"h-3"}),generate:(e,t)=>"".concat(e,"-").concat(e5[t]),match:e=>{let t=e.match(/^(m|mx|my|mt|mr|mb|ml)-([^-]+)$/);if(t){let e=t[1],a=e5.indexOf(t[2]);if(-1!==a)return[e,a]}return null},min:0,max:e5.length-1,onUpdate:C})})}),(0,n.jsx)(eJ,{title:"Padding",children:(0,n.jsx)("div",{className:"flex w-full gap-3",children:(0,n.jsx)(eY,{title:"Padding",classNames:I,breakpoint:null==(u=j.info)?void 0:u.activeBreakpoint,prefix:"p",prefixX:"px",prefixY:"py",prefixT:"pt",prefixR:"pr",prefixB:"pb",prefixL:"pl",iconX:(0,n.jsx)(e$,{className:"h-3"}),iconY:(0,n.jsx)(e$,{className:"h-3 rotate-90"}),iconT:(0,n.jsx)(eV.k8h,{className:"h-3"}),iconR:(0,n.jsx)(eV.hh8,{className:"h-3"}),iconB:(0,n.jsx)(eV._zK,{className:"h-3"}),iconL:(0,n.jsx)(eV.MFq,{className:"h-3"}),generate:(e,t)=>"".concat(e,"-").concat(e5[t]),match:e=>{let t=e.match(/^(p|px|py|pt|pr|pb|pl)-([^-]+)$/);if(t){let e=t[1],a=e5.indexOf(t[2]);if(-1!==a)return[e,a]}return null},min:0,max:e5.length-1,onUpdate:C})})}),(0,n.jsx)(eJ,{title:"Gap",children:(0,n.jsx)("div",{className:"flex w-full gap-3",children:A.showGap?(0,n.jsx)(eY,{title:"Gap",classNames:I,breakpoint:null==(m=j.info)?void 0:m.activeBreakpoint,prefix:"gap",prefixX:"gap-x",prefixY:"gap-y",iconX:(0,n.jsx)(e$,{className:"h-3"}),iconY:(0,n.jsx)(e$,{className:"h-3 rotate-90"}),generate:(e,t)=>"".concat(e,"-").concat(e5[t]),match:e=>{let t=e.match(/^(gap|gap-x|gap-y|gap-t|gap-r|gap-b|gap-l)-([^-]+)$/);if(t){let e=t[1],a=e5.indexOf(t[2]);if(-1!==a)return[e,a]}return null},min:0,max:e5.length-1,onUpdate:C}):(0,n.jsx)(eY,{title:"Gap",classNames:I,breakpoint:null==(h=j.info)?void 0:h.activeBreakpoint,prefix:"space",prefixX:"space-x",prefixY:"space-y",iconX:(0,n.jsx)(e$,{className:"h-3"}),iconY:(0,n.jsx)(e$,{className:"h-3 rotate-90"}),generate:(e,t)=>"".concat(e,"-").concat(e5[t]),match:e=>{let t=e.match(/^(space-x|space-y)-([^-]+)$/);if(t){let e=t[1],a=e5.indexOf(t[2]);if(-1!==a)return[e,a]}return null},min:0,max:e5.length-1,onUpdate:C})})}),(0,n.jsxs)(eJ,{title:"Border",children:[(0,n.jsxs)("div",{className:"flex w-full gap-3",children:[(0,n.jsx)(eX,{title:"Border Color",fallback:!0,onUpdate:C,classNames:I,computedColor:null==(p=j.info)?void 0:p.borderColor,prefix:"border-",match:e=>"border-white"===e||"border-black"===e||e&&/^border-[a-z]+-(|1|2|3|4|5|6|7|8|9)(00|50)$/.test(e)||e&&e.startsWith("border-[rgba")?e:null}),(0,n.jsx)(eW,{title:"Border Style",onUpdate:C,classNames:I,breakpoint:null==(x=j.info)?void 0:x.activeBreakpoint,type:"dropdown",options:[{display:(0,n.jsx)("span",{className:"text-gray-400",children:"Default"}),value:"",fallback:!0},{display:"None",value:"border-none"},{display:"Solid",value:"border-solid"},{display:"Dashed",value:"border-dashed"},{display:"Dotted",value:"border-dotted"}]})]}),(0,n.jsx)(eY,{title:"Border Width",classNames:I,breakpoint:null==(f=j.info)?void 0:f.activeBreakpoint,prefix:"border",prefixT:"border-t",prefixR:"border-r",prefixB:"border-b",prefixL:"border-l",iconT:(0,n.jsx)(eV.k8h,{className:"h-3"}),iconR:(0,n.jsx)(eV.hh8,{className:"h-3"}),iconB:(0,n.jsx)(eV._zK,{className:"h-3"}),iconL:(0,n.jsx)(eV.MFq,{className:"h-3"}),generate:(e,t)=>e1[t]?"".concat(e,"-").concat(e1[t]):e,match:e=>{let t=e.match(/^(border|border-t|border-r|border-b|border-l)-([^-]+)$/);if(t){let e=t[1],a=e1.indexOf(t[2]);if(-1!==a)return[e,a]}let a=e.match(/^(border|border-t|border-r|border-b|border-l)$/);if(a){let e=a[1],t=e1.indexOf("");if(-1!==t)return[e,t]}return null},min:0,max:e1.length-1,onUpdate:C})]}),(0,n.jsx)(eJ,{title:"Radius",children:(0,n.jsx)(eW,{title:"Radius",onUpdate:C,classNames:I,breakpoint:null==(g=j.info)?void 0:g.activeBreakpoint,icon:(0,n.jsx)(eV.qA9,{className:"size-3"}),type:"dropdown",options:[{display:(0,n.jsx)("span",{className:"text-gray-400",children:"Default"}),value:"",fallback:!0},{display:"None",value:"rounded-none"},{display:"Small",value:"rounded-sm"},{display:"Normal",value:"rounded"},{display:"Medium",value:"rounded-md"},{display:"Large",value:"rounded-lg"},{display:"Extra Large",value:"rounded-xl"},{display:"Full",value:"rounded-full"}]})}),(0,n.jsx)(eJ,{title:"Shadow",children:(0,n.jsx)(eW,{title:"Shadow",onUpdate:C,classNames:I,breakpoint:null==(v=j.info)?void 0:v.activeBreakpoint,icon:(0,n.jsx)(eV.ZCQ,{className:"size-3"}),type:"dropdown",options:[{display:(0,n.jsx)("span",{className:"text-gray-400",children:"Default"}),value:"",fallback:!0},{display:"None",value:"shadow-none"},{display:"Extra Small",value:"shadow-xs"},{display:"Small",value:"shadow-sm"},{display:"Normal",value:"shadow"},{display:"Medium",value:"shadow-md"},{display:"Large",value:"shadow-lg"},{display:"Extra Large",value:"shadow-xl"}]})}),(0,n.jsx)(eJ,{title:"Opacity",children:(0,n.jsx)(eK,{title:"Opacity",classNames:I,prefix:"opacity",icon:(0,n.jsx)(eV.Aon,{className:"h-3"}),generate:(e,t)=>0===t?"opacity-0":t<=1?"opacity-[".concat(t,"]"):"opacity-".concat(t),match:e=>{let t=e.match(/^opacity-\[?([.0-9]+)\]?$/);return t?["opacity",Number(t[1])]:null},min:0,max:100,onUpdate:C})})]},null==j?void 0:j.key)]})}let tt=[];function ta(e){let{isMobile:t,animateUser:a,onSubmit:l}=e,{messages:o,isLoading:c,isStreaming:u,initialStreamPromise:m,activeForkKey:p,isRestoring:x}=(0,i.Pk)(),{expectUser:f}=(0,A.J)(),{setShowSignInDialog:g}=(0,eA.AO)(),[v]=(0,B.d)(),{canWriteToChat:j}=(0,N.tZ)(),b=(0,i.jo)(),y=!!((null==v?void 0:v.remaining)!==void 0&&v.remaining<=0),w=(0,ez.C)(),k=(0,s.useCallback)(e=>{g({prompt:"new"===e.action&&e.input||""})},[g]),C=(0,s.useMemo)(()=>{if(!o.length)return null;let e=o.filter(e=>"user"===e.role);return e.length>1?e[e.length-1]:null},[o]),S=c||u,M=(0,R.H)(o),I=(0,s.useMemo)(()=>new Map(o.map(e=>[e.id,e])),[o]),D=(0,s.useMemo)(()=>p&&0!==p.length?p[p.length-1].startsWith(eS.tg)?p.slice(0,p.length-1).map(e=>I.get(e)):p.map(e=>I.get(e)):[],[p,I]),{scrollDownButton:L,vlistRef:z,scrollToBottom:E,scrollToHash:P,handleScroll:T,containerRef:F}=(0,eL.I)({count:D.length,pushToBottom:!S&&u});tn({scrollToBottom:E,scrollToHash:P});let U=(0,s.useCallback)(()=>{l(),E()},[l,E]),{submit:V,stopLlmResponse:_}=(0,eS.yI)({onSubmit:U}),{showTopBorder:O,topRef:$,bottomRef:q}=(0,eE.Y)("vertical",{containerRef:F,showInitialBorders:!0});!function(e){let{submit:t,initialStreamPromise:a}=e,{prefillOptions:n}=(0,i.Pk)(),r=(0,eh.useRouter)(),l=(0,s.useRef)(!1),o=(0,i.jo)(),{setMetadata:c}=(0,N.tZ)(),{user:d}=(0,A.J)();(0,s.useEffect)(()=>{let e=!1;return(async()=>{if(!a||!n||l.current||null===d)return;let s=await a;if(!e){if(l.current=!0,"error"===s.status){let e=Error(s.message);(0,H.z)(e,r)||h.o.error("Failed to submit chat. Start a new chat or refresh the page."),o({initialStreamPromise:void 0,messages:[]});return}e||t({action:"new",input:n.query},s)}})(),()=>{e=!0}},[a,n,r,d,t,o,c])}({submit:V,initialStreamPromise:m});let G=(0,s.useMemo)(()=>{if(!p||!D.length)return[];let e=D.filter(Boolean).map(e=>{let t=e.id===p[0],s=e.id===p[p.length-1];return(0,n.jsx)("div",{className:(0,d.cn)("flex w-full px-4 py-3 empty:hidden [&>div]:w-full"),"data-is-first":t,"data-is-last":s&&!c,children:(0,n.jsx)(ew,{animateUser:a&&!m,forkKeyOptions:M.get(e.parentId||eD.pe)||tt,isLastMessage:s&&!x,isLoading:c,isStreaming:u,message:e,submit:V,setChatState:b},(0,eN.B)(e))},(0,eN.B)(e)+"-container")});if(!S)return e;let t=(0,n.jsx)(eC,{isRestoring:x,animate:!m,lastMessageType:null==C?void 0:C.type},"spinner");return u?[...e.slice(0,-1),t,e.at(-1)]:[...e,t]},[p,D,S,x,m,null==C?void 0:C.type,u,c,a,M,V,b]),[Z]=(0,eF.YI)(),{dm:Y}=(0,W.D)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{"aria-roledescription":"chat messages",className:"relative size-full","data-testid":"chat-messages-container",id:ek.cJ,role:"list",style:{contain:"strict"},children:[(0,n.jsx)("div",{className:(0,d.cn)("from-background via-background/75 pointer-events-none absolute left-0 right-4 top-0 z-10 h-8 bg-gradient-to-b to-transparent transition-opacity",O?"opacity-100":"opacity-0")}),(0,n.jsxs)("div",{className:"relative h-full w-full overflow-y-auto border-t border-transparent transition-opacity duration-150 ease-in",ref:F,style:{overflowAnchor:"none"},id:ek.tu,children:[(0,n.jsx)("div",{ref:$,className:"absolute inset-x-0 top-0 h-1.5 w-full"}),(0,n.jsx)("div",{className:"group/message-list mx-auto w-full max-w-3xl [&_div[data-is-first=true]]:pt-2 [&_div[data-is-last=true]]:pb-7",children:(0,n.jsx)(r.YV,{ref:z,onScroll:T,children:G})}),(0,n.jsx)("div",{ref:q,className:"absolute inset-x-0 bottom-0 h-px w-full"})]}),(0,n.jsx)(e9,{})]}),j?(0,n.jsx)(eM.BW,{isMobile:t,isNewChat:!1,isSignedIn:f,isAnonymous:!!(!f&&w),scrollDownButton:Z&&Y?null:L,stop:_,submit:f||w&&!y?V:k}):(0,n.jsx)("div",{className:"sticky inset-x-0 bottom-0",children:L}),(0,n.jsx)(eI.X,{})]})}function tn(e){let{data:t,mutate:a}=(0,l.Ay)("scroll-functions",null,{fallbackData:e?{scrollToHash:e.scrollToHash,scrollToBottom:e.scrollToBottom}:void 0});return(0,s.useEffect)(()=>{e&&a({scrollToHash:e.scrollToHash,scrollToBottom:e.scrollToBottom})},[null==e?void 0:e.scrollToHash,null==e?void 0:e.scrollToBottom,a,e]),null!=t?t:{scrollToHash:()=>{},scrollToBottom:()=>{}}}},28824:(e,t,a)=>{"use strict";a.d(t,{V:()=>L});var n=a(97667),s=a(66692),r=a(80381),l=a(17545),i=a(40767),o=a(90654),c=a(39929),d=a(13729),u=a(37707),m=a(16292),h=a(10838),p=a(32136),x=a(74118),f=a(16894),g=a(25951),v=a(15154),j=a(99066),b=a(37758),y=a(19243),w=a(90516),N=a(33571),k=a(93660),C=a(40711),S=a(2783),M=a(80672),I=a(70676);let A=(0,I.createServerReference)("40d6803ad625db66abd2069dd63e6439de5e55d64e",I.callServer,void 0,I.findSourceMapURL,"addIntrospectionMessages");var D=a(38509);function L(e){var t,a;let{integration:I,allTeamStores:L,onConnect:z,status:E,vercelProjectId:P,onStatusChange:T,source:F,starter:R,disabled:U,sendFollowUp:V=!0,stepIndex:B,envVarKeys:_}=e,{es:O}=(0,u.D)(),{stores:H}=(0,h.g)({vercelProjectId:null!=P?P:void 0,refreshInterval:0}),{activeForkKey:$}=(0,x.Pk)(),q=(0,p.tZ)(),W=window.location.pathname.includes("/projects/"),G=null!=(a=null==(t=q.project)?void 0:t.projectId)?a:W&&1?window.location.pathname.split("/").pop():void 0,{startTimeout:Z,clearTimeout:Y}=(0,D.cP)(null!=G?G:""),{chatId:K}=(0,x.xz)(),{vercelProjectWithDashboard:J,refetchVercelProject:Q}=(0,g.Ok)(G),{submit:X}=(0,j.yI)(),{refresh:ee}=(0,C.Z)(),{showEnvModal:et,setShowEnvModal:ea,setEnvModalData:en}=(0,w.i)(),es=function(){let[e,t]=(0,N.useState)(!1);return(0,N.useEffect)(()=>{t(navigator.userAgent.toLocaleLowerCase().includes("safari")&&!navigator.userAgent.toLocaleLowerCase().includes("chrome"))},[]),e}(),er=(0,M.useSetAtom)(S.uH);(0,N.useEffect)(()=>{"manual"!==I.slug||et||"linking_integration"!==E||T(null!=B?B:I.slug,"none")},[et,E,I.slug,T,B]);let el=async e=>{if(U)return null;if(G)return{projectId:G,vercelProjectWithDashboard:J};T(null!=B?B:e,"creating_project");let t=await (0,f.g)({projectName:q.title,chatId:K||"",onSuccess:()=>{},includeSuccessToast:!1});if(!t.id)return d.o.error("Failed to create project. ".concat(t.errors?Object.values(t.errors).join("\n"):"Please add this chat to a project.")),T(null!=B?B:e,"none"),null;await q.setMetadata({...q,project:{projectId:t.id,vercelProjectId:t.vercelProjectId||null,name:q.title,settings:{icon:"icon-wand-sparkles",color:null},isCreator:!0}});let a=await Q();return a?{projectId:t.id,vercelProjectWithDashboard:a}:(d.o.error("Failed to fetch project data. Please try again."),T(null!=B?B:e,"none"),null)},ei=async e=>{if(!U)try{T(null!=B?B:I.slug,"linking_integration");let a=await el(I.slug);if(!a)return;let{projectId:n,vercelProjectWithDashboard:s}=a;if(!s||!n)return;let r=await fetch("/chat/api/integrations/marketplace/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integrationId:e,projectId:s.project.id})});if(!r.ok){var t;let e=await r.json();throw Error(null!=(t=e.error)?t:"Failed to connect integration")}if(H.refetch(),Q(),ee(),T(null!=B?B:I.slug,"connected_integration"),(0,y.u)("ConnectExistingIntegration",{integrationId:I.id,integrationName:I.name,projectId:s.project.id}),W)return;if(!V){if(T(null!=B?B:I.slug,"introspecting_db"),b.uk.includes(I.name)&&K){let t=await (0,v.W)({props:{language:"sql",source:"SQL_SCHEMA_QUERY",meta:{file:"",transaction:"false"},closed:!1,originalCode:void 0,isPreviewable:!1},v0ProjectId:n,initialVercelProjectId:null!=P?P:void 0,operationId:"".concat(e,"-").concat(n),sqlExecProvider:I.name});if("error"in t){console.error("Failed to introspect DB:",t),T(null!=B?B:I.slug,"none");return}let a=t.stdout.join("\n");A({chatId:K,schemaContent:a,forkKey:$})}T(null!=B?B:I.slug,"connected_integration");return}if(b.uk.includes(I.name)){let t=await (0,v.W)({props:{language:"sql",source:"SQL_SCHEMA_QUERY",meta:{file:"",transaction:"false"},closed:!1,originalCode:void 0,isPreviewable:!1},v0ProjectId:n,initialVercelProjectId:null!=P?P:void 0,operationId:"".concat(e,"-").concat(n),sqlExecProvider:I.name});d.o.success("Integration connected successfully"),er(!1),"error"in t?await X({action:"new",attachments:[],input:"The ".concat(I.name," instance has been connected to the [Vercel Project](").concat(s.project.url,"). We were unable to query the schema for the newly connected ").concat(I.name," instance."),type:"added-integration",revalidateVercelEnvAndIntegrations:!0}):await X({action:"new",attachments:[],input:"The ".concat(I.name," instance has been connected to the [Vercel Project](").concat(s.project.url,"). The schema for this instance is ").concat(t.stdout.join("\n")),type:"added-integration",workflowState:R?"add-existing-sql-db-starter":"add-existing-sql-db",revalidateVercelEnvAndIntegrations:!0})}else d.o.success("Integration connected successfully"),er(!1),await X({action:"new",attachments:[],input:"The ".concat(I.name," instance has been connected to the [Vercel Project](").concat(s.project.url,")."),type:"added-integration",workflowState:R||"settings"===F?"add-starter-integration":b.PP.includes(I.name)?"add-ai":"add-nonsql-store",revalidateVercelEnvAndIntegrations:!0})}catch(e){T(null!=B?B:I.slug,"none"),d.o.error(e instanceof Error?e.message:"Failed to connect integration")}},eo=[...L.data.marketplaceStores.filter(e=>e.product&&e.product.name===I.name),...L.data.nativeStores.filter(e=>e.type===I.slug)];switch(E){case"introspecting_db":return(0,n.jsx)(m.x,{pending:!0,disabled:!0,variant:"secondary",size:"sm",children:"Introspecting"});case"creating_project":return(0,n.jsx)(m.x,{pending:!0,disabled:!0,variant:"secondary",size:"sm",children:"Creating project"});case"linking_integration":return(0,n.jsx)(m.x,{pending:!0,disabled:!0,variant:"secondary",size:"sm",children:"manual"===I.slug?"Adding":"Connecting"});case"added_env_vars":return(0,n.jsx)(s.$,{disabled:!0,variant:"secondary",size:"sm",children:"Added"});case"connected_integration":return(0,n.jsx)(s.$,{disabled:!0,variant:"secondary",size:"sm",children:"Connected"})}return"manual"===I.slug?(0,n.jsx)(s.$,{size:"sm",variant:"secondary",onClick:async()=>{var e;(0,y.u)("ClickAddIntegration",{integration:I});let t=await el(I.slug);t&&(null==(e=t.vercelProjectWithDashboard)?void 0:e.dashboardProject)&&(T(null!=B?B:I.slug,"linking_integration"),await en({mode:"missing",projectId:t.projectId,variables:(null==_?void 0:_.map(e=>({key:e,value:""})))||[],onSave:e=>{T(null!=B?B:I.slug,"added_env_vars"),(0,y.u)("AddIntegration",{integrationSlug:I.slug,source:F,chatId:K||"",envVars:e.map(e=>e.key)}),V&&!W&&X({action:"new",attachments:[],input:"The ".concat(e.map(e=>e.key).join(", ")," environment variables have been added to this project."),type:"added-integration",workflowState:"add-env-vars",revalidateVercelEnvAndIntegrations:!0})}}),ea(!0))},children:(0,n.jsx)(i.F,{className:"size-4"})}):L.isLoading?(0,n.jsx)(k.E,{className:"h-8 w-20 rounded-md"}):(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(s.$,{disabled:U,size:"sm",variant:"secondary",className:"w-full\n          ".concat(eo.length>0&&O?"w-[calc(100%-34px)] rounded-r-none border-r-0":"","\n        "),onClick:async()=>{var e;T(null!=B?B:I.slug,"linking_integration"),Z(I.name,()=>{T(null!=B?B:I.slug,"none")});let t=null;"blob"!==I.slug&&es&&(t=window.open("","_blank","width=1200,height=800"));let a=await el(I.slug);if(!a||!(null==(e=a.vercelProjectWithDashboard)?void 0:e.dashboardProject))return void Y(I.name);await z(I,a.projectId,a.vercelProjectWithDashboard.dashboardProject,t,B)},children:"Create"}),eo.length>0&&O?(0,n.jsxs)(c.DropdownMenu,{children:[(0,n.jsx)(c.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(s.$,{size:"sm",variant:"secondary",className:"w-[34px] rounded-l-none px-2",disabled:U,children:(0,n.jsx)(l.y,{className:"h-4 w-4"})})}),(0,n.jsxs)(c.DropdownMenuContent,{className:"max-h-[200px] overflow-y-auto",align:"end",children:[(0,n.jsxs)(c.DropdownMenuItem,{onClick:async()=>{var e;let t=window.open("","_blank","width=1200,height=800");T(null!=B?B:I.slug,"linking_integration"),Z(I.name,()=>{T(null!=B?B:I.slug,"none")});let a=await el(I.slug);if(!a||!(null==(e=a.vercelProjectWithDashboard)?void 0:e.dashboardProject))return void Y(I.name);await z(I,a.projectId,a.vercelProjectWithDashboard.dashboardProject,t,B)},className:"gap-3 px-3",children:[(0,n.jsx)(o.f,{className:"size-4"}),(0,n.jsx)("span",{children:"Create new"})]}),eo.map(e=>(0,n.jsxs)(c.DropdownMenuItem,{className:"gap-3 px-3",onClick:()=>ei(e.id),children:[(0,n.jsx)(r.default,{src:"product"in e?b.eV[e.product.name]:b.eV[e.type]||"/placeholder.svg",alt:e.name,width:16,height:16}),(0,n.jsx)("span",{children:e.name||"Unnamed Instance"})]},e.id))]})]}):null]})}},29279:(e,t,a)=>{"use strict";a.d(t,{SqlExecutionProvider:()=>c,n:()=>o});var n=a(97667),s=a(33571),r=a(70158),l=a(25603);let i=(0,s.createContext)({sqlExecutionStates:{},updateSqlExecutionState:()=>{}});function o(e){let t=(0,s.useContext)(i);if(!t)throw Error("useSqlExecutionState must be used within a SqlExecutionProvider");return{sqlExecutionState:e?t.sqlExecutionStates[e]:void 0,updateSqlExecutionState:a=>{e&&t.updateSqlExecutionState(e,a)},allSqlExecutionStates:t.sqlExecutionStates}}function c(e){let{children:t}=e,[a,o]=(0,s.useState)({}),c=(0,r.useParams)().chatId,{data:d}=(0,l.Ay)(c?["blocks-execution-states",c]:null,{revalidateOnFocus:!1,revalidateOnReconnect:!1});return(0,s.useEffect)(()=>{d&&o(d)},[d]),(0,n.jsx)(i.Provider,{value:{sqlExecutionStates:a,updateSqlExecutionState:(e,t)=>{o(a=>({...a,[e]:t}))}},children:t})}},29412:(e,t,a)=>{"use strict";a.d(t,{e:()=>A,A:()=>T});var n=a(97667),s=a(33571),r=a(23016),l=a.n(r),i=a(28963),o=a(70676);let c=(0,o.createServerReference)("70f946ed6f00c0b6ceb98e263b1594642e4e1d4326",o.callServer,void 0,o.findSourceMapURL,"startChatFromZip");var d=a(13729),u=a(70158),m=a(99715),h=a(87501),p=a(10103),x=a(66692),f=a(93119),g=a(95393),v=a(55274),j=a(28819),b=a(48685),y=a(20125),w=a(23680),N=a(50391),k=a(63186),C=a(25603),S=a(19243),M=a(27693),I=a(86943);function A(e){let{onClose:t,attachment:a,projectId:r}=e,[o,m]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1),[g,v]=(0,s.useState)([]),[j,y]=(0,s.useState)(new Set),[C,A]=(0,s.useState)(null),[D,L]=(0,s.useState)(a),E=(0,u.useRouter)(),{showZipModal:F,setShowZipModal:R}=T(),U=(0,M.k)();async function V(e,t){return await (0,b.Se)(t,e,{access:"public",handleUploadUrl:"/chat/api/chat/upload",clientPayload:JSON.stringify({component:"zip-file",fileType:"application/zip",extension:"zip"}),contentType:"application/zip"})}(0,s.useEffect)(()=>{L(a)},[a]),(0,s.useEffect)(()=>{F&&D&&"object"==typeof D.content&&"byteLength"in D.content&&(f(!0),B(D.content).finally(()=>{f(!1)}))},[F,D]);let B=async e=>{try{let t=await l().loadAsync(e),a=new Set,n=[];t.forEach((e,t)=>{let s=e.split("/").filter(Boolean),r=n;s.forEach((e,n)=>{let l=n===s.length-1,i=r.find(t=>t.name===e);if(i)l&&!t.dir&&(i.isDirectory=!1),r=i.children||[];else{let i={name:e,path:s.slice(0,n+1).join("/"),isDirectory:!l||t.dir,children:t.dir?[]:void 0};z(i.path)||a.add(i.path),r.push(i),l||(r=i.children||[])}})});let s=e=>{for(let t=e.length-1;t>=0;t--){let a=e[t];a.children&&(s(a.children)?a.children=void 0:0===a.children.length&&(a.children=void 0))}return 0===e.length};s(n),v(n),y(a),A(t)}catch(e){console.error("Error loading zip contents:",e),d.o.error("Failed to load zip contents")}},_=e=>{let t=[];return e.isDirectory||t.push(e.path),e.children&&e.children.forEach(e=>{t.push(..._(e))}),t},O=async()=>{if(C&&D){m(!0);try{let t=new(l());for(let e of j){if(z(e)){console.warn("File is disabled: ".concat(e));continue}let a=C.files[e];if(!a){console.warn("File not found in original zip: ".concat(e));continue}if(a.dir)t.folder(e);else{let n=await a.async("uint8array");t.file(e,n)}}let a=await t.generateAsync({type:"blob"});if(a.size>1024*I.N*1024)return void d.o.error("Selected files exceed ".concat(I.N,"MB"));let n=await V(a,D.name||"Untitled.zip");(0,S.u)("CreateChatFromZip",{folderName:D.name,folderSize:D.content&&ArrayBuffer.isView(D.content)?D.content.byteLength:0,selectedFiles:Array.from(j),totalFiles:Object.keys(C.files).length});let s=await c(D.name||"Untitled.zip",n.url,r);if("string"!=typeof s){var e;d.o.error(null!=(e=s.error)?e:"Failed to create chat");return}R(!1),E.push("/chat/".concat(s))}catch(e){console.error(e),d.o.error("An error occurred while creating the chat.")}finally{m(!1),null==t||t()}}},H=(0,s.useRef)(null),{inputFileRef:$,onInputChange:q,uploading:W,isDraggingFile:G}=(0,w.Ay)({isSignedIn:!0,disablePaste:!0,disableDrag:!F,dragContainerRef:H,saveToDrafts:!1,onSuccess:(e,t)=>{var a;if(1!==t.length&&F)return void d.o.error("Only one zip folder is supported.");let n=t[0];if((null==(a=n.name.split(".").pop())?void 0:a.toLowerCase())!=="zip"&&F)return void d.o.error("Only zip folders are supported.");L(n)},projectId:void 0,onFinish:()=>{}}),Z=(0,s.useMemo)(()=>G?(0,n.jsx)("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center gap-2 rounded-lg border border-dashed border-blue-600 bg-blue-100 shadow-none",children:(0,n.jsx)(N.Ou,{className:"text-sm text-blue-600",children:U("uploadZipModal.emptyStateDragging")})}):null,[G,U]);return(0,n.jsxs)(i.Modal,{open:F,onOpenChange:R,children:[(0,n.jsxs)("div",{className:"grid",children:[(0,n.jsx)(i.ModalHeader,{className:"flex justify-start",children:(0,n.jsx)("div",{className:"flex w-full flex-col items-start gap-4",children:(0,n.jsxs)("div",{className:"flex flex-col items-start gap-1.5",children:[(0,n.jsx)(i.ModalTitle,{className:"text-xl font-semibold",children:U("uploadZipModal.title")}),(0,n.jsx)(i.ModalDescription,{children:D?U("uploadZipModal.descriptionFileAttached")(D.name):U("uploadZipModal.descriptionNoFileAttached")})]})})}),(0,n.jsx)(i.ModalContent,{children:D?(0,n.jsx)("div",{className:"overflow-y-auto",children:h||W?(0,n.jsx)("div",{className:"bg-muted border-alpha-200 flex h-60 rounded-md border"}):(0,n.jsx)(P,{files:g,selectedFiles:j,onSelectFile:(e,t,a)=>{y(n=>{let s=new Set(n);if(a){let a=t=>{for(let n of t){if(n.path===e)return n;if(n.children){let e=a(n.children);if(e)return e}}},n=a(g);n&&_(n).forEach(e=>{t&&!z(e)?s.add(e):s.delete(e)})}else t?s.add(e):s.delete(e);return s})}})}):(0,n.jsxs)("div",{className:"relative transition-all",ref:H,children:[Z,(0,n.jsx)(k.pp,{className:"h-60",subtitle:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,n.jsx)("span",{children:(0,n.jsx)(p.g,{className:"h-4 w-4"})}),(0,n.jsxs)("p",{children:[U("uploadZipModal.emptyStateDescription")," ",(0,n.jsx)("button",{onClick:()=>{var e;return null==(e=$.current)?void 0:e.click()},className:"text-blue-600 hover:underline",children:U("uploadZipModal.emptyStateAction")})]})]})})]})}),(0,n.jsx)(i.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between",children:[D&&(0,n.jsx)("div",{className:"text-muted-foreground text-sm",children:U("uploadZipModal.filesSelected")(j.size)}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,n.jsx)(i.ModalClose,{asChild:!0,children:(0,n.jsx)(x.$,{variant:"secondary",onClick:()=>{L(null),R(!1),null==t||t()},size:"sm",children:U("uploadZipModal.cancel")})}),D?(0,n.jsx)(x.$,{onClick:O,disabled:o||0===j.size,size:"sm",autoFocus:!0,children:o?U("uploadZipModal.creatingChat"):U("uploadZipModal.startChat")}):(0,n.jsx)(x.$,{variant:"secondary",size:"sm",disabled:!0,children:U("uploadZipModal.startChat")})]})]})})]}),(0,n.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",ref:$,type:"file",accept:".zip",onChange:e=>{q(e)}})]})}let D=[".gitignore",".git","package.json","tsconfig.json","node_modules",".next","__MACOSX",".DS_Store","Thumbs.db","desktop.ini","npm-debug.log","yarn-error.log","yarn.lock","package-lock.json","pnpm-lock.yaml","repomix-output.txt","repomix-output.json","repomix-output.xml","v0-user-next.config.js","placeholder-logo.svg","placeholder-logo.png","placeholder-user.jpg","placeholder.jpg","placeholder.svg","next-env.d.ts"],L=new Map;function z(e){if(L.has(e))return L.get(e);let t=D.some(t=>e===t||e.endsWith(t))||e.includes(".env")||e.includes("node_modules")||e.includes("__MACOSX")||e.startsWith("public/");return L.set(e,t),t}function E(e){var t;let{file:a,selectedFiles:r,onSelectFile:l,level:i=0}=e,[o,c]=s.useState(!z(a.path)&&!(null==(t=a.children)?void 0:t.every(e=>z(e.path)))),d=a.isDirectory&&a.children&&a.children.length>0,u=(0,s.useMemo)(()=>{var e;return z(a.path)||(null==(e=a.children)?void 0:e.every(e=>z(e.path)))},[a]),p=s.useMemo(()=>!!a.isDirectory&&!!a.children&&(function e(t){let a=[];return t.isDirectory||a.push(t.path),t.children&&t.children.forEach(t=>{a.push(...e(t))}),a})(a).every(e=>r.has(e)),[a,r]),x=(0,n.jsx)(f.Checkbox,{id:a.path,checked:a.isDirectory?p:r.has(a.path),onCheckedChange:e=>{u||l(a.path,e,a.isDirectory)},disabled:u,className:"data-[state=checked]:border-none data-[state=checked]:bg-black"}),b=(0,n.jsxs)("div",{className:(0,j.cn)("flex items-center gap-2 p-1",u&&"opacity-50"),children:[(0,n.jsxs)("div",{className:"flex flex-1 items-center",children:[d&&(0,n.jsx)("button",{onClick:()=>{c(!o)},className:"hover:bg-accent flex h-4 w-4 items-center justify-center rounded text-gray-500",disabled:u,children:(0,n.jsx)(g.P.div,{initial:!1,animate:{rotate:90*!!o},transition:{duration:.2},children:(0,n.jsx)(m.b,{className:"h-4 w-4"})})}),(0,n.jsx)("div",{className:"text-gray-500",children:a.isDirectory?null:(0,n.jsx)(h.Z,{className:"h-4 w-4"})}),(0,n.jsx)("label",{htmlFor:a.path,className:(0,j.cn)("flex-1 cursor-pointer select-none text-sm",u&&"cursor-not-allowed",a.isDirectory?"ml-1":"ml-2"),children:a.name})]}),u?(0,n.jsx)(y.Tooltip,{disableHoverableContent:!0,content:(0,n.jsxs)("p",{children:["This ",a.isDirectory?(0,n.jsx)("span",{children:"folder"}):(0,n.jsx)("span",{children:"file"})," ",(0,n.jsx)("span",{children:"is not supported at this time"})]}),side:"top",children:x}):x]});return(0,n.jsxs)("li",{children:[b,(0,n.jsx)(v.N,{initial:!1,children:d&&o&&(0,n.jsxs)(g.P.ul,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"flex overflow-hidden",children:[(0,n.jsx)("div",{className:"flex w-6 justify-center",children:(0,n.jsx)("div",{className:"bg-alpha-400 w-px"})}),(0,n.jsx)("div",{className:"flex-1",children:a.children.map(e=>(0,n.jsx)(E,{file:e,selectedFiles:r,onSelectFile:l,level:i+1,files:a.children||[]},e.path))})]})})]})}function P(e){let t=(0,s.useMemo)(()=>[...e.files].sort((e,t)=>e.isDirectory&&!t.isDirectory?-1:!e.isDirectory&&t.isDirectory?1:e.name.localeCompare(t.name)),[e.files]);return(0,n.jsx)("div",{className:"bg-muted border-alpha-200 flex max-h-60 overflow-y-auto rounded-md border",children:(0,n.jsx)("ul",{className:"w-full p-2",children:t.map(t=>(0,n.jsx)(E,{file:t,...e},t.path))})})}function T(){let{data:e,mutate:t}=(0,C.Ay)("showZipModal",null);return{showZipModal:e,setShowZipModal:t}}},30014:(e,t,a)=>{"use strict";a.d(t,{R:()=>f});var n=a(97667),s=a(70676);let r=(0,s.createServerReference)("704797e62171cdac7826f9edc838feff56322a2d41",s.callServer,void 0,s.findSourceMapURL,"updateProjectSettingsIcon");var l=a(74096),i=a(8026),o=a(66692),c=a(93660),d=a(28819),u=a(51311),m=a(33571),h=a(10037);let p=(0,u.default)(()=>Promise.resolve().then(a.bind(a,74096)).then(e=>e.IconPicker),{loadableGenerated:{webpack:()=>[74096]},loading:()=>(0,n.jsx)(c.E,{className:"size-12 rounded-xl"})}),x=(0,u.default)(()=>Promise.resolve().then(a.bind(a,74096)).then(e=>e.IconPickerContent),{loadableGenerated:{webpack:()=>[74096]},loading:()=>(0,n.jsx)(l.IconPickerSkeleton,{})});function f(e){let{projectId:t,icon:a,color:s,size:l="lg",readOnly:c,isNewPage:u=!1,onSelect:f,random:g}=e,[v,j]=(0,m.useState)(!1),[b,y]=(0,m.useState)(!1),[w,N]=(0,m.useState)({name:(0,h.KI)(a),color:null!=s?s:""});return(0,m.useEffect)(()=>{N({name:(0,h.KI)(a),color:null!=s?s:""})},[a,s]),(0,n.jsx)(p,{random:g,icon:w,onValueChange:e=>{f&&f(e.name),N(e),y(!0),u||(0,m.startTransition)(()=>{r(t,e.name,e.color)})},trigger:(0,n.jsx)(o.$,{className:(0,d.cn)("aspect-square p-0","xs"===l&&"size-5 rounded-sm","sm"===l&&"size-8 rounded-lg","lg"===l&&"size-12 rounded-xl"),"data-testid":"project-icon-picker",disabled:c,onFocus:()=>y(!!b),onMouseEnter:()=>y(!1),tooltip:c?void 0:{open:!b&&v,onOpenChange:j,content:"Change icon"},variant:"ghost",children:(0,n.jsx)(i.h,{color:w.color,icon:w.name,size:"lg"})}),children:(0,n.jsx)(x,{})})}},30227:(e,t,a)=>{"use strict";a.d(t,{QQ:()=>p,lF:()=>m,sE:()=>h});var n=a(97667),s=a(25603),r=a(66692),l=a(33571),i=a(27693),o=a(18513),c=a(13729),d=a(28963),u=a(12);function m(){let{data:e,mutate:t}=(0,s.Ay)("showDeleteFolderDialog",null,{fallbackData:!1}),{data:a,mutate:n}=(0,s.Ay)("deleteFolderDialogData",null,{fallbackData:{folderName:"",source:""}});return{deleteFolderDialogData:a,setDeleteFolderDialogData:n,showDeleteFolderDialog:e,setShowDeleteFolderDialog:t}}async function h(e,t,a){let n=[...e];for(let e of n)e.meta.file.startsWith(t.folderName+"/")&&(e.isDeleted=!0,e.isUserEdit=!0,e.isMerged=!1,e.moveToEnd=!0);if(!(await a(n)).success)throw Error("Failed")}function p(e){let{blockId:t,sourceFiles:a,onSuccess:s}=e,{deleteFolderDialogData:p,showDeleteFolderDialog:x,setShowDeleteFolderDialog:f}=m(),g=(0,u.W)(t),[v,j]=(0,l.useState)(!1),b=(0,i.k)(),y=(0,l.useCallback)(async()=>{try{j(!0),await h(a,p,g),s()}catch(e){c.o.error(b("fileTreeActions.folderDeletedNotificationError"))}finally{j(!1)}},[p,a,s,g,b]);return(0,n.jsxs)(d.Modal,{onOpenChange:f,open:x,responsive:!1,children:[(0,n.jsx)(d.ModalHeader,{children:(0,n.jsx)(d.ModalTitle,{children:b("fileTreeActions.deleteFolder")})}),(0,n.jsx)(d.ModalContent,{children:(0,n.jsxs)("p",{className:"mb-2",children:["Are you sure you want to delete"," ",(0,n.jsx)("span",{className:"font-bold",children:p.folderName}),"?"]})}),(0,n.jsxs)(d.ModalFooter,{children:[(0,n.jsx)(d.ModalClose,{asChild:!0,children:(0,n.jsx)(r.$,{size:"sm",variant:"secondary",children:b("fileTreeActions.cancel")})}),(0,n.jsx)(r.$,{"data-testid":"confirm-delete-message",disabled:v,onClick:y,size:"sm",variant:"destructive",children:v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.IconSpinner,{className:"size-4"}),b("fileTreeActions.deleting")]}):b("fileTreeActions.delete")})]})]})}},30230:(e,t,a)=>{"use strict";a.d(t,{Ig:()=>c,Wz:()=>i});var n=a(57560),s=a(141),r=a(93187);let l=new Map,i=(0,s.G)(l,()=>({latestGit:(0,n.eU)({error:r.p2})})),o=new Map,c=(0,s.G)(o,e=>({...i(e)}))},31693:(e,t,a)=>{"use strict";a.d(t,{o:()=>x});var n=a(97667),s=a(92800),r=a(65034),l=a(62045),i=a(87501),o=a(2079),c=a(78454),d=a(63809),u=a(62653),m=a(88790),h=a(28819);let p=(0,a(73832).G)('<g clip-path="url(#clip0_872_3178)">\n  <path d="M13.7974 2.11525C12.3195 -0.0135593 9.37709 -0.637288 7.26183 0.705085L3.53302 3.09153C2.51607 3.72881 1.81098 4.77288 1.60759 5.95254C1.43132 6.94237 1.58048 7.95932 2.05505 8.84068C1.72963 9.32881 1.51268 9.87119 1.41776 10.4407C1.20082 11.6475 1.48556 12.8949 2.19065 13.8847C3.68217 16.0136 6.61098 16.6373 8.72624 15.2949L12.4551 12.922C13.472 12.2847 14.1771 11.2407 14.3805 10.061C14.5567 9.07119 14.4076 8.05424 13.933 7.17288C14.2584 6.68475 14.4754 6.14237 14.5703 5.57288C14.8008 4.35254 14.5161 3.10508 13.7974 2.11525Z" fill="currentColor"/>\n  <path d="M6.8958 14.0881C5.68902 14.4 4.428 13.9254 3.72292 12.9085C3.28902 12.3119 3.12631 11.5661 3.24834 10.8339C3.27546 10.7119 3.30258 10.6034 3.3297 10.4814L3.3975 10.2644L3.58733 10.4C4.03478 10.7254 4.52292 10.9695 5.05173 11.1322L5.18733 11.1729L5.17377 11.3085C5.16021 11.4983 5.21445 11.7017 5.32292 11.8644C5.53987 12.1763 5.91953 12.3254 6.28563 12.2305C6.36699 12.2034 6.44834 12.1763 6.51614 12.1356L10.2314 9.76271C10.4212 9.64068 10.5433 9.46441 10.5839 9.24746C10.6246 9.03051 10.5704 8.8 10.4483 8.62373C10.2314 8.31186 9.85173 8.17627 9.48563 8.27119C9.40428 8.29831 9.32292 8.32542 9.25512 8.3661L7.83139 9.27458C7.60089 9.42373 7.34326 9.5322 7.07207 9.6C5.86529 9.91187 4.60428 9.43729 3.89919 8.42034C3.47885 7.82373 3.30258 7.07797 3.43817 6.34576C3.56021 5.64068 3.99411 5.00339 4.60428 4.62373L8.33309 2.25085C8.5636 2.1017 8.82123 1.99322 9.09241 1.91186C10.2992 1.6 11.5602 2.07458 12.2653 3.09153C12.6992 3.68814 12.8619 4.4339 12.7399 5.1661C12.7128 5.28814 12.6856 5.39661 12.645 5.51864L12.5772 5.73559L12.3873 5.6C11.9399 5.27458 11.4517 5.03051 10.9229 4.8678L10.7873 4.82712L10.8009 4.69153C10.8144 4.50169 10.7602 4.29831 10.6517 4.13559C10.4348 3.82373 10.0551 3.68814 9.68902 3.78305C9.60767 3.81017 9.52631 3.83729 9.45851 3.87797L5.74326 6.25085C5.55343 6.37288 5.43139 6.54915 5.39072 6.7661C5.35004 6.98305 5.40428 7.21356 5.52631 7.38983C5.74326 7.7017 6.12292 7.83729 6.48902 7.74237C6.57038 7.71525 6.65173 7.68814 6.71953 7.64746L8.14326 6.73898C8.37377 6.58983 8.63139 6.48136 8.90258 6.4C10.1094 6.08814 11.3704 6.56271 12.0755 7.57966C12.5094 8.17627 12.6721 8.92203 12.55 9.65424C12.428 10.3593 11.9941 10.9966 11.3839 11.3763L7.65512 13.7492C7.42461 13.8983 7.16699 14.0068 6.8958 14.0881Z" fill="white"/>\n  </g>\n  <defs>\n  <clipPath id="clip0_872_3178">\n  <rect width="16" height="16" fill="white"/>\n  </clipPath>\n  </defs>');function x(e){let{lang:t,fill:a}=e,x={className:"size-4"},g={...x,className:(0,h.cn)(a?"[&_path]:".concat(a):"[&_path]:currentColor",x.className)};switch(t){case"typescript":return(0,n.jsx)(r.V,{...x});case"javascript":return(0,n.jsx)(s.F,{...x});case"powershell":case"shellscript":return(0,n.jsx)(f,{...x});case"typescriptreact":case"javascriptreact":return(0,n.jsx)(c.z,{...g});case"html":case"xml":return(0,n.jsx)(l.Y,{...x});case"svelte":return(0,n.jsx)(p,{...x});case"plaintext":return(0,n.jsx)(o.i,{...x});case"vue":case"vue-html":return(0,n.jsx)(d.w,{...x,...g});case"python":return(0,n.jsx)(u.M,{...x,...g});case"sql":return(0,n.jsx)(m.W,{...x,...g});default:return(0,n.jsx)(i.Z,{...x})}}function f(e){return(0,n.jsxs)("svg",{fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_3211_43963)",children:[(0,n.jsx)("path",{d:"M4 7L6 5.5L4 4",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,n.jsx)("path",{d:"M7 9H10",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,n.jsx)("path",{d:"M13.4444 1H2.55556C1.69645 1 1 1.69645 1 2.55556V13.4444C1 14.3036 1.69645 15 2.55556 15H13.4444C14.3036 15 15 14.3036 15 13.4444V2.55556C15 1.69645 14.3036 1 13.4444 1Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_3211_43963",children:(0,n.jsx)("rect",{fill:"white",height:"16",width:"16"})})})]})}},31761:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40d83d3ee113ec909bb0a219c64a638ac285d354b7",n.callServer,void 0,n.findSourceMapURL,"createEnvVars")},32095:(e,t,a)=>{"use strict";a.d(t,{Nt:()=>i,P4:()=>l});var n=a(57560),s=a(141),r=a(95734);let l=(0,s.e)(null,()=>({user:(0,n.eU)(r.nH),chats:(0,n.eU)(r.nH),scopes:(0,n.eU)(r.nH),projects:(0,n.eU)(r.nH),rateLimit:(0,n.eU)(r.nH),newFeatureBanner:(0,n.eU)(r.nH),gitNamespaces:(0,n.eU)(r.nH)})),i=(0,s.e)(null,()=>({...l()}))},32136:(e,t,a)=>{"use strict";a.d(t,{kM:()=>d,sC:()=>c,tZ:()=>o});var n=a(25603),s=a(74118),r=a(33571),l=a(38792),i=a(21715);function o(e){let{chatId:t}=(0,s.xz)(),{data:a,mutate:i,isLoading:o}=(0,n.Ay)(["chat:meta",null!=e?e:t]),c=(0,r.useRef)(null!=a?a:l.O);return{setMetadata:(0,r.useCallback)(e=>i(t=>({...null!=t?t:c.current,...e})),[i]),...null!=a?a:l.O,isLoading:o}}function c(){let{chatId:e}=(0,s.xz)(),{handleSavePromptDraft:t}=(0,i.jh)(),{data:a,mutate:l}=(0,n.Ay)(["chat:quote",e]);return{quote:a,setQuote:(0,r.useCallback)(e=>{l(e),t({quote:e||void 0})},[l])}}function d(){let{chatId:e}=(0,s.xz)(),{data:t,mutate:a}=(0,n.Ay)(["chat:privacy",e]);return{chatPrivacy:t,setChatPrivacy:a}}},32198:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40089315b6e1b8b26ff4878febb39ca34bf20d9834",n.callServer,void 0,n.findSourceMapURL,"exportMessages")},32265:(e,t,a)=>{"use strict";a.d(t,{CG:()=>d,Fm:()=>f,cj:()=>c,h:()=>x,kN:()=>u,qp:()=>g});var n=a(97667),s=a(33571),r=a(13144),l=a(60914),i=a(19434),o=a(84089);let c=r.bL,d=r.l9,u=r.bm,m=r.ZL,h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.hJ,{className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80 ease-in-out dark:bg-white/80",a),...s,ref:t})});h.displayName=r.hJ.displayName;let p=(0,l.F)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 gap-4 p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 border-b",bottom:"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 border-t",left:"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=s.forwardRef((e,t)=>{let{side:a="right",className:s,children:l,showClose:c=!0,...d}=e;return(0,n.jsxs)(m,{children:[(0,n.jsx)(h,{}),(0,n.jsxs)(r.UC,{className:(0,i.cn)(p({side:a}),s),ref:t,...d,children:[c?(0,n.jsxs)(r.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute right-4 top-4 z-10 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,n.jsx)(o.F,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}):null,l]})]})});x.displayName=r.UC.displayName;let f=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})};f.displayName="SheetHeader";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.hE,{className:(0,i.cn)("text-foreground text-lg font-semibold leading-none",a),ref:t,...s})});g.displayName=r.hE.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.VY,{className:(0,i.cn)("text-muted-foreground text-sm",a),ref:t,...s})}).displayName=r.VY.displayName},32707:(e,t,a)=>{"use strict";a.d(t,{NewChatButton:()=>x});var n=a(97667),s=a(19243),r=a(99066),l=a(68481),i=a(94177),o=a(40767),c=a(66692),d=a(97950),u=a(33571),m=a(28819),h=a(27693),p=a(48315);let x=(0,u.forwardRef)(function(e,t){let{variant:a="text",className:x,buttonVariant:f,onButtonClick:g,...v}=e,j=(0,h.k)(),{stopLlmResponse:b}=(0,r.yI)(),y=(0,u.useCallback)(()=>{b(),(0,s.u)("ClickNewChat"),null==g||g()},[b,g]);return"logo"===a||"logo-sm"===a?(0,n.jsx)(c.$,{asChild:!0,className:(0,m.cn)("border-none hover:bg-transparent focus:bg-transparent focus-visible:bg-transparent has-[>svg]:p-0 [&>svg]:size-8","logo-sm"===a?"[&>svg]:w-7":"size-8",x),variant:"ghost",ref:t,...v,children:(0,n.jsxs)(d.PrefetchLinkAndRefreshOnHover,{"data-testid":"header-logo",href:"/",onClick:y,children:[(0,n.jsx)(l.g,{"aria-hidden":!0}),(0,n.jsx)("span",{className:"sr-only",children:j("newChatButton.newChat")})]})}):"v3-logo"===a?(0,n.jsx)(c.$,{asChild:!0,className:(0,m.cn)("size-8 w-auto rounded-md py-1.5 has-[>svg]:px-1 [&>svg]:size-7",x),size:"sm",variant:"ghost",ref:t,...v,children:(0,n.jsxs)(d.PrefetchLinkAndRefreshOnHover,{"data-testid":"header-logo",href:"/",onClick:y,children:[(0,n.jsx)(l.g,{"aria-hidden":!0,className:"size-10 translate-x-[-0.5px]"}),(0,n.jsx)("span",{className:"sr-only",children:j("newChatButton.newChat")})]})}):"icon"===a?(0,n.jsx)(c.$,{asChild:!0,className:(0,m.cn)("hover:bg-gray-150 size-8 shadow-[0px_1px_2px_0px_hsla(0,0%,0%,0.04)] has-[>svg]:px-0",x),tooltip:{side:"right",content:j("newChatButton.newChat"),sideOffset:8},variant:"secondary",ref:t,...v,children:(0,n.jsxs)(d.PrefetchLinkAndRefreshOnHover,{href:"/chat",onClick:y,children:[(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(o.F,{})}),(0,n.jsx)("span",{className:"sr-only",children:j("newChatButton.newChat")})]})}):"ghost"===a?(0,n.jsx)(c.$,{asChild:!0,className:(0,m.cn)("size-7 rounded-md",x),tooltip:"New Chat",variant:"ghost",size:"sm",ref:t,...v,children:(0,n.jsx)(d.PrefetchLinkAndRefreshOnHover,{href:"/chat",onClick:y,children:(0,n.jsx)(o.F,{})})}):"sidebar"===a?(0,n.jsx)(c.$,{asChild:!0,variant:"secondary",className:(0,m.cn)("border-none shadow-sm",x),size:"sm",ref:t,...v,children:(0,n.jsx)(d.PrefetchLinkAndRefreshOnHover,{className:"flex flex-row items-center gap-2.5",href:"/chat",onClick:y,children:"New Chat"})}):"pencil"===a?(0,n.jsx)(c.$,{asChild:!0,variant:"secondary",size:"sm",className:(0,m.cn)("size-7 rounded-md",x),ref:t,...v,children:(0,n.jsx)(d.PrefetchLinkAndRefreshOnHover,{className:"flex flex-row items-center gap-2.5",href:"/chat",onClick:y,children:(0,n.jsx)(i.Y,{size:14})})}):"sidebar-item"===a?(0,n.jsx)(p.W0,{children:(0,n.jsxs)(p.ms,{href:"/chat",onClick:y,children:[(0,n.jsx)(o.F,{}),(0,n.jsx)("span",{children:"New Chat"})]})}):"collapsible"===a?(0,n.jsx)(c.$,{asChild:!0,className:(0,m.cn)("collapsed:w-8 hover:bg-gray-150 focus:bg-gray-150 focus-visible:bg-gray-150 bg-background transition-sidebar relative h-8 w-full overflow-hidden border-none px-2 text-gray-900 shadow-sm",x),size:"sm",ref:t,...v,children:(0,n.jsx)(d.PrefetchLinkAndRefreshOnHover,{href:"/chat",onClick:y,children:(0,n.jsxs)("div",{className:"collapsed:left-0 collapsed:translate-x-2 transition-sidebar absolute inset-2 left-[calc((var(--sidebar-width)-128px)/2)] flex w-fit items-center justify-center gap-2 whitespace-nowrap",children:[(0,n.jsx)("div",{className:"collapsed:opacity-100 transition-sidebar opacity-0 ease-in-out",children:(0,n.jsx)(o.F,{})}),(0,n.jsx)("span",{children:j("newChatButton.newChat")})]})})}):(0,n.jsx)(c.$,{asChild:!0,className:x,size:"sm",variant:f,ref:t,...v,children:(0,n.jsx)(d.PrefetchLinkAndRefreshOnHover,{href:"/chat",onClick:y,children:j("newChatButton.newChat")})})});x.displayName="NewChatButton"},32790:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>l,aR:()=>i,wL:()=>u});var n=a(97667),s=a(33571),r=a(28819);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("shadow-base bg-background-subtle rounded-lg",a),ref:t,...s})});l.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("grid gap-4",a),ref:t,...s})});i.displayName="CardHeader",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("bg-background mb-4 flex h-8 w-8 items-center justify-center rounded-lg border [&>svg]:size-4",a),ref:t,...s})}).displayName="CardIcon";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("h3",{className:(0,r.cn)("whitespace-nowrap font-medium leading-none tracking-tight",a),ref:t,...s})});o.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("p",{className:(0,r.cn)("text-muted-foreground text-sm",a),ref:t,...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("p-6 pt-0",a),ref:t,...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)(" flex items-center p-6 pt-0",a),ref:t,...s})});u.displayName="CardFooter"},33365:(e,t,a)=>{"use strict";a.d(t,{AnimatedIconProvider:()=>l,w:()=>r});var n=a(97667),s=a(33571);let r=(0,s.createContext)(null);function l(e){let{children:t}=e,[a,l]=(0,s.useState)(()=>new Map),i=(0,s.useRef)(null),o=(0,s.useCallback)(e=>{let t=e.target;a.forEach((a,n)=>{if(a.parent.contains(t))switch(e.type){case"mouseover":i.current!==n&&(i.current=n,a.transitionTo("hover"));break;case"mouseout":a.parent.contains(e.relatedTarget)||(i.current=null,a.transitionTo("idle"));break;case"mousedown":a.transitionTo("tap");break;case"mouseup":a.transitionTo(i.current===n?"hover":"idle")}else"mouseover"===e.type&&i.current===n&&(i.current=null,a.transitionTo("idle"))})},[a]);(0,s.useEffect)(()=>(window.addEventListener("mouseover",o,!0),window.addEventListener("mouseout",o,!0),window.addEventListener("mousedown",o,!0),window.addEventListener("mouseup",o,!0),()=>{window.removeEventListener("mouseover",o,!0),window.removeEventListener("mouseout",o,!0),window.removeEventListener("mousedown",o,!0),window.removeEventListener("mouseup",o,!0)}),[o]);let c=(0,s.useCallback)((e,t)=>{l(a=>new Map(a).set(e,t))},[]),d=(0,s.useCallback)(e=>{l(t=>{let a=new Map(t);return a.delete(e),a})},[]);return(0,n.jsx)(r.Provider,{value:{registerIcon:c,unregisterIcon:d},children:t})}},33578:(e,t,a)=>{"use strict";function n(e){return e.startsWith("image/")&&!e.includes("svg")}function s(e){return(e/1048576).toFixed(2).replace(/\.?0+$/,"")+"MB"}a.d(t,{IG:()=>s,Lu:()=>i,Ye:()=>n,lg:()=>l});let r=["text/plain","text/markdown","text/html","application/json","text/csv","text/x-python","application/typescript","text/tsx","text/jsx","text/markdown","text/html","text/css","application/yaml","application/yml","application/sql","application/x-sql","application/xml","message/rfc822"],l=["txt","md","json","csv","py","ts","tsx","js","jsx","log","html","css","yml","yaml","mermaid","mjs","mts","sql","map","xml","eml"];function i(e,t){return r.includes(e)||l.includes(t)}},34034:(e,t,a)=>{"use strict";a.d(t,{YI:()=>b,o8:()=>j,qo:()=>y,uu:()=>w});var n=a(97667),s=a(33571),r=a(57560),l=a(80672),i=a(61149),o=a(48339),c=a(48476),d=a(28819),u=a(36323),m=a(4868),h=a(20125),p=a(19243),x=a(74118),f=a(94475),g=a(28265);let v=(0,r.eU)(!1),j=(0,r.eU)(null);function b(){let[e,t]=(0,l.useAtom)(v),a=(0,u.eu)(),n=null==a?void 0:a.id,r=(0,s.useCallback)(e=>{if(t(e),!n)return;(0,p.u)("DesignModeToggled",{enabled:e});let a=(0,o.j)(n),s=document.getElementById(a);s&&s.contentWindow&&(0,c.q)(s.contentWindow,{type:"devtools_enable",designMode:!0})},[t,n]),{chatId:d}=(0,x.xz)();return(0,s.useEffect)(()=>{r(!1)},[d]),(0,i.A)("design-mode:shortcut",()=>{let e=e=>{let{data:a}=e;a&&"object"==typeof a&&a.__v0_remote__&&"devtools_state"===a.type&&t(a.enabled)},a=e=>{if("KeyD"===e.code&&(e.altKey||e.metaKey)){e.preventDefault();let t=document.querySelector('iframe[data-v0="true"]');t&&t.contentWindow&&(0,c.q)(t.contentWindow,{type:"devtools_enable",designMode:!0})}};return window.addEventListener("message",e),window.addEventListener("keydown",a),()=>{window.removeEventListener("message",e),window.removeEventListener("keydown",a)}}),[e,r]}function y(){let[e]=(0,l.useAtom)(v),[t]=(0,l.useAtom)(j);return e?t?[t,(0,n.jsx)("div",{className:"p-3 pb-0 select-none",children:(0,n.jsxs)("div",{className:"flex w-min items-center justify-center gap-1.5 whitespace-nowrap rounded-md text-blue-700 border border-alpha-200 px-2 py-0.5 text-xs font-semibold bg-blue-100 font-mono",children:[(0,n.jsx)("div",{className:"size-2 rotate-45 border-2 border-blue-700"}),t.name]})},"refinement-tag")]:[t,null]:[null,null]}function w(){let e=(0,f.r)(),t=(0,u.eu)(),a=null==t?void 0:t.id,[s,r]=b(),l=!!(a&&s);return"code-project"!==(null==t?void 0:t.type)?null:(0,n.jsx)(h.Tooltip,{content:(0,n.jsxs)("span",{className:"inline-flex gap-2 items-center",children:[(0,n.jsx)("span",{children:"Design Mode"}),(0,n.jsxs)(g.r,{children:[(0,n.jsx)(g.u,{children:e?"":"Alt"}),(0,n.jsx)(g.u,{children:"D"})]})]}),side:"right",children:(0,n.jsxs)("label",{className:(0,d.cn)("inline-flex cursor-pointer items-center gap-1.5 rounded-md p-1.5 select-none",l?"bg-blue-100":"bg-alpha-400"),children:[(0,n.jsx)(m.Switch,{className:(0,d.cn)("h-3 w-4 border-[1.5px] !bg-transparent p-[1.5px]",l?"border-blue-700":"border-gray-900"),thumbClassName:(0,d.cn)("flex size-1.5 items-center justify-center bg-transparent shadow-none data-[state=checked]:translate-x-[theme(spacing.1)]",l?"!bg-blue-700":"border-[1.5px] border-gray-900"),disabled:!a,checked:l,onCheckedChange:()=>r(!s)}),(0,n.jsx)("span",{className:(0,d.cn)("text-xs",l?"text-blue-700":"text-gray-900"),children:"Design"})]})})}},34623:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});var n=a(97667),s=a(65521),r=a(99647);function l(){return(0,n.jsx)(r.Dp,{variants:{hover:{y:-2,x:-1,rotate:-12}},children:(0,n.jsx)(s.k,{"aria-hidden":!0})})}a(33571)},35129:(e,t,a)=>{"use strict";a.d(t,{O:()=>s});var n=a(70676);let s=(0,n.createServerReference)("6056a8a0a948ac21f7c7950c2ebf970ad21293f271",n.callServer,void 0,n.findSourceMapURL,"forkBlock")},35441:(e,t,a)=>{"use strict";a.d(t,{_:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40ae5cbd356462339d04af8d847d504bab307fcec5",n.callServer,void 0,n.findSourceMapURL,"deleteChat")},35486:(e,t,a)=>{"use strict";a.d(t,{QZ:()=>o,TN:()=>l,br:()=>i});var n=a(97667),s=a(59331);let r=/^#([0-9a-f]{6}|[0-9a-f]{8})$/i;function l(e){return r.test(e)}function i(e){let{value:t,...a}=e;return(0,n.jsxs)("code",{...a,className:"font-mono font-normal before:hidden rounded-[0.375rem] border bg-gray-100 px-[0.15rem] h-5 after:hidden inline-flex items-center gap-0.5 align-middle",children:[(0,n.jsx)("span",{className:"inline-block size-3 rounded-[0.2rem] border",style:{backgroundColor:t}}),t]})}function o(){function e(e){if(-1===e.indexOf("#")||!r.test(e))return e;let t=[];for(;;){let a=r.exec(e);if(!a)break;let n=a[0],s=a.index;s>0&&t.push({type:"text",value:e.substring(0,s)}),t.push({type:"inlineCode",value:n}),e=e.substring(s+n.length)}return e.length>0&&t.push({type:"text",value:e}),t}return t=>{(0,s.T)(t,[[/#([0-9a-f]{6}|[0-9a-f]{8})\b/gi,e]],{ignore:["html","link","linkReference","image","imageReference","code","inlineCode"]})}}},35853:(e,t,a)=>{"use strict";a.d(t,{e:()=>s});var n=a(70676);let s=(0,n.createServerReference)("70f1cdab0590df4c36296b954c26c8fd86e5c4f483",n.callServer,void 0,n.findSourceMapURL,"transformExecutionOutputToEvents")},36259:(e,t,a)=>{"use strict";a.d(t,{i:()=>s});var n=a(70676);let s=(0,n.createServerReference)("402e9270e9786aa0962238fc1894844c8ad20ea5e6",n.callServer,void 0,n.findSourceMapURL,"collectBlockDeployWarnings")},36323:(e,t,a)=>{"use strict";a.d(t,{I4:()=>u,eu:()=>d,oQ:()=>h,y6:()=>m,z6:()=>p});var n=a(76727),s=a(97396),r=a(74118),l=a(33571),i=a(25603),o=a(70182),c=a(45586);function d(e){let{chatId:t}=(0,r.xz)(),{data:a}=(0,i.Ay)(["active-block",null!=e?e:t]);return a}function u(){let{chatId:e}=(0,r.xz)(),{data:t}=(0,i.Ay)(["block-view",e]);return!!t}function m(){let{chatId:e}=(0,r.xz)(),{mutate:t}=(0,o.iX)(),{ensureBlockSource:a}=(0,c.sv)();return(0,l.useCallback)(n=>{(null==n?void 0:n.id)&&a(n.id),t(["active-block",e],null!=n?n:null,!1)},[e,t,a])}function h(){let{chatId:e}=(0,r.xz)(),{mutate:t}=(0,o.iX)();return(0,l.useCallback)((a,n)=>{a?t(["active-block",e],n,!1):t(["active-block",e],null,!1),t(["block-view",e],a,!1)},[e,t])}function p(){let{messages:e}=(0,r.Pk)(),t=d(),a=h(),{ensureBlockSource:i}=(0,c.sv)();return(0,l.useCallback)((r,l)=>{if(!t)return;let o=()=>{let t;if(!l)return void a(!1);let s=-1;for(let a of e.map(e=>{var t;return(0,n.sY)(null!=(t=e.content)?t:"",e.id)}).flat()){if(!a)continue;let e=l.findIndex(e=>e===a.messageId);e>-1&&e>=s&&(s=e,t=a)}if(!t)return void a(!1);i(t.id),a(!0,t)};return r?r===t.messageId?void o():void(new Set((0,s.Ir)(e.map(e=>({...e,messageId:e.id})),r)).has(t.messageId)&&o()):void a(!1)},[t,e,a])}},36380:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});var n=a(33571),s=a(25603);function r(e){let{data:t,mutate:a}=(0,s.Ay)(["block:consoleEvents",e],{fallbackData:{}});return{blockStatus:null!=t?t:{},flagNewEvent:(0,n.useCallback)(t=>a(a=>({...a,[e]:a&&"error"===a[e]?"error":t})),[e,a]),clearEvents:(0,n.useCallback)(()=>a(t=>{let a={...t};return a[e]=null,a}),[e,a])}}},36863:(e,t,a)=>{"use strict";a.d(t,{F:()=>s});var n=a(33571);function s(e){let t=(0,n.useRef)(e);return(0,n.useEffect)(()=>{t.current=e},[e]),t}},37631:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(97667),s=a(66692),r=a(28819);function l(e){let{className:t,outline:a,active:l,...i}=e;return(0,n.jsx)(s.$,{className:(0,r.cn)("size-6 rounded-md",!a&&"text-gray-500",l&&"text-teal-600",t),size:"xs",variant:a?"secondary":"ghost",...i})}},37707:(e,t,a)=>{"use strict";a.d(t,{D:()=>o,FlagsProvider:()=>i});var n=a(97667),s=a(33571),r=a(95995);let l=(0,s.createContext)(null);function i(e){let{children:t,promise:a,middlewareFlags:i}=e,o={};for(let e of i)o[e]=!0;let[c,d]=(0,s.useState)(o);return(0,s.useEffect)(()=>{a.then(e=>{e.ve&&(0,r.W)(),(0,s.startTransition)(()=>{d(e)})})},[a]),(0,n.jsx)(l.Provider,{value:c,children:t})}function o(){let e=(0,s.useContext)(l);if(null===e)throw Error("");return e}},37758:(e,t,a)=>{"use strict";a.d(t,{Bi:()=>d,Dk:()=>p,F5:()=>x,Jc:()=>m,PP:()=>u,Tb:()=>h,eV:()=>i,fY:()=>s,k$:()=>l,o0:()=>o,r2:()=>r,ud:()=>n,uk:()=>c});let n=["upstash","neon","supabase","blob","groq","fal","deepinfra","xai"],s={upstash:"Upstash for Redis",neon:"Neon",supabase:"Supabase",blob:"Blob",groq:"Groq",xai:"Grok",fal:"fal",deepinfra:"Deep Infra","api-key":"Groq"},r={"Upstash for Redis":"upstash",Neon:"neon",Supabase:"supabase",Blob:"blob",Groq:"groq",Grok:"xai",fal:"fal","Deep Infra":"deepinfra"},l={"Upstash for Redis":"database",Neon:"database",Supabase:"database",Blob:"database",Groq:"ai",Grok:"ai",fal:"ai","Deep Infra":"ai"},i={Supabase:"/chat-static/citation/supabase.svg",Neon:"/chat-static/citation/neon.svg","Upstash for Redis":"/chat-static/citation/upstash.svg",blob:"/chat-static/icons/blob-no-background.svg",fal:"/chat-static/icons/fal.svg",Groq:"/chat-static/icons/groq-no-background.svg",Grok:"/chat-static/icons/grok.svg","Deep Infra":"/chat-static/icons/deepinfra.svg"},o=["supabase","neon"],c=["Supabase","Neon"],d={Supabase:["POSTGRES_URL","DATABASE_URL","SUPABASE_URL"],Neon:["POSTGRES_URL","DATABASE_URL"]},u=["Groq","Grok","fal","Deep Infra"],m={Supabase:["SUPABASE_URL","SUPABASE_SERVICE_ROLE_KEY","SUPABASE_ANON_KEY","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY"],Neon:["DATABASE_URL"],"Upstash for Redis":["KV_REST_API_URL","KV_REST_API_TOKEN"],Blob:["BLOB_READ_WRITE_TOKEN"],Groq:["GROQ_API_KEY"],Grok:["XAI_API_KEY"],fal:["FAL_KEY"],"Deep Infra":["DEEPINFRA_API_KEY"]},h={Supabase:["@supabase/supabase-js"],Neon:["@neondatabase/serverless"],"Upstash for Redis":["@upstash/redis"],Blob:["@vercel/blob"],Groq:["@ai-sdk/groq"],Grok:["@ai-sdk/xai"],fal:["@ai-sdk/fal","@fal-ai/serverless-client"],"Deep Infra":["@ai-sdk/deepinfra"]},p=[new Set(o)],x={"edge-config":{title:"Edge Config",description:"Ultra-low latency reads",icon:"/chat-static/icons/edge-config.svg"},blob:{title:"Blob",description:"Fast object storage",icon:"/chat-static/icons/blob.svg"}}},38035:(e,t,a)=>{"use strict";a.d(t,{Fb:()=>i,Og:()=>o,i_:()=>l,ru:()=>r});var n=a(97667),s=a(39849);let r=e=>{let{refinementElements:t,prompt:a}=e,n="<user_request_context>";for(let{file:e,componentName:a,sourceContext:s}of t)n+="\nUser's request is specifically about the file \"".concat(e,'" and the ').concat(a?'"'.concat(a,'" element'):"element"," at this specific position (including its inner content, too):\n\n```\n").concat(s,"\n```\n");return n+"Please apply a Quick Edit to this file and make the necessary changes.\n\n</user_request_context>\n\n<user_request>\n".concat(a,"\n</user_request>\n")},l=(e,t)=>{let a=e.split("<user_request>")[0];return"".concat(a,"\n<user_request>\n").concat(t,"\n</user_request>\n")},i=e=>e&&e.includes("<user_request>")?e.split("<user_request>")[1].split("</user_request>")[0].trim():e,o=e=>{if(!e)return"Refine";let t=e.match(/"([^"]+)" element/);if(!t)return"Refine";let a=e.match(/file "([^"]+)"/);return a?(0,n.jsxs)(n.Fragment,{children:[a[1],(0,n.jsx)(s.c,{className:"-mx-1 size-3"}),t[1]]}):"Refine"}},38383:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(33571);function s(e){let t=(0,n.useRef)();return(0,n.useEffect)(()=>{t.current=e}),t.current}},38509:(e,t,a)=>{"use strict";a.d(t,{cP:()=>o});var n=a(141),s=a(94282),r=a(57560);let l=new Map,i=(0,n.G)(l,()=>({integrationTimeouts:(0,r.eU)({})}));function o(e){let t=i(e);return{startTimeout:(e,a)=>{let n=s.M.get(t.integrationTimeouts);n[e]&&window.clearTimeout(n[e]);let r=window.setTimeout(()=>{a();let n={...s.M.get(t.integrationTimeouts)};delete n[e],s.M.set(t.integrationTimeouts,n)},6e4);s.M.set(t.integrationTimeouts,{...n,[e]:r})},clearTimeout:e=>{let a=s.M.get(t.integrationTimeouts);if(a[e]){window.clearTimeout(a[e]);let n={...a};delete n[e],s.M.set(t.integrationTimeouts,n)}}}}(0,n.G)(new Map,e=>({...i(e)}))},38792:(e,t,a)=>{"use strict";a.d(t,{O:()=>s,k:()=>n});let n={messages:[],isLoading:!1,undo:null,activeForkKey:void 0,isContinuing:!1,isStreaming:!1,isAuthor:!1,isRestoring:!1},s={title:"",isNew:!1,authorId:"",ownerId:""}},39257:(e,t,a)=>{"use strict";a.d(t,{Kx:()=>c});var n=a(74293);n.z.object({id:n.z.string(),title:n.z.string(),description:n.z.string().min(3,"Please provide a description.").max(1e3,"Description cannot be longer than 1000 characters"),source:n.z.object({title:n.z.string(),url:n.z.string(),description:n.z.string().optional()}),code:n.z.string(),createdAt:n.z.string().or(n.z.number()),meta:n.z.object({project:n.z.string(),file:n.z.string()})}).pick({id:!0,title:!0,description:!0,source:!0,code:!0,createdAt:!0,meta:!0});let s=n.z.enum(["registry:style","registry:lib","registry:example","registry:block","registry:component","registry:ui","registry:hook","registry:theme","registry:page","registry:file","registry:internal"]),r=n.z.discriminatedUnion("type",[n.z.object({path:n.z.string(),content:n.z.string().optional(),type:n.z.enum(["registry:file","registry:page"]),target:n.z.string()}),n.z.object({path:n.z.string(),content:n.z.string().optional(),type:s.exclude(["registry:file","registry:page"]),target:n.z.string().optional()})]),l=n.z.object({config:n.z.object({content:n.z.array(n.z.string()).optional(),theme:n.z.record(n.z.string(),n.z.any()).optional(),plugins:n.z.array(n.z.string()).optional()}).optional()}),i=n.z.object({light:n.z.record(n.z.string(),n.z.string()).optional(),dark:n.z.record(n.z.string(),n.z.string()).optional()}),o=n.z.object({$schema:n.z.string().optional(),name:n.z.string(),type:s,title:n.z.string().optional(),author:n.z.string().min(2).optional(),description:n.z.string().optional(),dependencies:n.z.array(n.z.string()).optional(),devDependencies:n.z.array(n.z.string()).optional(),registryDependencies:n.z.array(n.z.string()).optional(),files:n.z.array(r).optional(),tailwind:l.optional(),cssVars:i.optional(),meta:n.z.record(n.z.string(),n.z.any()).optional(),docs:n.z.string().optional(),categories:n.z.array(n.z.string()).optional()});n.z.object({version:n.z.literal(2),id:n.z.string(),payload:o,source:n.z.object({title:n.z.string(),url:n.z.string(),description:n.z.string().optional()}),createdAt:n.z.string().or(n.z.number()),meta:n.z.object({project:n.z.string(),file:n.z.string()})}).pick({id:!0,version:!0,payload:!0,source:!0,createdAt:!0,meta:!0}),o.extend({meta:n.z.object({blockId:n.z.string().optional(),templateId:n.z.string().optional(),images:n.z.array(n.z.object({url:n.z.string(),name:n.z.string(),size:n.z.number()})).optional(),author:n.z.string().min(2,"Author is required and must be at least 2 characters long."),env:n.z.array(n.z.object({name:n.z.string(),url:n.z.string().optional()})).optional()})}),n.z.object({filename:n.z.string().min(1).max(100),file:n.z.instanceof(ArrayBuffer).refine(e=>e.byteLength>0).refine(e=>e.byteLength/1048576<=5)});let c=1e4;n.z.object({blockId:n.z.string(),description:n.z.string().max(c,"Description must be less than ".concat(c," characters.")).optional(),imageUrl:n.z.string().url("Please upload an image for your template.").optional().or(n.z.literal("")),category:n.z.enum(["apps","blocks","components","games","sites","starters"],{required_error:"Category is required",invalid_type_error:"Category is invalid"}),envVarKeys:n.z.array(n.z.string()).optional()}).extend({imageUrl:n.z.string().url("Please upload an image for your template.").nullable().optional()})},40209:(e,t,a)=>{"use strict";a.d(t,{d:()=>i});var n=a(33571),s=a(25603),r=a(74118),l=a(37707);function i(e,t){let{mi:a}=(0,l.D)(),{chatId:i}=(0,r.xz)(),o=(0,n.useRef)(null),c=new URLSearchParams;i&&c.set("chatId",i),c.set("source",e.source),e.messageId&&c.set("messageId",e.messageId);let{data:d,mutate:u,isLoading:m}=(0,s.Ay)(i&&a?"/chat/api/integrations/marketplace/link?".concat(c.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch integration links");return await t.json()},{refreshInterval:e=>3e3*(null!=e&&!!e.shouldContinuePolling),revalidateOnFocus:!0,onSuccess:e=>{let{activeLinks:a}=e;if(0!==a.length){if(o.current){let e=o.current,n=[];for(let t of a){let a=e.find(e=>e.integrationLinkId===t.integrationLinkId);a&&!a.connected&&t.connected&&n.push(t)}n.length>0&&t(n)}o.current=a}}});return{connectedLinks:null==d?void 0:d.connectedLinks,refetchLinks:u,isLoading:m}}},40346:(e,t,a)=>{"use strict";a.d(t,{TooltipProvider:()=>i,ZI:()=>d,k$:()=>c,m_:()=>o});var n=a(97667),s=a(33571),r=a(6130),l=a(19434);let i=r.Kq,o=r.bL,c=r.l9;r.i3;let d=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...i}=e;return(0,n.jsx)(r.ZL,{children:(0,n.jsx)(r.UC,{className:(0,l.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-sm text-primary-foreground shadow-lg animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),ref:t,sideOffset:s,...i})})});d.displayName=r.UC.displayName},40445:(e,t,a)=>{"use strict";function n(e){return!!e&&!("membership"in e)}a.d(t,{W:()=>n})},40711:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(48339),s=a(25603),r=a(36323),l=a(33571),i=a(36863);function o(e){let{data:t,mutate:a}=(0,s.Ay)("browser-frame:canGoBack",{fallbackData:!1}),{data:o,mutate:c}=(0,s.Ay)("browser-frame:canGoForward",{fallbackData:!1}),{data:d,mutate:u}=(0,s.Ay)("browser-frame:href",{fallbackData:""}),{data:m,mutate:h}=(0,s.Ay)("browser-frame:iframe",{fallbackData:null}),{data:p,mutate:x}=(0,s.Ay)("browser-frame:loading",{fallbackData:!0}),{data:f,mutate:g}=(0,s.Ay)("browser-frame:temporalHref",{fallbackData:null}),v=(0,r.eu)(),j=(0,i.F)(d),b=(0,l.useMemo)(()=>e||(null==v?void 0:v.id),[e,v]),y=(0,l.useCallback)(()=>{m&&(m.contentDocument?m.contentDocument.location.reload():j.current?m.src=j.current:m.src=m.src,g(null),x(!0))},[m,j,x,g]);return(0,l.useEffect)(()=>{let e;if(!b)return;let t=(0,n.j)(b),s=document.getElementById(t),r=e=>{let{data:t}=e;if(t&&"object"==typeof t&&t.__v0_remote__)switch(t.type){case"location_change":u(e.data.href),a("boolean"==typeof e.data.canGoBack&&e.data.canGoBack),c("boolean"==typeof e.data.canGoForward&&e.data.canGoForward);break;case"app_navigation_state":x(e.data.loading)}};return window.addEventListener("message",r),s||(e=new MutationObserver(()=>{let a=document.getElementById(t);a&&(null==e||e.disconnect(),h(a))})).observe(document.body,{childList:!0,subtree:!0}),h(s),x(!0),()=>{window.removeEventListener("message",r);try{null==e||e.disconnect()}catch(e){}}},[b,u,x]),{canGoBack:t,setCanGoBack:a,canGoForward:o,setCanGoForward:c,href:d,setHref:u,iframe:m,latestHref:j,loading:p,setLoading:x,refresh:y,temporalHref:f,setTemporalHref:g}}},41199:(e,t,a)=>{"use strict";a.d(t,{M:()=>s});var n=a(97667);function s(e){let{title:t,children:a,titleSuffix:s}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,n.jsxs)("span",{className:"text-label-14 flex items-center justify-between gap-2 font-medium",children:[t,s]}),(0,n.jsx)("span",{className:"text-label-14 text-gray-500",children:a})]})}},41416:(e,t,a)=>{"use strict";a.d(t,{M:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40675172741d20977ba28dcb706fb40a9d8847a530",n.callServer,void 0,n.findSourceMapURL,"assignProjectToChat")},42438:(e,t,a)=>{"use strict";a.d(t,{C:()=>s,j:()=>r});var n=a(33571);async function s(e){return"writeText"in navigator.clipboard&&!!e&&(await navigator.clipboard.writeText(e),!0)}function r(e){let{timeout:t=2e3}=e,[a,r]=n.useState(!1);return{isCopied:a,copyToClipboard:async e=>{await s(e)&&(r(!0),setTimeout(()=>{r(!1)},t))}}}},43434:(e,t,a)=>{"use strict";a.d(t,{f:()=>d});var n=a(97396),s=a(70731),r=a(25603),l=a(74118),i=a(33571);let o={};async function c(e,t){let{arg:a}=t,s=(0,n.K1)(a.activeForkKey);if(s)return fetch(e,{method:"POST",body:JSON.stringify({chatId:a.chatId,messageId:s})}).then(e=>e.json())}function d(){let{chatId:e}=(0,l.xz)(),{trigger:t}=(0,s.A)("/chat/api/chat/leaf",c),{data:a,mutate:n}=(0,r.Ay)(["chat:leaf:cache",e],null),d=(0,i.useCallback)(e=>{n(t=>{if(!e)return t;let a=!1,n={...t||o};for(let t of e)n[t]!==e&&(n[t]=e,a=!0);return a?n:t})},[n]);return{cacheForkKey:d,saveLeafMessageId:(0,i.useCallback)(e=>{let{chatId:a,activeForkKey:n}=e;a&&t({chatId:a,activeForkKey:n})},[t]),forkKeyCache:a||o,switchForkKey:d}}},43809:(e,t,a)=>{"use strict";a.d(t,{X:()=>o});var n=a(97667);a(33571);var s=a(28819),r=a(32707),l=a(71543),i=a(88404);function o(e){let{preventPeek:t=!1,className:a,...o}=e,{expectUser:c}=(0,l.J)(),{startPeeking:d,stopPeeking:u,stopPeekingForced:m}=(0,i._2)("skeleton");return c?(0,n.jsx)("div",{onMouseEnter:t?void 0:d,onMouseLeave:t?void 0:u,className:(0,s.cn)("flex",a),children:(0,n.jsx)(r.NewChatButton,{onClick:()=>m({onlyOnCollapsed:!0}),variant:"v3-logo",className:"border-0",...o})}):null}},44557:(e,t,a)=>{"use strict";a.d(t,{Sn:()=>U,h5:()=>R});var n=a(97667),s=a(32376),r=a(99542),l=a(16979),i=a(93660),o=a(80381),c=a(35501),d=a.n(c),u=a(80672),m=a(33571),h=a(81614),p=a(93187),x=a(80574),f=a(7104),g=a(60914),v=a(20630);let j=new Map;function b(e){let{deploymentId:t}=e,a=function(){let e=(0,m.useRef)(null),t=(0,m.useRef)(!0);return(0,m.useEffect)(()=>{let a=e.current;if(!a)return;let n=()=>{let{scrollHeight:e,scrollTop:n,clientHeight:s}=a;t.current=e-n-s<200},s=()=>{if(e.current&&t.current){let{scrollHeight:t,scrollTop:a,clientHeight:n}=e.current;e.current.scrollTo({top:e.current.scrollHeight,behavior:t-a-n>700?"auto":"smooth"})}},r=new ResizeObserver(s),l=new MutationObserver(s);return a.addEventListener("scroll",n),r.observe(a),l.observe(a,{childList:!0,subtree:!0,characterData:!0}),s(),()=>{a.removeEventListener("scroll",n),r.disconnect(),l.disconnect()}},[]),e}(),{logs:s,data:r}=function(e){let{deploymentId:t}=e,[a,n]=(0,m.useState)(void 0),{data:s}=(0,v.B)(["deployment","logs"],{deploymentId:t,since:a},{refreshInterval:1e3,keepPreviousData:!0}),[r,l]=(0,m.useState)([]),i=(0,m.useRef)(new Map);return(0,m.useEffect)(()=>{j.has(t)||j.set(t,new Map),i.current=j.get(t)},[t]),(0,m.useEffect)(()=>{var e;s&&(n(s.nextSince),(null!=(e=s.logs)?e:[]).forEach(e=>{e.id&&i.current.set(e.id,e)}),l(Array.from(i.current.values())))},[s]),{logs:r,data:s}}({deploymentId:t}),o=(0,m.useMemo)(()=>r&&0!==s.length?r.logs?(0,n.jsx)("div",{className:"text-label-13-mono flex flex-col",children:s.map(e=>{var t;let a=e.date?new Date(e.date).toTimeString().split(" ")[0]:null;return(0,n.jsxs)("span",{className:y({level:null!=(t=e.level)?t:"info"}),children:[a?(0,n.jsx)("span",{"data-timestamp":!0,className:"mr-2",children:a}):null,(0,n.jsx)("span",{className:"overflow-wrap-anywhere break-all",children:e.text})]},e.id)})}):(0,n.jsx)(h.p,{title:"Unable to fetch logs",variant:"error",icon:(0,n.jsx)(l.V,{}),children:"There was an error deploying your chat. Please try again."}):(0,n.jsx)(i.E,{className:"h-full w-full"}),[r,s]);return(0,n.jsx)("div",{className:"no-scrollbar flex h-full w-full flex-col overflow-y-scroll",ref:a,children:o})}let y=(0,g.F)("relative flex flex-row items-start px-2 py-[2px] first:pt-1 last:pb-1",{variants:{level:{info:"text-gray-700",error:"bg-red-50 text-red-700",warning:"bg-amber-50 text-amber-700"}}});var w=a(53849),N=a(27831),k=a(55270),C=a(66692);function S(e){let{deploymentId:t}=e,a=(0,f.WV)(t),{deployment:c,error:g}=(0,u.useAtomValue)(a.status),v=(0,u.useAtomValue)(a.state),j=(0,u.useAtomValue)((0,k.K9)().isPointerDown),y=(0,m.useMemo)(()=>{if(g&&g!==p.p2)return(0,n.jsx)(h.p,{title:"Failed to fetch deployment",variant:"error",icon:(0,n.jsx)(l.V,{}),children:"There was an error fetching your deployment."});switch(v){case"queued":case"deploying":if("queued"===v){if(!c)return null;return(0,n.jsx)(d(),{href:c.inspectorUrl,target:"_blank",children:(0,n.jsxs)(C.$,{variant:"ghost",children:["View on Vercel",(0,n.jsx)(r.F,{})]})})}return(0,n.jsxs)("div",{className:"text-label-14 flex items-center justify-center gap-2 text-gray-500",children:[(0,n.jsx)(x.y,{size:16}),(null==c?void 0:c.git)?"Pushing changes...":"Deploying..."]});case"building":case"failed":case"error":if(!c)return null;return(0,n.jsxs)("div",{className:"group relative h-full w-full",children:[(0,n.jsx)(b,{deploymentId:c.id}),(0,n.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-0 h-[64px] bg-gradient-to-t from-[#00000022] to-transparent opacity-0 group-hover:opacity-100",style:{...(0,N.iA)(["opacity"]),opacity:j?0:void 0}}),(0,n.jsx)("div",{className:"z-100 flex translate-y-[32px] scale-95 items-center justify-center group-hover:translate-y-0 group-hover:scale-100",style:{...(0,N.iA)(["transform","opacity"]),opacity:j?0:void 0},children:(0,n.jsxs)(d(),{href:c.inspectorUrl,target:"_blank",className:"z-90 material-menu text-label-13 absolute bottom-2 flex items-center gap-1 whitespace-nowrap rounded-full px-2 py-1 font-medium text-gray-900 transition-all hover:bg-gray-100",children:["View logs on Vercel",(0,n.jsx)(r.F,{})]})})]});case"deployed":case"not-deployed":return(0,n.jsxs)("div",{className:"group relative flex h-full w-full items-center justify-center overflow-hidden",children:[(null==c?void 0:c.screenshotUrl)?(0,n.jsx)(o.default,{src:c.screenshotUrl,alt:"Deployment Card Preview",width:480,height:360,className:"absolute h-full w-full object-cover transition-all duration-300 group-hover:scale-105"}):(0,n.jsx)(i.E,{}),(null==c?void 0:c.url)&&(0,n.jsx)(d(),{href:"https://".concat(c.bestDomain),target:"_blank",className:"group z-10 flex h-full w-full items-center justify-center bg-gradient-to-t from-[#00000066] to-transparent",children:(0,n.jsxs)("span",{className:"bg-background text-label-14 flex h-8 w-fit items-center gap-2 rounded-md px-2 font-medium group-hover:bg-gray-100",children:["Visit Site",(0,n.jsx)(s.i,{})]})})]});default:return(0,n.jsx)(h.p,{icon:!0,title:"No Preview Available"})}},[g,v,j,c]),S=(0,m.useMemo)(()=>g?"error":v,[g,v]);return(0,n.jsx)(w._r,{renderKey:S,style:{width:"100%"},duration:.6,exit:{scale:.97},enter:{scale:1.01},children:(0,n.jsx)("div",{className:"border-alpha-400 bg-muted relative flex h-[200px] w-full items-center justify-center overflow-hidden rounded-md border",children:y})})}var M=a(20125),I=a(28819),A=a(19434);function D(e){let{title:t,children:a,className:s,...r}=e;return(0,n.jsxs)("div",{className:(0,A.cn)("flex min-w-0 flex-col items-start gap-1 overflow-hidden",s),...r,children:[t?(0,n.jsx)(D.Title,{children:t}):null,a]})}D.Title=function(e){let{children:t}=e;return(0,n.jsx)("span",{className:"text-label-14 text-gray-500",children:t})},D.Item=function(e){let{children:t,Icon:a,mono:s=!1,className:r,...l}=e;return(0,n.jsxs)("div",{className:(0,A.cn)("flex h-5 w-full min-w-0 items-center gap-2 [&>*]:truncate [&_a:hover]:underline",s?"text-label-13-mono":"text-label-14",r),...l,children:[a?(0,n.jsx)("span",{className:"min-w-4 text-gray-500",children:(0,n.jsx)(a,{className:"flex-none"})}):null,t]})},D.ItemSkeleton=function(e){let{width:t}=e;return(0,n.jsx)(D.Item,{children:(0,n.jsx)(i.E,{className:"h-4 w-full",style:{width:t}})})};var L=a(44812),z=a(57025),E=a(99339),P=a(79844);function T(e){let{deploymentId:t}=e,a=(0,f.WV)(t),{deployment:s}=(0,u.useAtomValue)(a.status),l=(0,m.useMemo)(()=>{if(!s)return(0,n.jsx)(D,{children:(0,n.jsx)(D.Item,{children:"No domains available"})});let e=s.filteredAliases.filter(e=>e.alias!==s.bestDomain);return(0,n.jsx)(D,{title:s.git?"Domain":"",children:(0,n.jsx)(D.Item,{children:s.bestDomain!==R&&s.bestDomain?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d(),{href:(0,I.sT)(s.bestDomain),target:"_blank",children:s.bestDomain}),(0,n.jsx)(r.F,{className:"-ml-1 min-w-4"}),e.length?(0,n.jsx)(M.Tooltip,{delayDuration:200,disableHoverableContent:!1,content:(0,n.jsx)("div",{className:"flex flex-col gap-1 px-1.5",children:(0,n.jsx)("ul",{children:e.map(e=>(0,n.jsxs)("li",{className:"flex items-center justify-center space-x-1 text-[11px]",children:[(0,n.jsx)("a",{href:(0,I.sT)(e.alias),target:"_blank",className:"hover:underline",children:e.alias}),(0,n.jsx)(r.F,{className:"min-w-4"})]},e.alias))})}),children:(0,n.jsxs)("span",{className:"flex h-6 w-6 cursor-default select-none items-center justify-center rounded-full bg-gray-100 text-[10px] font-medium text-gray-600",children:["+",e.length]})}):null]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E,{className:"h-4 w-[180px]"}),(0,n.jsx)(r.F,{className:"-ml-1 min-w-4"})]})})})},[s]),o=(0,m.useMemo)(()=>{let e=null==s?void 0:s.git;if(e){let a=e.ref,s=e.sha,r="https://github.com/".concat(e.ownerName,"/").concat(e.repoName),l="".concat(r,"/tree/").concat(a),o="".concat(r,"/commit/").concat(s),c=(0,n.jsx)("span",{className:"text-label-13-mono",children:s.substring(0,7)});return(0,n.jsxs)(D,{title:"Source",children:[(0,n.jsx)(D.Item,{Icon:L.Z,children:(0,n.jsx)(d(),{href:l,target:"_blank",className:"text-label-13-mono",children:a})}),(0,n.jsxs)(D.Item,{Icon:z.Y,children:[s===R?(0,n.jsx)(i.E,{className:"h-4 select-none text-transparent",children:c}):(0,n.jsx)(d(),{href:o,target:"_blank",className:"inline-flex gap-2",children:c}),(0,n.jsx)("span",{children:""}),(0,n.jsx)(F,{shortHand:!0,deploymentId:t})]})]})}return(0,n.jsx)(D,{children:(0,n.jsx)(D.Item,{children:(0,n.jsx)(F,{deploymentId:t})})})},[null==s?void 0:s.git,t]);return(0,n.jsx)(w._r,{...w.fG.fade,renderKey:t,childClassName:"overflow-hidden",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[l,o]})})}function F(e){let{deploymentId:t,shortHand:a=!1}=e,s=(0,f.WV)(t),{deployment:r}=(0,u.useAtomValue)(s.status),[l,i]=(0,m.useState)(0);return((0,m.useEffect)(()=>{if(!(null==r?void 0:r.createdAt))return;let e=setInterval(()=>{r.createdAt>Date.now()-65e3&&i(l+1)},200);return()=>clearInterval(e)},[r,l,i]),r&&r.creator)?(0,n.jsxs)("div",{className:"text-label-14 flex items-center gap-1.5 tabular-nums",children:[(0,n.jsxs)("span",{children:[a?null:"Last updated ",0===r.createdAt?"Just now":(0,P.f)(new Date(r.createdAt),!0,Date.now(),!1)]}),(0,n.jsx)(E.AvatarUser,{userId:r.creator.uid,rounded:!0,size:"xs"}),(0,n.jsx)("span",{className:"font-medium",children:r.creator.username})]}):null}let R="LOADING_SKELETON";function U(e){let{deploymentId:t,stopFetch:a=!1}=e;return(0,n.jsx)(m.Suspense,{fallback:(0,n.jsx)(i.E,{className:"h-[200px] w-full"}),children:(0,n.jsx)(V,{deploymentId:t,stopFetch:a})})}function V(e){let{deploymentId:t,stopFetch:a=!0}=e;return(0,v.B)(["deployment","status"],{deploymentId:t},{stopFetch:a}),(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)(S,{deploymentId:t}),(0,n.jsx)(T,{deploymentId:t})]})}},44606:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,P:()=>o});var n=a(2230);let s=(0,n.nV)(),r=(0,n.sP)("chat"),l=(0,n.sP)("scoped"),i=(0,n.sP)("project"),o={chat:r,scoped:l,deployment:(0,n.sP)("deployment"),project:i},c=s},44825:(e,t,a)=>{"use strict";a.d(t,{Q:()=>r});var n=a(97667),s=a(95352);function r(){return(0,n.jsx)("div",{className:"bg-muted flex aspect-square w-full items-center justify-center rounded-xl",children:(0,n.jsxs)("div",{className:"relative flex size-12 items-center justify-center",children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-full border-[2px] border-gray-200"}),(0,n.jsx)("div",{className:"animate-spin-slow absolute inset-0 rounded-full border-[2px] border-transparent border-t-gray-500"}),(0,n.jsx)("div",{className:"text-3xl text-gray-400",children:(0,n.jsx)(s._,{})})]})})}},45586:(e,t,a)=>{"use strict";a.d(t,{DK:()=>A,Mu:()=>I,P6:()=>C,f8:()=>D,sv:()=>S});var n=a(97667),s=a(33571),r=a(74118),l=a(76727),i=a(36323),o=a(25603),c=a(70182),d=a(13653),u=a(68163),m=a(79844),h=a(79463),p=a(91220),x=a(66692),f=a(81966),g=a(28488),v=a(97396),j=a(28819),b=a(50904),y=a(25296),w=a(17209),N=a(86943),k=a(70731);let C=e=>{let{blockId:t,searchAll:a=!1}=e,{messages:n,activeForkKey:i,chatId:c}=(0,r.Pk)(),{data:d,mutate:u}=(0,o.Ay)(["blocks:overrides",c]),{blocks:m}=(0,s.useMemo)(()=>(function(e){let{messages:t,overrides:a}=e,n=[];for(let e of t)if("assistant"===e.role){var s;let t=(0,l.sY)(e.content,e.id);for(let r of(e.isContentLoading&&(null==(s=e.loadingBlocks)?void 0:s.length)&&n.push(...e.loadingBlocks),t)){let e=null==a?void 0:a[r.id],t={...r,...e};N.kX.includes(t.type)||n.push(t)}}return{blocks:n}})({messages:n,overrides:d}),[d,n]),{allBlocks:h,thisBlock:p}=(0,s.useMemo)(()=>{let e=m.find(e=>e.id===t);if(a)return{allBlocks:m,thisBlock:e};let n=new Set(i);return{allBlocks:m.filter(e=>!!e.messageId&&n.has(e.messageId)),thisBlock:e}},[m,a,i,t]),x=(0,s.useCallback)(e=>{let{blockId:t,data:a}=e;u(e=>({...e,[t]:{...null==e?void 0:e[t],...a}}))},[u]),{projectBlocks:f,activeProject:g,activeVersionIndex:v,activeBlockIndex:j,blockVersions:b}=(0,s.useMemo)(()=>{let e,a,n={},s=-1;for(let r of h){if(N.kX.includes(r.type))continue;let l=r.meta.project||"";n[l]||(n[l]=[]),r.id===t&&(e=l,a=r.meta.file,s=n[l].length),n[l].push(r)}let r=[],l=-1,i=n[e||""];for(let s=0;s<(i?i.length:0);s++){let i=n[e||""][s];i.id===t&&(l=r.length),i.meta.file===a&&r.push(i)}return{blockVersions:r,projectBlocks:n,activeProject:e,activeBlockIndex:s,activeVersionIndex:l}},[h,t]),y=(0,s.useCallback)(async e=>{let[t,a]=e,n=h.find(e=>e.id===a),s=v>0?b[v-1]:void 0;if(!(null==n?void 0:n.needsBlockSource)&&!(null==s?void 0:s.needsBlockSource))return null==n?void 0:n.source;let[r,l]=await Promise.all([(null==n?void 0:n.needsBlockSource)?M(a):null==n?void 0:n.source,(null==s?void 0:s.needsBlockSource)?M(s.id):void 0]);return r&&x({blockId:a,data:{source:r,needsBlockSource:!1}}),s&&l&&x({blockId:s.id,data:{source:l,needsBlockSource:!1}}),r},[v,h,b,x]),{trigger:w,isMutating:C}=(0,k.A)(t?["block:source",t]:null,y,{optimisticData:null==p?void 0:p.source});return{history:b,allBlocks:h,latestSource:null==p?void 0:p.source,projectBlocks:g&&g in f?f[g]:[],projectBlockIndex:j,project:g,currentBlockIndex:v,updateBlockData:x,ensureBlockSource:w,isLoadingBlockSource:C}};function S(){let{mutate:e}=(0,c.iX)();return{ensureBlockSource:(0,s.useCallback)(t=>{e(["block:source",t])},[e])}}async function M(e){let t=await fetch("/chat/api/blocks/source?blockId=".concat(e),{headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch block source");let{source:a}=await t.json();return a}function I(e){let{blockId:t,separator:a=!0}=e,{history:l,currentBlockIndex:o}=C({blockId:t,searchAll:!0}),{messages:c,activeForkKey:d}=(0,r.Pk)(),N=(0,r.jo)(),k=(0,i.y6)(),{getBlockCreatedAt:S}=(0,h.y)(),M=(0,i.eu)(),{setPulsePreview:I}=D(),{getBlockDeployed:A}=(0,b.G)(),[L,z]=(0,s.useState)(!1),[E,P]=(0,s.useState)(Date.now()),T=(0,s.useCallback)(e=>{z(e),P(Date.now())},[]),{scrollToHash:F}=(0,g.r)();return l.length<=1?(0,n.jsx)("div",{className:"no-block-history hidden"}):(0,n.jsxs)(n.Fragment,{children:[a?(0,n.jsx)(f.Separator,{className:"mx-1.5 h-[22px]",orientation:"vertical"}):null,(0,n.jsx)("div",{className:"block-history flex gap-1",onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),children:(0,n.jsxs)(p.l6,{open:L,onOpenChange:T,value:null==M?void 0:M.id,onValueChange:e=>{let t=l.find(t=>t.id===e);if((null==t?void 0:t.isLoading)||(k(t),!(null==t?void 0:t.messageId)))return;let a=c.map((e,t)=>({...e,parentId:e.parentId||null,createdAt:new Date(t),messageId:e.id})),n=(0,v.n1)(a,t.messageId);d&&!d.includes(t.messageId)&&N({activeForkKey:n}),I({blockId:t.id}),F(t.messageId,150,!0,n)},children:[(0,n.jsx)(x.$,{variant:"secondary",size:"sm",className:"h-7 rounded-md px-1.5",asChild:!0,children:(0,n.jsx)(p.bq,{hideChevron:!0,children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsxs)("span",{children:["v",o+1]}),(0,n.jsx)(u.X,{})]})})}),(0,n.jsx)(p.gC,{align:"end",className:"max-h-[280px] w-[245px]",children:l.toReversed().map((e,t)=>{let a=null==d?void 0:d.includes(e.messageId);return(0,n.jsx)(p.eb,{iconOnRight:!0,value:e.id,disabled:e.isLoading,className:(0,j.cn)("px-2 py-1.5",!a&&!e.isLoading&&"text-gray-500 hover:text-gray-500 focus:text-gray-500"),children:(0,n.jsxs)("div",{className:"flex flex-col items-start",children:[(0,n.jsxs)("div",{className:(0,j.cn)("flex items-center gap-2 font-medium"),children:[(0,n.jsxs)("div",{children:["Version ",l.length-t]}),A(e.id)?(0,n.jsxs)(w.E,{children:[(0,n.jsx)(y.q,{size:12})," Deployed"]}):null]}),(0,n.jsx)("div",{className:(0,j.cn)("text-[13px] text-gray-500",!a&&!e.isLoading&&"text-gray-400"),children:S(e.id)?(0,m.f)(new Date(S(e.id)),!0,E):"Just now"})]})},e.id)})})]})})]})}function A(e){let{blockId:t}=e,{data:a}=(0,o.Ay)(["pulse-preview",t],null,{fallbackData:!1});return{pulsePreview:null!=a&&a}}function D(){return{setPulsePreview:(0,s.useCallback)(e=>{let{blockId:t}=e;(0,d.k)(["pulse-preview",t],!0),setTimeout(()=>(0,d.k)(["pulse-preview",t],!1),2e3)},[])}}},45650:(e,t,a)=>{"use strict";a.d(t,{ThemeProvider:()=>o,D:()=>c});var n=a(97667),s=a(33571);"(function() {\n  !function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()\n  var html = document.documentElement;\n  var meta = document.querySelector('meta[name=\"theme-color\"]');\n  if (!meta) {\n    meta = document.createElement('meta');\n    meta.setAttribute('name', 'theme-color');\n    document.head.appendChild(meta);\n  }\n  function updateThemeColor() {\n    window.themeClass = html.className;\n    var isDark = html.classList.contains('dark');\n    meta.setAttribute('content', isDark ? '".concat("hsl(240deg 3% 6%)","' : '").concat("hsl(0 0% 100%)","');\n  }\n  var observer = new MutationObserver(updateThemeColor);\n  observer.observe(html, { attributes: true, attributeFilter: ['class'] });\n  updateThemeColor();\n})();");let r=()=>{!function(){!function(){try{let e=document.documentElement,t=e.classList;t.remove("light","dark");let a=localStorage.getItem("theme");if("system"!==a&&a)a&&t.add(a||"");else{let a="(prefers-color-scheme: dark)",n=window.matchMedia(a);n.media!==a||n.matches?(e.style.colorScheme="dark",t.add("dark")):(e.style.colorScheme="light",t.add("light"))}("light"===a||"dark"===a)&&(e.style.colorScheme=a)}catch(e){}}();let e=document.documentElement,t=document.querySelector('meta[name="theme-color"]');function a(){window.themeClass=e.className;let a=e.classList.contains("dark");null==t||t.setAttribute("content",a?"${DARK_THEME_COLOR}":"${LIGHT_THEME_COLOR}")}t||((t=document.createElement("meta")).setAttribute("name","theme-color"),document.head.appendChild(t)),new MutationObserver(a).observe(e,{attributes:!0,attributeFilter:["class"]}),a()}()},l=(0,s.createContext)({theme:"",setTheme:e=>{}}),i=e=>{window.themeClass=e,document.documentElement.className=e,document.documentElement.style.colorScheme=e};function o(e){let{children:t}=e,a="";a=localStorage.getItem("theme")||document.documentElement.className||"";let[o,c]=(0,s.useState)(a),d=(0,s.useMemo)(()=>({theme:o,setTheme:e=>{try{localStorage.setItem("theme",e)}catch(e){console.error(e)}let t=e;"system"===e&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),i(t),c(e)}}),[o,c]);return(0,s.useEffect)(()=>{r()},[]),(0,s.useEffect)(()=>{if("system"!==d.theme)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{"system"===d.theme&&i(e.matches?"dark":"light")};return e.addEventListener("change",t),t(e),()=>e.removeEventListener("change",t)},[d]),(0,n.jsx)(l.Provider,{value:d,children:t})}function c(){return(0,s.useContext)(l)}},45738:(e,t,a)=>{"use strict";a.d(t,{QP:()=>p,WZ:()=>m,v:()=>h});var n=a(97667),s=a(66692),r=a(74118),l=a(47540),i=a(39929),o=a(29209),c=a(7107),d=a(67714),u=a(28819);function m(e){let{messageId:t}=e,{chatId:a}=(0,r.xz)(),s=new URL("/chat/internal/chats",window.location.origin);return a?(s.searchParams.set("chatId",a),s.searchParams.set("messageId",t),(0,n.jsx)(l.N,{external:!0,href:s.toString(),children:(0,n.jsxs)(i.DropdownMenuItem,{children:[(0,n.jsx)(o.w,{})," View Internal Page"]})})):null}function h(e){let{chatId:t,className:a}=e;if(!t)return null;let r=new URL("/chat/internal/chats",window.location.origin);return r.searchParams.set("chatId",t),(0,n.jsx)(s.$,{onClick:()=>{window.open(r.href,"_blank")},className:(0,u.cn)("size-7 rounded-md",a),size:"sm",tooltip:{side:"bottom",content:"View Internal Page (AI Team Only)"},variant:"ghost",children:(0,n.jsx)(o.w,{})})}function p(e){let{chatId:t,messageId:a}=e;return t?(0,n.jsx)(l.N,{external:!0,href:(0,c.P)({chatId:t,messageId:a}),children:(0,n.jsxs)(i.DropdownMenuItem,{children:[(0,n.jsx)(d.A,{})," View in Braintrust"]})}):null}},47277:(e,t,a)=>{"use strict";a.d(t,{P:()=>f});var n=a(97667),s=a(33571),r=a(19434),l=a(17773),i=a(84089),o=a(55762),c=a(66692),d=a(13729),u=a(12507),m=a(56505),h=a(70158),p=a(25951),x=a(27831);function f(e){let{initialTitle:t,projectId:a,canEditProjectName:f}=e,{projectName:g,updateProjectName:v}=(0,p.OT)(),[j,b]=(0,s.useState)(g||t),[y,w]=(0,s.useState)(!1),[N,k]=(0,s.useState)(!1),[C,S]=(0,s.useState)(!1),M=(0,h.useRouter)(),I=(0,s.useRef)(g||t),A=(0,s.useRef)(null);(0,s.useEffect)(()=>{y||(b(g||t),I.current=g||t)},[g,t,y]),(0,s.useEffect)(()=>{var e;y&&(null==(e=A.current)||e.focus())},[y]);let D=()=>{f&&(w(!0),S(!1),I.current=j)},L=()=>{w(!1),S(!1),b(I.current)};async function z(e){k(!0);let t=e.get("name"),n=I.current;if(w(!1),b(t),t===n)return void k(!1);v(t),d.o.success("Renamed project");try{let e=await (0,m.o)({projectId:a,name:t});if(!("success"in e)&&e.error)throw Error(e.error)}catch(e){v(n),b(n),w(!0),(0,u.z)(e,M,"Failed to rename project")||d.o.error("Failed to rename project")}k(!1)}let E=(0,n.jsxs)("div",{className:"relative z-10 h-8 min-w-4",children:[(0,n.jsx)("input",{autoComplete:"off",className:(0,r.cn)("absolute inset-0 h-8 max-w-96 translate-y-[0.5px] whitespace-pre border-b text-xl font-semibold leading-relaxed tracking-tight focus:!border-gray-500 focus:outline-none",!y&&"hidden"),"data-1p-ignore":!0,disabled:!y,id:"name",name:"name",onChange:e=>b(e.target.value),onKeyDown:e=>{"Escape"===e.key&&L()},ref:A,value:j}),(0,n.jsx)("button",{type:"button",disabled:!f,onClick:D,className:(0,r.cn)("size-fit min-w-0 max-w-72 overflow-hidden truncate text-left text-xl font-semibold leading-relaxed tracking-tight sm:max-w-96",f?"cursor-pointer":"pointer-events-none",y&&"invisible"),id:"name",children:(0,n.jsx)("h1",{className:(0,r.cn)("truncate whitespace-pre",!f&&"pointer-event-auto"),children:j})})]}),P=y?(0,n.jsxs)("div",{className:"mb-0.5 flex gap-2",style:{...(0,x.iA)(["transform","opacity"]),transform:"translateX(0)",opacity:1},children:[(0,n.jsx)("div",{children:(0,n.jsx)(c.$,{"aria-label":"Update",className:"size-7",disabled:N,type:"submit",variant:"ghost",children:(0,n.jsx)(l.J,{className:"size-4"})})}),(0,n.jsx)(c.$,{"aria-label":"Cancel",className:"size-7",onClick:L,onTouchStart:L,type:"button",variant:"ghost",children:(0,n.jsx)(i.F,{className:"size-4"})})]}):(0,n.jsx)(c.$,{"aria-label":"Edit Project Name",className:(0,r.cn)("absolute -right-9 mb-0.5 inline-flex size-7",!C&&"pointer-events-none"),onClick:D,type:"button",variant:"ghost",inert:!C,style:{...(0,x.iA)(["opacity","transform"]),opacity:+!!C,transform:"translateX(".concat(C?0:-28,"px)")},children:(0,n.jsx)(o.g,{className:"size-3.5"})});return(0,n.jsx)("form",{"data-is-editing":y,className:(0,r.cn)("peer",C&&"pr-9"),onSubmit:async e=>{e.preventDefault();let t=new FormData(e.currentTarget);await z(t)},onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&y&&e.currentTarget.requestSubmit()},onMouseEnter:()=>{f&&S(!0)},onMouseLeave:()=>S(!1),children:(0,n.jsxs)("div",{className:"relative flex items-center gap-2",children:[E,P]})})}},48118:(e,t,a)=>{"use strict";a.d(t,{NewProjectButton:()=>y});var n=a(97667),s=a(66692),r=a(28819),l=a(35501),i=a.n(l),o=a(37879),c=a(40767),d=a(27693),u=a(83195),m=a(93660),h=a(73655),p=a(56712),x=a(86943),f=a(16894),g=a(33571),v=a(16292),j=a(13729),b=a(25887);function y(e){let{variant:t,onAfterClick:a,className:l,numProjects:y,quickCreate:w=!1,projectName:N,onSuccess:k,assignToChatId:C,withIcon:S,...M}=e,I=(0,d.k)(),{activeScope:A}=(0,h.k6)(),{planSlug:D}=(0,u.N)(!0,null==A?void 0:A.id),[L,z]=(0,g.useState)(!1),E=D&&("v0-level0"!==D||y<x.AB),{setShowQuickProjectCreateDialog:P}=(0,p.A)(),T=(0,g.useCallback)(async()=>{if(N){z(!0);try{let{errors:t}=await (0,f.g)({projectName:N,onSuccess:k,chatId:C});if(t){var e;j.o.error(null!=(e=t.name[0])?e:"Failed to create project.")}}finally{z(!1)}}},[N,k,C]);return E||void 0!==D?E?w&&N?(0,n.jsxs)(v.x,{className:(0,r.cn)(l),pending:L,onClick:T,size:"sm",variant:t,...M,children:[S&&(0,n.jsx)(c.F,{}),I("project.createDialog.newProjectButton")]}):w?(0,n.jsxs)(s.$,{className:(0,r.cn)(l),onClick:()=>{P(!0)},size:"sm",variant:t,...M,children:[S&&(0,n.jsx)(c.F,{}),I("project.createDialog.newProjectButton")]}):(0,n.jsx)(s.$,{className:(0,r.cn)(l),size:"sm",variant:t,...M,asChild:!0,children:(0,n.jsxs)(i(),{className:(0,r.cn)(l),href:"/chat/projects/new",onClick:a,children:[S&&(0,n.jsx)(c.F,{}),I("project.createDialog.newProjectButton")]})}):(0,n.jsxs)(s.$,{className:(0,r.cn)(l),"data-testid":"new-project-upgrade-button",onClick:()=>{(0,b.D)({type:"upgradePlan"}),null==a||a()},size:"sm",type:"button",children:[(0,n.jsx)(o.l,{}),I("project.createDialog.upgradePlan")]}):(0,n.jsx)(m.E,{className:(0,r.cn)("h-8 w-24",l)})}},48315:(e,t,a)=>{"use strict";a.d(t,{CG:()=>g,ES:()=>C,OQ:()=>k,Pg:()=>b,Qn:()=>S,SidebarContent:()=>f,SidebarHeader:()=>x,W0:()=>y,ms:()=>N,rY:()=>j,ux:()=>v,vP:()=>M});var n=a(97667);a(33571);var s=a(28819),r=a(65994),l=a(3576),i=a(70158),o=a(97950),c=a(53663),d=a(99715),u=a(93660),m=a(88404),h=a(99999);let p="flex flex-col items-stretch p-2";function x(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(p,"gap-3",t),...a})}function f(e){let{className:t,...a}=e,{showTopBorder:r,showBottomBorder:l,containerRef:i,topRef:o,bottomRef:d}=(0,c.Y)("vertical");return(0,n.jsxs)("div",{className:(0,s.cn)(p,"flex-1 overflow-y-auto border-y border-transparent transition-[border-color]",{"border-t-gray-200":r},"has-[.recents-skeleton]:border-b-gray-200",t),ref:i,...a,children:[(0,n.jsxs)("div",{className:"relative flex h-fit w-full flex-col gap-4",children:[(0,n.jsx)("div",{ref:o,className:"absolute inset-x-0 top-0 h-px w-full"}),a.children,(0,n.jsx)("div",{ref:d,className:"absolute inset-x-0 bottom-0 h-px w-full"})]}),(0,n.jsx)("div",{className:(0,s.cn)("from-muted via-muted/75 pointer-events-none absolute bottom-0 left-0 right-2 z-10 h-16 bg-gradient-to-t transition-opacity",l?"opacity-100":"opacity-0")})]})}function g(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(p,"gap-3 py-3",t),...a})}function v(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)("flex w-full min-w-0 flex-col items-stretch gap-0.5",t),...a})}function j(e){let{className:t,open:a,children:r,...l}=e,i=void 0!==a;return(0,n.jsxs)("h2",{className:(0,s.cn)("flex h-[1.875rem] content-center gap-1 px-2 text-[0.8125rem] font-medium text-gray-500",i&&"w-full cursor-pointer select-none justify-between transition-colors hover:text-gray-900",t),...l,children:[r,i&&(0,n.jsx)(d.b,{className:(0,s.cn)("h-4 w-4 translate-y-px",{"rotate-90 transition-transform":a})})]})}function b(e){let{className:t,...a}=e;return(0,n.jsx)("ul",{className:(0,s.cn)("flex w-full min-w-0 flex-col gap-0.5",t),...a})}function y(e){let{className:t,...a}=e;return(0,n.jsx)("li",{className:(0,s.cn)("hover:bg-alpha-200 has-[[data-current=true]]:bg-alpha-200 has-[[data-state=open]]:bg-alpha-200 focus-within:bg-alpha-200 active:bg-alpha-200 group relative flex h-8 list-none items-center rounded-md text-gray-600","has-[button:disabled]:pointer-events-none has-[button:disabled]:opacity-50",t),...a})}let w="focus-visible:ring-offset-background rounded-md group-has-[.item-action]:pr-8 flex [&_svg]:shrink-0 [&_div]:truncate [&_span]:truncate min-w-0 items-center justify-center gap-2 whitespace-nowrap flex size-full min-w-0 items-center justify-start gap-2 px-2 text-sm font-normal outline-none text-gray-600 focus-within:text-gray-900 hover:text-gray-900 focus:text-gray-900 group-hover:text-gray-900 data-[current=true]:text-gray-900 ring-blue-600 focus-visible:ring-2 focus-visible:ring-offset-1";function N(e){var t,a;let{className:c,asChild:d=!1,href:u,children:p,unavailable:x,noActive:f,...g}=e,{setSheetOpen:v}=(0,r.e)(),j=(0,i.usePathname)(),b="/".concat(null!=(t=(0,h.je)(j))?t:""),y=[...null!=(a=g.altmatches)?a:[],u],{stopPeekingForced:N}=(0,m._2)("skeleton"),k=y.includes(b)||y.includes("/chat".concat(b))||y.includes(j),C=d?l.DX:x?"a":o.PrefetchLinkAndRefreshOnHover;return(0,n.jsx)(C,{className:(0,s.cn)(w,x&&"pointer-events-none",c),"data-current":k&&!f,href:u,onClick:()=>{(0,h.yy)(u)||N({onlyOnCollapsed:!0}),v(!1)},...g,children:p})}function k(e){let{className:t,children:a,onClick:l,...i}=e,{setSheetOpen:o}=(0,r.e)();return(0,n.jsx)("button",{className:(0,s.cn)(w,t),onClick:e=>(null==l||l(e),o(!1)),...i,children:a})}function C(e){let{className:t,...a}=e,{setOpenedDropdown:r}=(0,m._2)("skeleton");return(0,n.jsx)(l.DX,{className:(0,s.cn)("touch:opacity-100 item-action hover:bg-alpha-200 data-[state=open]:bg-alpha-200 focus-visible:bg-alpha-200 active:bg-alpha-200 absolute right-2 size-5 rounded-sm bg-transparent text-gray-600 opacity-0 transition-all hover:text-gray-900 focus:text-gray-900 focus-visible:opacity-100 group-focus-within:opacity-100 group-hover:opacity-100 group-has-[[data-current=true]]:opacity-100 data-[state=open]:opacity-100",t),onClick:e=>{var t;r(!0),null==(t=a.onClick)||t.call(a,e)},...a})}function S(e){let{length:t,className:a,...r}=e;return 0===t?(0,n.jsx)(M,{children:(0,n.jsx)(u.E,{className:(0,s.cn)("h-7 w-full",a)})}):(0,n.jsx)("div",{className:(0,s.cn)("flex w-full min-w-0 flex-col gap-0.5",a),...r,children:Array.from({length:t}).map((e,t)=>(0,n.jsx)("div",{className:"flex h-8 w-full items-center justify-start px-2",children:(0,n.jsx)("div",{className:"bg-alpha-300 h-5 w-[--width] animate-pulse rounded-md",style:{"--width":["80%","100%","90%","70%","100%","80%","40%"][t%7]}})},t))})}function M(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)("mx-2 h-16 content-center rounded-lg border border-dashed px-8 text-center text-xs text-gray-500",t),...a})}},48339:(e,t,a)=>{"use strict";a.d(t,{j:()=>c,r:()=>d});var n=a(97667);a(33571);var s=a(17e3),r=a(62045),l=a(5083),i=a(49211),o=a(66683);function c(e){return"v0-preview-".concat(e)}function d(e){let{hasBlockPreview:t,activeTab:a,setActiveTab:c}=e,{isPublished:d}=(0,i.usePublishedPage)(),u=(0,n.jsx)(s.Tabs,{className:"w-full",onValueChange:c,value:a,children:(0,n.jsxs)(s.TabsList,{className:"relative h-10 [&>*]:flex-1",children:[(0,n.jsxs)(s.TabsTrigger,{className:"h-8 w-full flex-1",disabled:!(0,o.O)(t),value:"preview",children:[(0,n.jsx)(l.p,{}),(0,n.jsx)("span",{className:"select-none",children:"Preview"})]}),(0,n.jsxs)(s.TabsTrigger,{className:"h-8 flex-1",value:"code",children:[(0,n.jsx)(r.Y,{}),(0,n.jsx)("span",{className:"select-none",children:"Code"})]})]})});return d?(0,n.jsx)("div",{className:"flex w-full items-center gap-2",children:u}):null}},48476:(e,t,a)=>{"use strict";a.d(t,{A:()=>$,q:()=>H});var n=a(97667),s=a(33571),r=a(97468),l=a(39849),i=a(54146),o=a(33324),c=a(81657),d=a(84089),u=a(36863),m=a(27693),h=a(67572),p=a(28819);a(61266);var x=a(12079),f=a(3974),g=a(37631),v=a(74905),j=a(618),b=a(25809),y=a(71916),w=a(37758),N=a(66692),k=a(80381),C=a(74118),S=a(25603);function M(e){let{data:t,isLoading:a,mutate:n,error:s}=(0,S.Ay)(e?["chat:dont-show-again",e]:null,{revalidateOnFocus:!1,revalidateOnMount:!1,revalidateOnReconnect:!1});return{dontShowAgain:t,isLoading:a,error:s,refetchDontShowAgain:n,addToDontShowAgain:(a,s)=>{if(!e)return;let r=[...t||[],...a,...s];return n(async()=>{let t=await fetch("/chat/api/chat/integrations/dont-show-again",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chatId:e,missingEnvVars:a,missingIntegrations:s})});if(!(await t.json()).success)throw Error('Failed to update "don\'t show again" list');return r},{optimisticData:r,rollbackOnError:!0,revalidate:!1})}}}var I=a(15932),A=a(37707),D=a(80672),L=a(2783),z=a(32136),E=a(36323),P=a(70158),T=a(16894),F=a(35129),R=a(13729),U=a(16292);function V(e){let{integrationNames:t,standaloneEnvs:a}=e,{scp:s}=(0,A.D)();if(!a&&0===t.length||a&&0===t.length&&0===a.length)return null;let r=[...t,...a&&a.length>0?["manual"]:[]];return(0,n.jsx)("div",{className:(0,p.cn)("flex w-full",!s&&"justify-center"),children:(0,n.jsx)("div",{className:"flex",children:r.map((e,t)=>(0,n.jsx)("div",{className:"relative h-12 w-12 rounded-full border border-gray-700 bg-black",style:{marginLeft:0===t?0:"-12px",zIndex:t},children:(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"relative h-7 w-7",children:"manual"===e?(0,n.jsx)(I.r,{className:"h-7 w-7 !text-white"}):(0,n.jsx)(k.default,{src:w.eV[e]||"/placeholder.svg",alt:e,fill:!0,className:"rounded-sm object-contain"})})})},e))})})}function B(e){let{open:t,setOpen:a,missingEnvs:r}=e,{chatId:l}=(0,C.xz)(),{addToDontShowAgain:i}=M(l),{scp:o}=(0,A.D)(),[c,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),x=(0,P.useRouter)(),f=(0,D.useSetAtom)(L.uH),g=(0,D.useSetAtom)(L.xb),v=(0,E.eu)(),{project:j,title:k,canWriteToChat:S}=(0,z.tZ)(),I=(0,z.tZ)(),{integrationsNeeded:B,standaloneEnvs:_}=(0,s.useMemo)(()=>{let e=new Set,t=[];for(let a of r){let n=!1;for(let[t,s]of Object.entries(w.Jc))if(s.includes(a)){e.add(t),n=!0;break}n||t.push(a)}return{integrationsNeeded:Array.from(e),standaloneEnvs:t}},[r]);return B.length>0||_.length>0?o?(0,n.jsx)("div",{className:(0,p.cn)("absolute inset-0",!t&&"pointer-events-none"),children:(0,n.jsxs)(y.lG,{open:t,modal:!1,onOpenChange:a,children:[(0,n.jsx)("div",{"data-state":t?"open":"closed",className:(0,p.cn)("bg-alpha-700 dark:bg-alpha-900 absolute inset-0 z-50 transition-opacity data-[state=closed]:pointer-events-none data-[state=closed]:opacity-0 data-[state=open]:opacity-100"),onClick:()=>{t&&a(!1)}}),(0,n.jsxs)(y.Cf,{showClose:!1,onEscapeKeyDown:()=>{var e;return null==(e=document.getElementById("env-warning-trigger"))?void 0:e.focus()},className:"max-h-[400px] max-w-[min(540px,90vw)] gap-2.5 overflow-y-scroll p-6 shadow-sm",omitPortal:!0,onInteractOutside:e=>e.preventDefault(),children:[(0,n.jsxs)(y.HM,{onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},tabIndex:1,className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,n.jsx)(d.F,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,n.jsx)(V,{integrationNames:B,standaloneEnvs:_}),(0,n.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,n.jsx)(y.L3,{className:"flex w-full justify-start text-xl",children:(0,n.jsxs)("span",{children:["This generation uses"," ",(0,n.jsx)("span",{children:B.length+_.length>1?"integrations":B.length>0?B[0]:"an integration"})]})}),(0,n.jsx)(y.rr,{className:"flex w-full justify-start text-sm text-gray-500",children:"Complete the steps in chat to ensure the generation works correctly."})]}),(0,n.jsx)("div",{className:"flex w-full justify-end",children:(0,n.jsx)(N.$,{onClick:async()=>{await i(r,B)},variant:"secondary",size:"sm",children:"Don't show again"})})]})]})]})}):(0,n.jsx)("div",{className:(0,p.cn)("absolute inset-0",!t&&"pointer-events-none"),children:(0,n.jsxs)(y.lG,{open:t,modal:!1,onOpenChange:a,children:[(0,n.jsx)("div",{"data-state":t?"open":"closed",className:(0,p.cn)("bg-alpha-700 dark:bg-alpha-900 absolute inset-0 z-50 transition-opacity data-[state=closed]:pointer-events-none data-[state=closed]:opacity-0 data-[state=open]:opacity-100"),onClick:()=>{t&&a(!1)}}),(0,n.jsxs)(y.Cf,{showClose:!1,onEscapeKeyDown:()=>{var e;return null==(e=document.getElementById("env-warning-trigger"))?void 0:e.focus()},className:"max-h-[400px] max-w-[min(440px,90vw)] gap-2.5 overflow-y-scroll p-6 shadow-sm",omitPortal:!0,onInteractOutside:e=>e.preventDefault(),children:[(0,n.jsxs)(y.HM,{onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},tabIndex:1,className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,n.jsx)(d.F,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}),B.length>0?(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,n.jsx)(V,{integrationNames:B}),(0,n.jsx)(y.L3,{className:"text-xl",children:(0,n.jsxs)("span",{children:["This generation uses"," ",(0,n.jsx)("span",{children:B.length>1?"integrations":B[0]}),"."]})}),(0,n.jsxs)(y.rr,{className:"text-md text-gray-500",children:["Add the required integration",(0,n.jsx)("span",{children:B.length>1&&"s"})," in chat or from the Settings panel."," ",S?!(null==j?void 0:j.projectId)&&(0,n.jsx)("span",{children:"You'll need to create a project first."}):(0,n.jsx)("span",{children:"You'll need to fork this chat first."})]}),(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsx)(N.$,{onClick:async()=>{await i(r,B)},variant:"secondary",size:"sm",children:"Don't show again"}),c||m?(0,n.jsx)(U.x,{variant:"default",pending:!0,size:"sm",children:c?"Creating Project":"Forking Block"}):(0,n.jsx)(N.$,{onClick:async()=>{if(!S){if(!v)return void R.o.error("Failed to fork chat");h(!0);let e=await (0,F.O)(v.id);if(!e||"string"!=typeof e){R.o.error("Failed to fork chat"),h(!1);return}return x.push("/chat/".concat(e)),R.o.success("Chat forked successfully"),void h(!1)}if(!(null==j?void 0:j.projectId)){u(!0);let e=await (0,T.g)({projectName:k,chatId:l||"",includeSuccessToast:!1});if(!e.id)return R.o.error("Failed to create project. Please add this chat to a project."),null;await I.setMetadata({...I,project:{projectId:e.id,vercelProjectId:e.vercelProjectId||null,name:k,settings:{icon:"icon-wand-sparkles",color:null},isCreator:!0}}),u(!1)}f(!0),g("integrations")},variant:"default",size:"sm",children:S?(null==j?void 0:j.projectId)?"Open Settings":"Create Project":"Fork Block"})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(y.c7,{className:"items-start text-start",children:[(0,n.jsxs)(y.L3,{className:"flex items-center gap-2 text-lg",children:[(0,n.jsx)(b.o,{className:"!text-amber-600"}),(0,n.jsx)("span",{children:"Missing Environment Variables"})]}),(0,n.jsx)(y.rr,{className:"text-foreground text-sm",children:"This generation may have limited functionality without the following environment variables:"})]}),r.map(e=>(0,n.jsx)("p",{className:"w-fit max-w-full truncate rounded-sm bg-gray-200 px-[3px] py-0.5 font-mono text-[13px] leading-none",children:e},e)),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(N.$,{onClick:()=>i(r,[]),variant:"secondary",size:"sm",className:"w-fit",children:"Don't show again"})})]})]})]})}):null}var _=a(40711),O=a(73641);function H(e,t){e.postMessage({__v0_remote__:1,...t},"*")}function $(e){let{iframeId:t,blockId:a,devTools:y,allowMobileFullscreen:w,isV3:N,children:k}=e,C=(0,m.k)(),{fullScreenResult:S,setFullscreenResult:I}=(0,h.S)(),A=(0,v.s)(),[D,L]=(0,s.useState)(!1),{dontShowAgain:z,isLoading:E}=M((0,O.x)()),[P,T]=(0,s.useState)(new Map),F=(0,s.useMemo)(()=>{var e;return E?[]:(null!=(e=P.get(t))?e:[]).filter(e=>!(null==z?void 0:z.includes(e)))},[t,P,z,E]),[R,U]=(0,s.useState)(!0),V=(0,s.useMemo)(()=>R&&F.length>0,[R,F]),{canGoBack:$,canGoForward:W,href:G,setHref:Z,iframe:Y,latestHref:K,loading:J,setLoading:Q,refresh:X,temporalHref:ee,setTemporalHref:et}=(0,_.Z)(a),ea=(0,s.useMemo)(()=>{if(!G)return"";let e=new URL(G);return e.pathname+e.search+e.hash},[G]),en=(0,u.F)(ee);(0,s.useEffect)(()=>{if(!Y)return;let e=e=>{let{data:a}=e;if(a&&"object"==typeof a&&a.__v0_remote__)switch(a.type){case"missing-envs":let n=Array.isArray(a.names)&&a.names.every(e=>"string"==typeof e);T(new Map(P.set(t,n?a.names:[]))),U(a.show);break;case"devtools_state":L(a.enabled)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[Y,t,P]);let es=(0,s.useCallback)(()=>{Y&&window.open(K.current||Y.src,"_blank","noreferrer,noopener")},[Y,K]),er=(0,s.useCallback)(()=>{Y&&Y.contentWindow&&(H(Y.contentWindow,{type:"navigate_back"}),et(null))},[Y,et]),el=(0,s.useCallback)(()=>{Y&&Y.contentWindow&&(H(Y.contentWindow,{type:"navigate_forward"}),et(null))},[Y,et]),ei=(0,s.useCallback)(()=>{var e;Y&&Y.contentWindow&&(H(Y.contentWindow,{type:"navigate_to",href:null===en.current?K.current:new URL(null!=(e=en.current)?e:"",K.current).href}),Q(!0))},[Y,K,en,Q]),eo=(0,s.useMemo)(()=>{let e=null!==ee?ee:ea;if(!e)return"";try{return decodeURIComponent(e)}catch(t){return e}},[ee,ea]);return(0,n.jsxs)("div",{className:"flex h-full w-full flex-col","data-slot":"browser",children:[(0,n.jsxs)(f.o,{className:N?"h-6 gap-1 px-0":"bg-muted gap-1 px-2",bottomBorder:!N,children:[(0,n.jsx)(g.Z,{disabled:!$,onClick:er,children:(0,n.jsx)(r.J,{})}),(0,n.jsx)(g.Z,{disabled:!W,onClick:el,children:(0,n.jsx)(l.c,{})}),(0,n.jsx)(g.Z,{onClick:X,children:J?(0,n.jsx)(q,{}):(0,n.jsx)(c.g,{})}),(0,n.jsxs)("div",{className:"relative mx-1 flex-1",children:[(0,n.jsx)("input",{type:"text",className:(0,p.cn)("focus:border-alpha-200 h-6 w-full min-w-0 rounded-full border border-transparent bg-gray-200 px-2.5 text-gray-900 outline-none hover:bg-gray-300/50",S&&"pl-7"),value:eo,onKeyDown:e=>{"Enter"===e.key?(ei(),Z(new URL(null!=ee?ee:"",G).href),et(null),e.stopPropagation(),e.currentTarget.blur()):"Escape"===e.key&&(et(null),e.stopPropagation(),e.currentTarget.blur())},onChange:e=>void et(e.currentTarget.value),onFocus:e=>{e.currentTarget.select()},spellCheck:!1}),S&&(0,n.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",children:(0,n.jsx)(j.o,{className:"size-4"})})]}),F.length>0&&(0,n.jsx)(g.Z,{className:"text-amber-600",id:"env-warning-trigger",tooltipDirection:"bottom",tooltip:"Missing Environment Variables",onClick:()=>U(!V),children:(0,n.jsx)(b.o,{})}),y&&!N?(0,n.jsx)(g.Z,{"data-slot":"button-select",className:D?"!bg-blue-500/15 text-blue-500":"focus:bg-transparent",tooltip:{side:"bottom",content:"Select"},onClick:()=>{let e=document.getElementById(t);e&&e.contentWindow&&H(e.contentWindow,{type:"devtools_enable"})},children:(0,n.jsx)(o.f,{})}):null,(0,n.jsx)(g.Z,{"data-slot":"button-new-tab",tooltip:{side:"bottom",content:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{children:"Open in new tab"}),(0,n.jsx)("span",{className:"max-w-[200px] text-center text-sm text-gray-400",children:"This link is insecure and can expose your code and data."})]})},onClick:es,children:(0,n.jsx)(x.H,{})}),(0,n.jsx)(g.Z,{className:(0,p.cn)(!w&&A?"hidden":null),"data-slot":"button-fullscreen","data-testid":"fullscreen-button",tooltip:{side:"bottom",content:C(S?"previewBlock.close":"previewBlock.fullscreen")},onClick:()=>I(!S,a),children:S?(0,n.jsx)(d.F,{}):(0,n.jsx)(i.g,{})})]}),(0,n.jsxs)("div",{className:"relative flex w-full flex-1 shrink-0 flex-col","data-slot":"browser-content",children:[(0,n.jsx)(B,{open:V,setOpen:U,missingEnvs:F}),k]})]})}function q(){return(0,n.jsx)("svg",{className:"browserframe-loading-spinner",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("circle",{fill:"none",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round",cx:"33",cy:"33",r:"30"})})}},48985:(e,t,a)=>{"use strict";async function n(e){let{blockId:t,skipDeploy:a,skippedDeployWarning:n,branch:s}=e;try{return fetch("/chat/api/git/push",{method:"POST",body:JSON.stringify({blockId:t,skipDeploy:a,skippedDeployWarning:n,branch:s})})}catch(e){throw e}}a.d(t,{k:()=>n})},49019:(e,t,a)=>{"use strict";a.d(t,{P:()=>h,c:()=>m});var n=a(97667),s=a(82974),r=a(7987),l=a(76727),i=a(72092),o=a(33571),c=a(28819),d=a(19676),u=a(35486);let m=o.memo(function(e){var t;let{children:a,...s}=e;return a.length>1e4?(0,n.jsx)("p",{children:a}):(0,n.jsx)(r.o,{remarkPlugins:[u.QZ],...s,components:{pre:e=>(0,n.jsx)("pre",{...e,className:"bg-background border-alpha-400 text-foreground rounded-lg border p-2 px-[0.5rem] py-[0.3rem] font-mono text-xs font-normal [&_code]:border-none [&_code]:bg-transparent"}),code:e=>{let{children:t,...a}=e;return"string"==typeof t&&(0,u.TN)(t)?(0,n.jsx)(u.br,{value:t}):(0,n.jsx)("code",{...a,className:"rounded-[0.375rem] border bg-gray-100 font-mono text-xs font-normal before:hidden after:hidden",children:t})},...null!=(t=s.components)?t:{}},children:a})});function h(e){var t;let{message:a,className:r,isLastMessage:o=!1}=e,u=(0,s.B)(a);return"string"==typeof a.content?(0,n.jsx)(i.s,{className:(0,c.cn)("w-full",r),children:(0,n.jsx)(m,{children:a.content})},u):(0,d.Ne)(a)?null:(0,n.jsx)("div",{className:(0,c.cn)("flex-1 text-sm",r),children:(0,n.jsx)(l.A4,{isLastMessage:o,messageId:u,role:a.role,rows:null!=(t=a.content)?t:[],streaming:a.streaming})},u)}},49211:(e,t,a)=>{"use strict";a.r(t),a.d(t,{PublishedPageProvider:()=>l,usePublishedPage:()=>i});var n=a(97667),s=a(33571);let r=(0,s.createContext)(!1);function l(e){let{children:t}=e;return(0,n.jsx)(r.Provider,{value:!0,children:t})}function i(){return{isPublished:(0,s.use)(r)||!1}}},50206:(e,t,a)=>{"use strict";a.d(t,{d:()=>i});var n=a(97667),s=a(80381),r=a(38400);let l=["alipay","amex","diners","discover","elo","hipercard","jcb","maestro","mastercard","paypal","unionpay","visa"];function i(e){let{brand:t,width:a=14}=e;return l.includes(t)?(0,n.jsx)(s.default,{alt:"logo for ".concat(t),height:"20",src:"/assets/cardbrands/".concat(t,".svg"),width:a}):(0,n.jsx)(r.A,{})}},50251:(e,t,a)=>{"use strict";a.d(t,{C:()=>I,ImportFromFigmaModal:()=>M});var n=a(97667),s=a(33571),r=a(28963),l=a(66692),i=a(49848),o=a(16292),c=a(57157),d=a(16979),u=a(35293),m=a(80381),h=a(55274),p=a(95393),x=a(19434),f=a(19243),g=a(27693),v=a(57716),j=a(70428),b=a(25603),y=a(92461),w=a(47540),N=a(75486);function k(e){let{inputRef:t,inputValue:a,setInputValue:s,urlError:c,setUrlError:u,handleImport:f,handleClose:v,isLoading:j}=e,b=(0,g.k)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ModalHeader,{className:"flex justify-start p-5",children:(0,n.jsxs)("div",{className:"flex w-full flex-col items-start gap-2",children:[(0,n.jsxs)("div",{className:"bg-muted/50 relative h-[180px] w-full rounded-md",children:[(0,n.jsx)(m.default,{src:"/chat-static/figma-integration-light.svg",alt:"",className:"h-full w-full rounded-md object-cover dark:hidden",fill:!0,priority:!0}),(0,n.jsx)(m.default,{src:"/chat-static/figma-integration-dark.svg",alt:"",className:"hidden h-full w-full rounded-md object-cover dark:block",fill:!0,priority:!0})]}),(0,n.jsxs)("div",{className:"flex w-full flex-col items-start gap-2",children:[(0,n.jsx)(r.ModalTitle,{className:"text-xl font-semibold",children:b("figmaIntegration.importFromFigma")}),(0,n.jsxs)("form",{className:"flex w-full flex-col space-y-3",onSubmit:e=>{e.preventDefault(),f()},children:[(0,n.jsx)("div",{className:"text-left text-sm text-gray-900",children:(0,n.jsx)(r.ModalDescription,{children:b("figmaIntegration.importFigmaDescription")})}),(0,n.jsxs)("div",{className:"space-y-1.5",children:[(0,n.jsx)(i.p,{ref:t,type:"url",size:"sm",placeholder:b("figmaIntegration.enterFigmaUrl"),className:(0,x.cn)("bg-subtle w-full",c&&"border-red-500"),value:a,onChange:e=>{s(e.target.value),c&&u(null)}}),(0,n.jsx)(h.N,{mode:"sync",children:c&&(0,n.jsx)(p.P.div,{initial:{height:0,opacity:0,y:-8},animate:{height:"auto",opacity:1,y:0},exit:{height:0,opacity:0,y:-8},transition:{duration:.15,ease:"easeOut"},children:(0,n.jsxs)("span",{className:"flex items-center gap-2 whitespace-nowrap text-red-500",children:[(0,n.jsx)(d.V,{className:"h-4 w-4 shrink-0"}),(0,n.jsx)("span",{className:"truncate text-sm",children:c})]})})})]})]})]})]})}),(0,n.jsx)(r.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[(0,n.jsx)(r.ModalClose,{asChild:!0,disabled:j,children:(0,n.jsx)(l.$,{onClick:v,size:"sm",variant:"secondary",disabled:j,children:b("figmaIntegration.cancel")})}),(0,n.jsx)(o.x,{onClick:f,size:"sm",pending:j,autoFocus:!0,children:b("figmaIntegration.next")})]})})]})}function C(e){let{color:t}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded-md border p-1",children:[(0,n.jsx)("div",{className:"h-4 w-4 rounded-sm border",style:{backgroundColor:t.hex}}),(0,n.jsx)("div",{className:"flex flex-col",children:(0,n.jsx)("span",{className:"text-muted-foreground text-xs",children:t.hex.toLowerCase()})})]})}function S(e){let{imageBase64:t,originalFigmaUrl:a,nodeContext:s,handleImport:i,handleClose:d,isLoading:h,imageHeight:p}=e,x=(0,g.k)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"max-h-[calc(100vh-8rem)] overflow-y-auto",children:(0,n.jsx)(r.ModalHeader,{className:"flex w-full flex-col p-3 md:p-5",children:(0,n.jsxs)("div",{className:"flex w-full flex-col gap-3 md:gap-4",children:[(0,n.jsx)(r.ModalTitle,{className:"text-left text-lg font-semibold md:text-xl",children:x("figmaIntegration.heresWhatWellImport")}),(0,n.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,n.jsx)("h3",{className:"text-left text-sm font-medium md:text-base",children:x("figmaIntegration.visualContext")}),p&&p/2>982&&(0,n.jsxs)(N.Fc,{children:[(0,n.jsx)(u.A,{className:"h-4 w-4"}),(0,n.jsx)(N.TN,{children:x("figmaIntegration.heightWarning")})]}),(0,n.jsx)("div",{className:"bg-muted/50 relative h-[200px] w-full rounded-md border md:h-[400px]",children:t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.default,{src:t,alt:"Figma design preview",className:"rounded-md object-cover object-top",fill:!0,sizes:"100vw",priority:!0}),(0,n.jsx)("div",{className:"absolute bottom-2 right-2 z-10 md:bottom-3 md:right-3",children:(0,n.jsx)(w.N,{href:a,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),passHref:!0,children:(0,n.jsxs)(y.E,{className:"bg-muted hover:bg-muted/50 max-w-[200px] cursor-pointer truncate text-xs md:text-sm",variant:"secondary",children:[(0,n.jsx)(c.Y,{className:"h-3 w-3 shrink-0"}),(0,n.jsx)("span",{className:"truncate",children:s.frameName||x("figmaIntegration.openInFigma")})]})})})]})}),(0,n.jsx)("div",{className:"mt-3 flex flex-col space-y-3",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:gap-6",children:[s.nodes.designTokens.length>0&&(0,n.jsxs)("div",{className:"mb-6 flex flex-1 flex-col gap-2 md:mb-0",children:[(0,n.jsx)("h3",{className:"text-left text-sm font-medium md:text-base",children:x("figmaIntegration.designTokens")}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:s.nodes.designTokens.map((e,t)=>(0,n.jsx)(C,{color:e},e.hex||t))})]}),s.nodes.colors.length>0&&(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,n.jsx)("h3",{className:"text-left text-sm font-medium md:text-base",children:x("figmaIntegration.colors")}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:s.nodes.colors.map((e,t)=>(0,n.jsx)(C,{color:e},e.hex||t))})]})]})})]})]})})}),(0,n.jsx)(r.ModalFooter,{className:"border-border bg-muted sticky bottom-0 border-t !p-3 md:!p-4",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[(0,n.jsx)(r.ModalClose,{asChild:!0,disabled:h,children:(0,n.jsx)(l.$,{onClick:d,size:"sm",variant:"secondary",disabled:h,children:x("figmaIntegration.cancel")})}),(0,n.jsx)(o.x,{onClick:i,size:"sm",pending:h,autoFocus:!0,children:x("figmaIntegration.confirm")})]})})]})}function M(){var e;let t=(0,g.k)(),{importFigmaModalOpen:a,setImportFigmaModalOpen:l}=I(),{setSignInWithFigmaModal:i}=(0,j.f)(),[o,c]=(0,s.useState)("url"),[d,u]=(0,s.useState)(null),[m,h]=s.useState(null),p=s.useRef(null),[b,y]=s.useState(""),[w,N]=s.useState(""),C=(0,v.q)(p);(0,s.useEffect)(()=>{if((null==a?void 0:a.open)&&!C.isSignedIn){var e,t;l(null),i({figmaOauthUrl:"".concat(null!=(t=null==(e=C.userData)?void 0:e.figmaOauthUrl)?t:"","&from=import")})}},[C.isSignedIn,null==a?void 0:a.open,l,i,null==(e=C.userData)?void 0:e.figmaOauthUrl]);let M=()=>{l(null),h(null),y(""),c("url"),p.current&&(p.current.value="")},A=()=>{M(),(0,f.u)("FigmaModalClose")},D=async()=>{if(!b){let e=t("figmaIntegration.enterValidUrl");h(e),(0,f.u)("FigmaUrlSubmit",{url:"",success:!1,error:e});return}try{await L(b)}catch(e){(0,f.u)("FigmaUrlSubmit",{url:b,success:!1,error:e instanceof Error?e.message:"Unknown error"})}},L=async e=>{let n,s=!1;if("url"===o)if(C.isFigmaUrl(e))try{let[a,s]=await Promise.all([C.getNodeContext(e),C.handleFigmaUrl(e)]);s.success?(u(a),N(s.data.base64),h(null),c("context")):(n=s.error||t("figmaIntegration.invalidUrl"),h(n))}catch(e){n=e instanceof Error?e.message:"Error loading Figma content",h("Error loading Figma content")}else h(n=t("figmaIntegration.invalidUrl"));else(await C.handleFigmaUrl(e)).success&&(null==a?void 0:a.onImport)?(A(),await a.onImport(e),s=!0):h(n="Failed to import Figma URL");(0,f.u)("FigmaUrlSubmit",{url:e,success:s,error:n})};return a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Modal,{onClose:A,onOpenChange:C.isLoading?void 0:M,open:!!a,className:(0,x.cn)("w-full","url"===o?"max-w-xl":"md:!w-[800px]"),children:(0,n.jsx)("div",{className:"flex w-full flex-col",children:d?"url"===o?(0,n.jsx)(k,{inputRef:p,inputValue:b,setInputValue:y,urlError:m,setUrlError:h,handleImport:D,handleClose:A,isLoading:C.isLoading}):(0,n.jsx)(S,{imageBase64:w,originalFigmaUrl:b,nodeContext:d,handleImport:D,handleClose:A,isLoading:C.isLoading,imageHeight:C.imageHeight}):(0,n.jsx)(k,{inputRef:p,inputValue:b,setInputValue:y,urlError:m,setUrlError:h,handleImport:D,handleClose:A,isLoading:C.isLoading})})}),(0,n.jsx)(j.default,{})]}):null}function I(){let{data:e,mutate:t}=(0,b.Ay)("useImportFromFigmaModal",null);return{importFigmaModalOpen:e,setImportFigmaModalOpen:t,figmaContext:null==e?void 0:e.figmaContext}}},50904:(e,t,a)=>{"use strict";a.d(t,{G:()=>l});var n=a(74118),s=a(25603),r=a(33571);function l(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,s.Ay)(["blocks-deployed",e]);return{getBlockDeployed:(0,r.useCallback)(e=>{var a;return!!(null==t||null==(a=t.get(e))?void 0:a.deploymentId)},[t]),setBlockDeployed:(0,r.useCallback)((e,n)=>{a(new Map(null==t?void 0:t.set(e,n)))},[t,a])}}},50942:(e,t,a)=>{"use strict";a.d(t,{X:()=>r});var n=a(97667),s=a(28819);function r(e){let{className:t,...a}=e;return(0,n.jsx)("svg",{className:(0,s.cn)("h-4 w-4 animate-spin",t),fill:"currentColor",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,n.jsx)("path",{d:"M232 128a104 104 0 0 1-208 0c0-41 23.81-78.36 60.66-95.27a8 8 0 0 1 6.68 14.54C60.15 61.59 40 93.27 40 128a88 88 0 0 0 176 0c0-34.73-20.15-66.41-51.34-80.73a8 8 0 0 1 6.68-14.54C208.19 49.64 232 87 232 128Z"})})}},51368:(e,t,a)=>{"use strict";a.d(t,{b:()=>tr,P:()=>tn});var n=a(97667),s=a(33571),r=a(66692),l=a(32265),i=a(40767),o=a(58642),c=a(68618),d=a(84089),u=a(32376),m=a(25951),h=a(50391),p=a(27693),x=a(90962),f=a(63072),g=a(74118),v=a(62080),j=a(37707),b=a(35501),y=a.n(b),w=a(70158),N=a(32790),k=a(80381),C=a(67702),S=a(10838),M=a(37758),I=a(93660),A=a(16979),D=a(15941),L=a(19243),z=a(28819),E=a(28824),P=a(27194),T=a(32136),F=a(36323),R=a(5759),U=a(63186),V=a(81966);function B(e){let{count:t=4}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex flex-col p-4 pb-0",children:(0,n.jsx)("div",{className:"flex h-7 w-36 items-center",children:(0,n.jsx)(I.E,{className:"h-5 w-full"})})}),(0,n.jsx)("div",{className:"flex flex-col gap-3 p-4",style:{maskImage:"linear-gradient(to bottom, black 20%, transparent 100%)"},children:Array.from({length:t}).map((e,t)=>(0,n.jsxs)("div",{className:"border-alpha-400 shadow-base flex items-center justify-between gap-3 rounded-lg border-0 p-3.5",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(I.E,{className:"h-8 w-8 rounded-full"}),(0,n.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,n.jsx)(I.E,{className:"h-[12px] w-24"}),(0,n.jsx)(I.E,{className:"h-[10px] w-40"})]})]}),(0,n.jsx)(I.E,{className:"h-7 w-[74px]"})]},t))})]})}function _(e){let{vercelProjectId:t,onIntegrationClick:a,vercelProjectName:l,teamSlug:i,isV3:o}=e,{mi:c,scp:d}=(0,j.D)(),[u,m]=(0,s.useState)({}),{stores:p}=(0,P.B)(),{title:x,project:f}=(0,T.tZ)(),g=(0,F.eu)(),v=window.location.pathname.includes("/projects/"),b=(e,t)=>{m(a=>({...a,[e]:t}))},{integrations:y,refetch:w}=(0,C.A)({integrationIds:M.ud,isEnabled:c||o}),{connections:I,stores:_,isLoading:O,error:H,refetch:$}=(0,S.g)({vercelProjectId:t,v0ProjectId:null==f?void 0:f.projectId,refreshInterval:0}),{connectedIntegrationItems:q,unconnectedIntegrationItems:W,missingIntegrationsItems:G}=(0,s.useMemo)(()=>{if(O)return{connectedIntegrationItems:[],unconnectedIntegrationItems:[],missingIntegrationsItems:[]};let e=new Map;I.data.forEach(t=>{e.set(t.slug,{url:"https://vercel.com/".concat(i,"/~/integrations/").concat(t.slug,"/").concat(t.id),type:"connection"})}),_.data.marketplaceStores.forEach(t=>{t.product&&e.set(t.product.slug,{url:"https://vercel.com/".concat(i,"/").concat(l,"/stores/integration/").concat(t.id,"/settings"),type:"store"})}),_.data.nativeStores.forEach(t=>{e.set(t.type,{url:"https://vercel.com/".concat(i,"/~/stores/").concat(t.type,"/").concat(t.id,"/browser"),type:"native-store"})});let t=(null==g?void 0:g.source)?(0,R.N)(g.source):[],a=[],n=[],s=[];return y.forEach(r=>{let l=e.get(r.slug);l?a.push({...r,connectionUrl:l.url,type:l.type}):t.includes(r.name)?s.push(r):n.push(r)}),{connectedIntegrationItems:a,unconnectedIntegrationItems:n,missingIntegrationsItems:s}},[O,I.data,_.data.marketplaceStores,_.data.nativeStores,null==g?void 0:g.source,y,i,l]);return H?(0,n.jsx)("div",{className:"flex size-full items-center justify-center p-4",children:(0,n.jsx)(h.Sv,{children:(0,n.jsxs)(h.HY,{children:[(0,n.jsx)(h.Ft,{className:"[&>svg]:!text-red-700",children:(0,n.jsx)(A.V,{})}),(0,n.jsx)(h.cz,{children:"Error Loading Integrations"}),(0,n.jsx)(h.Ou,{children:null==H?void 0:H.message}),(0,n.jsx)(r.$,{size:"sm",onClick:()=>{$(),w()},children:"Retry"})]})})}):O?(0,n.jsx)(B,{}):(0,n.jsxs)("div",{className:(0,z.cn)("grid",o&&"grid-cols-1 !p-0"),children:[G.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.wn,{label:"Missing Integrations",info:"These integrations are required for this project.",className:"gap-3 p-4",children:G.map(e=>(0,n.jsxs)(N.Zp,{className:o?"w-full shadow-none":"",children:[(0,n.jsxs)(N.aR,{className:"bg-muted border-alpha-200 flex items-center gap-2 rounded-t-lg border-b px-3 py-2 font-medium text-amber-800 ",children:[(0,n.jsx)(D.N,{})," ",(0,n.jsx)("span",{className:"text-sm",children:"Required"})]}),(0,n.jsx)(N.Wu,{className:(0,z.cn)("flex flex-col gap-4 p-3",o&&"gap-0"),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"relative h-8 w-8 overflow-hidden rounded-full",children:(0,n.jsx)(k.default,{src:e.icon,alt:e.name,fill:!0,className:"select-none object-cover"})}),(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("h3",{className:"font-medium",children:e.name}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]}),(0,n.jsx)(E.V,{allTeamStores:p,integration:e,onConnect:async(e,t,n,s)=>{let r=M.Dk.some(t=>t.has(e.slug)&&q.some(e=>t.has(e.slug)));await a(e,r,t,n,s),_.refetch(),(0,L.u)("ClickAddIntegration",{integration:e})},status:u[e.slug],vercelProjectId:t,onStatusChange:b,source:"settings",starter:x.toLowerCase().includes("starter"),sendFollowUp:!v&&!d})]})})]},e.id))}),(0,n.jsx)(V.Separator,{})]}),q.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.wn,{label:"Connected Integrations",info:"Integrations that are already connected to this project.",className:"gap-3 p-4",children:q.map(e=>(0,n.jsx)(N.Zp,{className:o?"w-full !shadow-none":"",children:(0,n.jsx)(N.Wu,{className:"flex flex-col gap-4 !border-none p-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"relative h-8 w-8 overflow-hidden rounded-full",children:(0,n.jsx)(k.default,{src:e.icon,alt:e.name,fill:!0,className:"select-none object-cover"})}),(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("h3",{className:"font-medium",children:e.name}),(0,n.jsx)("p",{className:"text-gray-500",children:e.description})]})]}),(0,n.jsx)("a",{target:"_blank",href:e.connectionUrl,children:(0,n.jsx)(r.$,{variant:"outline",size:"sm",children:"Manage"})})]})})},e.id))}),W.length>0&&(0,n.jsx)(V.Separator,{})]}),W.length>0&&(0,n.jsx)(U.wn,{label:"Available Integrations",info:"Integrations that are available to connect to this project.",className:"gap-3 p-4",children:W.map(e=>(0,n.jsx)(N.Zp,{className:o?"w-full shadow-none":"",children:(0,n.jsx)(N.Wu,{className:(0,z.cn)("flex flex-col gap-4 p-3",o&&"gap-0"),children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"relative h-8 w-8 overflow-hidden rounded-full",children:(0,n.jsx)(k.default,{src:e.icon,alt:e.name,fill:!0,className:"select-none object-cover"})}),(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("h3",{className:"font-medium",children:e.name}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]}),(0,n.jsx)(E.V,{allTeamStores:p,integration:e,onConnect:async(e,t,n,s)=>{let r=M.Dk.some(t=>t.has(e.slug)&&q.some(e=>t.has(e.slug)));await a(e,r,t,n,s),_.refetch(),(0,L.u)("ClickAddIntegration",{integration:e})},status:u[e.slug],vercelProjectId:t,onStatusChange:b,source:"settings",starter:x.toLowerCase().includes("starter"),sendFollowUp:!v&&!d})]})})},e.id))})]})}var O=a(73655),H=a(70676);let $=(0,H.createServerReference)("40281435e3f51b8762819f56c3fd265a3918367442",H.callServer,void 0,H.findSourceMapURL,"createIntegrationLinkAction");var q=a(40445),W=a(13729),G=a(41416),Z=a(80672),Y=a(2783),K=a(99066),J=a(17e3),Q=a(42938),X=a(66948),ee=a(38312),et=a(99466),ea=a(28963),en=a(16292);let es=(0,H.createServerReference)("4094017d9daf498960afca5b32f86fdb8a26b28958",H.callServer,void 0,H.findSourceMapURL,"deleteEnvVars");var er=a(90516),el=a(40711);function ei(e){let{envVar:t,setOpenDetailsModal:a,setSelectedEnvVar:l,className:i}=e,[o,c]=(0,s.useState)(!1),d=(0,p.k)();return(0,n.jsxs)("div",{className:(0,z.cn)("flex w-full items-center justify-between gap-2 p-3",i),children:[(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0.5 text-[13px] leading-5",children:[(0,n.jsx)("span",{className:"max-w-[200px] truncate font-mono uppercase sm:max-w-[300px]",children:t.key}),(0,n.jsxs)("span",{className:"inline-flex items-center",children:[o?(0,n.jsx)("code",{className:"max-w-[300px] truncate rounded-md bg-gray-200 px-1",children:t.value}):(0,n.jsx)("span",{className:"tracking-widest",children:""}),(0,n.jsx)(r.$,{variant:"ghost",className:"ml-1 size-5 text-gray-500",onClick:()=>c(!o),"aria-label":d(o?"projectSettings.hideValue":"projectSettings.showValue"),children:o?(0,n.jsx)(ee.X,{}):(0,n.jsx)(X.k,{})}),(0,n.jsx)(r.$,{variant:"ghost",className:"size-5 text-gray-500",onClick:()=>{navigator.clipboard.writeText(t.value),W.o.success("Copied value of ".concat(t.key," to clipboard"))},"aria-label":"Copy",children:(0,n.jsx)(Q.Q,{})})]})]}),(0,n.jsx)(U.eC,{onClick:()=>{a(!0),l(t)}})]})}function eo(e){let{setSaving:t,vercelProjectId:a,v0ProjectId:l}=e,[o,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),{envVars:h,isLoading:x,refetchVercelProject:f}=(0,m.Ok)(null!=l?l:void 0),v=h?Object.keys(h).length:0,[j,b]=(0,s.useTransition)(),{setEnvModalData:y,setShowEnvModal:w}=(0,er.i)(),k=(0,p.k)(),C=(0,m.LP)(),{chatId:S}=(0,g.xz)(),{refresh:M}=(0,el.Z)(),I=(0,s.useCallback)(()=>{o&&l&&a&&(t(!0),b(async()=>{(await es({envVarId:o.id,v0ProjectId:l,vercelProjectId:a,chatId:S})).success?W.o.success(k("projectSettings.envVarDeleteSuccess")(o.key)):W.o.error(k("projectSettings.envVarDeleteError")(o.key)),u(!1),f(),M()}))},[o,l,a,t,S,f,M,k]),A=(0,s.useCallback)(()=>{l&&(y({mode:"create",projectId:l}),w(!0))},[y,w,l]),D=(0,s.useMemo)(()=>h?Object.values(h).sort((e,t)=>{let a=e.updatedAt||e.createdAt;return(t.updatedAt||t.createdAt)-a}):[],[h]);return x?(0,n.jsx)(U.Zv,{title:k("projectSettings.environmentVariables")}):(0,n.jsxs)(n.Fragment,{children:[0===v?(0,n.jsx)(U.pp,{title:k("projectSettings.noEnvVars"),subtitle:k("projectSettings.envVarSubtitle")(a),className:"h-full",children:(0,n.jsxs)(r.$,{size:"sm",variant:"secondary",onClick:()=>{A()},children:[(0,n.jsx)(i.F,{}),"Add Variables"]})}):(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[C&&a&&(0,n.jsxs)(r.$,{variant:"secondary",size:"sm",onClick:A,children:[(0,n.jsx)(i.F,{}),"Add"]}),(0,n.jsx)(N.Zp,{children:D.map((e,t)=>(0,n.jsx)(ei,{envVar:e,setOpenDetailsModal:u,setSelectedEnvVar:c,className:t>0?"border-t":""},e.id))})]}),(0,n.jsxs)(ea.Modal,{open:d,onOpenChange:u,children:[(0,n.jsx)(ea.ModalHeader,{children:(0,n.jsx)(ea.ModalTitle,{className:"flex items-center gap-2",children:k("projectSettings.envVarDetails")})}),(0,n.jsx)(ea.ModalContent,{children:(0,n.jsx)(et.oL,{envVar:o})}),C&&(0,n.jsx)(ea.ModalFooter,{className:"border-border bg-muted flex border-t !p-4",children:(0,n.jsx)(en.x,{size:"sm",pending:j,variant:"destructive",onClick:I,disabled:j,children:k("projectSettings.delete")})})]})]})}var ec=a(69077),ed=a(84031);let eu=(0,H.createServerReference)("6011d0ea4e9f640a4e9321aa8562d7a1836b89a5d2",H.callServer,void 0,H.findSourceMapURL,"updateProjectSettingsInstructions");var em=a(12507),eh=a(8689),ep=a(7086);function ex(e){let{readOnly:t,projectId:a,initialInstructions:r,textAreaMinHeight:l,buttonVariant:i,onSubmit:o,onFinish:c}=e,[d,u]=(0,s.useState)(r),[h,x]=(0,s.useState)(!1),f=(0,w.useRouter)(),[g,v]=(0,s.useState)(!1),j=(0,p.k)(),{updateInstructions:b}=(0,m.kL)(a),y=(0,s.useCallback)(async e=>{if(e&&e.preventDefault(),!t){x(!0),null==o||o();try{let e=await eu(a,d);if(!0===e)b(d),W.o.success("Project Instructions updated"),v(!0),setTimeout(()=>v(!1),1e3),f.refresh();else throw Error(e.error)}catch(e){(0,em.z)(e,f,"An error occurred while updating instructions")||W.o.error("Error",{description:"An error occurred while updating instructions."})}finally{x(!1),null==c||c()}}},[t,o,a,d,b,f,c]),{formRef:k,onKeyDown:C}=(0,ec.w)({submitMessage:y,localFileInfos:[]});return(0,n.jsx)(N.Zp,{className:"bg-background flex flex-col border-0 shadow-none",children:(0,n.jsx)("form",{className:"flex flex-1 flex-col",onSubmit:y,ref:k,children:(0,n.jsxs)(N.Wu,{className:"flex flex-1 flex-col gap-3 p-0",children:[(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,n.jsx)("div",{className:"flex flex-1 flex-col",children:(0,n.jsx)(ep.T,{asChild:!0,children:(0,n.jsx)(eh.o,{className:"!pointer-events-auto",disabled:t,id:"instructions",maxLength:5e3,minHeight:l,onChange:e=>u(e.target.value),onKeyDown:C,placeholder:j("projectInstructions.placeholder"),value:d})})}),(0,n.jsx)(ed.j,{count:d.length,max:5e3,message:"For larger context, consider using sources.",messageThreshold:5e3})]}),!t&&(0,n.jsx)(en.x,{className:"ml-auto w-full","data-testid":"save-instructions-button",disabled:g||d===r||h,pending:h,variant:i,children:"Save Changes"})]})})})}function ef(e){let{setSaving:t,projectId:a}=e,{instructions:s,isLoading:l}=(0,m.kL)(a),i=(0,m.LP)();return a?(0,n.jsx)(U.wn,{label:"Project Instructions",info:"Custom instructions and guidelines for v0 to follow in responses.",className:"gap-3 border-b p-4",children:l?(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsx)(I.E,{className:"h-36 w-full"}),(0,n.jsx)(r.$,{disabled:!0,variant:"secondary",size:"sm",children:"Save Changes"})]}):(0,n.jsx)(ex,{readOnly:!i,projectId:a,initialInstructions:s,textAreaMinHeight:144,buttonVariant:"secondary",onSubmit:()=>{t(!0)},onFinish:()=>{t(!1)}})}):null}var eg=a(39929),ev=a(43447),ej=a(27596),eb=a(94177),ey=a(31095),ew=a(66418),eN=a(23680),ek=a(94669),eC=a(15379),eS=a(80574);function eM(e){let{size:t,status:a,isUploaded:s,progress:r,showSuccess:l}=e,i=(0,p.k)();if("processing"===a)return(0,n.jsxs)("div",{className:"inline-flex items-center gap-1 text-gray-500",children:[s?(0,n.jsx)("span",{className:"text-[13px] leading-[18px]",children:i("projectSettings.isIndexing")}):(0,n.jsx)("span",{className:"text-[13px] leading-[18px]",children:i("projectSettings.isUploading")}),r?(0,n.jsxs)("span",{className:"text-[13px] leading-[18px]",children:["(",Math.round(100*r),"%)"]}):null]});if(l)return(0,n.jsxs)("div",{className:"inline-flex items-center gap-2 text-[13px] leading-[18px] text-blue-600",children:[(0,n.jsx)(ej.r,{size:12}),i("projectSettings.uploaded")]});if("error"===a)return(0,n.jsxs)("div",{className:"inline-flex items-center gap-2 text-[13px] leading-[18px] text-red-600",children:[(0,n.jsx)(D.N,{size:12}),i("projectSettings.uploadError")]});let o=t?t>1048576?"".concat((t/1048576).toFixed(2),"MB"):"".concat((t/1024).toFixed(2),"KB"):"---";return(0,n.jsx)("div",{className:"inline-flex items-center text-[13px] leading-[18px] text-gray-500",children:o})}function eI(e){let{source:t,className:a}=e,{metadata:l,url:i,sourceId:o,status:c,title:d,finishedAt:u,isOptimistic:h,progress:x}=t,f=d||"---",[g,v]=(0,s.useState)(!1),j=(0,p.k)(),b=(0,m.LP)(),[y,w]=(0,ek.useDeleteSourceModal)(),{setSource:N}=(0,eC.useRenameSourceModal)();(0,s.useEffect)(()=>{if("success"===c&&u&&Date.now()-new Date(u).getTime()<5e3){v(!0);let e=setTimeout(()=>{v(!1)},5e3);return()=>{clearTimeout(e)}}},[u,c]);let[k,C]=(0,s.useTransition)(),S=(0,s.useCallback)(()=>{i&&C(async()=>{try{let e=new URLSearchParams({url:i,type:"blob"}),t=await fetch("/chat/api/chat/download?".concat(e.toString())),a=await t.blob(),n=window.URL.createObjectURL(a),s=document.createElement("a");s.href=n,s.download=f,document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(n)}catch(e){W.o.error(j("projectSettings.downloadSourceError")(e instanceof Error?e.message:void 0))}})},[i,f,j]),M=(0,s.useMemo)(()=>"processing"!==c&&"error"===c?(0,n.jsx)(r.$,{onClick:()=>{w(o)},size:"sm",variant:"destructive",children:j("projectSettings.delete")}):(0,n.jsxs)(eg.DropdownMenu,{children:[(0,n.jsx)(eg.DropdownMenuTrigger,{children:(0,n.jsx)(U.eC,{label:j("projectSettings.openSourceActions")})}),(0,n.jsx)(eg.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,n.jsxs)(eg.DropdownMenuGroup,{children:[b&&(0,n.jsxs)(eg.DropdownMenuItem,{onSelect:()=>{N({sourceId:o,sourceName:f})},children:[(0,n.jsx)(eb.Y,{}),(0,n.jsx)("span",{children:j("projectSettings.rename")})]}),i?(0,n.jsxs)(eg.DropdownMenuItem,{onSelect:S,disabled:k,children:[(0,n.jsx)(ey.f,{}),(0,n.jsx)("span",{children:j("projectSettings.download")}),k?(0,n.jsx)(eS.y,{}):null]}):null,b&&(0,n.jsxs)(eg.DropdownMenuItem,{onSelect:()=>{w(o)},variant:"destructive",children:[(0,n.jsx)(ev.l,{}),(0,n.jsx)("span",{children:j("projectSettings.delete")})]})]})})]}),[c,j,i,S,k,w,o,N,f,b]);return(0,n.jsxs)("div",{className:(0,z.cn)("flex w-full items-center justify-between gap-2 p-3","processing"===c&&"animate-pulse",a),children:[(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0.5 leading-5",children:[(0,n.jsx)("span",{className:"max-w-[200px] truncate text-sm font-medium sm:max-w-[300px]",children:f}),(0,n.jsx)(eM,{size:null==l?void 0:l.size,status:c,isUploaded:!h,progress:x,showSuccess:g})]}),b||i?M:null]})}function eA(e){let{setSaving:t,projectId:a}=e,l=(0,p.k)(),{sources:i,isLoading:o,revalidateSources:c,setSources:d}=(0,m.py)(a),u=(0,m.LP)(),x=i.length||0,f=(0,s.useRef)(null),{inputFileRef:g,onInputChange:v,uploading:j,isDraggingFile:b}=(0,eN.Ay)({isSignedIn:!0,disablePaste:!0,dragContainerRef:f,saveToDrafts:!1,onUploadStart:e=>{t(!0),d(t=>[{sourceId:e.id,title:e.name,type:"attachment",url:e.url,content:null,description:null,metadata:null,isOptimistic:!0,status:"processing",progress:null,finishedAt:null},...t||[]],{revalidate:!1})},projectId:a||void 0,onFinish:()=>{t(!1),c()}}),y=(0,s.useMemo)(()=>b?(0,n.jsxs)("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center gap-2 rounded-lg border border-dashed border-blue-600 bg-blue-100 shadow-none",children:[(0,n.jsx)(h.cz,{className:"text-sm text-blue-600",children:l("projectSettings.dropHere")}),(0,n.jsx)(h.Ou,{className:"text-sm text-blue-600",children:l("projectSettings.dropHereDescription")})]}):null,[b,l]);return a?o?(0,n.jsx)(U.Zv,{title:l("projectSettings.sources")}):(0,n.jsxs)(U.wn,{label:l("projectSettings.sources"),info:"Sources let v0 use your files and information in responses.",className:"gap-3 p-4",children:[(0,n.jsxs)("div",{className:"relative flex flex-col gap-3",ref:f,"data-sources-drop-container":!0,children:[y,0===x?(0,n.jsx)("div",{className:"transition-all",ref:f,children:(0,n.jsx)(U.pp,{title:l("projectSettings.noSources"),subtitle:l("projectSettings.noSourcesDescription"),className:"h-56",children:(0,n.jsxs)(r.$,{size:"sm",variant:"secondary",onClick:()=>{var e;null==(e=g.current)||e.click()},children:[(0,n.jsx)(ew.b,{}),"Upload Files"]})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.$,{variant:"secondary",size:"sm",onClick:()=>{if(u){var e;null==(e=g.current)||e.click()}},children:[(0,n.jsx)(ew.b,{}),"Upload Files"]}),(0,n.jsx)(N.Zp,{className:"transition-all",children:i.map((e,t)=>(0,n.jsx)(eI,{source:e,className:t>0?"border-t":""},e.sourceId))}),(0,n.jsx)(eC.default,{projectId:a}),(0,n.jsx)(ek.default,{projectId:a})]})]}),(0,n.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:j,multiple:!0,onChange:e=>{v(e)},ref:g,type:"file"})]}):null}var eD=a(68163),eL=a(44812),ez=a(25296),eE=a(90332),eP=a(21071),eT=a(88639),eF=a(92647),eR=a(76106),eU=a(35129);function eV(e){let{setSaving:t,vercelProjectWithDashboard:a,isLoading:s,v0ProjectId:r,closeSettingsSheet:l}=e;return s?(0,n.jsx)(eH,{}):(0,n.jsx)(eB,{vercelProjectWithDashboard:a,setSaving:t,v0ProjectId:r,closeSettingsSheet:l})}function eB(e){let{vercelProjectWithDashboard:t,setSaving:a,v0ProjectId:r,closeSettingsSheet:l}=e,{vercelProject:i}=(0,s.useMemo)(()=>{var e,a,n,s;return{vercelProject:null==t?void 0:t.project,deploymentId:null==t||null==(a=t.dashboardProject)||null==(e=a.productionDeployment)?void 0:e.id,alias:null==t||null==(n=t.dashboardProject)?void 0:n.domain,prodBlockInfo:null==t?void 0:t.prodBlockInfo,allAliases:null==t||null==(s=t.dashboardProject)?void 0:s.aliases}},[t]);return(0,n.jsxs)("div",{className:"border-alpha-400 flex items-center justify-between gap-3 rounded-lg border p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e$,{}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Vercel"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:t?null==i?void 0:i.name:(0,n.jsx)("span",{className:"text-gray-500",children:"This project is not connected to Vercel."})})]})]}),t?(0,n.jsx)(e_,{vercelProjectWithDashboard:t,setSaving:a,v0ProjectId:r,closeSettingsSheet:l}):(0,n.jsx)(eO,{setSaving:a,v0ProjectId:r})]})}function e_(e){var t;let{vercelProjectWithDashboard:a,setSaving:l,v0ProjectId:i,closeSettingsSheet:o}=e,{activeScopeSlug:c}=(0,O.k6)(),[d,h]=(0,s.useTransition)(),{refetchVercelProject:x}=(0,m.Ok)(i),f=(0,p.k)(),g=(0,j.D)(),v=(0,m.LP)(),b=null==(t=a.dashboardProject)?void 0:t.link,N=(0,s.useCallback)(()=>{l(!0),h(async()=>{try{let e=await (0,eF.y)({v0ProjectId:i});"error"in e||!e.success?W.o.error(f("projectSettings.projectUnlinkError")):(W.o.success(f("projectSettings.projectUnlinkSuccess")),await x())}catch(e){W.o.error(f("projectSettings.projectUnlinkError"))}finally{h(()=>{l(!1)})}})},[i,l,f,x]),k=(0,w.useRouter)(),{vercelProject:C,prodBlockInfo:S}=(0,s.useMemo)(()=>{var e,t,n,s;return{vercelProject:a.project,deploymentId:null==(t=a.dashboardProject)||null==(e=t.productionDeployment)?void 0:e.id,alias:null==(n=a.dashboardProject)?void 0:n.domain,prodBlockInfo:a.prodBlockInfo,allAliases:null==(s=a.dashboardProject)?void 0:s.aliases}},[a]),M=(0,s.useCallback)(()=>{let e=null==S?void 0:S.blockId;if(e)try{h(async()=>{let t=await (0,eU.O)(e);if(!t||"string"!=typeof t)return void W.o.error("error");k.push("/chat/".concat(t)),o()})}catch(e){console.log(e),W.o.error("error")}},[o,null==S?void 0:S.blockId,k]);return(0,n.jsxs)(eg.DropdownMenu,{children:[(0,n.jsx)(eg.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsxs)(r.$,{variant:"secondary",size:"sm",children:[(0,n.jsx)(eP.S,{className:"!text-green-700"}),"Connected",(0,n.jsx)(eD.X,{})]})}),(0,n.jsx)(eg.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,n.jsxs)(eg.DropdownMenuGroup,{children:[g.ppe&&S?(0,n.jsx)(y(),{href:"/chat/".concat(S.chatId,"?b=").concat(S.blockId,"&f=0"),onClick:e=>{e.metaKey||o()},children:(0,n.jsxs)(eg.DropdownMenuItem,{children:[(0,n.jsx)(X.k,{}),(0,n.jsx)("span",{children:f("blockActions.openInChat")})]})}):null,!b&&S?(0,n.jsxs)(eg.DropdownMenuItem,{onSelect:M,children:[(0,n.jsx)(eL.Z,{}),(0,n.jsx)("span",{children:f("blockActions.fork")})]}):null,(0,n.jsx)(eg.DropdownMenuItem,{asChild:!0,children:(0,n.jsxs)("a",{href:C.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,n.jsx)(u.i,{className:"size-3"}),(0,n.jsx)("span",{children:f("projectSettings.viewOnVercel")})]})}),g.ppe&&v?(0,n.jsx)(eg.DropdownMenuItem,{asChild:!0,children:(0,n.jsxs)("a",{href:"https://vercel.com/".concat(c,"/").concat(C.name,"/settings/domains"),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,n.jsx)(ez.q,{className:"size-3"}),(0,n.jsx)("span",{children:f("projectSettings.setCustomDomain")})]})}):null,v&&(0,n.jsxs)(eg.DropdownMenuItem,{variant:"destructive",disabled:d,onClick:N,children:[(0,n.jsx)(ev.l,{}),(0,n.jsx)("span",{children:f("projectSettings.unlinkVercelProject")})]})]})})]})}function eO(e){let{setSaving:t,v0ProjectId:a}=e,l=(0,p.k)(),{setSelectedProjectId:i}=(0,m._t)(),{projects:o,isReady:c}=(0,eT.D)(),[d,u]=(0,s.useTransition)(),[h,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)(""),v=(0,s.useMemo)(()=>(null==o?void 0:o.length)&&o.length>0,[o]),j=(null==o?void 0:o.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())))||[],b=(0,s.useCallback)(e=>{i(e.id)},[i]),y=(0,s.useCallback)(e=>{e&&(t(!0),u(async()=>{try{let t=await (0,eR.t)({v0ProjectId:a,vercelProjectId:e.id});"error"in t||!t.success||W.o.success(l("projectSettings.projectLinkSuccess"))}catch(e){W.o.error(l("projectSettings.projectLinkError"))}finally{u(()=>{t(!1)})}}))},[a,t,l]);return(0,n.jsxs)(n.Fragment,{children:[v?(0,n.jsxs)(eg.DropdownMenu,{children:[(0,n.jsx)(eg.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(r.$,{variant:"secondary",size:"sm",disabled:d||!c,children:"Connect"})}),(0,n.jsx)(eg.DropdownMenuContent,{align:"end",className:"w-[calc(100vw-32px)] overflow-y-auto md:max-w-[467px]",side:"bottom",children:(0,n.jsx)(et.e$,{filteredProjects:j,searchQuery:f,setSearchQuery:g,isLoading:!c,selectedProject:void 0,handleLinkProject:y,setShowCreateModal:x})})]}):(0,n.jsx)(r.$,{variant:"secondary",size:"sm",disabled:d||!c,onClick:()=>x(!0),children:"Connect"}),(0,n.jsx)(et.Dm,{v0ProjectId:a,onClose:()=>x(!1),open:h,onProjectCreated:b})]})}function eH(){return(0,n.jsxs)("div",{className:"border-alpha-400 flex items-center justify-between gap-3 rounded-lg border p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e$,{}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Deploy to Vercel"}),(0,n.jsx)(I.E,{className:"my-1 h-4 w-36"})]})]}),(0,n.jsx)(I.E,{className:"h-7 w-24"})]})}function e$(){return(0,n.jsx)("div",{className:"border-alpha-400 flex size-11 items-center justify-center rounded-lg border bg-[#000000]",children:(0,n.jsx)(eE.h,{color:"background-100",className:"size-3.5"})})}var eq=a(40346),eW=a(61112),eG=a(23423);let eZ=(0,H.createServerReference)("4052f3dbc11fae23e220cf52b372b82636dc9471b7",H.callServer,void 0,H.findSourceMapURL,"startChatFromGit");var eY=a(25887);function eK(e){var t;let{vercelProjectWithDashboard:a,isLoading:s,v0ProjectId:r,closeSettingsSheet:l,chatId:i}=e;return s?(0,n.jsx)(eX,{}):(null==a||null==(t=a.dashboardProject)?void 0:t.link)?(0,n.jsx)(eJ,{dashboardProject:a.dashboardProject,vercelProject:a.project,link:a.dashboardProject.link,v0ProjectId:r,closeSettingsSheet:l}):(0,n.jsx)(eQ,{vercelProjectWithDashboard:a,chatId:i})}function eJ(e){var t,a;let{dashboardProject:l,vercelProject:i,link:o,v0ProjectId:c,closeSettingsSheet:d}=e,m=(0,p.k)(),[h,x]=(0,s.useTransition)(),f=l.link,g=(0,w.useRouter)(),v=(0,s.useCallback)(()=>{if(f)try{x(async()=>{let{chatId:e}=await eZ({projectId:c});if(!e||"string"!=typeof e)return void W.o.error("error");g.push("/chat/".concat(e)),d()})}catch(e){console.log(e),W.o.error("error")}},[f,c,g,d]);return(0,n.jsxs)("div",{className:"border-alpha-400 flex items-center justify-between gap-3 rounded-lg border p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e0,{}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"GitHub"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:o.repo})]})]}),(0,n.jsxs)(eg.DropdownMenu,{children:[(0,n.jsx)(eg.DropdownMenuTrigger,{asChild:!0,disabled:h,children:(0,n.jsxs)(r.$,{variant:"secondary",size:"sm",children:[(0,n.jsx)(eP.S,{className:"!text-green-700"}),"Connected",(0,n.jsx)(eD.X,{})]})}),(0,n.jsx)(eg.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,n.jsxs)(eg.DropdownMenuGroup,{children:[f?(0,n.jsxs)(eg.DropdownMenuItem,{onSelect:v,children:[(0,n.jsx)(eL.Z,{}),(0,n.jsx)("span",{children:m("projectSettings.forkMainBranch")})]}):null,(0,n.jsx)(eg.DropdownMenuItem,{asChild:!0,children:(0,n.jsx)("a",{href:"https://github.com/".concat(null==(t=l.link)?void 0:t.org,"/").concat(null==(a=l.link)?void 0:a.repo),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between",children:(0,n.jsxs)("span",{className:"flex items-center gap-3",children:[(0,n.jsx)(u.i,{className:"size-3"}),(0,n.jsx)("span",{children:m("projectSettings.viewOnGitHub")})]})})}),(0,n.jsx)(eg.DropdownMenuItem,{asChild:!0,children:(0,n.jsx)("a",{href:"".concat(i.url,"/settings/git"),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between",children:(0,n.jsxs)("span",{className:"flex items-center gap-3",children:[(0,n.jsx)(u.i,{className:"size-3"}),(0,n.jsx)("span",{children:m("projectSettings.manageGit")})]})})})]})})]})]})}function eQ(e){let{vercelProjectWithDashboard:t,chatId:a}=e,s=null==t?void 0:t.project;return(0,n.jsxs)("div",{className:"border-alpha-400 flex items-center justify-between gap-3 rounded-lg border p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e0,{}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"GitHub"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"This project is not connected to GitHub."})]})]}),(0,n.jsx)(eq.TooltipProvider,{children:(0,n.jsxs)(eq.m_,{children:[(0,n.jsx)(eq.k$,{asChild:!0,children:(0,n.jsx)("span",{className:"flex items-center justify-center",tabIndex:-1,children:(0,n.jsx)(r.$,{asChild:!0,variant:"secondary",size:"sm",disabled:!s,onClick:()=>{(0,eY.D)({type:"connectRepo",data:{chatId:a}})},children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!s&&(0,n.jsx)(eG.C,{}),(0,n.jsx)("span",{children:"Connect"})]})})})}),!s&&(0,n.jsx)(eq.ZI,{children:"Connect to Vercel to enable GitHub Integration."})]})})]})}function eX(){return(0,n.jsxs)("div",{className:"border-alpha-400 flex items-center justify-between gap-3 rounded-lg border p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(e0,{}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"GitHub"}),(0,n.jsx)(I.E,{className:"my-1 h-4 w-36"})]})]}),(0,n.jsx)(I.E,{className:"h-7 w-24"})]})}function e0(){return(0,n.jsx)("div",{className:"border-alpha-400 flex size-11 items-center justify-center rounded-lg border bg-white",children:(0,n.jsx)(eW.P,{})})}var e1=a(6902),e5=a(39257),e2=a(91220),e3=a(77292);function e6(e){let{isPending:t,values:a,setValues:s,files:l,uploading:i,removeFile:o,inputFileRef:c,onInputChange:d,awaitingThumbnail:u}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-label-14 text-gray-500",children:"Thumbnail (1920 x 1080 recommended)"}),u?(0,n.jsx)(I.E,{className:"aspect-video w-full"}):l.length>0&&l[0].url&&!i?(0,n.jsxs)(N.Zp,{className:"relative aspect-video w-full overflow-hidden rounded-lg",children:[(0,n.jsx)(r.$,{disabled:t,variant:"secondary",className:"absolute right-2 top-2 z-10 size-7 rounded-md",onClick:()=>{var e;return o(null==(e=l[0])?void 0:e.id)},tooltip:{content:"Remove thumbnail",side:"bottom"},children:(0,n.jsx)(ev.l,{})}),(0,n.jsx)(k.default,{src:l[0].url,alt:"Template thumbnail",className:"pointer-events-none z-0 object-cover",fill:!0})]}):(0,n.jsx)(N.Zp,{className:"bg-muted relative aspect-video w-full",children:(0,n.jsxs)("label",{className:"flex size-full flex-col items-center justify-center gap-3",children:[(0,n.jsx)(ew.b,{className:"size-4 !text-gray-500"}),(0,n.jsx)("div",{className:"text-label-14 text-gray-500",children:"Drop or upload a thumbnail here"}),(0,n.jsx)(en.x,{variant:"secondary",pending:i,onClick:e=>{var t;e.preventDefault(),e.stopPropagation(),null==(t=c.current)||t.click()},children:i?"Uploading":"Upload"}),(0,n.jsx)("input",{accept:"image/*",className:"sr-only",max:1,type:"file",onChange:d,ref:c,disabled:t||i})]})})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)(e1.Label,{htmlFor:"category",className:"text-label-14 text-gray-500",children:["Category",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),null===a.category?(0,n.jsx)(I.E,{className:"h-10 w-full"}):(0,n.jsxs)(e2.l6,{value:a.category,disabled:t,onValueChange:e=>s(t=>({...t,category:e})),required:!0,children:[(0,n.jsx)(e2.bq,{id:"category",className:"disabled:border-alpha-300 disabled:bg-gray-100 disabled:text-gray-400 disabled:opacity-100 disabled:ring-0",children:(0,n.jsx)(e2.yv,{placeholder:"Select a category"})}),(0,n.jsx)(e2.gC,{children:e3.L.map(e=>(0,n.jsx)(e2.eb,{value:e.value,children:e.text},e.value))})]})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(e1.Label,{htmlFor:"description",className:"text-label-14 text-gray-500",children:"Description"}),null===a.description?(0,n.jsx)(I.E,{className:"h-48 w-full"}):(0,n.jsx)(ep.T,{asChild:!0,children:(0,n.jsx)(eh.o,{maxHeight:192,minHeight:80,disabled:t,id:"description",maxLength:e5.Kx,name:"description",placeholder:"Describe your template...",spellCheck:!1,onChange:e=>s(t=>({...t,description:e.target.value})),value:a.description||""})})]})]})}var e7=a(55709),e9=a(4868),e4=a(47540);let e8=(0,H.createServerReference)("602365428d08b773ee9895a7c99494e432f3c6983c",H.callServer,void 0,H.findSourceMapURL,"updateProjectSettingsCommunityEnabled");var te=a(99151);function tt(e){let{projectId:t,containerRef:a}=e,r=(0,p.k)(),{data:l,mutate:i}=(0,m.gS)(t),o=(0,m.LP)(),[c,d]=(0,s.useTransition)(),[h,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[v,j]=(0,s.useOptimistic)(!!((null==l?void 0:l.templateCanonId)&&!l.deletedAt)),b=(null==l?void 0:l.templateVersion)?l.templateVersion.description:null,[y,w]=(0,s.useState)({description:b,category:(null==l?void 0:l.category)||null}),k=(null==l?void 0:l.category)!==null&&(null==l?void 0:l.templateVersion.description)!==null&&(null==l?void 0:l.templateVersion.imageUrl)!==null,{files:C,uploading:S,removeFile:M,inputFileRef:A,onInputChange:D,setInitialFiles:L}=(0,te.Lb)({initialImages:(null==l?void 0:l.templateVersion)&&l.templateVersion.imageUrl?[{url:l.templateVersion.imageUrl,name:"Current Image"}]:[],disableDrag:!1,containerRef:a});(0,s.useEffect)(()=>{l&&"templateVersionId"in l&&!l.templateVersionId.startsWith("none-")&&(w(e=>({description:l.templateVersion.description||e.description,category:l.category||e.category})),l.templateVersion.imageUrl?(L([{url:l.templateVersion.imageUrl,name:"Current Image"}]),g(!1)):g(!0))},[l,L,f]);let z=l&&"templateVersionId"in l&&!l.templateVersionId.startsWith("none-");return(0,n.jsxs)("div",{className:"flex size-full flex-col",children:[(0,n.jsxs)("div",{className:"z-0 flex grow flex-col gap-4 overflow-y-auto p-4",children:[(0,n.jsxs)("div",{className:"bg-background-subtle border-alpha-200 flex items-center justify-between rounded-lg border p-3",children:[(0,n.jsxs)(e1.Label,{className:"flex flex-col gap-1 cursor-pointer",htmlFor:"project-community-switch",children:[(0,n.jsxs)("span",{className:"flex gap-2 font-medium leading-[16px] text-gray-900",children:[(0,n.jsx)("span",{children:r("projectCommunity.title")}),v&&(null==l?void 0:l.templateCanonId)&&!l.templateVersionId.startsWith("none-")&&(0,n.jsx)(e4.N,{href:"/community/".concat(l.templateCanonId),target:"_blank",children:(0,n.jsx)(u.i,{})})]}),(0,n.jsx)("span",{className:"text-gray-500",children:r("projectCommunity.description")()})]}),(0,n.jsx)(e9.Switch,{id:"project-community-switch",checked:v,onCheckedChange:e=>{c||(e&&x(!0),(0,s.startTransition)(async()=>{try{j(e);let a=await e8(t,e);await i(),e?void 0!==a&&"templateVersionId"in a&&!a.templateVersionId.startsWith("none-")?W.o.success("Your project has been enabled for v0 Community"):W.o.success("Your project will be enabled for v0 Community after the next successful deployment"):W.o.success("Your project is no longer visible on v0 Community")}catch(e){W.o.error("Failed to update Community Status")}finally{x(!1)}}))},disabled:!o})]}),v&&(h?(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"text-label-14 text-gray-500",children:"Thumbnail (1920 x 1080 recommended)"}),(0,n.jsx)(I.E,{className:"aspect-video w-full"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)(e1.Label,{htmlFor:"category",className:"text-label-14 text-gray-500",children:["Category",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)(I.E,{className:"h-10 w-full"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(e1.Label,{htmlFor:"description",className:"text-label-14 text-gray-500",children:"Description"}),(0,n.jsx)(I.E,{className:"h-48 w-full"})]})]}):z?(0,n.jsx)(e6,{isPending:c,values:y,setValues:w,files:C,uploading:S,removeFile:M,inputFileRef:A,onInputChange:D,awaitingThumbnail:f}):(0,n.jsxs)(N.Zp,{className:"bg-muted flex aspect-video w-full flex-col items-center justify-center gap-2",children:[(0,n.jsx)("div",{className:"text-label-14 font-medium",children:"No Template Version"}),(0,n.jsx)("div",{className:"text-label-14 text-pretty text-center text-gray-500",children:"Your project will be enabled for v0 Community after the next successful deployment"})]}))]}),v&&z&&(0,n.jsx)("div",{className:"bg-muted shrink-0 border-t p-4",children:(0,n.jsx)(en.x,{className:"w-full",size:"sm",pending:c,disabled:S||!k,onClick:()=>l?y.category?C.length&&"success"===C[0].status?void d(async()=>{let e=await (0,e7.D)({blockId:l.templateVersion.blockId,description:y.description||"",category:y.category,imageUrl:C[0].url});if(e.error)return void W.o.error(e.error);W.o.success("Update successful")}):void W.o.error("Please add a thumbnail image"):void W.o.error("Please select a category"):void W.o.error("Template not found"),children:c?"Saving":"Save Changes"})})]})}var ta=a(44557);async function tn(e){let{v0ProjectId:t,chatId:a,integration:n,dashboardProject:s,teamSlug:r,source:l,messageId:i,needPrefix:o}=e;if(!t)return"";let c=await $({projectId:t,chatId:a||void 0,integrationId:n.id,integrationName:n.name,source:l,messageId:i});if(!c.success)return W.o.error("Failed to start integration setup process."),"";let d=n.parentSlug||n.slug,u=new URLSearchParams;return(u.set("v0pid",t),u.set("token",c.token),o&&u.set("needPrefix","true"),n.parentSlug&&u.set("productId",n.id),s)?"https://vercel.com/v0/".concat(r,"/").concat(s.name,"/").concat(d,"?").concat(u.toString()):"https://vercel.com/v0/".concat(r,"/").concat(d,"?").concat(u.toString())}let ts=[{value:"overview",label:"Overview"},{value:"integrations",label:"Integrations"},{value:"env",label:"Environment Variables"},{value:"knowledge",label:"Knowledge"},{value:"community",label:"Community"}];function tr(e){var t,a,b;let{v0ProjectId:N,chatTitle:k,isSheetOpen:C,onOpenChange:S,initiatePolling:M}=e,{cpe:I}=(0,j.D)(),A=(0,p.k)(),D=(0,w.usePathname)(),{vercelProjectWithDashboard:z,isLoading:E}=(0,m.Ok)(N),{activeScope:P}=(0,O.k6)(),T=(0,v._)(),{reassignPending:F,handleReassignProject:R}=(0,f.Z)(),{chatId:U}=(0,g.xz)(),[V,H]=(0,s.useState)(!1),[$,Q]=(0,s.useState)(!1),{activeScopeSlug:X}=(0,O.k6)(),{refetchVercelProject:ee}=(0,m.Ok)(N),et=(0,Z.useSetAtom)(Y.uH),{submit:ea}=(0,K.yI)(),[en,es]=(0,Z.useAtom)(Y.xb),er=(0,Z.useSetAtom)(Y.xb),el=(0,s.useRef)(null),ei=null==z||null==(a=z.dashboardProject)||null==(t=a.productionDeployment)?void 0:t.id,ec=(0,s.useCallback)(e=>{S?S(e):H(e),setTimeout(()=>{e||er("overview")},200)},[S,er]),ed=(0,s.useMemo)(()=>D.split("/").includes("projects"),[D]),eu=(0,s.useCallback)(e=>{e.preventDefault(),e.target instanceof Element&&e.target.closest("[data-sources-drop-container]")||e.stopPropagation()},[]);return(0,n.jsxs)(l.cj,{open:void 0!==C?C:V,onOpenChange:ec,children:[(0,n.jsx)(l.CG,{asChild:!0,children:(0,n.jsx)(r.$,{"aria-label":A("projectSettings.label"),className:"size-7 rounded-md px-1 py-1.5 text-gray-900",size:"sm",variant:"ghost",tooltip:{side:"bottom",content:"Project Settings"},children:(0,n.jsx)(o.H,{})})}),(0,n.jsx)(l.h,{className:"pointer-events-auto flex w-screen flex-col gap-0 overflow-hidden p-0 data-[state=closed]:duration-300 data-[state=open]:duration-300 sm:!max-w-[550px]","aria-describedby":void 0,onInteractOutside:e=>{$&&e.preventDefault()},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onMouseLeave:e=>{e.preventDefault(),e.stopPropagation()},onCloseAutoFocus:e=>{e.preventDefault()},onDrop:eu,side:"right",showClose:!1,ref:el,children:N?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Fm,{className:"sticky gap-1 p-4 text-left",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,n.jsx)(l.qp,{className:"text-base",children:A("projectSettings.label")}),(0,n.jsxs)("div",{className:"flex gap-2",children:[!ed&&(0,n.jsx)(r.$,{variant:"outline",className:"h-7 rounded-md",size:"sm",asChild:!0,children:(0,n.jsxs)(y(),{href:"/chat/projects/".concat(N),target:"_blank",children:["View Project ",(0,n.jsx)(u.i,{})]})}),(0,n.jsx)(l.kN,{asChild:!0,children:(0,n.jsx)(r.$,{variant:"outline",className:"size-7 rounded-md",size:"sm",children:(0,n.jsx)(d.F,{})})})]})]})}),(0,n.jsxs)(J.Tabs,{variant:"underline",value:en,onValueChange:e=>{"overview"===e&&ee(),es(e)},className:"relative z-0 flex grow flex-col overflow-hidden",children:[(0,n.jsx)("div",{className:"from-background pointer-events-none absolute -left-px top-0 z-10 h-[31px] w-6 bg-gradient-to-r to-transparent"}),(0,n.jsx)("div",{className:"from-background pointer-events-none absolute -right-px top-0 z-10 h-[31px] w-6 bg-gradient-to-l to-transparent"}),(0,n.jsx)(J.TabsList,{className:"no-scrollbar z-0 w-full shrink-0 overflow-x-auto px-2",children:ts.map(e=>(0,n.jsx)(J.TabsTrigger,{value:e.value,children:e.label},e.value))}),(0,n.jsx)(tl,{value:"overview",children:(0,n.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,n.jsx)(eV,{setSaving:Q,vercelProjectWithDashboard:z,isLoading:E,v0ProjectId:N,closeSettingsSheet:()=>ec(!1)}),(0,n.jsx)(eK,{vercelProjectWithDashboard:z,isLoading:E,v0ProjectId:N,closeSettingsSheet:()=>ec(!1),chatId:U}),N&&ei&&(0,n.jsx)(ta.Sn,{deploymentId:ei})]})}),(0,n.jsx)(tl,{value:"integrations",children:(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(B,{}),children:(0,n.jsx)(_,{isV3:!1,vercelProjectId:null==z?void 0:z.project.id,onIntegrationClick:async(e,t,a,n,s)=>{if("blob"===e.slug)return void((await fetch("/chat/api/integrations/marketplace/storage/create-blob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(null==z?void 0:z.project.name,"-blob"),projectId:null==z?void 0:z.project.id})})).ok?(W.o.success("Blob storage connected successfully"),(0,L.u)("AddIntegration",{integrationSlug:"blob",chatId:U||"",source:"settings"}),et(!1),ed||await ea({action:"new",attachments:[],input:"A blob store has been added to the [Vercel Project](".concat(null==z?void 0:z.project.url,")."),type:"added-integration",workflowState:"ask-user-for-next-steps",revalidateVercelEnvAndIntegrations:!0})):W.o.error("Failed to connect blob storage"));let r=await tn({v0ProjectId:a||"",chatId:U||"",integration:e,dashboardProject:n,teamSlug:P&&(0,q.W)(P)?null!=T?T:"":null!=X?X:"",source:"settings",needPrefix:t});null==M||M(),r&&s?s.location.href=r:r&&window.open(r,"_blank")},vercelProjectName:null!=(b=null==z?void 0:z.project.name)?b:"",teamSlug:P&&(0,q.W)(P)?null!=T?T:"":null!=X?X:""})})}),(0,n.jsx)(tl,{value:"env",className:"p-4",children:(0,n.jsx)(eo,{setSaving:Q,vercelProjectId:null==z?void 0:z.project.id,v0ProjectId:N})}),(0,n.jsxs)(tl,{value:"knowledge",children:[(0,n.jsx)(ef,{setSaving:Q,projectId:N}),(0,n.jsx)(eA,{setSaving:Q,projectId:N})]}),I&&(0,n.jsx)(tl,{value:"community",className:"overflow-hidden",children:(0,n.jsx)(tt,{projectId:N,containerRef:el})})]})]}):(0,n.jsxs)("div",{className:"bg-muted flex grow flex-col items-center justify-center gap-3 rounded-md px-9 py-12",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsx)(h.Ft,{children:(0,n.jsx)(c.z,{})}),(0,n.jsx)("p",{className:"font-medium text-gray-900",children:"Add to a Project"}),(0,n.jsx)("p",{className:"text-center text-sm text-gray-500",children:"Add this chat to a project to add instructions, sources, environment variables, integrations, and more."})]}),(0,n.jsx)(x.o,{className:"w-auto",handleProjectSelect:R,projectName:k,onSuccess:e=>{U&&(0,G.M)({payload:{chatId:U,projectId:e}})},quickCreate:!0,align:"center",triggerButton:(0,n.jsxs)(r.$,{size:"sm",variant:"secondary",disabled:F,children:[(0,n.jsx)(i.F,{}),"Add Project"]}),disabled:F})]})})]})}function tl(e){let{value:t,className:a,children:s}=e;return(0,n.jsx)(J.a,{value:t,className:(0,z.cn)("grow overflow-y-auto",a),children:s})}},51919:()=>{},52520:(e,t,a)=>{"use strict";a.d(t,{Ok:()=>s,_I:()=>l,l:()=>r});var n=a(74377);let s=()=>(0,n.$C)(32),r=()=>(0,n.$C)(21),l=()=>(0,n.$C)(11)},53663:(e,t,a)=>{"use strict";a.d(t,{Y:()=>s});var n=a(33571);function s(e,t){var a;let[s,r]=(0,n.useState)(null!=(a=null==t?void 0:t.showInitialBorders)&&a),[l,i]=(0,n.useState)(!1),o=(0,n.useRef)(null),c=(null==t?void 0:t.containerRef)||o,d=(0,n.useRef)(null),u=(0,n.useRef)(null);return((0,n.useEffect)(()=>{var e;let a=c.current,n=d.current,s=u.current;if(!a||!n||!s)return;let l={root:a,threshold:null!=(e=null==t?void 0:t.threshold)?e:0},o=new IntersectionObserver(e=>{let[t]=e;r(!t.isIntersecting)},l),m=new IntersectionObserver(e=>{let[t]=e;i(!t.isIntersecting)},l);return o.observe(n),m.observe(s),()=>{o.disconnect(),m.disconnect()}},[c,null==t?void 0:t.threshold]),"vertical"==e)?{showTopBorder:s,showBottomBorder:l,topRef:d,bottomRef:u,containerRef:c}:{showLeftBorder:s,showRightBorder:l,leftRef:d,rightRef:u,containerRef:c}}},54116:(e,t,a)=>{"use strict";a.d(t,{s:()=>eu});var n=a(97667),s=a(33571),r=a(39929),l=a(66692),i=a(93660),o=a(27693),c=a(83933),d=a(58642),u=a(57765),m=a(66759),h=a(69701),p=a(35733),x=a(34825),f=a(70676);let g=(0,f.createServerReference)("00d0b6c3e7f76a71dec7120462cfa42881d04ab697",f.callServer,void 0,f.findSourceMapURL,"logoutAction");var v=a(99339),j=a(28819),b=a(2995),y=a(12029),w=a(1731),N=a(92461),k=a(40445),C=a(73655),S=a(45050),M=a(46290),I=a(50307),A=a(17e3),D=a(20125),L=a(45650);function z(e){let{className:t}=e,{theme:a,setTheme:s}=(0,L.D)(),r=(0,o.k)();return(0,n.jsx)(A.Tabs,{variant:"secondary",className:t,onClick:e=>e.stopPropagation(),onValueChange:e=>s(e),value:a,children:(0,n.jsxs)(A.TabsList,{id:"theme-switcher",className:(0,j.cn)("h-fit overflow-hidden rounded-full border p-0 focus-within:overflow-visible [&>[role=tab]]:size-6","[&>[role=tab]>.absolute]:-inset-px [&>[role=tab]>.absolute]:rounded-full [&>[role=tab]>.absolute]:border [&>[role=tab]>.absolute]:bg-transparent"),children:[(0,n.jsx)(D.Tooltip,{content:r("sidebar.themeSwitcher.system"),children:(0,n.jsxs)(A.TabsTrigger,{className:"[&>div]:shrink-0",value:"system",children:[(0,n.jsx)(S.L,{size:12}),(0,n.jsx)("span",{className:"sr-only",children:"System"})]})}),(0,n.jsx)(D.Tooltip,{content:r("sidebar.themeSwitcher.light"),children:(0,n.jsxs)(A.TabsTrigger,{className:"[&>div]:shrink-0",value:"light",children:[(0,n.jsx)(I.b,{size:12}),(0,n.jsx)("span",{className:"sr-only",children:"Light"})]})}),(0,n.jsx)(D.Tooltip,{content:r("sidebar.themeSwitcher.dark"),children:(0,n.jsxs)(A.TabsTrigger,{className:"[&>div]:shrink-0",value:"dark",children:[(0,n.jsx)(M.A,{size:12}),(0,n.jsx)("span",{className:"sr-only",children:"Dark"})]})})]})})}var E=a(91220),P=a(94293),T=a(99080);let F=(0,f.createServerReference)("40ad9522a5ee65bc12818bccf1f3cf44e61c087258",f.callServer,void 0,f.findSourceMapURL,"setAdminMode"),R=(0,f.createServerReference)("401d107d4149678c5416c42192b0eeca96d7b23bce",f.callServer,void 0,f.findSourceMapURL,"setDemoMode");var U=a(4868);function V(){let e=(0,o.k)(),{user:t}=(0,C.k6)(),[a,l]=(0,s.useTransition)(),[i,c]=(0,s.useState)(),d=(0,s.useMemo)(()=>null!=i?i:null==t?void 0:t.isAdminMode,[i,null==t?void 0:t.isAdminMode]),[u,m]=(0,s.useTransition)(),[h,p]=(0,s.useState)(),x=(0,s.useMemo)(()=>null!=h?h:null==t?void 0:t.isDemoMode,[h,null==t?void 0:t.isDemoMode]);return(0,n.jsxs)(n.Fragment,{children:[(null==t?void 0:t.isVercelian)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(b.rX,{children:[(0,n.jsx)(b.Wq,{children:"Internal"}),!x&&(0,n.jsx)(_,{clickable:!0,disabled:a,onClick:()=>{let e=!d;c(e),l(()=>F(e))},label:"Admin Mode",children:(0,n.jsx)(U.Switch,{className:"pointer-events-none",checked:d,asDiv:!0})}),(0,n.jsx)(_,{clickable:!0,disabled:u,onClick:()=>{let e=!x;p(e),m(()=>R(e))},label:"Demo Mode",children:(0,n.jsx)(U.Switch,{className:"pointer-events-none",checked:x,asDiv:!0})})]}),(0,n.jsx)(r.mB,{})]}):null,(0,n.jsxs)(b.rX,{children:[(0,n.jsx)(b.Wq,{children:e("sidebar.scopeSwitcher.preferences")}),(0,n.jsx)(_,{label:e("sidebar.scopeSwitcher.theme"),onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null==(t=document.getElementById("theme-switcher"))||t.focus())},children:(0,n.jsx)(z,{})}),(0,n.jsx)(_,{label:e("sidebar.scopeSwitcher.language"),onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null==(t=document.getElementById("locale-switcher"))||t.focus())},children:(0,n.jsx)(B,{})})]})]})}function B(){let{locale:e,setLocale:t}=(0,P.useLocale)();return(0,n.jsxs)(E.l6,{onValueChange:e=>t(e),value:e,children:[(0,n.jsx)(E.bq,{id:"locale-switcher",className:"h-7 max-w-[5rem] gap-1 px-2 [&>svg]:w-3 [&>svg]:shrink-0","data-testid":"language-selector",children:(0,n.jsx)("div",{className:"truncate text-xs",children:(0,n.jsx)(E.yv,{placeholder:T.YZ[e]})})}),(0,n.jsx)(E.gC,{children:(0,n.jsx)(E.s3,{children:Object.keys(T.YZ).map(e=>(0,n.jsx)(E.eb,{value:e,children:T.YZ[e]},e))})})]})}let _=e=>{let{label:t,children:a,clickable:s=!1,className:r,...l}=e,i=(0,j.cn)("cursor-default items-center justify-between gap-4 focus:bg-transparent focus-visible:bg-gray-100","function"==typeof l.onClick&&"cursor-pointer",r);return(0,n.jsxs)(b.Dr,{className:i,clickable:s,svgStyling:!1,...l,children:[(0,n.jsx)(b.sW,{label:t}),a]})};var O=a(3069);let H=s.forwardRef((e,t)=>{let{className:a,value:s,...r}=e;return(0,n.jsx)(O.bL,{ref:t,className:(0,j.cn)("bg-secondary relative h-4 w-full overflow-hidden rounded-full",a),...r,children:(0,n.jsx)(O.C1,{className:"h-full w-full flex-1 rounded-r-full bg-teal-700 transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});H.displayName=O.bL.displayName;var $=a(18858);function q(){let[e]=(0,$.d)();if(!e)return(0,n.jsxs)("div",{className:"text-muted-foreground flex w-full flex-col gap-1.5 p-1.5 text-[13px] font-medium",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"Messages Left"}),(0,n.jsx)(i.E,{className:"h-3 w-12"})]}),(0,n.jsx)(i.E,{className:"h-2 w-full"}),(0,n.jsx)(i.E,{className:"mb-[3.5px] mt-1 h-3 w-32"})]});let t=e.remaining/e.limit*100,a=Math.ceil((new Date(e.reset).getTime()-Date.now())/864e5);return(0,n.jsxs)("div",{className:"text-muted-foreground flex w-full flex-col gap-1.5 p-1.5 text-[13px] font-medium",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-gray-600",children:"Messages Left"}),(0,n.jsxs)("span",{className:"flex items-center gap-1 text-gray-500",children:[e.remaining,"/",e.limit]})]}),(0,n.jsx)(H,{value:t,className:"h-2"}),(0,n.jsx)("div",{className:"flex items-center justify-between font-normal",children:(0,n.jsxs)("span",{className:"flex items-center gap-1",children:["Usage resets in ",a," ",(0,n.jsx)("span",{children:1===a?"day":"days"})]})})]})}var W=a(63476),G=a(25887),Z=a(35501),Y=a.n(Z),K=a(17253);function J(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(b.rX,{children:[(0,n.jsx)(b.Wq,{children:"Credit Balance"}),(0,n.jsx)(Q,{label:"Monthly credits"}),(0,n.jsx)(Q,{label:"Purchased credits"})]}),(0,n.jsx)(r.mB,{})]})}let Q=e=>{let{label:t,className:a,...s}=e,r=(0,j.cn)("focus-visible:none cursor-default items-center justify-between gap-4 focus:bg-transparent",a);return(0,n.jsxs)(b.Dr,{className:r,clickable:!1,svgStyling:!1,...s,children:[(0,n.jsx)(b.sW,{label:t}),(0,n.jsx)("div",{className:"h-5 w-16 animate-pulse rounded bg-gray-200"})]})};function X(e){let{onClick:t}=e,{planInfo:a,isLoading:l}=(0,K.z)(),i=(0,s.useMemo)(()=>{if(a)return Math.ceil(Math.abs(a.billingCycle.end-Date.now())/864e5)},[a]);if(l)return(0,n.jsx)(J,{});if(!a)return null;let o=a.plan,c="v0-level0"===o,d=a.balance.remaining,u=a.onDemand.balance;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(b.rX,{children:[(0,n.jsx)(b.Wq,{children:"Credit Balance"}),(0,n.jsx)(b.xG,{className:"font-medium text-gray-500",label:"Monthly credits",href:"/chat/settings/billing",onClick:()=>t(!1),children:d.toFixed(2)}),c?null:(0,n.jsx)(b.xG,{className:"font-medium text-gray-500",label:"Purchased credits",href:"/chat/settings/billing",onClick:()=>t(!1),children:u.toFixed(2)}),(0,n.jsx)(ee,{plan:o,monthly:d,payAsYouGo:u,daysRemaining:i})]}),(0,n.jsx)(r.mB,{})]})}function ee(e){let{plan:t,monthly:a,payAsYouGo:s,daysRemaining:r}=e;return"v0-level0"===t?(0,n.jsx)(es,{}):!a&&s?(0,n.jsx)(en,{}):a<=0&&r&&"number"==typeof s?(0,n.jsx)(ea,{daysRemaining:r}):null}let et=e=>{let{variant:t,children:a}=e;return(0,n.jsx)("div",{className:(0,j.cn)("mt-1 rounded-lg p-2","amber"===t?"bg-amber-50":"bg-blue-100"),children:(0,n.jsx)("p",{className:(0,j.cn)("font-sm text-sm [&_a]:font-medium [&_a]:underline [&_button]:font-medium [&_button]:underline","amber"===t?"text-amber-900 [&_a]:hover:text-amber-700":"text-blue-900 [&_a]:text-blue-800 [&_a]:hover:text-blue-700"),children:a})})};function ea(e){let{daysRemaining:t}=e;return(0,n.jsxs)(et,{variant:"amber",children:["Your monthly credits will reset in ",t," ",1===t?"day":"days","."," ",(0,n.jsx)("button",{onClick:()=>(0,G.D)({type:"buyMoreCredits",data:{onSuccess:()=>{}}}),children:"Buy more credits"})]})}function en(){return(0,n.jsxs)(et,{variant:"blue",children:["You're now using your pay as you go credits."," ",(0,n.jsx)(Y(),{href:"/chat/settings/billing",children:"Buy more credits"})]})}function es(){return(0,n.jsxs)(et,{variant:"blue",children:["Upgrade your plan to buy more credits."," ",(0,n.jsx)(l.$,{className:"text-blue-800 underline underline-offset-1",onClick:()=>(0,G.D)({type:"upgradePlan"}),variant:"link",children:"Upgrade plan"})]})}var er=a(37707),el=a(86943),ei=a(83195),eo=a(13833),ec=a(15941);function ed(e){var t;let{className:a}=e,{activeScope:s}=(0,C.k6)(),{planInfo:r,planSlug:l}=(0,ei.N)(!0,null==s?void 0:s.id),i=(0,eo.DB)(r),o=null==i||null==(t=i.openInvoices[0])?void 0:t.url;return r&&o&&l&&"v0-level0"!==l&&"paid"!==i.status&&"processing"!==i.status?(0,n.jsx)(N.E,{className:(0,j.cn)("pointer-events-auto h-7 rounded-md border border-red-600/20 px-2 text-sm text-red-700 hover:bg-red-200 focus:bg-red-200 focus-visible:bg-red-200 has-[>svg]:pl-2",a),variant:"red",asChild:!0,children:(0,n.jsxs)(Y(),{href:o,children:[(0,n.jsx)(ec.N,{size:16}),(0,n.jsx)("span",{className:"non-payment-text",children:"Payment Failed"})]})}):null}function eu(e){let{className:t,...a}=e,f=(0,o.k)(),[S,M]=(0,s.useState)(!1),I=(0,W.x)(),{tbb:A}=(0,er.D)(),D=(0,s.useRef)(null),{activeScope:L,user:z}=(0,C.k6)(),E=(0,k.W)(L),P=(0,s.useCallback)(()=>{(0,G.D)({type:"upgradePlan"}),M(!1)},[]);if(!z)return(0,n.jsx)(i.E,{className:"m-0.5 size-6 rounded-full"});let T=E&&"v0-level0"===z.v0plan,F=z.isAdminMode;return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(ed,{className:I?"@[60rem]/chat-header:[&_.non-payment-text]:block @[60rem]/chat-header:w-auto w-7 [&_.non-payment-text]:hidden":void 0}),F?(0,n.jsxs)(N.E,{className:"pointer-events-none h-7 rounded-md border border-blue-600/20 px-2 text-sm text-blue-700 has-[>svg]:pl-2",variant:"blue",children:[(0,n.jsx)(u.F,{size:16}),"Admin Mode"]}):null,"test"===z.billingMode?(0,n.jsxs)(N.E,{className:"pointer-events-none h-7 rounded-md border border-blue-600/20 px-2 text-sm text-blue-700 has-[>svg]:pl-2",variant:"blue",children:[(0,n.jsx)(u.F,{size:16}),"Stripe Test Mode"]}):null,(0,n.jsxs)(r.DropdownMenu,{open:S,onOpenChange:M,children:[(0,n.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(l.$,{ref:D,className:(0,j.cn)("hover:bg-alpha-400 focus:bg-alpha-400 size-fit border-0 p-0.5",S&&"bg-alpha-400",F&&"bg-blue-200 ring-2 ring-blue-700 hover:bg-blue-600/50 hover:ring-blue-900 focus:bg-blue-600/50 focus:ring-blue-900",t),"data-testid":"user-menu-toggle",rounded:!0,variant:"ghost",tooltip:F?"You are in Admin Mode":"Profile",...a,children:(0,n.jsx)(v.AvatarUser,{userId:z.id,className:"size-6 rounded-full"})})}),(0,n.jsxs)(r.DropdownMenuContent,{onCloseAutoFocus:e=>{e.preventDefault()},onEscapeKeyDown:()=>{var e;M(!1),null==(e=D.current)||e.focus()},align:"end",className:"max-h-[calc(100vh-90px)] w-[250px] overflow-y-auto",side:"top",sideOffset:8,children:[(0,n.jsx)(b.rX,{children:(0,n.jsx)("div",{className:"h-11 content-center px-1.5",children:(0,n.jsx)(w.X,{scope:z,user:z,showEmail:!0,showName:!0,showAvatar:!1})})}),T&&!A?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.mB,{}),(0,n.jsx)(b.rX,{children:(0,n.jsx)(q,{})})]}):null,(0,n.jsx)(r.mB,{}),(0,n.jsxs)(b.rX,{children:[(0,n.jsx)(b.xG,{label:f("sidebar.scopeSwitcher.settings"),Icon:(0,n.jsx)(d.H,{}),href:"/chat/settings",onClick:()=>{M(!1)}}),(0,n.jsx)(b.xG,{label:"Pricing",Icon:(0,n.jsx)(p.p,{}),href:"/pricing"}),(0,n.jsx)(b.xG,{label:"Documentation",Icon:(0,n.jsx)(h.G,{}),href:"https://vercel.com/docs/v0"}),(0,n.jsx)(b.xG,{label:"Community Forum",sameTab:!1,className:"group",Icon:(0,n.jsx)(x.z,{className:"[&_path]:fill-gray-500 group-hover:[&_path]:fill-gray-900"}),href:el.ts}),I?(0,n.jsx)(b.Dr,{onSelect:()=>(0,G.D)({type:"feedback"}),children:(0,n.jsx)(b.sW,{label:"Feedback",Icon:(0,n.jsx)(m.v,{})})}):null]}),(0,n.jsx)(r.mB,{}),A?(0,n.jsx)(X,{onClick:M}):null,(0,n.jsx)(V,{}),(0,n.jsx)(r.mB,{}),(0,n.jsx)(b.rX,{children:(0,n.jsx)(b.bA,{label:f("sidebar.scopeSwitcher.signOut"),Icon:(0,n.jsx)(c.f,{}),action:g})}),T&&!A?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.mB,{}),(0,n.jsx)(b.rX,{children:(0,n.jsx)(y._2,{asChild:!0,children:(0,n.jsx)(l.$,{size:"sm",className:"focus:ring-0 focus-visible:ring-0",onClick:P,"data-testid":"upgrade-cta-button",children:"Upgrade to Premium"})})})]}):null]})]})]})}},54483:(e,t,a)=>{"use strict";a.d(t,{s:()=>s});var n=a(25603);function s(e){let{blockId:t,fileName:a,originalCode:s,newCode:r}=e,{data:l,mutate:i}=(0,n.Ay)(["block:diffView:show",t],{fallbackData:!1}),{data:o}=(0,n.Ay)(["block:diffView",t,a],{fallbackData:!!s&&s!==r});return{hasDiffs:o,showDiffs:l,setShowDiffs:i}}},54545:(e,t,a)=>{"use strict";a.d(t,{u:()=>n});let n={current:null}},54810:(e,t,a)=>{"use strict";a.d(t,{Qg:()=>p,Sb:()=>f,US:()=>d,aD:()=>g,eC:()=>x,tE:()=>c,y8:()=>m});var n=a(97667),s=a(33571),r=a(77831),l=a(8698),i=a(60914),o=a(19434);let c=l.Kq,d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(l.LM,{className:(0,o.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col lg:max-w-[420px]",a),ref:t,...s})});d.displayName=l.LM.displayName;let u=(0,i.F)("group pointer-events-auto relative flex max-w-[420px] flex-col gap-3 overflow-hidden rounded-xl p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background",destructive:"destructive group border-[#DA3036] bg-[#DA3036] text-white",warning:"warning group border-warning bg-warning text-warning-foreground"}},defaultVariants:{variant:"default"}}),m=s.forwardRef((e,t)=>{let{className:a,variant:s,...r}=e;return(0,n.jsx)(l.bL,{className:(0,o.cn)(u({variant:s}),a),ref:t,...r})});m.displayName=l.bL.displayName;let h=(0,i.F)("inline-flex h-8 shrink-0 items-center justify-center rounded-md px-3 text-sm font-medium transition-colors focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",secondary:"bg-transparent hover:bg-secondary group-[.destructive]:hover:bg-destructive"}},defaultVariants:{variant:"default"}}),p=s.forwardRef((e,t)=>{let{className:a,variant:s,...r}=e;return(0,n.jsx)(l.rc,{className:(0,o.cn)(h({variant:s}),a),ref:t,...r})});p.displayName=l.rc.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(l.bm,{className:(0,o.cn)("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),ref:t,"toast-close":"",...s,children:(0,n.jsx)(r.MKb,{className:"h-4 w-4"})})});x.displayName=l.bm.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(l.hE,{className:(0,o.cn)("text-sm font-semibold [&+div]:text-xs",a),ref:t,...s})});f.displayName=l.hE.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(l.VY,{className:(0,o.cn)("text-sm opacity-90",a),ref:t,...s})});g.displayName=l.VY.displayName},54910:(e,t,a)=>{"use strict";a.d(t,{Kn:()=>o,Sl:()=>d,rc:()=>c});var n=a(97667),s=a(33571),r=a(28819),l=a(66692),i=a(81966);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("bg-background flex w-fit items-center gap-1 rounded-[10px] p-1 shadow-sm",a),ref:t,...s})});o.displayName="ActionGroup";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(l.$,{className:(0,r.cn)("hover:bg-alpha-200 focus:bg-alpha-200 focus-visible:bg-alpha-200 h-6 min-w-6 rounded-md px-1 text-sm text-gray-500 hover:text-gray-900 focus:text-gray-900 focus-visible:text-gray-900 has-[>kbd]:gap-[6px] has-[>svg]:px-1",a),ref:t,size:"xs",variant:"ghost",...s})});c.displayName="Action";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(i.Separator,{className:(0,r.cn)("bg-alpha-400 h-5 w-px",a),ref:t,...s})});d.displayName="ActionSeparator"},55709:(e,t,a)=>{"use strict";a.d(t,{D:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40927a25b749eb709f2fac147306ec305b56e4eb41",n.callServer,void 0,n.findSourceMapURL,"editTemplateAction")},56033:(e,t,a)=>{"use strict";a.d(t,{Y:()=>d});var n=a(97667);a(33571);var s=a(28819),r=a(65994),l=a(66692),i=a(32707),o=a(84466),c=a(71543);function d(e){let{className:t,...a}=e,{setSheetOpen:d}=(0,r.e)(),{expectUser:u}=(0,c.J)();return u?(0,n.jsxs)(l.$,{className:(0,s.cn)("size-7 rounded-md sm:hidden",t),size:"sm",variant:"ghost",id:"sidebar-trigger",onClick:()=>d(!0),...a,children:[(0,n.jsx)(o.P,{className:"size-4 shrink-0"}),(0,n.jsx)("span",{className:"sr-only",children:"Show Menu"})]}):(0,n.jsx)(i.NewChatButton,{variant:"logo-sm",className:t})}},56179:(e,t,a)=>{"use strict";function n(e,t){return e.slice().sort(t)}a.d(t,{n:()=>n})},56505:(e,t,a)=>{"use strict";a.d(t,{o:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40f483f15ce9ae2418f4d99129d454596df1b46c5b",n.callServer,void 0,n.findSourceMapURL,"renameProject")},56508:(e,t,a)=>{"use strict";a.d(t,{C:()=>w});var n=a(97667);function s(){return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M0 8C0 3.58172 3.58172 0 8 0V0C12.4183 0 16 3.58172 16 8V8C16 12.4183 12.4183 16 8 16V16C3.58172 16 0 12.4183 0 8V8Z",fill:"#18181B"}),(0,n.jsx)("path",{d:"M12.1998 9.32958C12.1998 6.90643 10.3194 4.10002 7.9998 4.10002C5.68021 4.10002 3.7998 6.90643 3.7998 9.32958C3.7998 11.7527 5.68021 11.9 7.9998 11.9C10.3194 11.9 12.1998 11.7527 12.1998 9.32958Z",stroke:"#D97706",strokeWidth:"1.5"})]})}function r(){return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M0 8.00001C0 3.58193 3.58192 0.000366211 8 0.000366211V0.000366211C12.4181 0.000366211 16 3.58193 16 8.00001V8.00001C16 12.4181 12.4181 15.9997 8 15.9997V15.9997C3.58192 15.9997 0 12.4181 0 8.00001V8.00001Z",fill:"#18181B"}),(0,n.jsx)("path",{d:"M11.6702 4.24481C10.0485 2.58555 7.41938 2.58555 5.79776 4.24481C4.17614 5.90408 4.17614 8.59428 5.79776 10.2536L6.5318 9.50247C5.3156 8.25801 5.3156 6.24035 6.5318 4.99592C7.74802 3.75146 9.7199 3.75146 10.9361 4.99592L11.6702 4.24481Z",fill:"black"}),(0,n.jsx)("path",{d:"M10.2025 5.7474C9.39174 4.91778 8.07712 4.91778 7.26632 5.7474C6.4555 6.57705 6.4555 7.92214 7.26632 8.75176L8.00037 8.00068C7.59496 7.58586 7.59496 6.91332 8.00037 6.49849C8.40577 6.08367 9.06305 6.08367 9.46848 6.49849L10.2025 5.7474Z",fill:"black"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.202 11.7552C8.58039 13.4144 5.95122 13.4144 4.32959 11.7552L5.06364 11.0041C6.27986 12.2486 8.25174 12.2486 9.46795 11.0041C10.6842 9.75966 10.6842 7.742 9.46795 6.49754L10.202 5.74646C11.8236 7.40573 11.8236 10.0959 10.202 11.7552ZM8.73479 10.2531C7.92396 11.0827 6.60939 11.0827 5.79858 10.2531L6.53263 9.50197C6.93803 9.91678 7.59532 9.91678 8.00074 9.50197C8.40614 9.08714 8.40614 8.41459 8.00074 7.99978L8.73479 7.2487C9.54559 8.07832 9.54559 9.42343 8.73479 10.2531Z",fill:"#58C591"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.79825 4.24499C7.41987 2.58573 10.049 2.58573 11.6707 4.24499L10.9366 4.9961C9.72039 3.75164 7.74851 3.75164 6.53229 4.9961C5.31609 6.24054 5.31609 8.25819 6.53229 9.50265L5.79825 10.2537C4.17662 8.59447 4.17662 5.90426 5.79825 4.24499ZM7.26632 5.74753C8.07712 4.91791 9.39174 4.91791 10.2025 5.74753L9.46848 6.49862C9.06305 6.0838 8.40577 6.0838 8.00037 6.49862C7.59496 6.91345 7.59496 7.586 8.00037 8.00081L7.26632 8.75189C6.4555 7.92227 6.4555 6.57718 7.26632 5.74753Z",fill:"#84DBBD"})]})}function l(){return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"0",width:"16",height:"16",rx:"8",fill:"#18181B"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.60645 5.13072C3.60645 4.29017 4.28784 3.60876 5.12838 3.60876H10.9117C11.7523 3.60876 12.4336 4.29017 12.4336 5.13072V10.0495C12.4336 10.9191 11.3332 11.2965 10.7995 10.6099L9.13105 8.46362V11.0663C9.13105 11.8228 8.51779 12.4361 7.76132 12.4361H5.12838C4.28784 12.4361 3.60645 11.7547 3.60645 10.9141V5.13072ZM5.12838 4.82633C4.96027 4.82633 4.82399 4.96261 4.82399 5.13072V10.9141C4.82399 11.0822 4.96027 11.2185 5.12838 11.2185H7.80699C7.89102 11.2185 7.9135 11.1504 7.9135 11.0663V7.57609C7.9135 6.70648 9.01392 6.32907 9.54761 7.01564L11.2161 9.16197V5.13072C11.2161 4.96261 11.232 4.82633 11.0639 4.82633H5.12838Z",fill:"#12FFF7"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.60645 5.13072C3.60645 4.29017 4.28784 3.60876 5.12838 3.60876H10.9117C11.7523 3.60876 12.4336 4.29017 12.4336 5.13072V10.0495C12.4336 10.9191 11.3332 11.2965 10.7995 10.6099L9.13105 8.46362V11.0663C9.13105 11.8228 8.51779 12.4361 7.76132 12.4361H5.12838C4.28784 12.4361 3.60645 11.7547 3.60645 10.9141V5.13072ZM5.12838 4.82633C4.96027 4.82633 4.82399 4.96261 4.82399 5.13072V10.9141C4.82399 11.0822 4.96027 11.2185 5.12838 11.2185H7.80699C7.89102 11.2185 7.9135 11.1504 7.9135 11.0663V7.57609C7.9135 6.70648 9.01392 6.32907 9.54761 7.01564L11.2161 9.16197V5.13072C11.2161 4.96261 11.232 4.82633 11.0639 4.82633H5.12838Z",fill:"url(#paint0_linear_6519_11262)"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.60645 5.13072C3.60645 4.29017 4.28784 3.60876 5.12838 3.60876H10.9117C11.7523 3.60876 12.4336 4.29017 12.4336 5.13072V10.0495C12.4336 10.9191 11.3332 11.2965 10.7995 10.6099L9.13105 8.46362V11.0663C9.13105 11.8228 8.51779 12.4361 7.76132 12.4361H5.12838C4.28784 12.4361 3.60645 11.7547 3.60645 10.9141V5.13072ZM5.12838 4.82633C4.96027 4.82633 4.82399 4.96261 4.82399 5.13072V10.9141C4.82399 11.0822 4.96027 11.2185 5.12838 11.2185H7.80699C7.89102 11.2185 7.9135 11.1504 7.9135 11.0663V7.57609C7.9135 6.70648 9.01392 6.32907 9.54761 7.01564L11.2161 9.16197V5.13072C11.2161 4.96261 11.232 4.82633 11.0639 4.82633H5.12838Z",fill:"url(#paint1_linear_6519_11262)"}),(0,n.jsx)("path",{d:"M10.9121 3.60876C11.7527 3.60876 12.4341 4.29017 12.4341 5.13072V10.0495C12.4341 10.9191 11.3336 11.2965 10.7999 10.6099L9.13145 8.46362V11.0663C9.13145 11.8228 8.51822 12.4361 7.76172 12.4361C7.84578 12.4361 7.91393 12.3679 7.91393 12.2839V7.57609C7.91393 6.70648 9.01432 6.32907 9.54802 7.01564L11.2165 9.16197V3.91315C11.2165 3.74504 11.0802 3.60876 10.9121 3.60876Z",fill:"#B9FFB3"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"paint0_linear_6519_11262",x1:"12.4336",y1:"12.4361",x2:"4.67168",y2:"3.60887",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#B9FFB3"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#B9FFB3",stopOpacity:"0"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_6519_11262",x1:"12.4336",y1:"12.4361",x2:"7.19057",y2:"10.3967",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#1A1A1A",stopOpacity:"0.9"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#1A1A1A",stopOpacity:"0"})]})]})]})}function i(){return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"0",width:"16",height:"16",rx:"8",fill:"#18181B"}),(0,n.jsxs)("g",{clipPath:"url(#clip0_6503_14101)",children:[(0,n.jsx)("path",{d:"M8.78261 12.8805C8.53205 13.2061 8.02401 13.0277 8.01797 12.612L7.92969 6.53137H11.8921C12.6097 6.53137 13.01 7.38672 12.5637 7.9667L8.78261 12.8805Z",fill:"url(#paint0_linear_6503_14101)"}),(0,n.jsx)("path",{d:"M8.78261 12.8805C8.53205 13.2061 8.02401 13.0277 8.01797 12.612L7.92969 6.53137H11.8921C12.6097 6.53137 13.01 7.38672 12.5637 7.9667L8.78261 12.8805Z",fill:"url(#paint1_linear_6503_14101)",fillOpacity:"0.2"}),(0,n.jsx)("path",{d:"M7.17088 3.09614C7.42145 2.77051 7.9295 2.94893 7.93553 3.36467L7.97422 9.44525H4.06144C3.34373 9.44525 2.94344 8.5899 3.38974 8.00992L7.17088 3.09614Z",fill:"#3ECF8E"})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"paint0_linear_6503_14101",x1:"7.92969",y1:"7.87959",x2:"11.4836",y2:"9.32409",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#249361"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#3ECF8E"})]}),(0,n.jsxs)("linearGradient",{id:"paint1_linear_6503_14101",x1:"6.36839",y1:"5.6738",x2:"8.05436",y2:"8.74958",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{}),(0,n.jsx)("stop",{offset:"1",stopOpacity:"0"})]}),(0,n.jsx)("clipPath",{id:"clip0_6503_14101",children:(0,n.jsx)("rect",{width:"9.60018",height:"10.182",fill:"white",transform:"translate(3.2002 2.90906)"})})]})]})}var o=a(66692),c=a(33571),d=a(20393),u=a(27831);function m(e){let{shouldMarch:t=!1,numberOfVisibleChildren:a=3,overlap:s=4,size:r=16,waitMs:l=500,stepDurationMs:i=700,children:o}=e,m=(0,c.useRef)(null),[h,p]=(0,c.useState)(0),[x,f]=(0,c.useState)(!1),g=(0,c.useRef)(0);if(c.Children.count(o)<a+1)throw Error("children must be at least ".concat(a+1," items"));let v=(0,c.useMemo)(()=>c.Children.toArray(o),[o]),j=(0,c.useMemo)(()=>[...v,...v.slice(0,a)],[v,a]),b=(0,c.useCallback)(()=>{if(!m.current)return;let e=g.current;e===j.length-a?(f(!0),e=0):(f(!1),e+=1),p(e),g.current=e},[j.length,a]),y=(0,c.useRef)(null),w=(0,c.useRef)(null);(0,c.useEffect)(()=>(t&&(w.current=setTimeout(()=>{b(),y.current=setInterval(()=>{b()},i)},l)),()=>{clearTimeout(w.current),clearInterval(y.current)}),[b,t,i,l]);let N=(0,c.useMemo)(()=>"translateX(-".concat(h*r-h*s,"px)"),[h,s,r]),k={duration:400,timingFunction:[.27,.04,.27,.97]};return(0,n.jsx)("div",{className:"relative overflow-visible",style:{width:r*a-s*(a-1),height:r},children:(0,n.jsx)("div",{ref:m,className:"absolute flex",style:{transform:N,...x?{}:(0,u.iA)(["transform"],k)},children:c.Children.map(j,(e,t)=>{let l=t<h+a&&t>h-1;return(0,n.jsx)("div",{className:"absolute rounded-full",style:{width:r,height:r,left:t*r-t*s,transform:l?"scale(1)":"scale(0.5)",...(0,d.o)(l),...x?{}:(0,u.iA)(["opacity","transform"],k)},children:e},"".concat(t,"-marching-child"))})})})}var h=a(77635),p=a(74118),x=a(36323),f=a(80672),g=a(53849),v=a(80574),j=a(13729),b=a(2783),y=a(19434);function w(e){let{className:t,text:a="Integrations"}=e,d=(0,f.useSetAtom)(b.uH),u=(0,f.useSetAtom)(b.xb),[w,k]=(0,c.useState)("idle"),[C,S]=(0,c.useState)(!1),{chatId:M}=(0,p.xz)(),I=(0,x.eu)(),A=(0,h.S)({chatId:M,activeBlock:I}),D=(0,c.useMemo)(()=>[l,i,r,s].map((e,t)=>(0,n.jsx)("div",{className:"bg-background flex h-full w-full items-center justify-center rounded-full transition-colors duration-200 group-hover:bg-gray-200",children:(0,n.jsx)(e,{})},t)),[]),L=(0,c.useCallback)(async()=>{if("loading"!==w){k("loading");try{await A(),setTimeout(()=>{d(!0),u("integrations")},100)}catch(e){j.o.error("Failed to create project")}finally{k("idle")}}},[w,A,d,u]),z=(0,c.useMemo)(()=>{switch(w){case"idle":return(0,n.jsxs)(N,{children:[(0,n.jsx)(m,{shouldMarch:C,size:18,overlap:4,children:D}),a]});case"loading":return(0,n.jsxs)(N,{children:[(0,n.jsx)(v.y,{size:16}),"Connecting..."]})}},[D,w,C,a]);return(0,n.jsx)(o.$,{size:"sm",variant:"secondary",className:(0,y.cn)("h-7 w-[144px] select-none rounded-md",t),onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onClick:L,"data-slot":"integrations-connect-button",children:(0,n.jsx)(g._r,{renderKey:w,...g.fG.buttonContent,children:z})})}function N(e){let{children:t}=e;return(0,n.jsx)("span",{className:"flex items-center gap-1",children:t})}},56712:(e,t,a)=>{"use strict";a.d(t,{A:()=>x,QuickProjectCreateModal:()=>f});var n=a(97667),s=a(25603),r=a(66692),l=a(33571),i=a(27693),o=a(18513),c=a(17410),d=a(28963),u=a(16894),m=a(74118),h=a(41416),p=a(70158);function x(){let{data:e,mutate:t}=(0,s.Ay)("showQuickProjectCreateDialog",null,{fallbackData:!1});return{showQuickProjectCreateDialog:e,setShowQuickProjectCreateDialog:t}}function f(){let{chatId:e}=(0,m.xz)(),t=(0,p.useRouter)(),[a,s]=(0,l.useState)({}),[f,g]=(0,l.useState)(""),{showQuickProjectCreateDialog:v,setShowQuickProjectCreateDialog:j}=x(),[b,y]=(0,l.useState)(!1),w=(0,i.k)(),N=(0,l.useCallback)(a=>{e?(0,h.M)({payload:{chatId:e,projectId:a}}):t.push("/chat/projects/".concat(a))},[e,t]),k=(0,l.useCallback)(async t=>{t.preventDefault(),s({}),y(!0);try{let t=await (0,u.g)({projectName:f,chatId:e,onSuccess:e=>{N(e),j(!1),g("")}});t.errors&&s(t.errors)}catch(e){console.error("Failed to create project:",e),s({name:["An unexpected error occurred. Please try again."]})}finally{y(!1)}},[f,e,N,j]);return(0,n.jsxs)(d.Modal,{onOpenChange:j,open:v,responsive:!1,children:[(0,n.jsx)(d.ModalHeader,{children:(0,n.jsx)(d.ModalTitle,{children:w("quickProjectCreateDialog.title")})}),(0,n.jsx)(d.ModalContent,{children:(0,n.jsx)("form",{className:"flex flex-col gap-6",onSubmit:k,children:(0,n.jsx)(c.t,{name:f,onChange:e=>g(e.target.value),errors:a,placeholder:w("quickProjectCreateDialog.inputPlaceholder"),disabled:b})})}),(0,n.jsxs)(d.ModalFooter,{children:[(0,n.jsx)(d.ModalClose,{asChild:!0,children:(0,n.jsx)(r.$,{size:"sm",variant:"secondary",children:w("quickProjectCreateDialog.cancel")})}),(0,n.jsx)(r.$,{"data-testid":"confirm-delete-message",disabled:b,onClick:k,size:"sm",children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.IconSpinner,{className:"size-4"}),w("quickProjectCreateDialog.creating")]}):w("quickProjectCreateDialog.create")})]})]})}},57085:(e,t,a)=>{"use strict";a.d(t,{Q:()=>h,Z:()=>p});var n=a(97667),s=a(33571),r=a(66692),l=a(65714),i=a(13729),o=a(80574),c=a(82077),d=a(12507),u=a(19434),m=a(73641);let h="v0-chat-export";function p(e){let{className:t}=e,[a,p]=(0,s.useTransition)(),x=(0,m.x)();return(0,n.jsx)(r.$,{disabled:a,onClick:()=>{p(async()=>{if(!x)return void i.o.error("Chat ID not found.");try{let e=await (0,l.V)({payload:{chatId:x}});if("error"in e)throw Error(e.error);let t=new Blob([JSON.stringify(e.data)],{type:"application/json"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="".concat(h,"-").concat(x,"-").concat(new Date().toISOString(),".json"),n.click(),URL.revokeObjectURL(a)}catch(e){(0,d.z)(e)||i.o.error("Something went wrong. Please try again.")}})},className:(0,u.cn)("size-7 rounded-md px-1 py-1.5 text-gray-900",t),size:"sm",tooltip:{side:"bottom",content:"Export Chat (AI Team only)"},variant:"ghost",children:a?(0,n.jsx)(o.y,{}):(0,n.jsx)(c.A,{})})}},57716:(e,t,a)=>{"use strict";a.d(t,{q:()=>o});var n=a(33571),s=a(37707),r=a(25603),l=a(70428);let i=/^https:\/\/www\.figma\.com\/(?:file|design)\/[a-zA-Z0-9]+(?:\/[^\/]+)?\/?\?node-id=[0-9]+-[0-9]+(?:&node-type=(?:frame|component|section))?(?:&t=[a-zA-Z0-9-]+)?(?:&m=dev)?(?:&t=[a-zA-Z0-9-]+)?$/;function o(e){let t=(0,s.D)(),{setSignInWithFigmaModal:a}=(0,l.f)(),{data:o,isLoading:c}=(0,r.Ay)("integrations:figma",{fallbackData:{isSignedIn:!1,figmaOauthUrl:""}}),[d,u]=(0,n.useState)({imageBase64:null,originalUrl:null,fileName:null,isScreenshotLoading:!1,isContextLoading:!1,error:null,nodeContext:null}),m=(0,n.useCallback)(e=>t.fi&&!c&&i.test(e),[t.fi,c]),h=(0,n.useCallback)(async t=>{var n,s;let r=t||(null==(n=e.current)?void 0:n.value)||"";if(!r)return{success:!1,reason:"invalid_url"};if(!m(r))return{success:!1,reason:r.includes("figma.com")?"missing_node":"invalid_url"};if(u(e=>({...e,originalUrl:r,isScreenshotLoading:!0})),!(null==o?void 0:o.isSignedIn))return a({figmaOauthUrl:null!=(s=null==o?void 0:o.figmaOauthUrl)?s:""}),u(e=>({...e,isScreenshotLoading:!1})),{success:!1,needsAuth:!0};try{let e=await fetch("/chat/api/integrations/figma/get-screenshot?url=".concat(encodeURIComponent(r)));if(401===e.status)return a({figmaOauthUrl:o.figmaOauthUrl}),u(e=>({...e,imageBase64:null,originalUrl:null,fileName:null,isScreenshotLoading:!1,isContextLoading:!1,error:"Authentication required",nodeContext:null})),{success:!1,needsAuth:!0};if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch Figma image")}let t=await e.json(),n=new URL(r).pathname.split("/").pop()||"Figma Design",s={success:!0,data:{base64:t.base64,originalUrl:t.originalUrl,fileName:n}};return u(e=>({...e,imageBase64:t.base64,originalUrl:t.originalUrl,fileName:n,isScreenshotLoading:!1,error:null,nodeContext:JSON.stringify(t,null,0),imageHeight:t.height})),s}catch(t){console.error("Error fetching Figma image:",t);let e=t instanceof Error?t.message:"Failed to fetch image";return u(t=>({...t,imageBase64:null,originalUrl:null,fileName:null,isScreenshotLoading:!1,error:e,nodeContext:null})),{success:!1,error:e}}},[e,m,null==o?void 0:o.isSignedIn,null==o?void 0:o.figmaOauthUrl,a]),p=(0,n.useCallback)(async e=>{try{u(e=>({...e,isContextLoading:!0,error:null}));let t=await fetch("/chat/api/integrations/figma/context?url=".concat(encodeURIComponent(e))),a=await t.json();return u(e=>({...e,isContextLoading:!1,nodeContext:JSON.stringify(a,null,0)})),a}catch(t){let e=t instanceof Error?t.message:"Failed to fetch context";throw u(t=>({...t,isContextLoading:!1,error:e})),t}},[]);return(0,n.useMemo)(()=>{var e;return{...d,isLoading:d.isScreenshotLoading||d.isContextLoading||c,isFigmaLoading:c,handleFigmaUrl:h,isFigmaUrl:m,isSignedIn:!c&&null!=(e=null==o?void 0:o.isSignedIn)&&e,userData:o,getNodeContext:p}},[d,h,m,o,p,c])}},58576:(e,t,a)=>{"use strict";a.d(t,{q:()=>M,H:()=>I});var n=a(97667),s=a(33571),r=a(66692),l=a(7086),i=a(13729),o=a(69077),c=a(6902),d=a(93929),u=a(74702),m=a(67006),h=a(19243),p=a(74118),x=a(28819),f=a(28963),g=a(99647),v=a(31640);function j(){return(0,n.jsx)(g.Dp,{variants:{hover:{y:2,x:-1,rotate:12}},children:(0,n.jsx)(v.t,{"aria-hidden":!0})})}var b=a(27693),y=a(92095),w=a(8689),N=a(22447),k=a(25887),C=a(84371);function S(e){let{children:t,value:a,reasons:s}=e;return(0,n.jsx)(d.a,{className:"is-mobile:text-xs",onClick:()=>s.toggle(a),selected:s.has(a),children:t})}function M(e){let{messageId:t,quote:a,voteOptions:d}=e,{activeForkKey:g}=(0,p.Pk)(),{formRef:v,onKeyDown:j}=(0,o.w)(),{chatId:y,messageText:C,promptMessageId:M,userId:I,leafMessageId:A}=d,[D,L]=(0,s.useState)(""),z=(0,u.L)(),E=(0,b.k)(),P=(0,s.useCallback)(()=>{L(""),z.clear(),(0,k.z)()},[z]),T=(0,s.useCallback)(async e=>{if(e.preventDefault(),M&&C&&t&&A)try{i.o.success(E("downvoteDialog.successToast")),await Promise.all([P(),(0,h.u)("SubmitDownvote",{messageId:t,leafMessageId:A,quote:a,reasons:z.values,freeformFeedback:D}),(0,m.p)({feedback:D,quote:a,reasons:z.values,chatId:y,leafMessageId:A,promptMessageId:M,messageId:t,userId:I,type:"downvote"})])}catch(e){console.error(e),i.o.error("Failed to send feedback. Please try again later.")}},[M,C,t,A,E,P,a,z.values,D,y,I]),F=(0,s.useMemo)(()=>(0,n.jsxs)("form",{className:(0,x.cn)("flex flex-col","is-mobile:gap-3 is-not-mobile:gap-6"),onSubmit:T,ref:v,children:[a&&(0,n.jsxs)("div",{className:(0,x.cn)("bg-muted flex items-center gap-2 text-ellipsis py-3 text-sm text-gray-900","is-mobile:-mx-3 is-mobile:px-3 is-not-mobile:-mx-6 is-not-mobile:px-6"),children:[(0,n.jsx)("div",{className:"w-1 shrink-0 self-stretch rounded-full bg-gray-300"}),(0,n.jsx)("span",{className:"line-clamp-2",children:a})]}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsxs)("div",{className:"grid w-full grid-cols-2 items-center justify-start gap-2",children:[(0,n.jsx)(S,{reasons:z,value:"inaccurate",children:E("downvoteDialog.options.incorrectInformation")}),(0,n.jsx)(S,{reasons:z,value:"off-topic",children:E("downvoteDialog.options.instructionsIgnored")}),(0,n.jsx)(S,{reasons:z,value:"lazy",children:E("downvoteDialog.options.beingLazy")}),(0,n.jsx)(S,{reasons:z,value:"style",children:E("downvoteDialog.options.dontLikeStyle")}),(0,n.jsx)(S,{reasons:z,value:"bad-recommendation",children:E("downvoteDialog.options.badRecommendation")}),(0,n.jsx)(S,{reasons:z,value:"other",children:E("downvoteDialog.options.other")})]})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)(c.Label,{className:"text-sm font-normal text-gray-500",htmlFor:"downvote-feedback",children:[E("downvoteDialog.howCanWeImprove")," ",(0,n.jsx)("span",{className:"text-gray-400",children:E("downvoteDialog.optional")})]}),(0,n.jsx)(l.T,{asChild:!0,children:(0,n.jsx)(w.o,{id:"downvote-feedback",name:"feedback",onChange:e=>L(e.target.value),onKeyDown:j,placeholder:"Your feedback...",minHeight:80,maxHeight:192,value:D})})]}),(0,n.jsxs)("div",{className:"is-mobile:flex-col-reverse is-not-mobile:flex-row flex w-full items-center justify-end gap-2",children:[(0,n.jsx)(r.$,{className:"is-mobile:w-full",onClick:e=>{e.preventDefault(),P()},size:"sm",variant:"secondary",children:E("downvoteDialog.cancel")}),(0,n.jsx)(r.$,{className:"is-mobile:w-full",size:"sm",type:"submit",children:E("downvoteDialog.submit")})]})]}),[T,v,a,z,E,j,D,P]);return(0,n.jsx)(N._,{type:"messageDownvote",children:(0,n.jsxs)("div",{className:"overflow-auto",children:[(0,n.jsxs)(f.ModalHeader,{children:[(0,n.jsx)(f.ModalTitle,{children:E("downvoteDialog.title")}),(0,n.jsx)(f.ModalDescription,{children:E("downvoteDialog.description")(a)})]}),(0,n.jsx)(f.ModalContent,{children:F})]})})}function I(e){let{variant:t,messageId:a,quoteRef:s,tooltip:l,...i}=e,{isLoading:o,canVote:c}=(0,y.q)(),d=(0,C.q)({messageId:a});return o||!c?null:"quote"===t?(0,n.jsx)(r.$,{"aria-label":"Downvote",className:"text-muted-foreground hover:text-foreground rounded-md p-0 text-sm",onClick:()=>{var e,t;(0,h.u)("OpenDownvote",{quote:null==s||null==(e=s.current)?void 0:e.call(s),messageId:a}),(0,k.D)({type:"messageDownvote",data:{messageId:a,quote:null==s||null==(t=s.current)?void 0:t.call(s),voteOptions:d}})},size:"xs",variant:"ghost",children:(0,n.jsx)(j,{"aria-hidden":!0})}):(0,n.jsx)(r.$,{"aria-label":"Downvote Response",onClick:()=>{(0,h.u)("OpenDownvote",{messageId:a}),(0,k.D)({type:"messageDownvote",data:{messageId:a,voteOptions:d}})},size:"xs",tooltip:l,variant:"ghost",...i,children:(0,n.jsx)(j,{})})}},59479:e=>{e.exports={loading:"loading-dots_loading__XNw9B",blink:"loading-dots_blink__PxRH1"}},59790:(e,t,a)=>{"use strict";a.d(t,{UC:()=>o,LB:()=>i,wi:()=>c,hE:()=>r});var n=a(97667),s=a(28819);let r=e=>{let{id:t,children:a,className:r}=e;return(0,n.jsx)("h3",{className:(0,s.cn)("pb-4 text-base font-semibold",r),id:null!=t?t:void 0,children:a})};var l=a(19434);function i(e){let{children:t,className:a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("border-border flex flex-col justify-between rounded-lg border",a),children:t})}let o=e=>{let{children:t}=e;return(0,n.jsx)("div",{className:"px-5 py-4",children:t})};function c(e){let{children:t,className:a=""}=e;return(0,n.jsx)("footer",{className:(0,s.cn)("border-border bg-muted rounded-b-lg border-t px-4 py-3",a),children:t})}},59801:(e,t,a)=>{"use strict";a.d(t,{E:()=>s});var n=a(70676);let s=(0,n.createServerReference)("402b62cf9878195d202d58c85f42850f225a954ef4",n.callServer,void 0,n.findSourceMapURL,"newProjectAction")},60574:(e,t,a)=>{"use strict";a.d(t,{e:()=>c});var n=a(33571),s=a(36323),r=a(74118),l=a(76727),i=a(86943);let o=e=>"last-opened-block:".concat(e);function c(){let{messages:e,chatId:t,activeForkKey:a}=(0,r.Pk)(),c=(0,s.oQ)();return{reopenLastBlock:(0,n.useCallback)(()=>{var n,s;let r=localStorage.getItem(o(t));if(r)for(let t of e.filter(e=>null==a?void 0:a.includes(e.id))){let e=(0,l.sY)(null!=(n=t.content)?n:"",t.id).find(e=>e.id===r);if(e)return c(!0,e),!0}for(let t of[...e].reverse().filter(e=>null==a?void 0:a.includes(e.id))){let e=(0,l.sY)(null!=(s=t.content)?s:"",t.id).filter(e=>{var t;return!i.kX.includes(null!=(t=e.meta.type)?t:"")});if(0!==e.length)return c(!0,e[e.length-1]),!0}return!1},[e,c,t,a]),saveLastOpenedBlock:(0,n.useCallback)(e=>{e?localStorage.setItem(o(t),e):localStorage.removeItem(o(t))},[t])}}},61070:(e,t,a)=>{"use strict";a.d(t,{$5:()=>r,g7:()=>o,m9:()=>i});let n=new Intl.NumberFormat("en-US",{style:"currency",currency:"usd"}),s=new Intl.NumberFormat("en-US",{style:"currency",currency:"usd",maximumFractionDigits:0}),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";switch(t){case"default":return n.format(e/100);case"display":return s.format(e/100)}};function l(e){return r(e.reduce((e,t)=>e+t.price.cents,0),"display")}function i(e){return l(e.items)}function o(e){return l(e.items)}},61182:(e,t,a)=>{"use strict";a.d(t,{V:()=>i});var n=a(97667),s=a(33571),r=a(53849),l=a(80574);function i(e){let{loading:t,isLoading:a,children:i,debounceChildren:o=!1,...c}=e,d=function(e,t){let[a,n]=(0,s.useState)(e),r=(0,s.useRef)();return(0,s.useEffect)(()=>(r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{n(e)},200),()=>{r.current&&clearTimeout(r.current)}),[e,200]),a}(i,200);return(0,n.jsx)(r._r,{...r.fG.buttonContent,...c,style:{width:"100%",...c.style},children:(0,n.jsx)("span",{className:"flex items-center gap-2",children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.y,{size:16}),t]}):o?d:i})})}},61266:()=>{},61589:(e,t,a)=>{"use strict";a.d(t,{D:()=>r});var n=a(61222),s=a.n(n);function r(e,t){return t?"".concat(s()(t.slice(0,50)),"-").concat(e):e}},61852:(e,t,a)=>{"use strict";a.d(t,{E:()=>o,PortalProvider:()=>l,W:()=>i});var n=a(97667),s=a(33571);let r=(0,s.createContext)({containers:{},setContainers:()=>{}});function l(e){let{children:t}=e,[a,l]=(0,s.useState)({});return(0,n.jsx)(r.Provider,{value:{containers:a,setContainers:l},children:t})}function i(){return(0,s.useContext)(r)}function o(e){let t=(0,s.useRef)(null),{setContainers:a}=i();return(0,s.useEffect)(()=>(a(a=>({...a,[e]:t.current})),()=>{a(t=>{let{[e]:a,...n}=t;return n})}),[e,a]),t}},61872:(e,t,a)=>{"use strict";a.d(t,{A2:()=>s.A2,F7:()=>i,GP:()=>l,L5:()=>r});var n=a(86943),s=a(75997);function r(e){let{blockType:t}=e,a="",s=[],r=[];for(let t of e.files)t.moveToEnd?r.push(t):s.push(t);for(let e of(s.push(...r),s)){for(let t of["isEdit","isMerged","isDeleted","isLocked","isMoved","isRecovered","isUserEdit","isLoading"])e[t]?e.meta[t]="true":delete e.meta[t];delete e.meta.moveToEnd;let s=function(e){let t=[];for(let[a,n]of Object.entries(e))n&&t.push("".concat(a,'="').concat(n,'"'));if(t.length)return t.join(" ")}(e.meta),r=n.Vr[t];a&&(a+="\n"),a+="".concat(r).concat(e.lang).concat(s?":"+s:"");let l=e.source.trim();l&&(a+="\n"+l)}return a}a(74260);let l=(e,t)=>{let a=JSON.parse(JSON.stringify(t));for(let t of a)t.meta.file&&void 0!==e[t.meta.file]&&(t.source=e[t.meta.file]);return a};function i(e){let t={mapping:{}};for(let a of e)t.mapping[a.meta.file||""]={data:a.blobUrl||a.source,type:a.blobUrl?"url":"file"};return t}},62080:(e,t,a)=>{"use strict";a.d(t,{_:()=>i});var n=a(33571),s=a(11472),r=a(71954),l=a(40445);function i(){let{user:e}=(0,r.Y)(),{scopes:t}=(0,s.b)(),a=(0,n.useMemo)(()=>t?t.filter(e=>!(0,l.W)(e)):[],[t]);return(0,n.useMemo)(()=>{var t;return null==(t=a.find(t=>t.id===(null==e?void 0:e.defaultTeamId)))?void 0:t.slug},[a,e])}},62619:(e,t,a)=>{"use strict";a.d(t,{PaymentDialog:()=>I,C:()=>M});var n=a(97667),s=a(33571),r=a(90643),l=a(25603),i=a(65717),o=a(70676);let c=(0,o.createServerReference)("40f56dffee1d50d368339f976916113978fe1240ae",o.callServer,void 0,o.findSourceMapURL,"changePlanAction");var d=a(23687),u=a(61070),m=a(19434),h=a(88684),p=a(71916),x=a(66692),f=a(80574),g=a(65744),v=a(19243),j=a(73655);function b(e){let{disabled:t,onPaymentSelected:a,paymentMethod:r,onBack:l,description:i,willCharge:o,onPaymentMethodAdded:c}=e,{user:d}=(0,j.k6)(),u=(0,h.k)({paymentMethod:r,billingDetails:d?{name:d.name,email:d.email}:void 0}),m=(0,s.useRef)(null),b=t||"submitting"===u.status,y="Add Card"+(o?" and Pay":"");"use-existing"===u.status&&(y="Confirm"+(o?" and Pay":""));let w=async()=>{try{if("add-new"===u.status){let e=await u.submit();e&&(null==c||c(e))}null==a||a()}catch(e){if("object"==typeof e&&null!==e&&"type"in e){let{type:t,code:a,decline_code:n,param:s,doc_url:r}=e;(0,v.u)("BillingNewPaymentMethodStripeError",{type:t,code:a,declineCode:n,param:s,docUrl:r})}}};return(0,g.ML)("keydown",e=>{"Escape"===e.key&&l(),"Enter"===e.key&&w()},m),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid h-fit px-4",ref:m,children:[u.form,(0,n.jsx)("div",{className:"bottom-0 mb-2 mt-4 text-sm text-gray-500",children:null!=i?i:(0,n.jsxs)(n.Fragment,{children:['By clicking on "',y,'" you will link the new payment method to your Vercel account']})})]}),(0,n.jsxs)(p.Es,{className:"flex flex-col-reverse gap-2 px-4 py-0 md:flex-row md:justify-between",children:[(0,n.jsx)(x.$,{className:"w-full md:w-auto",disabled:b,onClick:()=>{"add-new"===u.status&&u.useExisting?u.useExisting():l()},size:"sm",variant:"secondary",children:"Cancel"}),(0,n.jsxs)(x.$,{disabled:b,onClick:w,size:"sm",children:[b?(0,n.jsx)(f.y,{size:14}):null,y]})]})]})}var y=a(13729),w=a(65156),N=a(70158);function k(e,t){switch(t.type){case"set-payment-method":if(!e)return e;return{...e,paymentMethod:t.paymentMethod};case"set-billing-details":return t.billingDetails}}var C=a(28963),S=a(83195);function M(){let{data:e,mutate:t}=(0,l.Ay)("paymentDialogOpen",null,{fallbackData:null});return{paymentDialogOpen:!!e,selectedPlan:e,setPaymentDialogPlan:t}}function I(e){let{billingPromise:t,onBack:a}=e,l=(0,N.useRouter)(),{isActiveScopeReady:o,isTeam:h,user:p}=(0,j.k6)(),{update:x}=(0,S.N)(o&&!h,null==p?void 0:p.id),f=(0,i.c)({action:c,additionalFields:{source:"chat"}}),{paymentDialogOpen:g,selectedPlan:v,setPaymentDialogPlan:I}=M(),A=(0,s.use)(t),{billingDetails:D,optimisticSetBillingDetails:L,optimisticSetPaymentMethod:z}=function(e){let[t,a]=(0,s.useOptimistic)(e,k);return{billingDetails:t,optimisticSetPaymentMethod:e=>{(0,s.startTransition)(()=>{a({type:"set-payment-method",paymentMethod:e})})},optimisticSetBillingDetails:e=>{(0,s.startTransition)(()=>{a({type:"set-billing-details",billingDetails:e})})}}}(A[0].ok?A[0].value:null),E=(0,s.useMemo)(()=>A[1].ok?A[1].value:[],[A]),P=(0,s.useMemo)(()=>E.find(e=>"v0-level3"===e.slug),[E]);(0,s.useEffect)(()=>()=>void I(null),[I]);let T=v&&"v0-level3"===v?P:null,F=(0,s.useCallback)(async()=>{if(T)try{let e=await f.submit({planSlug:T.slug,entitlement:"messages",entitlementFromCurrentSession:"yes"});L(e),x(),y.o.success("Upgraded plan successfully.")}catch(t){let e=(0,w.m)(t);"no_active_subscription"===e||"already_on_plan"===e?l.refresh():y.o.error((0,n.jsx)(w.K,{code:e,variant:"unstyled"}),{duration:5e3})}finally{I(null)}},[f,x,L,l,I,T]),R=(0,s.useMemo)(()=>T?(0,n.jsx)(b,{description:(0,n.jsxs)(n.Fragment,{children:["By clicking on Confirm you'll start your"," ",T.name," plan subscription of"," ",(0,n.jsxs)("span",{className:"font-medium text-black",children:[(0,u.m9)(T),"/month,"]})," ","with a renewal date of the"," ",(0,n.jsxs)("span",{className:"font-medium text-black",children:[(0,m.ep)(new Date().getDate())," of each month"]}),"."]}),disabled:"submitting"===f.status,onBack:()=>{null==a||a(),I(null)},onPaymentMethodAdded:z,onPaymentSelected:F,paymentMethod:null==D?void 0:D.paymentMethod,willCharge:!0}):null,[null==D?void 0:D.paymentMethod,f.status,a,F,z,I,T]);return D?(0,n.jsxs)(r.StripeProvider,{mode:D.settings.mode,children:[(0,n.jsx)(C.Modal,{onOpenChange:e=>e?I(null==T?void 0:T.slug):I(null),open:g,children:(0,n.jsxs)(C.ModalContent,{className:"flex flex-col gap-6 md:px-2",children:[(0,n.jsxs)(C.ModalTitle,{className:"px-3",children:["Subscribing to"," ",(null==T?void 0:T.slug)==="v0-platinum"?(0,n.jsx)("span",{children:"Ultra"}):(0,n.jsx)("span",{children:"Premium"}),(0,n.jsx)("span",{children:" plan"})]}),R]})}),(0,n.jsx)(d.Z,{children:(0,n.jsx)("form",{...f.props})})]}):null}},62903:(e,t,a)=>{"use strict";a.d(t,{C:()=>c,z:()=>o});var n=a(97667),s=a(33571),r=a(90626),l=a(27962),i=a(28819);let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.bL,{className:(0,i.cn)("grid gap-2",a),...s,ref:t})});o.displayName=r.bL.displayName;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(r.q7,{ref:t,className:(0,i.cn)("aspect-square h-4 w-4 rounded-full border border-gray-400 focus:outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600",a),...s,children:(0,n.jsx)(r.C1,{className:"flex items-center justify-center",children:(0,n.jsx)(l.A,{className:"size-2 fill-white stroke-white"})})})});c.displayName=r.q7.displayName},63072:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var n=a(32136),s=a(74118),r=a(33571),l=a(13729),i=a(73655),o=a(12507),c=a(41416);function d(){let{project:e,setMetadata:t}=(0,n.tZ)(),{chatId:a}=(0,s.xz)(),{activeScope:d}=(0,i.k6)(),[u,m]=(0,r.useTransition)();return{reassignPending:u,handleReassignProject:(0,r.useCallback)(n=>{var s,r;if(!a||!d)return;let i=e?{...e}:void 0;t({project:n?{projectId:n.projectId,name:n.name,settings:{color:(null==(s=n.settings)?void 0:s.color)||null,icon:(null==(r=n.settings)?void 0:r.icon)||null},vercelProjectId:n.vercelProjectId,isCreator:n.creatorId===d.id}:void 0}),m(async()=>{try{let e=await (0,c.M)({payload:{chatId:a,projectId:(null==n?void 0:n.projectId)||null}});if(null==e?void 0:e.error)throw Error(e.error)}catch(e){(0,o.z)(e)||l.o.error("Something went wrong. Please try again."),t({project:i})}})},[a,t,e,d])}}},63186:(e,t,a)=>{"use strict";a.d(t,{Zv:()=>v,eC:()=>f,pp:()=>x,wn:()=>p});var n=a(97667),s=a(66692),r=a(6902),l=a(43573),i=a(40767),o=a(8153),c=a(20125),d=a(50391),u=a(93660),m=a(27693),h=a(28819);function p(e){let{children:t,label:a,badge:l,onAdd:d,info:u,className:p}=e,x=(0,m.k)();return(0,n.jsxs)("div",{className:(0,h.cn)("flex flex-col gap-2",p),children:[(0,n.jsxs)("div",{className:"flex h-7 items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsxs)(r.Label,{className:"text-sm font-medium text-gray-900",children:[a,l]}),u&&(0,n.jsx)(c.Tooltip,{content:(0,n.jsx)("div",{className:"text-center",children:u}),children:(0,n.jsx)(o.f,{className:"h-3 w-3",color:"gray-400"})})]}),d&&(0,n.jsx)(s.$,{"aria-label":x("projectSettings.add")(a),className:"size-7 text-gray-500",size:"sm",variant:"ghost",onClick:d,tooltip:{side:"bottom",content:"Add ".concat(a)},children:(0,n.jsx)(i.F,{})})]}),t]})}function x(e){let{title:t,subtitle:a,children:s,className:r}=e;return(0,n.jsx)(d.Sv,{className:(0,h.cn)("relative h-[156px] rounded-md border border-dashed border-gray-300 px-8",r),children:(0,n.jsxs)(d.HY,{children:[t&&(0,n.jsx)(d.cz,{className:"text-sm text-gray-900",children:t}),a&&(0,n.jsx)(d.Ou,{className:"text-pretty text-sm text-gray-500",children:a}),s]})})}function f(e){let{className:t,label:a,onClick:r,disabled:i}=e,o=(0,m.k)(),c=a||o("projectSettings.moreOptions"),d=r?s.$:"div";return(0,n.jsxs)(d,{className:(0,h.cn)("flex size-6 items-center justify-center text-gray-500",t),size:"sm",variant:"ghost",disabled:i,onClick:r,"cmdk-item-actions":"",children:[(0,n.jsx)(l.a,{}),(0,n.jsx)("span",{className:"sr-only",children:c})]})}function g(e){let{children:t,suffix:a,className:s}=e;return(0,n.jsxs)("div",{className:(0,h.cn)("odd:bg-muted flex h-[58px] w-full items-center justify-between gap-2 rounded-lg p-2",s),children:[t,a]})}function v(e){let{title:t}=e;return(0,n.jsxs)(p,{label:t,onAdd:()=>{},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(g,{suffix:(0,n.jsx)(f,{}),children:(0,n.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,n.jsx)(u.E,{className:"h-3 w-40"}),(0,n.jsx)(u.E,{className:"h-3 w-16"})]})}),(0,n.jsx)(g,{suffix:(0,n.jsx)(f,{}),children:(0,n.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,n.jsx)(u.E,{className:"h-3 w-40"}),(0,n.jsx)(u.E,{className:"h-3 w-16"})]})})]}),(0,n.jsx)(s.$,{size:"sm",variant:"secondary",disabled:!0,children:"Show More"})]})}},63587:(e,t,a)=>{"use strict";a.d(t,{BE:()=>m,Uz:()=>o,_s:()=>i,gk:()=>h,zj:()=>u});var n=a(97667),s=a(28819),r=a(33571),l=a(93272);let i=e=>{let{shouldScaleBackground:t=!0,...a}=e;return(0,n.jsx)(l._s.Root,{shouldScaleBackground:t,...a})};i.displayName="Drawer";let o=l._s.Trigger,c=l._s.Portal;l._s.Close;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(l._s.Overlay,{className:(0,s.cn)("bg-alpha-700 dark:bg-alpha-900 fixed inset-0 z-50",a),ref:t,...r})});d.displayName=l._s.Overlay.displayName;let u=r.forwardRef((e,t)=>{let{className:a,hideThumb:r,children:i,...o}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(d,{}),(0,n.jsxs)(l._s.Content,{className:(0,s.cn)("bg-background fixed inset-x-0 bottom-0 z-50 mt-24 flex h-[96%] flex-col gap-2 rounded-t-[10px] p-2 shadow-[0_0_0_1px_hsl(var(--alpha-400))] outline-none",a),ref:t,...o,children:[!r&&(0,n.jsx)("div",{className:"bg-alpha-400 mx-auto mt-4 h-2 w-[100px] rounded-full"}),i]})]})});u.displayName="DrawerContent";let m=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)("grid gap-1.5 p-4 text-center sm:text-left",t),...a})};m.displayName="DrawerHeader";let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(l._s.Title,{className:(0,s.cn)("text-lg font-semibold leading-none tracking-tight",a),ref:t,...r})});h.displayName=l._s.Title.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(l._s.Description,{className:(0,s.cn)("text-muted-foreground text-sm",a),ref:t,...r})}).displayName=l._s.Description.displayName},65156:(e,t,a)=>{"use strict";a.d(t,{K:()=>m,m:()=>h});var n=a(97667),s=a(35501),r=a.n(s),l=a(42633),i=a(60914),o=a(19434);let c={rate_limited:"Too many requests, try again in 1 minute.",payment_method_required:"Payment method required. Add a payment method and try again.",plan_not_self_serve:"Contact sales to upgrade to this plan.",has_subscription:"You already have a subscription.",user_plans:"You are unable to upgrade your plan at this time.",no_subscription:"You do not have a subscription to cancel.",no_active_subscription:"You do not have an active subscription to change.",already_on_plan:"You are already subscribed to this plan.",plan_not_available:"This plan is not available at this time.",no_scheduled_plan_change:"You do not have any scheduled plan changes to cancel.",no_on_demand_credits:"Your plan does not include on-demand credit purchases. Upgrade your plan and try again.",duplicate_idempotency_key:"Your previous subscription modification is processing. Please try again in a minute.",upgrade_attempts_exceeded:"Your payment has been declined. Please check your information and try again later.",no_session:"Log in and try again."},d=(0,i.F)("",{variants:{variant:{default:"text-sm font-medium text-destructive",unstyled:""}},defaultVariants:{variant:"default"}}),u=(0,i.F)("h-auto p-0 underline",{variants:{variant:{default:"text-destructive",unstyled:"text-inherit"}},defaultVariants:{variant:"default"}});function m(e){let{code:t,variant:a,className:s}=e,i=t?c[t]:void 0;return(0,n.jsx)("div",{className:(0,o.cn)(d({variant:a,className:s})),children:i||(0,n.jsxs)(n.Fragment,{children:["We've encountered an unexpected issue. Should this continue, kindly reach out to our"," ",(0,n.jsx)(l.$n,{asChild:!0,className:(0,o.cn)(u({variant:a})),variant:"link",children:(0,n.jsx)(r(),{href:"https://vercel.com/help",target:"_blank",children:"support"})})," ","team."]})})}function h(e){if("object"==typeof e&&null!==e){if("code"in e&&"string"==typeof e.code)return e.code;if("message"in e&&"string"==typeof e.message)return e.message}if("string"==typeof e)return e}},65714:(e,t,a)=>{"use strict";a.d(t,{V:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40338bf4f623dfd3a251237a0c6f18b64aa112bcf6",n.callServer,void 0,n.findSourceMapURL,"exportChat")},65717:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});var n=a(33571);function s(e){let{action:t,additionalFields:a={}}=e,s=(0,n.useId)(),r=(0,n.useRef)(new FormData),l=(0,n.useRef)(null),[i,o]=(0,n.useState)("idle"),[c,d]=(0,n.useState)(null);return{status:i,error:c,submit:e=>{if(l.current)throw Error("Cannot submit form while another action is pending");o("submitting"),d(null);let t=document.getElementById(s);if(!t)throw Error("No form found for useImperativeHandle with id ".concat(s));let n=new FormData;if(e)for(let[t,a]of Object.entries(e))n.append(t,a);for(let[e,t]of Object.entries(a))n.append(e,t);return r.current=n,new Promise((e,a)=>{l.current={resolve:e,reject:a},t.requestSubmit()})},props:{id:s,action:async()=>{var e,a,n;try{let n=await t(r.current);n.ok?null==(e=l.current)||e.resolve(n.value):(d(n.error.message),null==(a=l.current)||a.reject(n.error))}catch(e){d(e instanceof Error?e.message:"Unknown error"),null==(n=l.current)||n.reject()}finally{l.current=null,o("idle")}},onSubmit:e=>e.stopPropagation()}}}},65994:(e,t,a)=>{"use strict";a.d(t,{e:()=>l});var n=a(25603),s=a(80672),r=a(13089);function l(){let{data:e,mutate:t}=(0,n.Ay)("sidebar-sheet-open",{fallbackData:!1}),a=(0,r.UY)(),l=(0,s.useAtomValue)(a.dialogOpen);return{sheetOpen:e,setSheetOpen:t,actionChatId:((null==l?void 0:l.type)==="deleteChat"?l.data.chatId:null)||((null==l?void 0:l.type)==="shareChat"?l.data.chatId:null)}}},66152:(e,t,a)=>{"use strict";a.d(t,{LX:()=>i,P5:()=>l,RQ:()=>o});var n=a(33571),s=a(25603),r=a(37707);function l(e){let{blockId:t,isPreviewable:a}=e,l=(0,n.useMemo)(()=>!0===a||"object"==typeof a&&"warning"in a,[a]),{bl:i}=(0,r.D)(),{data:o,mutate:c}=(0,s.Ay)(["block:activeTab",t],{fallbackData:i||l?"preview":"code"});return(0,n.useEffect)(()=>{(l||i)&&c("preview")},[l,i,c]),{hasBlockPreview:a,activeTab:o,setActiveTab:c}}let i=e=>{let{data:t}=(0,s.Ay)(["block:activeTab",e]);return t},o=e=>{let{mutate:t}=(0,s.Ay)(["block:activeTab",e]);return t}},66683:(e,t,a)=>{"use strict";function n(e){return!0===e||"object"==typeof e&&"warning"in e}a.d(t,{O:()=>n})},67006:(e,t,a)=>{"use strict";a.d(t,{p:()=>s});var n=a(70676);let s=(0,n.createServerReference)("404154b74bb0d71fd1b7381f856f216db005c0e621",n.callServer,void 0,n.findSourceMapURL,"sendMessageFeedback")},67572:(e,t,a)=>{"use strict";a.d(t,{S:()=>r});var n=a(33571),s=a(25603);function r(){var e;let{data:t,mutate:a}=(0,s.Ay)("result:full-screen"),{mutate:r}=(0,s.Ay)("state:select"),l=(0,n.useCallback)((e,t)=>{a(a=>{if(!a&&!e)return;let n=new URL(window.location.href),s=n.searchParams,l=s.get("b"),i=null!=t?t:l;return i&&(e?s.set("f","1"):s.delete("f"),s.set("b",i),n.search=s.toString(),window.history.replaceState({},"",n.toString())),r(!1),{value:e}})},[a,r]);return{fullScreenResult:null!=(e=null==t?void 0:t.value)&&e,setFullscreenResult:l,source:null==t?void 0:t.source}}},67702:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(37758),s=a(37707),r=a(2066);function l(e){let{integrationIds:t,isEnabled:a}=e,{aie:l}=(0,s.D)(),i=new URLSearchParams,o=t.filter(e=>"blob"!==e);i.set("integrationIds",o.join(","));let{data:c,error:d,mutate:u}=(0,r.A)(a&&o.length?"/chat/api/integrations/marketplace/options?".concat(i.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch integration options data");return t.json()});return{integrations:[...((null==c?void 0:c.integrations)||[]).filter(e=>!["upstash-vector","upstash-qstash"].includes(e.slug)&&(l||!n.k$[e.name].includes("ai"))),...t.includes("blob")?[{id:"blob",slug:"blob",name:n.F5.blob.title,description:n.F5.blob.description,icon:n.F5.blob.icon}]:[]],isLoading:void 0===c,error:d||null,refetch:u}}},67964:(e,t,a)=>{"use strict";a.d(t,{ForkBlockButton:()=>b});var n=a(97667),s=a(33571),r=a(19243),l=a(66692),i=a(35129),o=a(13729),c=a(12507),d=a(92461),u=a(28819),m=a(80574),h=a(70158),p=a(74118),x=a(27693),f=a(16983),g=a(71543),v=a(39929),j=a(73832);function b(e){let{blockId:t,forkCount:a,className:j,page:b,isAuthor:w,isMenuItem:N=!1}=e,{expectUser:k}=(0,g.J)(),{setShowSignInDialog:C}=(0,f.AO)(),S=(0,h.useRouter)(),[M,I]=(0,s.useTransition)(),{isStreaming:A}=(0,p.Pk)(),D=(0,x.k)(),{user:L}=(0,g.J)(),z=(0,s.useCallback)(e=>{if(e.preventDefault(),!w&&(null==L?void 0:L.isAdminMode)&&!window.confirm("[V0 ADMIN] Are you sure you want to fork this block?"))return;let a=new URLSearchParams;a.set("forkBlockId",t);let n="http://localhost:3000/chat";n="https://v0.dev/chat";let s="".concat(n,"?").concat(a.toString());if(!k)return C({prompt:!1,forkBlockId:t});(0,r.u)("ClickForkBlock");try{I(async()=>{if("chat"===b){let e=await (0,i.O)(t);if(!e||"string"!=typeof e)return void o.o.error(D("forkBlockButton.errorToast"));let a=new URLSearchParams(window.location.search).get("assignBranch"),n=a?"/chat/".concat(e,"?assignBranch=").concat(encodeURIComponent(a)):"/chat/".concat(e);S.push(n)}if(o.o.success(D("forkBlockButton.successToast")),"block"===b){var e;null==(e=window.open(s,"_blank"))||e.focus()}})}catch(e){(0,h.unstable_rethrow)(e),console.log(e),(0,c.z)(e)||o.o.error(D("forkBlockButton.errorToast"))}},[w,null==L?void 0:L.isAdminMode,t,k,C,b,D,S]),E=null,P="block"===b||!w;E="block"===b?"secondary":w?"ghost":"secondary",P&&(E="default");let T=M?(0,n.jsx)(m.y,{className:"!size-4 text-gray-500",size:16}):(0,n.jsx)(y,{className:"!size-4"});return N?(0,n.jsxs)(v.DropdownMenuItem,{className:j,disabled:M||A,onClick:z,children:[T,(0,n.jsx)("span",{children:D("forkBlockButton.fork")})]}):(0,n.jsxs)(l.$,{className:(0,u.cn)("group rounded-md px-2 has-[>svg]:px-2",a&&"md:has-[>svg]:pr-2","ghost"===E?"size-7":"h-7",j),disabled:M||A,onClick:z,tooltip:P?void 0:{side:"bottom",align:"center",content:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"font-medium",children:"Fork"}),(0,n.jsx)("span",{className:"max-w-[180px] text-sm text-gray-400",children:"Create a copy of this block to edit in a new chat."})]})},size:"sm",variant:E,children:[M?(0,n.jsx)(m.y,{className:"!size-3.5 text-gray-500 md:!size-4",size:16}):(0,n.jsx)(y,{className:"!size-3.5 md:!size-4"}),P?"Fork":null,a?(0,n.jsx)(d.E,{className:"bg-gray-150 hidden min-w-5 border-0 text-gray-500 group-hover:bg-gray-300 group-hover:text-gray-600 md:flex",size:"sm",variant:"secondary",children:(0,n.jsx)("span",{className:"translate-y-[0.5px]",children:a})}):null]})}let y=(0,j.G)('\n<path d="M12.5 0C13.8807 0 15 1.11929 15 2.5C15 3.61933 14.2642 4.56613 13.25 4.88477V6C13.25 7.51878 12.0188 8.75 10.5 8.75H8.75V11.1143C9.76431 11.4328 10.5 12.3806 10.5 13.5C10.5 14.8807 9.38071 16 8 16C6.61929 16 5.5 14.8807 5.5 13.5C5.5 12.3806 6.23569 11.4328 7.25 11.1143V8.75H5.5C3.98122 8.75 2.75 7.51878 2.75 6V4.88477C1.73584 4.56613 1 3.61933 1 2.5C1 1.11929 2.11929 0 3.5 0C4.88071 0 6 1.11929 6 2.5C6 3.61933 5.26416 4.56613 4.25 4.88477V6C4.25 6.69036 4.80964 7.25 5.5 7.25H10.5C11.1904 7.25 11.75 6.69036 11.75 6V4.88477C10.7358 4.56613 10 3.61933 10 2.5C10 1.11929 11.1193 0 12.5 0ZM8 12.5C7.44772 12.5 7 12.9477 7 13.5C7 14.0523 7.44772 14.5 8 14.5C8.55228 14.5 9 14.0523 9 13.5C9 12.9477 8.55228 12.5 8 12.5ZM3.5 1.5C2.94772 1.5 2.5 1.94772 2.5 2.5C2.5 3.05228 2.94772 3.5 3.5 3.5C4.05228 3.5 4.5 3.05228 4.5 2.5C4.5 1.94772 4.05228 1.5 3.5 1.5ZM12.5 1.5C11.9477 1.5 11.5 1.94772 11.5 2.5C11.5 3.05228 11.9477 3.5 12.5 3.5C13.0523 3.5 13.5 3.05228 13.5 2.5C13.5 1.94772 13.0523 1.5 12.5 1.5Z" fill="currentColor"/>\n')},68160:(e,t,a)=>{"use strict";a.d(t,{f:()=>y});var n=a(97667),s=a(33571),r=a(13729),l=a(74118),i=a(69114),o=a(32136),c=a(19243),d=a(27693),u=a(70676);let m=(0,u.createServerReference)("40c69aae2325323a8a4f1598c8c7869fe0b52250b0",u.callServer,void 0,u.findSourceMapURL,"updateChatPrivacy");var h=a(12507),p=a(99997),x=a(73655),f=a(28819),g=a(91220),v=a(80574),j=a(6680),b=a(25887);function y(e){let{privacy:t,variant:a,chatId:d}=e,{isTeam:u,activeScope:p}=(0,x.k6)(),[f,g]=(0,s.useTransition)(),{chatId:v}=(0,l.xz)(),{setChatPrivacy:j}=(0,o.kM)(),{revalidate:y}=(0,i.m)(),{ownerId:N}=(0,o.tZ)(),[k,C]=(0,s.useState)(!1),S=!N||N===(null==p?void 0:p.id),M=(0,s.useCallback)(e=>{d===v&&j(e),(0,b.D)({type:"shareChat",data:{chatId:d,privacy:e}})},[d,v,j,b.D]),I=(0,s.useCallback)(e=>{!f&&d&&e!==t&&(M(e),("public"===e||"team"===e)&&(0,c.u)("ShareChat",{targetChatId:d,team:"team"===e}),g(async()=>{let n=await m({chatId:d,privacy:e});y(),"error"in n?((0,h.z)(Error(n.error))||r.o.error("Failed to update ".concat("chat"===a?"chat":"chat and block"," privacy")),M(null!=t?t:"private")):r.o.success("".concat("chat"===a?"Chat":"Chat and block"," privacy updated"))}))},[f,d,t,M,y,a]);return(0,n.jsx)(w,{pending:f,hideWarning:"block"===a,privacy:t,setPrivacy:I,open:k,setOpen:C,isOwnedByCurrentTeam:S,isTeam:u})}function w(e){let{pending:t,privacy:a,setPrivacy:s,open:r,setOpen:l,hideWarning:i,isOwnedByCurrentTeam:o,isTeam:c}=e,u=(0,d.k)(),m=o&&("team"===a||"team-edit"===a);return(0,n.jsxs)("div",{className:"flex w-full flex-col justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,n.jsxs)(g.l6,{disabled:t,value:a,onValueChange:s,open:r,onOpenChange:l,children:[(0,n.jsx)(g.bq,{className:"h-8 w-full rounded-md border border-gray-200 px-2 text-left",children:(0,n.jsx)(g.yv,{placeholder:"Select privacy setting",className:"flex w-full flex-row justify-between",children:a?(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-gray-500",children:p.E[a].icon}),(0,n.jsx)("span",{children:u("chatPrivacy.title")(a)})]}):null})}),(0,n.jsx)(g.gC,{className:"max-w-[95vw]",children:Object.keys(p.E).map(e=>{if((!c||!o)&&("team"===e||"team-edit"===e))return null;let s=p.E[e];return!1===s.visibleInPicker?null:(0,n.jsx)(g.eb,{value:e,className:(0,f.cn)("flex cursor-pointer items-center justify-between p-3 hover:bg-gray-100",a===e&&"bg-gray-100"),onSelect:e=>e.preventDefault(),iconOnRight:!0,icon:t?(0,n.jsx)(v.y,{}):void 0,children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-gray-500",children:s.icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:u("chatPrivacy.title")(e)}),(0,n.jsx)("p",{className:"line-clamp-1 text-sm text-gray-500",children:u("chatPrivacy.description")(e)})]})]})},e)})})]}),m&&(0,n.jsxs)(g.l6,{disabled:t,value:a,onValueChange:s,children:[(0,n.jsx)(g.bq,{className:"h-8 min-w-28 max-w-28 rounded-lg border border-gray-200 px-2 text-left text-sm",children:(0,n.jsx)(g.yv,{placeholder:"Select privacy setting",children:(0,n.jsx)("span",{children:u("chatPrivacy.teamSecondaryOptions")(a)})})}),(0,n.jsx)(g.gC,{className:"w-[350px] rounded-lg border border-gray-200 shadow-lg",children:["team","team-edit"].map(e=>(0,n.jsx)(g.eb,{value:e,className:(0,f.cn)("flex cursor-pointer items-center justify-between p-3 hover:bg-gray-100",a===e&&"bg-gray-100"),iconOnRight:!0,icon:t?(0,n.jsx)(v.y,{}):void 0,children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-gray-500",children:p.E[e].icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:u("chatPrivacy.teamSecondaryOptions")(e)}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:u("chatPrivacy.teamSecondaryDescription")(e)})]})]})},e))})]})]}),"public"!==a||i?null:(0,n.jsx)(j.$,{})]})}},68547:(e,t,a)=>{"use strict";a.d(t,{g:()=>l,m:()=>r});var n=a(33571),s=a(25603);function r(e){let{blockId:t,loadingPath:a,files:r}=e,{data:l,mutate:i}=(0,s.Ay)(["block:activeFile",t]),{data:o,mutate:c}=(0,s.Ay)(["block:autoSwitch",t]),d=void 0===o||o,u=(0,n.useMemo)(()=>{var e,t;let a=null==r||null==(e=r.findLast(e=>!e.isMerged))?void 0:e.meta.file;return a||(null==r||null==(t=r[0])?void 0:t.meta.file)},[r,t]),m=l;return d&&a&&(m=a),m||(m=u),{activeFilePath:m,setActiveFilePath:i,autoSwitch:d,setAutoSwitch:c}}function l(e){let{blockId:t}=e,{mutate:a}=(0,s.Ay)(["block:activeFile",t]);return a}},69077:(e,t,a)=>{"use strict";a.d(t,{w:()=>r});var n=a(33571),s=a(14483);function r(e){return{formRef:(0,n.useRef)(null),onKeyDown:(0,n.useCallback)(t=>{if(s.Fr)return;let a=t.currentTarget.value.trim(),n=""===a&&(null==e?void 0:e.localFileInfos)&&e.localFileInfos.length>0;if("Enter"===t.key&&!t.shiftKey&&!t.nativeEvent.isComposing){if(s.nr&&s.xl&&229===t.keyCode)return;t.preventDefault(),n?e.submitMessage():a.length>0&&(null==e||e.submitMessage())}},[e])}}},69114:(e,t,a)=>{"use strict";a.d(t,{m:()=>o,r:()=>c});var n=a(33571),s=a(25603),r=a(73655),l=a(93187);function i(e,t){let{activeScopeSlug:a}=(0,r.k6)(),{data:i,isLoading:o,mutate:c}=(0,s.Ay)(["chat:".concat(e),a],async t=>{let[,a]=t;if(a)try{let t=await fetch("history"===e?"/chat/api/history":"/chat/api/favorites",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to load chat ".concat(e));let a=await t.json();if(!a)throw Error("Failed to load chat ".concat(e));return a.map(e=>({...e,updatedAt:new Date(e.updatedAt)}))}catch(e){if(e==l.hB)return;throw e}},{fallbackData:t}),d=(0,n.useCallback)((e,t)=>{let a=e(i||[]);c(a,{optimisticData:a,revalidate:t})},[i,c]);return{data:i,isLoading:o,revalidate:(0,n.useCallback)(()=>c(),[c]),setData:d}}function o(e){return i("history",e)}function c(e){return i("favorites",e)}},69264:(e,t,a)=>{"use strict";a.d(t,{Cy:()=>m,vg:()=>h});var n=a(97667),s=a(33571);a(1332),a(19716);var r=a(12747),l=a(76640),i=a(53023),o=a(48882),c=a(55274),d=a(95393),u=a(19434);function m(e){let{citations:t}=e;return t.map(e=>{let t="cite-".concat(e.messageId,"-").concat(e.index);return(0,n.jsx)(r.t,{id:t,children:(0,n.jsxs)("a",{className:"inline-flex min-w-0 items-baseline gap-1 no-underline",href:e.url,rel:"noopener noreferrer",target:"_blank",children:[(0,n.jsx)("span",{className:"line-clamp-1",children:e.title}),(0,n.jsx)(l.A,{className:"size-3 shrink-0"})]})},t)})}function h(e){let{urls:t,className:a}=e,[r,l]=(0,s.useState)(0),m=["Browsing search results"];null==t||t.forEach((e,t)=>{let a=e.replace(/^https?:\/\//,"");m[t+1]="Browsing web page: ".concat(a)}),m[Object.keys(m).length]="Synthesizing ".concat(null==t?void 0:t.length," source").concat((null==t?void 0:t.length)===1?"":"s");let h=Object.keys(m).length;return((0,s.useEffect)(()=>{(async()=>{for(let e=0;e<h;e++)0!==e&&await (0,u.yy)(2e3),l(e)})()},[h]),t&&0!==t.length)?(0,n.jsx)("div",{className:(0,o.A)("!mt-[6px]",a),children:(0,n.jsx)("div",{className:"shimmer relative flex items-center gap-1.5 text-gray-500",children:(0,n.jsxs)(c.N,{mode:"popLayout",presenceAffectsLayout:!0,children:[(0,n.jsx)(i.A,{className:"size-4 shrink-0 leading-[normal]"}),(0,n.jsx)("div",{className:"mask relative grow leading-[15px]",children:(0,n.jsx)(c.N,{initial:!1,mode:"popLayout",presenceAffectsLayout:!0,children:(0,n.jsx)(d.P.span,{animate:{y:0},className:"inline-block grow text-ellipsis whitespace-nowrap text-[15px] leading-none md:w-[calc(100%_-_100px)]",exit:{y:-24},initial:{y:24},layout:!0,transition:{type:"tween",duration:.3},children:m[r]},"carousel-".concat(r))})})]})})}):null}a(66692);function p(e){let{index:t}=e;return _jsxs("span",{className:"block size-4 select-none",children:[_jsx("span",{className:"flex size-4 shrink-0 items-center justify-center rounded-full bg-gray-200 p-0.5 font-mono group-hover/citation:hidden",children:_jsx("span",{className:"text-[10px] text-gray-500",children:t})},"index"),_jsx("span",{className:"hidden size-4 shrink-0 items-center justify-center group-hover/citation:flex",children:_jsx(ArrowUpRightSmall,{className:"mt-[1px] text-[#656565]",size:16})},"icon")]})}},70073:(e,t,a)=>{"use strict";a.d(t,{BM:()=>c,Cs:()=>p,a0:()=>h,jP:()=>m});var n=a(57560),s=a(141),r=a(94282),l=a(93187),i=a(7104);let o=new Map,c=(0,s.G)(o,()=>({awaitingChatSubmissionResponse:(0,n.eU)(!1),isStreaming:(0,n.eU)(!1),isStreamingBlock:(0,n.eU)(!1),lastStableBlock:(0,n.eU)(null),forkKeyCache:(0,n.eU)({}),userInitiatedAbort:(0,n.eU)(!1),data:(0,n.eU)({activeBlock:null,activeForkKey:[],messages:[],title:"Untitled"}),permissions:(0,n.eU)({access:3,session:void 0,team:void 0,isAdmin:!1,isAuthor:!1,ownerId:void 0,authorId:void 0,canWriteToChat:!1}),externalMeta:(0,n.eU)({error:l.Sm}),project:(0,n.eU)({error:l.Sm,status:0})})),d=new Map,u=new Map,m=(0,s.G)(d,e=>{let t=c(e);return{...t,deploymentState:(0,n.eU)(e=>{let a=e(t.externalMeta);return a.error&&a.error!==l.p2?"error":a.deployment?(0,i.UD)(a.deployment.readyState):"not-deployed"}),isAuthor:(0,n.eU)(e=>e(t.permissions).isAuthor),canWriteToChat:(0,n.eU)(e=>!!e(t.permissions).canWriteToChat),activeForkKey:(0,n.eU)(e=>e(t.data).activeForkKey),activeBlock:(0,n.eU)(e=>e(t.data).activeBlock),hasMessages:(0,n.eU)(e=>e(t.data).messages.length>0),messages:(0,n.eU)(e=>e(t.data).messages),title:(0,n.eU)(e=>e(t.data).title)}}),h=(0,s.G)(u,(e,t)=>({editingContent:(0,n.eU)(a=>{var n;let s=a(t).find(t=>t.id===e);return s&&"user"===s.role&&null!=(n=s.editingContent)?n:null}),editingAttachments:(0,n.eU)(a=>{var n;let s=a(t).find(t=>t.id===e);return s&&"user"===s.role&&null!=(n=s.editingAttachments)?n:null})}));function p(e){let t=c(e);return{setChatData:e=>r.M.set(t.data,e),setActiveBlock:e=>{let a=r.M.get(t.data);r.M.set(t.data,{...a,activeBlock:e})},setAuthorId:e=>r.M.set(t.data,{...r.M.get(t.data),authorId:e}),setOwnerId:e=>r.M.set(t.data,{...r.M.get(t.data),ownerId:e}),setCanWriteToChat:e=>{r.M.set(t.data,{...r.M.get(t.data),canWriteToChat:e}),r.M.set(t.permissions,{...r.M.get(t.permissions),canWriteToChat:e})},setIsStreamingBlock:e=>r.M.set(t.isStreamingBlock,e),setLastStableBlock:e=>r.M.set(t.lastStableBlock,e),setChatPermissions:e=>r.M.set(t.permissions,e),setAwaitingChatSubmissionResponse:e=>r.M.set(t.awaitingChatSubmissionResponse,e),setIsStreaming:e=>r.M.set(t.isStreaming,e),setMessages:e=>r.M.set(t.data,{...r.M.get(t.data),messages:e}),setChatTitle:e=>r.M.set(t.data,{...r.M.get(t.data),title:e}),setActiveForkKey:e=>r.M.set(t.data,{...r.M.get(t.data),activeForkKey:e}),updateForkKeyCache:e=>r.M.set(t.forkKeyCache,e),addToForkKeyCache:(e,a)=>r.M.set(t.forkKeyCache,{...r.M.get(t.forkKeyCache),[e]:a}),updateActiveForkKey:e=>{let a=r.M.get(t.data);r.M.set(t.data,{...a,activeForkKey:e})},appendMessage:e=>{let a=r.M.get(t.data);r.M.set(t.data,{...a,messages:[...a.messages,e]})},updateMessage:(e,a)=>{let n=r.M.get(t.data);r.M.set(t.data,{...n,messages:n.messages.map(t=>t.id===e?{...t,...a}:t)})},removeMessage:e=>{let a=r.M.get(t.data);r.M.set(t.data,{...a,messages:a.messages.filter(t=>t.id!==e)})},updateMessageAttachments:(e,a)=>{let n=r.M.get(t.data),s=n.messages.find(t=>t.id===e);if(!s||"user"!==s.role)return;let l={...s,attachments:[...s.attachments||[],...a]};r.M.set(t.data,{...n,messages:n.messages.map(t=>t.id===e?l:t)})},updateMessageEditingContent:(e,a,n)=>{let s=r.M.get(t.data),l=s.messages.find(t=>t.id===e);if(!l||"user"!==l.role)return;let i={...l,editingContent:a,editingAttachments:n};r.M.set(t.data,{...s,messages:s.messages.map(t=>t.id===e?i:t)})},setUserInitiatedAbort:e=>r.M.set(t.userInitiatedAbort,e),abortStreaming:()=>{if(!r.M.get(t.isStreaming))return;r.M.set(t.userInitiatedAbort,!0);let e=r.M.get(t.data);if(e.messages.length>0){let a=e.messages[e.messages.length-1];"assistant"===a.role&&r.M.set(t.data,{...e,messages:[...e.messages.slice(0,-1),{...a,streaming:!1}]})}r.M.set(t.isStreaming,!1)}}}},70119:(e,t,a)=>{"use strict";a.d(t,{f:()=>n});let n=(a(33571).cache||(e=>e))(function(e,t){var a;return(null==(a=e.membership)?void 0:a.entitlements)&&e.membership.entitlements.some(e=>"v0"===e.entitlement)||function(e){var t,a;let{user:n,team:s}=e;return"vercel"===s.slug&&!!(t=n)&&(t.teams.includes("vercel")||(null==(a=t.email)?void 0:a.endsWith("@zeit.pub")))}({user:t,team:e})})},70428:(e,t,a)=>{"use strict";a.d(t,{default:()=>m,f:()=>h});var n=a(97667),s=a(33571),r=a(28963),l=a(66692),i=a(25603),o=a(57157),c=a(27693),d=a(19243),u=a(70158);function m(){let e=(0,c.k)(),{figmaOauthUrl:t,setSignInWithFigmaModal:a}=h(),i=(0,u.useRouter)();(0,s.useEffect)(()=>{t&&(0,d.u)("FigmaAuthModalOpen")},[t]);let m=e=>{(0,d.u)("FigmaAuthModalClose",{reason:e}),a(null)},p=async()=>{let e=window.location.pathname+window.location.search,t=await fetch("/chat/api/integrations/figma/get-oauth-url?returnPath=".concat(encodeURIComponent(e))).then(e=>e.json()).then(e=>e.url);i.push(t)};return t?(0,n.jsx)(r.Modal,{onOpenChange:e=>!e&&m("cancel"),open:!!t,children:(0,n.jsxs)("div",{className:"grid gap-6",children:[(0,n.jsx)(r.ModalHeader,{className:"flex justify-start p-5",children:(0,n.jsxs)("div",{className:"flex w-full flex-col items-start gap-4",children:[(0,n.jsx)("div",{className:"bg-muted border-border flex items-center gap-2 rounded-lg p-2",children:(0,n.jsx)("div",{className:"rounded-lg border bg-white p-2",children:(0,n.jsx)(o.Y,{className:"text-muted-foreground h-6 w-6"})})}),(0,n.jsxs)("div",{className:"flex flex-col items-start gap-1.5",children:[(0,n.jsx)(r.ModalTitle,{className:"text-xl font-semibold",children:e("figmaIntegration.signInWithFigma")}),(0,n.jsx)(r.ModalDescription,{className:"text-sm text-zinc-500",children:e("figmaIntegration.signInDescription")})]})]})}),(0,n.jsx)(r.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-end gap-4",children:[(0,n.jsx)(r.ModalClose,{asChild:!0,children:(0,n.jsx)(l.$,{onClick:()=>m("cancel"),size:"sm",variant:"secondary",children:e("figmaIntegration.cancel")})}),(0,n.jsx)(l.$,{onClick:p,size:"sm",variant:"default",autoFocus:!0,children:e("figmaIntegration.signIn")})]})})]})}):null}function h(){let{data:e,mutate:t}=(0,i.Ay)("signInWithFigmaModal",null);return{figmaOauthUrl:null==e?void 0:e.figmaOauthUrl,setSignInWithFigmaModal:t}}},70692:(e,t,a)=>{"use strict";a.d(t,{CreditBalance:()=>b,U:()=>N});var n=a(97667),s=a(66692),r=a(33571),l=a(59790),i=a(18513),o=a(2706),c=a(92461),d=a(20125);function u(e){let{expirationData:t}=e,{totalPayAsYouGoBalance:a,expirations:s}=t;if(1===s.length&&s[0].expiringAmount===a){let{expiringAmount:e,expiringDays:t}=s[0];return(0,n.jsxs)(c.E,{variant:"amber",size:"sm",children:["Expires in ",e," ",(0,n.jsx)("span",{children:1===t?"day":"days"})]})}if(1===s.length){let{expiringAmount:e,expiringDays:t}=s[0];return(0,n.jsxs)(c.E,{variant:"amber",size:"sm",children:["$",e," Expires in ",t," ",(0,n.jsx)("span",{children:1===t?"day":"days"})]})}return s.length>1?(0,n.jsx)(m,{content:(0,n.jsx)(d.TooltipContent,{children:(0,n.jsx)("div",{children:s.map((e,t)=>(0,n.jsxs)("div",{children:["$",e.expiringAmount," Expire in ",e.expiringDays," ",(0,n.jsx)("span",{children:1===e.expiringDays?"day":"days"})]},t))})}),children:(0,n.jsx)("div",{children:(0,n.jsxs)(c.E,{variant:"amber",size:"sm",className:"flex cursor-pointer items-center gap-1",children:["Some credits expire soon ",(0,n.jsx)(o.A,{size:14})]})})}):null}function m(e){let{content:t,children:a}=e,[s,l]=(0,r.useState)(!1);return(0,n.jsx)(d.Tooltip,{open:s,onOpenChange:l,delayDuration:150,content:t,children:a})}var h=a(25887),p=a(70158),x=a(26864),f=a(11747),g=a(19434),v=a(35501),j=a.n(v);function b(e){let{planInfo:t,canBuyCredits:a,needsToRequestCredits:i,daysRemaining:o,balanceOnly:c,autoTopupSection:d}=e,u=(0,p.useRouter)(),m=(0,r.useCallback)(()=>{(0,r.startTransition)(u.refresh)},[u.refresh]),{toolTipMonthly:x,toolTipBuyMore:f}=function(e){switch(e){case"v0-level0":return{toolTipMonthly:"These credits are issued monthly with your free plan. They do not roll over.",toolTipBuyMore:e=>(0,n.jsxs)(n.Fragment,{children:["You can't purchase additional credits on a free plan."," ",(0,n.jsx)(j(),{href:e?"":"/chat/upgrade",onClick:e,className:"text-gray underline",children:"Upgrade Plan"})]})};case"v0-level3":return{toolTipMonthly:"These credits are issued monthly with your Premium plan. They do not roll over.",toolTipBuyMore:()=>(0,n.jsxs)(n.Fragment,{children:["Buy more credits to pay for more v0 usage outside of your monthly credit limit. These credits expire a year after purchase."," ",(0,n.jsx)(j(),{href:"/pricing",className:"text-gray underline",children:"Learn more"})]})};case"v0-team":return{toolTipMonthly:"These credits are issued monthly with your Team plan. They do not roll over.",toolTipBuyMore:()=>(0,n.jsxs)(n.Fragment,{children:["Buy more credits to pay for more v0 usage outside of your monthly credit limit. These credits expire a year after purchase. Unlike monthly credits, they're shared amongst all members of the team."," ",(0,n.jsx)(j(),{href:"/pricing",className:"text-gray underline",children:"Learn more"})]})};case"v0-enterprise":return{toolTipMonthly:"These credits are issued monthly with your Enterprise plan. They do not roll over.",toolTipBuyMore:()=>(0,n.jsxs)(n.Fragment,{children:["Buy more credits to pay for more v0 usage outside of your monthly credit limit. These credits expire a year after purchase. Unlike monthly credits, they're shared amongst all members of the team."," ",(0,n.jsx)(j(),{href:"/pricing",className:"text-gray underline",children:"Learn more"})]})};default:return{toolTipMonthly:"These credits are issued monthly with your plan. They do not roll over.",toolTipBuyMore:e=>(0,n.jsxs)(n.Fragment,{children:["You can't purchase additional credits on a free plan."," ",(0,n.jsx)(j(),{href:e?"":"/chat/upgrade",onClick:e,className:"text-gray underline",children:"Upgrade Plan"})]})}}}(t.plan);return(0,n.jsxs)(l.LB,{children:[(0,n.jsxs)(l.UC,{children:[(0,n.jsx)(l.hE,{children:"Credit Balance"}),(0,n.jsxs)("div",{className:"flex flex-col gap-9 md:flex-row",children:[(0,n.jsx)(y,{title:"Monthly credits",amount:t.balance.remaining,total:t.balance.total,toolTipContent:x}),(0,n.jsx)(y,{title:"Additional purchased credits",amount:t.onDemand.balance,disabled:!a,toolTipContent:f(()=>(0,h.D)({type:"upgradePlan"}))})]}),d]}),c?null:(0,n.jsxs)(l.wi,{className:"bg-muted mt-1 flex flex-col justify-between gap-4 px-4 py-3 sm:flex-row sm:items-center",children:[(0,n.jsxs)("p",{className:"text-muted-foreground text-sm",children:["Your monthly credits reset in ",o," ",(0,n.jsx)("span",{children:1===o?"day":"days"}),".",(0,n.jsx)("span",{children:a?null:" Upgrade your plan to buy more credits."})]}),(0,n.jsx)(s.$,{size:"sm",onClick:()=>(0,h.D)({type:"buyMoreCredits",data:{onSuccess:m,role:t.role}}),disabled:!a,variant:"outline",className:"whitespace-nowrap",children:i?"Request More Credits":"Buy More Credits"})]})]})}function y(e){let{title:t,amount:a,total:s,currency:r="USD",disabled:l,toolTipContent:o,expirationData:c}=e;return(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)("span",{className:"text-muted-foreground text-sm",children:t}),(0,n.jsx)(w,{content:(0,n.jsx)("p",{children:o}),children:(0,n.jsx)("div",{children:(0,n.jsx)(i.IconInfoFill,{className:"text-muted-foreground h-4 w-4"})})})]}),(0,n.jsxs)("p",{className:"flex items-center gap-1 text-sm font-medium",children:[(0,n.jsx)("span",{className:(0,g.cn)("flex items-center",l?"text-muted-foreground":""),children:(0,n.jsx)(x.Ay,{value:a,format:{style:"currency",currency:r}})}),!l&&c?(0,n.jsx)(u,{expirationData:c}):null,s?(0,n.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:["/",(0,n.jsx)(x.Ay,{value:s,format:{style:"currency",currency:r}})]}):null]})]})}function w(e){let{content:t,children:a}=e,[s,l]=(0,r.useState)(!1);return(0,n.jsx)(d.Tooltip,{className:"max-w-[250px]",open:s,onOpenChange:l,content:t,disableHoverableContent:!1,children:a})}let N=r.forwardRef((e,t)=>{let{id:a,initialValue:s="",onChange:l,min:i=10,max:o=5e3,placeholder:c="$0.00",className:d="",currency:u="USD",disabled:m=!1}=e,[h,p]=(0,r.useState)(()=>""===s?"":s.toString());return(0,n.jsx)(f.Ay,{id:a,placeholder:c,value:h,ref:t,max:o,min:i,decimalsLimit:0,onBlur:()=>{if(""===h){p(i.toString()),l(i.toString());return}parseFloat(h)<i&&(p(i.toString()),l(i.toString()))},onValueChange:e=>{if(void 0===e||""===e){p(""),l("");return}let t=parseFloat(e),a=e;t>o&&(a=o.toString()),p(a),l(a)},prefix:k[u],className:(0,g.cn)("min-w-0 border-none bg-transparent outline-none",d),decimalScale:0,allowNegativeValue:!1,disabled:m})});N.displayName="CurrencyInput";let k={USD:"$",EUR:"",GBP:"\xa3",CAD:"CA$",AUD:"A$",JPY:"\xa5",CHF:"CHF",CNY:"\xa5"}},70770:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});var n=a(97667),s=a(28819);function r(e){let{size:t=16,className:a}=e;return(0,n.jsxs)("svg",{className:(0,s.cn)("copy-icon overflow-visible",a),fill:"currentColor",height:t,viewBox:"0 0 16 16",width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("style",{children:'.copy-icon {\n            * {\n              transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95), d 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n            }\n          }\n          button:has(.copy-icon):hover, button:has(.copy-icon):focus-visible {\n            .left {\n              d: path("M 2.75 0.5 C 1.7835 0.5 1 1.2835 1 2.25 V 9.75 C 1 10.7165 1.7835 11.5 2.75 11.5 H 3.75 H 6.5 V 10 H 3.75 H 2.75 C 2.6119 10 2.5 9.8881 2.5 9.75 V 2.25 C 2.5 2.1119 2.6119 2 2.75 2 H 8.25 C 8.3881 2 8.5 2.1119 8.5 2.25 V 5 H 10 V 2.25 C 10 1.2835 9.2165 0.5 8.25 0.5 H 2.75 Z");\n              transform: translate(-1px, -1px);\n            }\n            .right {\n              transform: translate(1px, 1px);\n            }\n          }'}),(0,n.jsx)("path",{className:"left",clipRule:"evenodd",d:"M2.75 0.5C1.7835 0.5 1 1.2835 1 2.25V9.75C1 10.7165 1.7835 11.5 2.75 11.5H3.75H4.5V10H3.75H2.75C2.61193 10 2.5 9.88807 2.5 9.75V2.25C2.5 2.11193 2.61193 2 2.75 2H8.25C8.38807 2 8.5 2.11193 8.5 2.25V3H10V2.25C10 1.2835 9.2165 0.5 8.25 0.5H2.75Z",fill:"currentColor",fillRule:"evenodd"}),(0,n.jsx)("path",{className:"right",clipRule:"evenodd",d:"M7.75 4.5C6.7835 4.5 6 5.2835 6 6.25V13.75C6 14.7165 6.7835 15.5 7.75 15.5H13.25C14.2165 15.5 15 14.7165 15 13.75V6.25C15 5.2835 14.2165 4.5 13.25 4.5H7.75ZM7.5 6.25C7.5 6.11193 7.61193 6 7.75 6H13.25C13.3881 6 13.5 6.11193 13.5 6.25V13.75C13.5 13.8881 13.3881 14 13.25 14H7.75C7.61193 14 7.5 13.8881 7.5 13.75V6.25Z",fill:"currentColor",fillRule:"evenodd"})]})}},71954:(e,t,a)=>{"use strict";a.d(t,{Y:()=>l});var n=a(71543),s=a(19434),r=a(25603);function l(){let{expectUser:e}=(0,n.J)(),{data:t,mutate:a}=(0,r.Ay)(e?"/chat/api/scopes/user":null,s.GO);return{user:t,mutate:a}}},72059:(e,t,a)=>{"use strict";a.d(t,{G:()=>s});var n=a(33571);function s(){var e=e=>"Enter"===e.key&&(e.ctrlKey||e.metaKey);let t=(0,n.useRef)(null);return{formRef:t,onKeyDown:a=>{let n=a.currentTarget.value.trim();if(e(a)&&n.length>0){var s;null==(s=t.current)||s.requestSubmit(),a.preventDefault()}}}}a(14483)},72092:(e,t,a)=>{"use strict";a.d(t,{s:()=>r});var n=a(97667),s=a(28819);function r(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)("prose prose-sm prose-gray min-w-0 break-words",t),...a})}},72524:(e,t,a)=>{"use strict";a.d(t,{c:()=>n,l:()=>l});let n=new Map;function s(e){if(e.nodeType===e.TEXT_NODE)return["#text",{}];if(e.nodeType!==e.ELEMENT_NODE)return["",{}];if("SPAN"===e.nodeName&&e.classList.contains("katex-html"))return["skip",{}];if("SPAN"===e.nodeName&&e.classList.contains("katex-mathml")){var t;return["#text",{},(null==(t=e.querySelector('annotation[encoding="application/x-tex"]'))?void 0:t.textContent)||""]}if("SPAN"===e.nodeName&&(e.classList.contains("linenumber")||e.classList.contains("react-syntax-highlighter-line-number")))return["skip",{}];let a=e.getAttribute("data-seg")||"";if("root"===a||"skip"===a)return[a,{}];let s=n.get(a);return[(null==s?void 0:s.type)||a,(null==s?void 0:s.props)||{}]}let r=new Set(["skip","footnoteReference"]);function l(e,t,a,n){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i="";function o(e,t,c,d){let[u,m,h]=s(e);if(r.has(u))return;if("#text"===u){c&&a&&l&&(i+="...");let t="string"==typeof h?h:e.textContent||"";i+=t,d&&n&&l&&(i+="...");return}let p={...t};switch(u){case"Codeblock":if(m.blockId){var x,f;i+=function(e){let{lang:t,project:a,file:n}=e;return"```".concat(t).concat(a?' project="'.concat(a,'"'):"").concat(n?' file="'.concat(n,'"'):"","\n")}({lang:m.lang,project:null==(x=m.meta)?void 0:x.project,file:null==(f=m.meta)?void 0:f.file})+"...\n```\n\n";return}i+="```".concat(m.lang||"","\n");break;case"code":i+="`";break;case"b":case"strong":i+="**";break;case"i":case"em":i+="*";break;case"del":i+="~~";break;case"hr":i+="---";break;case"Math":i+="$$";break;case"InlineMath":i+="$";break;case"li":if(t.ol){let e=m.index||"1";i+="".concat(e,". ")}else t.ul&&(i+="- ");break;case"ol":t.ol=!0;break;case"ul":t.ul=!0;break;case"h1":i+="# ";break;case"h2":i+="## ";break;case"h3":i+="### ";break;case"h4":i+="#### ";break;case"h5":i+="##### ";break;case"h6":i+="###### ";break;case"blockquote":i+="> ";break;case"tr":t.tableCols=0;break;case"th":case"td":t.tableCols=(t.tableCols||0)+1,p.tableCols=t.tableCols,t.tableCols>1&&(i+=" "),i+="| ";break;case"a":i+="["}let g=e.childNodes.length;for(let a=0;a<g;a++)o(e.childNodes[a],t,c&&0===a,d&&a===g-1);switch(u){case"Codeblock":i+="\n```\n\n";break;case"code":i+="`";break;case"b":case"strong":i+="**";break;case"i":case"em":i+="*";break;case"del":i+="~~";break;case"Math":i+="$$";break;case"InlineMath":i+="$";break;case"li":case"tr":i+="\n";break;case"p":case"table":case"hr":case"blockquote":case"ul":case"ol":case"img":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":i+="\n\n";break;case"thead":i+="|-----".repeat(t.tableCols||1)+"\n";break;case"a":i+="](".concat(m.href||"",")")}Object.assign(t,p)}return l?!function t(a){let[n,r]=s(a);switch(n){case"ul":return o(e,{ol:!1,ul:!0},!0,!0);case"ol":return o(e,{ol:!0,ul:!1},!0,!0);case"Codeblock":i+="```".concat(r.lang||"","\n"),o(e,{ol:!1,ul:!1},!0,!0),i+="\n```";return;case"blockquote":o(e,{ol:!1,ul:!1},!0,!0),i=i.split("\n").map(e=>"> ".concat(e)).join("\n");return;case"del":i+="~~",o(e,{ol:!1,ul:!1},!0,!0),i+="~~";return;case"h1":return i+="# ",o(e,{ol:!1,ul:!1},!0,!0);case"h2":return i+="## ",o(e,{ol:!1,ul:!1},!0,!0);case"h3":return i+="### ",o(e,{ol:!1,ul:!1},!0,!0);case"h4":return i+="#### ",o(e,{ol:!1,ul:!1},!0,!0);case"h5":return i+="##### ",o(e,{ol:!1,ul:!1},!0,!0);case"h6":return i+="###### ",o(e,{ol:!1,ul:!1},!0,!0);case"table":case"root":case"img":case"Math":return o(e,{ol:!1,ul:!1},!0,!0)}if(a.parentNode){if(a.nodeType===a.ELEMENT_NODE){let t=document.createDocumentFragment(),n=a.cloneNode(!1);n.appendChild(e),t.appendChild(n),e=t}t(a.parentNode)}}(t):o(e,{ol:!1,ul:!1},!0,!0),i.trim()}},72770:(e,t,a)=>{"use strict";a.d(t,{j:()=>s,t:()=>n});let{useChatMessageFinishedListener:n,emitChatMessageFinished:s}=(0,a(95087).createEvent)("chatMessageFinished")()},73057:(e,t,a)=>{"use strict";a.d(t,{I:()=>m});var n=a(97667),s=a(33571),r=a(74118),l=a(36323),i=a(70158),o=a(32136),c=a(4842),d=a(80791),u=a.n(d);function m(e){let{count:t,pushToBottom:a}=e,d=(0,s.useRef)(null),m=(0,s.useRef)(null),h=(0,s.useRef)(null),{messages:p,hashMessageId:x,activeForkKey:f}=(0,r.Pk)(),g=(0,l.I4)(),v=(0,i.usePathname)(),{setMetadata:j}=(0,o.tZ)(),{chatId:b}=(0,r.xz)(),[y,w]=(0,s.useState)(!1),[N,k]=(0,s.useState)(!0),C=(0,s.useCallback)((e,a,n)=>{var s;let r=!n&&e>=(null!=a?a:t)-1;null==(s=h.current)||s.scrollToIndex(e,{align:r?"end":"start"}),setTimeout(()=>{r&&m.current&&(m.current.scrollTop=m.current.scrollHeight-m.current.clientHeight+1)},0)},[t]),S=(0,s.useRef)(null),M=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!a){if(S.current===e)return;S.current=e}let s=new Set(null!=n?n:f||[]),r=p.filter(e=>s.has(e.id)).findIndex(t=>t.id===e);-1!==r&&setTimeout(()=>C(r,null==n?void 0:n.length,a),t)},[p,C,f]),I=(0,s.useCallback)(()=>!!h.current&&h.current.scrollOffset+h.current.viewportSize+20>h.current.scrollSize,[]),A=(0,s.useCallback)(()=>{k(I())},[I]),D=u()(A,100);(0,s.useEffect)(()=>{let e=e=>{e.preventDefault();let t=window.location.hash.slice(1);t&&M(t)},t=e=>{var t;let a=e.target.closest("a");if(a&&(null==(t=a.getAttribute("href"))?void 0:t.startsWith("#"))){e.preventDefault(),e.stopPropagation();let t=a.getAttribute("href").slice(1);window.history.pushState(null,"","".concat(v,"#").concat(t)),window.scrollTo(0,0),M(t)}},a=d.current;window.addEventListener("hashchange",e),null==a||a.addEventListener("click",t);let n=m.current?new ResizeObserver(D):void 0;return null==n||n.observe(m.current),window.location.hash?M(window.location.hash.slice(1),250*!!g):x&&M(x,0),()=>{window.removeEventListener("hashchange",e),null==a||a.removeEventListener("click",t),null==n||n.disconnect()}},[g,v,M,j,x,D]);let L=(0,s.useCallback)(()=>{C(t-1),setTimeout(()=>{C(t)},150)},[t,C]),z=(0,s.useRef)(!0),E=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!h.current||!z.current||window.location.hash&&S.current!==window.location.hash)return;let e="".concat(t,"-").concat(b);E.current!==e&&(E.current=e,C(t))},[t,b,C]),(0,s.useEffect)(()=>{var e;a&&(null==(e=h.current)||e.scrollToIndex(t,{align:"end"}))},[t,a]);let P=N||y;return{containerRef:m,vlistRef:h,scrollToBottom:L,scrollToHash:M,scrollDownButton:(0,s.useMemo)(()=>(0,n.jsx)(c.w,{hidden:P,scrollToBottom:()=>{w(!0),C(t-1),w(!1)}}),[P,w,C,t]),handleScroll:A}}},73655:(e,t,a)=>{"use strict";a.d(t,{iF:()=>p,A:()=>u,Yx:()=>h,k6:()=>m});var n=a(25603),s=a(71543),r=a(33571),l=a(11472),i=a(45437),o=a(40445),c=a(70158);function d(e){let{membership:t}=e;return!!t&&!!(t.entitlements&&t.entitlements.find(e=>"v0"===e.entitlement))}let u=e=>null!==e&&"team"===x(e),m=()=>{let e=(0,c.useRouter)(),{user:t,setUser:a,expectUser:u}=(0,s.J)(),{scopes:m,isScopesReady:f,refreshScopes:g}=(0,l.b)(),v=!!(f&&(!u||t)),{data:j,mutate:b,isLoading:y}=(0,n.Ay)(v?"activeScope":null,async()=>{var n,s,r;let l=null!=(n=null==m?void 0:m.find(o.W))?n:null,i=new URLSearchParams(window.location.search).get("scope");if(i){e.replace(window.location.pathname);let t=null==m?void 0:m.find(e=>(0,o.W)(e)?e.username===i:e.slug===i&&d({membership:e.membership}));if(t){let e=p(t),{user:n}=await h(e);return a(n),t}}let c=null==t?void 0:t.scope;if(!c){if(null==t?void 0:t.limited){let e=null!=(s=null==m?void 0:m.find(e=>!(0,o.W)(e)&&!e.limited&&d({membership:e.membership})))?s:null;if(e){let t=p(e),{user:n}=await h(t);a(n)}return e}return l}let[u,x]=c.split(":");if("team"===u){let e=null!=(r=null==m?void 0:m.find(e=>"slug"in e&&e.slug===x&&d({membership:e.membership})))?r:null;if((null==e?void 0:e.limited)&&!(0,o.W)(e)){let{user:e}=await h(x);a(e)}return e}return l},{revalidateIfStale:!1}),w=(0,r.useCallback)(async function(t){let{currentChatId:n,currentProjectId:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="slug"in t?t.slug:void 0,l=p(t),{user:o,redirectingToHome:c}=await h(l,{currentChatId:n,currentProjectId:s});a(o),r?(0,i.QC)("scope",r):(0,i.yM)("scope"),c||e.refresh(),b(t,{optimisticData:t,revalidate:!1})},[b,e,a]),N=(0,r.useMemo)(()=>f&&t&&!y&&null!=j?j:null,[f,t,j,y]),k=(0,r.useMemo)(()=>{var e;return null!=(e=function(e){return e?(0,o.W)(e)?e.username:e.slug:null}(N))?e:void 0},[N]),C=(0,r.useMemo)(()=>"team"===x(N),[N]);return{activeScope:N,activeScopeSlug:k,isActiveScopeReady:v&&void 0!==j,isTeam:C,setActiveScope:w,scopes:m,user:t,refreshScopes:g}};async function h(e){let{currentChatId:t,currentProjectId:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t?"&currentChatId=".concat(encodeURIComponent(t)):"",s=a?"&currentProjectId=".concat(encodeURIComponent(a)):"",r=await fetch("/chat/api/team/change-scope?scope=".concat(encodeURIComponent(e)).concat(n).concat(s),{method:"POST"});if(403===r.status){let e=await r.json();window.location.href=e.redirect}if(!r.ok)throw Error("Failed to update team slug cookie");let l=await r.json();if(!l.success)throw Error("Failed to update team slug cookie");return l.redirect&&(window.location.href=l.redirect),{user:l.user,redirectingToHome:!!l.redirect}}function p(e){return(0,o.W)(e)?"user:".concat(e.username):"team:".concat(e.slug)}function x(e){return e?(0,o.W)(e)?"user":"team":null}},74096:(e,t,a)=>{"use strict";a.r(t),a.d(t,{IconPicker:()=>x,IconPickerContent:()=>f,IconPickerSkeleton:()=>v});var n=a(97667),s=a(33571),r=a(66692),l=a(91211),i=a(28819),o=a(41956),c=a(28963),d=a(93660),u=a(7909),m=a(10037);let h=s.createContext(null),p=()=>{let e=s.useContext(h);if(!e)throw Error("useIconPicker must be used within an IconPicker");return e},x=s.forwardRef((e,t)=>{let{children:a,className:r,trigger:d,icon:u,onValueChange:m,...p}=e,x=(0,o.al)(480),[f,g]=s.useState(!1);return(0,n.jsx)(h.Provider,{value:{icon:u,onValueChange:m,open:f,setOpen:g},children:x?(0,n.jsxs)(c.Modal,{onOpenChange:g,open:f,trigger:d,children:[(0,n.jsx)("div",{className:"sr-only",children:(0,n.jsxs)(c.ModalHeader,{children:[(0,n.jsx)(c.ModalTitle,{children:"Change icon"}),(0,n.jsx)(c.ModalDescription,{children:"Change the icon and color of your project."})]})}),(0,n.jsx)(c.ModalContent,{className:"p-0",children:a})]}):(0,n.jsxs)(l.AM,{onOpenChange:g,open:f,children:[(0,n.jsx)(l.Wv,{asChild:!0,children:d}),(0,n.jsx)(l.hl,{align:"start",className:(0,i.cn)("w-auto",r),ref:t,sideOffset:8,...p,children:a})]})})});function f(e){let{...t}=e,{setOpen:a,icon:s,onValueChange:r}=p();return(0,n.jsx)("div",{...t,children:(0,n.jsx)(g,{onValueChange:e=>{r({...s,name:e}),a(!1)},value:s.name})})}x.displayName="IconPicker";let g=s.memo(s.forwardRef((e,t)=>{let{value:a,onValueChange:l,className:o,...c}=e,[d,h]=s.useState(0),p=s.useCallback(e=>{switch(e.key){case"ArrowRight":h(e=>(e+1)%m.RN.length);break;case"ArrowLeft":h(e=>(e-1+m.RN.length)%m.RN.length);break;case"ArrowDown":h(e=>(e+10)%m.RN.length);break;case"ArrowUp":h(e=>(e-10+m.RN.length)%m.RN.length);break;case"Enter":-1!==d&&l(m.RN[d])}},[d,l]),x=s.useCallback(e=>{l(e)},[l]),f=s.useCallback(e=>{h(e)},[]),g=s.useCallback(e=>{h(e)},[]);return s.useEffect(()=>{if(-1!==d){var e;null==(e=document.querySelector('[data-index="'.concat(d,'"]')))||e.focus()}},[d]),(0,n.jsx)("div",{className:(0,i.cn)("grid min-h-[208px] grid-cols-10 gap-2 overflow-y-auto p-2",o),onKeyDown:p,...c,ref:t,children:Object.entries(u.b).map((e,t)=>{let[s,l]=e;return(0,n.jsx)(r.$,{"aria-label":s,className:"aspect-square w-8 shrink-0 text-gray-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 focus-visible:ring-offset-white data-[active=true]:bg-gray-200 data-[active=true]:text-black","data-active":s===a,"data-index":t,onClick:()=>x((0,m.KI)(s)),onFocus:()=>f(t),onMouseEnter:()=>f(t),onMouseLeave:()=>g(-1),size:"sm",title:s,variant:"ghost",children:(0,n.jsx)(l,{})},s)})})}));g.displayName="IconPickerItems";let v=()=>(0,n.jsx)("div",{className:"grid grid-cols-10 gap-2 overflow-y-auto p-2",children:Array.from({length:50}).map((e,t)=>(0,n.jsx)("div",{className:"flex aspect-square w-8 shrink-0 items-center justify-center",children:(0,n.jsx)(d.E,{className:"aspect-square w-4 shrink-0 rounded-md bg-gray-200"})},t))})},74118:(e,t,a)=>{"use strict";a.d(t,{Pk:()=>h,jo:()=>m,xz:()=>u});var n=a(25603),s=a(70182),r=a(33571),l=a(38792),i=a(43434),o=a(70158),c=a(99999),d=a(70073);function u(){let{data:e,mutate:t}=(0,n.Ay)("chat:id"),a=(0,o.usePathname)();return(0,r.useEffect)(()=>{(0,c.yy)(a)||t(void 0,!1)},[a,t]),{chatId:e}}function m(){let{chatId:e}=u(),{setIsStreaming:t}=(0,d.Cs)(null!=e?e:"no_chat"),{saveLeafMessageId:a,cacheForkKey:n}=(0,i.f)(),{mutate:o}=(0,s.iX)();return(0,r.useCallback)(s=>{o(["chat:state",e],r=>{var i;let o=null!=r?r:l.k;return(o.activeForkKey&&n(o.activeForkKey),"function"==typeof s)?{...o,...s(o)}:(s.activeForkKey&&s.saveLeafMessageId&&e&&(delete s.saveLeafMessageId,a({chatId:e,activeForkKey:s.activeForkKey})),t(null!=(i=s.isStreaming)&&i),{...o,...s})})},[o,e,t,n,a])}function h(){let{chatId:e}=u(),{data:t}=(0,n.Ay)(["chat:state",e]);return{...null!=t?t:l.k,chatId:null!=e?e:"something_went_wrong"}}},74162:(e,t,a)=>{"use strict";a.d(t,{f:()=>l});var n=a(40445),s=a(83195),r=a(70119);function l(e){let{scope:t,user:a,suspense:l=!1}=e,i=(0,n.W)(t),{planSlug:o,isLoading:c}=(0,s.N)(!!i||!t.limited,t.id,void 0,6e4),d=i?void 0:t.membership.role,u=!!(i&&o)||!!(!i&&a&&(0,r.f)(t,a)),m=i?t.username:t.slug,h=!!(!i&&t.accessRequested);return{scopeIsUser:i,scopePlan:o||(i?void 0:t.activeTrialPlan),scopeSlug:m,scopeMembershipRole:d,user:a,hasV0Seat:u,accessRequested:h,isLoading:c}}},74260:(e,t,a)=>{"use strict";a.d(t,{SR:()=>r});let n=["mermaid","math","csv","toolcall","local"],s=new Map([["mermaid","mermaid"],["math","math"],["csv","csv"],["toolcall","toolcall"],["local","local"],["abap","abap"],["astro","astro"],["bat","bat"],["cmd","bat"],["bib","bibtex"],["bibtex","bibtex"],["clj","clojure"],["cljs","clojure"],["png","png"],["jpg","jpg"],["jpeg","jpeg"],["cljc","clojure"],["clojure","clojure"],["coffee","coffeescript"],["coffeescript","coffeescript"],["c","c"],["h","c"],["cpp","cpp"],["cc","cpp"],["cxx","cpp"],["hpp","cpp"],["hh","cpp"],["hxx","cpp"],["cs","csharp"],["csharp","csharp"],["docker-composeyml","dockercompose"],["docker-composeyaml","dockercompose"],["dockercompose","dockercompose"],["css","css"],["cu","cuda-cpp"],["cuh","cuda-cpp"],["cuda-cpp","cuda-cpp"],["d","d"],["pas","pascal"],["pascal","pascal"],["diff","diff"],["patch","diff"],["dockerfile","dockerfile"],["erl","erlang"],["hrl","erlang"],["erlang","erlang"],["fs","fsharp"],["fsi","fsharp"],["fsx","fsharp"],["fsharp","fsharp"],["gitcommit","git-commit"],["git-commit","git-commit"],["gitrebase","git-rebase"],["git-rebase","git-rebase"],["go","go"],["groovy","groovy"],["gvy","groovy"],["gy","groovy"],["gsh","groovy"],["hbs","handlebars"],["handlebars","handlebars"],["haml","haml"],["hs","haskell"],["lhs","haskell"],["haskell","haskell"],["html","html"],["htm","html"],["ini","ini"],["java","java"],["mjs","javascript"],["cjs","javascript"],["js","javascript"],["javascript","javascript"],["jsx","javascriptreact"],["javascriptreact","javascriptreact"],["json","json"],["jsonc","jsonc"],["jl","julia"],["julia","julia"],["kt","kotlin"],["kts","kotlin"],["kotlin","kotlin"],["tex","latex"],["latex","latex"],["less","less"],["lua","lua"],["makefile","makefile"],["mk","makefile"],["md","markdown"],["mdx","markdown"],["markdown","markdown"],["m","objective-c"],["objective-c","objective-c"],["mm","objective-cpp"],["objective-cpp","objective-cpp"],["ml","ocaml"],["mli","ocaml"],["ocaml","ocaml"],["pl","perl"],["pm","perl"],["t","perl"],["perl","perl"],["p6","perl6"],["pl6","perl6"],["pm6","perl6"],["perl6","perl6"],["php","php"],["txt","plaintext"],["plaintext","plaintext"],["ps1","powershell"],["psm1","powershell"],["psd1","powershell"],["powershell","powershell"],["jade","jade"],["pug","pug"],["py","python"],["rpy","python"],["pyw","python"],["cpy","python"],["python","python"],["r","r"],["cshtml","razor"],["razor","razor"],["rb","ruby"],["rbx","ruby"],["rjs","ruby"],["gemspec","ruby"],["ruby","ruby"],["rs","rust"],["rust","rust"],["scss","scss"],["sass","sass"],["shader","shaderlab"],["shaderlab","shaderlab"],["sh","shellscript"],["bash","shellscript"],["zsh","shellscript"],["shellscript","shellscript"],["slim","slim"],["sql","sql"],["styl","stylus"],["stylus","stylus"],["svelte","svelte"],["swift","swift"],["ts","typescript"],["typescript","typescript"],["terraform","terraform"],["tf","terraform"],["hcl","terraform"],["tsx","typescriptreact"],["typescriptreact","typescriptreact"],["tex","tex"],["vb","vb"],["vue","vue"],["vue-html","vue-html"],["svg","xml"],["xml","xml"],["xsl","xsl"],["xslt","xsl"],["yaml","yaml"],["yml","yaml"]]);function r(e){var t;if(!e)return"plaintext";let a=null!=(t=s.get(e))?t:"plaintext";return n.includes(a)?"plaintext":a}new Map(Array.from(s.entries()).map(e=>{let[t,a]=e;return[a,t]})).set("typescriptreact","tsx")},74702:(e,t,a)=>{"use strict";a.d(t,{L:()=>s});var n=a(33571);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,a]=(0,n.useState)(new Set(e));return{values:[...t],has:e=>t.has(e),toggle:e=>a(t=>new Set(t.delete(e)?t:t.add(e))),clear:()=>a(new Set)}}},74905:(e,t,a)=>{"use strict";a.d(t,{s:()=>r});var n=a(33571);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:900;return e<t},r=()=>{let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=window.matchMedia("(max-width: ".concat(899,"px)")),a=()=>{t(s(window.innerWidth))};return e.addEventListener("change",a),a(),()=>e.removeEventListener("change",a)},[]),e}},75486:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>d,XL:()=>c});var n=a(97667),s=a(33571),r=a(60914),l=a(28819);let i=(0,r.F)("[&>svg]:text-foreground relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:a,variant:s,...r}=e;return(0,n.jsx)("div",{className:(0,l.cn)(i({variant:s}),a),ref:t,role:"alert",...r})});o.displayName="Alert";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("h5",{className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a),ref:t,...s})});c.displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a),ref:t,...s})});d.displayName="AlertDescription"},75513:(e,t,a)=>{"use strict";a.d(t,{F:()=>s});let n=a(71018).vt({});function s(e,t){let a=n.clone(e);if(Array.isArray(t)&&9===t[1]&&9===t[2]){let e=t[0].slice(0,-1),n=t[0].slice(-1),s=a;for(let t of e){if("string"==typeof s[t])return s[t]+=n,a;s=s[t]}}return n.patch(a,t),a}},75997:(e,t,a)=>{"use strict";a.d(t,{A2:()=>l});var n=a(74260),s=a(86943);let r=["true","package-lock.json","yarn.lock","bun.lockb","pnpm-lock.yaml","npm-shrinkwrap.json","v0-user-next.config.mjs","v0-user-next.config.js"];function l(e){let{source:t,blockType:a,blockId:l}=e,i=t.split("\n"),o=null,c=[],d=s.Vr[a],u=!1;for(let e of i)if(e.startsWith(d)){let t,[a,...s]=e.slice(d.length).trim().split(":"),i=function(e){let t;if(!e)return{};let a=/(\w+)=["']([^"']*)["']|(\w+)/g,n={};for(;null!==(t=a.exec(e));)t[1]?n[t[1]]=t[2]:t[3]&&(n[t[3]]="true");return n}(s.join(":"));if(!i.file||r.some(e=>i.file===e)){u=!0;continue}u=!1,o&&c.push({...o});try{t=i.fixingBadLines.split(",").map(Number)}catch(e){t=void 0}i.url&&!i.url.startsWith("https://")&&delete i.url,o={lang:(0,n.SR)(a),meta:i,isEdit:!!i.isEdit,isAttachmentQuickEdit:!!i.isAttachmentQuickEdit,isLocked:!!i.isLocked,isQuickEdit:!!i.isQuickEdit,isTerminated:!!i.isTerminated,isDeleted:!!i.isDeleted,isFixed:!!i.isFixed,isRecovered:!!i.isRecovered,isMoved:!!i.isMoved,isMovedFrom:i.isMovedFrom,isTempFile:!!i.isTempFile||void 0,isHidden:!!i.isHidden||void 0,isLoading:!!i.isLoading||void 0,fixingBadLines:t,blockId:l,source:"",isMerged:!!i.isMerged,blobUrl:i.url}}else o&&!u&&(o.source+=e+"\n",o.blobUrl&&o.source.trim().length>0&&(o.blobUrl=void 0));o&&c.push(o);let m=c.length>0&&c[c.length-1].isTempFile;return c.filter(e=>{var t;return(!(!e.isDeleted&&(t=e.source).trim().startsWith("...")&&t.trim().endsWith("..."))||-1!==t.trim().indexOf("\n")||!!e.blobUrl)&&(!!m||!e.isTempFile)&&!e.isHidden})}},76106:(e,t,a)=>{"use strict";a.d(t,{t:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40f4fe074d80915a424f1cde9865a7650ae2a379f9",n.callServer,void 0,n.findSourceMapURL,"linkVercelProject")},76603:(e,t,a)=>{"use strict";a.d(t,{RG:()=>R,KM:()=>F});var n=a(97667),s=a(28819),r=a(14890),l=a(33571),i=a(49019),o=a(14397),c=a(13729),d=a(19243),u=a(42938),m=a(26522),h=a(94177),p=a(43447),x=a(10034),f=a(99339),g=a(77831),v=a(71543),j=a(32136);let b=l.memo(function(e){let{messageAuthorId:t}=e,{user:a}=(0,v.J)(),{authorId:s}=(0,j.tZ)(),r=t||s||(null==a?void 0:a.id);return r?(0,n.jsx)(f.AvatarUser,{size:"sm",userId:r}):(0,n.jsx)(f.Avatar,{size:"sm",children:(0,n.jsx)(g.hSU,{})})});var y=a(54910),w=a(78517),N=a(22237),k=a(16799),C=a(19676),S=a(27693),M=a(18858),I=a(41557),A=a(71449);function D(e){let{message:t,className:a}=e;return(0,n.jsx)(r.E,{avatar:(0,n.jsx)(b,{}),className:a,id:t.id,children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{className:"inline-flex items-center gap-1 rounded bg-green-600/15 px-1.5 py-0.5 text-sm text-green-800 cursor-pointer",children:[(0,n.jsx)(I.A,{className:"h-3.5 w-3.5"}),"Established connection with local v0 dev server."]}),(0,n.jsx)("div",{className:"p-1",children:(0,n.jsx)("p",{className:"text-sm whitespace-pre-wrap font-mono bg-gray-100 p-2",children:t.content||"Established connection with local v0 dev server."})})]})})}function L(e){let{message:t,className:a}=e;return(0,n.jsx)(r.E,{avatar:(0,n.jsx)(b,{}),className:a,id:t.id,children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{className:"inline-flex items-center gap-1 rounded bg-black/15 px-1.5 py-0.5 text-sm text-black cursor-pointer",children:[(0,n.jsx)(A.A,{className:"h-3.5 w-3.5"}),"User has made some changes directly to the local project."]}),(0,n.jsx)("div",{className:"p-1",children:(0,n.jsx)("p",{className:"text-sm whitespace-pre-wrap font-mono bg-gray-100 p-2",children:t.content})})]})})}var z=a(38035),E=a(25603),P=a(70182);let T=["added-environment-variables","added-integration","forked-block","reverted-block","sync-git"];function F(){let{mutate:e}=(0,P.iX)();return{setEditPromptForm:(0,l.useCallback)((t,a)=>{e([t,"initial-value-user-message"],a),e([t,"is-editing-user-message"],!0)},[e])}}function R(e){var t;let{message:a,animateUser:f,forkKeyOptions:g}=e,j=a;"refinement"===j.type&&(j={...j,content:(0,z.Fb)(j.content)});let I=(0,S.k)(),{user:A}=(0,v.J)(),{setConfirmDelete:P}=(0,w.a)(),F=(0,l.useMemo)(()=>(null==A?void 0:A.isAdminMode)?(0,k.Z)([j]):void 0,[j,A]),[R]=(0,M.d)(),U=(null==R?void 0:R.remaining)===0,{isEditing:V,initialEditValue:B,setIsEditing:_}=function(e){let{messageId:t}=e,{data:a,mutate:n}=(0,E.Ay)([t,"is-editing-user-message"],null),{data:s,mutate:r}=(0,E.Ay)([t,"initial-value-user-message"],null);return{isEditing:a||!1,initialEditValue:s||null,setIsEditing:(0,l.useCallback)(e=>{r(null),n(e)},[n,r])}}({messageId:j.id});if(j.type&&T.includes(j.type))return null;if((0,C.pm)(j))return(0,n.jsx)(D,{className:(0,s.cn)(f&&"animate-slideUpAndFade duration-500"),message:j});if((0,C.pW)(j))return(0,n.jsx)(L,{className:(0,s.cn)(f&&"animate-slideUpAndFade duration-500"),message:j});let O=""===j.content;return(0,n.jsx)(r.E,{avatar:(0,n.jsx)(b,{messageAuthorId:j.authorId}),className:(0,s.cn)(f&&"animate-slideUpAndFade duration-500"),id:j.id,children:V?(0,n.jsx)(o.x,{handleCancel:()=>_(!1),initialText:null!=(t=B||j.content)?t:"",messageId:j.id,content:a.content||"",type:j.type||"message",initialAttachments:j.attachments}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,s.cn)("flex flex-1 -translate-x-1 flex-col items-stretch",!(0,C.ZW)(j)&&"gap-2"),children:["refinement"===j.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"ml-1 flex w-min items-center justify-center gap-1.5 whitespace-nowrap rounded-full bg-teal-100 px-2.5 py-1 text-xs font-semibold text-teal-900",children:[(0,n.jsx)("div",{className:"size-2 rotate-45 border-2 border-teal-900"}),(0,z.Og)(a.content)]}),(0,n.jsxs)("div",{className:"flex items-start justify-start gap-2 pl-4",children:[(0,n.jsx)(m.S,{className:"size-3 h-6 text-gray-500"}),(0,n.jsx)(i.P,{className:"",message:j})]})]}):(0,n.jsx)(i.P,{className:"pl-1",message:j}),(0,n.jsx)(x.Cj,{attachments:j.attachments,className:(0,s.cn)("px-1 pb-3",!(0,C.ZW)(j)&&"pt-1")}),(0,n.jsx)("div",{className:(0,s.cn)("pointer-events-none absolute inset-y-0 right-0 z-10"),children:(0,n.jsxs)(y.Kn,{className:"pointer-events-auto sticky top-3 flex -translate-y-1.5 opacity-0 group-hover:opacity-100 has-[[data-state='delayed-open']]:opacity-100 has-[[data-state='instant-open']]:opacity-100 has-[[data-state=open]]:opacity-100 md:top-5 [[data-touch-active=true]_&]:opacity-100",children:[(0,n.jsx)(y.rc,{"aria-label":I("userMessage.editMessage"),className:"author-action",disabled:U,onClick:()=>{_(!0),(0,d.u)("OpenEditUserMessage",{messageId:j.id})},tooltip:U?I("userMessage.limitReached"):I("userMessage.editMessage"),children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(h.Y,{className:"pointer-events-none"})})},j.id),(0,n.jsx)(y.Sl,{className:"author-action"}),(0,n.jsx)(y.rc,{"aria-label":I("userMessage.deleteMessage"),className:"author-action",onClick:()=>{P(j.id),(0,d.u)("OpenDeleteMessage",{messageId:j.id})},tooltip:I("userMessage.deleteMessage"),children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(p.l,{className:"pointer-events-none"})})},j.id+"@delete"),!O&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Sl,{className:"author-action"}),(0,n.jsx)(y.rc,{"aria-label":I("userMessage.copyMessage"),onClick:()=>navigator.clipboard.writeText(j.content||"").then(()=>c.o.success(I("userMessage.copiedToClipboard"))).catch(()=>c.o.error("Failed to copy message to clipboard")),tooltip:I("userMessage.copyMessage"),children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(u.Q,{className:"pointer-events-none"})})})]})]})})]}),(0,n.jsx)(N.I,{className:"pt-2",forkKeyOptions:g,message:j}),(null==A?void 0:A.isAdminMode)&&(0,n.jsxs)("div",{className:"mt-4 w-fit flex-wrap gap-3 whitespace-pre-wrap font-mono text-[10px] text-gray-600",children:[(0,n.jsx)("span",{className:"text-gray-500",children:"Estimation:"}),F]})]})})}},76727:(e,t,a)=>{"use strict";a.d(t,{A4:()=>t_,sY:()=>tW,LU:()=>tZ,h:()=>tG,PQ:()=>tH});var n=a(97667),s=a(33571),r=a(66692),l=a(28819),i=a(27596),o=a(80296);function c(e){return(0,n.jsx)("div",{className:"bg-muted my-4 space-y-4 rounded-lg border px-4 pb-6 pt-2",children:e.children})}function d(e){let{value:t,selected:a,onClick:s,children:r,index:i}=e;return(0,n.jsxs)("label",{className:"flex w-full cursor-pointer flex-col",children:[(0,n.jsx)("input",{className:"size-0",defaultChecked:a,name:"answer",onClick:s,type:"radio",value:t}),(0,n.jsxs)("span",{className:(0,l.cn)("bg-background flex items-center justify-start gap-3 px-4 py-3 transition-colors",a&&"bg-blue-100"),children:[(0,n.jsx)("span",{className:(0,l.cn)("flex size-5 select-none items-center justify-center rounded-full bg-blue-100 text-center text-xs font-semibold text-blue-800 transition-colors",a&&"bg-blue-400 text-white"),children:String.fromCharCode(65+i)}),r]})]})}function u(e){let{correct:t,selected:a,className:s}=e;return t||a?(0,n.jsx)("span",{className:(0,l.cn)("inline-block size-6 shrink-0 rounded-full p-1 align-middle",t?"bg-blue-100 text-blue-600":"bg-red-100 text-red-500",s),children:t?(0,n.jsx)(i.r,{}):(0,n.jsx)(o.$,{})}):null}function m(e){let{answer:t,correctAnswer:a}=e;return(0,n.jsxs)("span",{className:(0,l.cn)("animate-slideDownAndFade flex select-none items-center justify-center gap-1 rounded-full py-1 pl-3 pr-5",t===a&&"bg-blue-100 text-blue-600",t&&t!==a&&"bg-red-100 text-red-500"),children:[void 0!==t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u,{correct:t===a,selected:!0})," "]}),void 0===t?(0,n.jsxs)(n.Fragment,{children:["The correct answer is: ",(0,n.jsx)("strong",{children:a})]}):t===a?(0,n.jsx)("span",{className:"font-bold text-blue-600",children:"Correct"}):(0,n.jsx)("span",{className:"font-bold text-red-500",children:"Incorrect"})]})}function h(e){let{answers:t,correctAnswer:a,question:l}=e,[i,o]=(0,s.useState)(null),[h,p]=(0,s.useState)(!1),[x,f]=(0,s.useState)(!1);return(0,n.jsxs)(c,{children:[(0,n.jsx)("p",{className:"text-md px-4 text-center font-semibold md:px-8 lg:px-12",children:l}),(0,n.jsx)("div",{className:"mx-0 flex flex-col divide-y overflow-hidden rounded-md border md:mx-8 lg:mx-12",children:t.map((e,t)=>(0,n.jsxs)(d,{index:t,onClick:()=>{x||o(e)},selected:e===i,value:e,children:[(0,n.jsx)("span",{className:"flex-1",children:e}),h?(0,n.jsx)(u,{className:"animate-slideDownAndFade ml-2",correct:e===a,selected:e===i}):null]},e))}),(0,n.jsx)("div",{className:"flex justify-center",children:h&&null!==i?(0,n.jsx)(m,{answer:i,correctAnswer:a}):(0,n.jsx)(r.$,{className:"h-9 select-none",disabled:null===i,onClick:()=>{p(!0),f(!0)},size:"sm",children:"Check answer"})})]})}var p=a(48882);function x(e){let{children:t,className:a,...s}=e;return(0,n.jsx)("div",{className:(0,p.A)("steps mb-12 ml-2 border-l border-gray-200 pl-5 sm:ml-4 sm:pl-6","[counter-reset:step]",a),...s,children:t})}a(98013);var f=a(51311);function g(e){let{title:t}=e;return(0,n.jsxs)("div",{className:"rounded-lg border border-gray-100 p-4 shadow-sm",children:[(0,n.jsx)("p",{className:"mb-2 mt-0 font-medium text-gray-600",children:t}),(0,n.jsxs)("div",{className:"animate-pulse",children:[(0,n.jsx)("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),(0,n.jsx)("div",{className:"mt-2 h-4 w-1/2 rounded bg-gray-200"}),(0,n.jsx)("div",{className:"mt-2 h-4 w-3/4 rounded bg-gray-200"})]})]})}var v=a(92871);function j(e){let{language:t,children:a,closed:s,sqlExecutionState:r,blockId:l="syntax-highlighter-block",transaction:i,type:o,fileName:c}=e;return(0,n.jsx)(v.N,{allowCopyCode:!0,allowDownloadCode:!1,caller:"inline",className:"not-prose max-h-[500px] md:max-h-[700px]",headerClassName:"bg-muted",language:t,showLineNumbers:!1,value:a,closed:s,blockId:l,originalCode:void 0,showQuickEditAnimation:!1,sqlExecutionState:r,transaction:i,type:o,fileName:c})}var b=a(17209),y=a(80889),w=a(62519),N=a(75171),k=a(72524),C=a(72092),S=a(65744),M=a(58576),I=a(32136),A=a(28265),D=a(27693);let L=(0,s.createContext)({}),z="function"==typeof Intl.Segmenter?new Intl.Segmenter("en",{granularity:"word"}):null,E=window.matchMedia("(prefers-reduced-motion: reduce)").matches;function P(e){let{streaming:t,readonly:a,children:l,messageId:i}=e,o=(0,D.k)(),{setQuote:c}=(0,I.sC)(),d=(0,s.useState)(()=>{let e=new Map,t=new Map,a=new Set,n=new Map,s=!1;return(r,l,i,o)=>{l.current&&(e.set(r,l),t.set(r,i),a.add(r),n.set(r,o),s||(s=!0,setTimeout(c,8)));async function c(){if(0===a.size){s=!1;return}let r=a.values().next().value;if(void 0===r){s=!1;return}for(let e of a)e<r&&(r=e);a.delete(r);let l=e.get(r),i=t.get(r),o=n.get(r);if(l&&l.current&&(null==o||o(),i&&i.current)){let e=l.current.textContent;i.current.startsWith(e)||(l.current.textContent="",e="");let t=function(e){let t=[];if(z)for(let{segment:a}of z.segment(e))t.push(a);else{let a=e.split(" ");for(let e=0;e<a.length;e++)e>0&&t.push(" "),t.push(a[e])}return t}(i.current.slice(e.length));for(let a=0;a<t.length&&(e+=t[a],l.current);a++)l.current.textContent=e," "!==t[a]&&await new Promise(e=>setTimeout(e,8))}setTimeout(c,8)}}})[0],u=!0!==a,m=(0,s.useRef)(null),[h,p]=(0,s.useState)(null),x=function(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{t("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)},[]),e}(),{refs:f,floatingStyles:g}=(0,y.we)({placement:x?"bottom":"top",middleware:[(0,w.cY)(12),(0,w.mG)(),(0,w.UU)({padding:6})],whileElementsMounted:N.ll}),v=(0,s.useRef)(()=>"");(0,s.useEffect)(()=>{let e=!1,t=()=>{var t;e=!1;let a=window.getSelection();if(null===a||!a.rangeCount)return void p(null);let n=a.getRangeAt(0);if(n.collapsed)return void p(null);let s=null==(t=m.current)?void 0:t.contains(n.commonAncestorContainer),r=m.current;if(!s){let e=!1,t=n.commonAncestorContainer;if(t instanceof HTMLElement){let a=t.closest('[data-seg="code-root"]');a&&a instanceof HTMLElement&&(e=!0,r=a)}if(!e)return void p(null)}for(;0===n.endOffset;)n.setEndBefore(n.endContainer);u&&f.setReference({getBoundingClientRect:()=>n.getBoundingClientRect(),getClientRects:()=>{let e=n.getClientRects(),t=[];t.item=e=>t[e];for(let a=0;a<e.length;a++){let n=e[a];n.width>.1&&n.height>.1&&t.push(n)}return t}}),e=!0,v.current=function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],a=n.cloneContents();return(0,k.l)(a,n.commonAncestorContainer,n.startOffset>0,(null==(e=n.endContainer.textContent)?void 0:e.length)!==n.endOffset,t)},u&&p(r)};function a(t){if(!e||!t.clipboardData)return;let a=v.current(!1);t.clipboardData.setData("text/markdown",a),t.clipboardData.setData("text/plain",a),t.preventDefault()}return document.addEventListener("selectionchange",t),document.addEventListener("keyup",t),document.addEventListener("copy",a),()=>{document.removeEventListener("selectionchange",t),document.removeEventListener("keyup",t),document.removeEventListener("copy",a)}},[f,u]);let[j,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=m.current;if(!e)return;let t=e=>{var t;null!=(t=f.floating.current)&&t.contains(e.target)||b(!0)},a=()=>{b(!1)};return e.addEventListener("pointerdown",t),e.addEventListener("pointerup",a),e.addEventListener("pointerleave",a),()=>{e.removeEventListener("pointerdown",t),e.removeEventListener("pointerup",a),e.removeEventListener("pointerleave",a)}},[f.floating]),(0,S.ML)("keydown",e=>{var t;"q"===e.key&&h&&(c(v.current()),null==(t=window.getSelection())||t.removeAllRanges(),e.stopPropagation(),e.preventDefault())});let E=(0,s.useMemo)(()=>({animate:t?d:void 0}),[t,d]);return(0,n.jsxs)("div",{ref:m,className:"w-full",children:[h&&(0,n.jsx)(y.XF,{root:h,children:(0,n.jsxs)("div",{className:"bg-background shadow-base-expand absolute left-0 top-0 z-50 flex select-none items-center gap-1 rounded-lg p-1","data-quote-button":!0,ref:f.setFloating,style:{...g,pointerEvents:j?"none":void 0},children:[(0,n.jsxs)(r.$,{className:"hover:text-foreground rounded-md px-0.5 py-0 text-sm text-gray-500",onClick:()=>{var e;c(v.current()),null==(e=window.getSelection())||e.removeAllRanges()},size:"xs",variant:"ghost",children:[o("segmenterProvider.quote"),(0,n.jsx)(A.u,{variant:"secondary",children:"Q"})]}),(0,n.jsx)("div",{className:"bg-alpha-400 h-5 w-px"}),(0,n.jsx)(M.H,{className:"text-gray-500",messageId:i,quoteRef:v,tooltip:"Downvote Selection",variant:"quote"})]})}),(0,n.jsx)(C.s,{"data-seg":"root",children:(0,n.jsx)(L.Provider,{value:E,children:l})})]})}var T=a(32376),F=a(12747),R=a(71543),U=a(69264),V=a(80574),B=a(24067),_=a(55274),O=a(99347);let H=O.bL,$=O.R6,q=O.Ke;var W=a(17545),G=a(39849);function Z(e){let{name:t,files:a=[],animated:r=!0}=e,[i,o]=(0,s.useState)(r),[c,d]=(0,s.useState)(a.length<2);(0,s.useEffect)(()=>{if(!r)return void o(!1);let e=setTimeout(()=>o(!1),250);return()=>clearTimeout(e)},[a,r]);let u=r?"animate-shimmer translate-y-px bg-[length:800%_100%] bg-clip-text text-sm text-transparent":void 0,m=r?{backgroundImage:"linear-gradient(90deg,rgb(161 161 170) 0%,rgb(161 161 170) 35%,rgb(212 212 216) 50%,rgb(161 161 170) 65%,rgb(161 161 170) 100%)"}:void 0;return(0,n.jsx)("div",{className:"font-mono text-gray-500",children:(0,n.jsxs)(H,{open:c,onOpenChange:d,children:[(0,n.jsx)($,{asChild:!0,children:(0,n.jsx)("button",{className:(0,l.cn)(u,"mb-2 flex cursor-pointer items-center"),style:m,children:i?t?(0,n.jsxs)(n.Fragment,{children:["Scanning ",a.length," files inside /",t,"..."]}):(0,n.jsxs)(n.Fragment,{children:["Reading ",a.length," files..."]}):(0,n.jsxs)(n.Fragment,{children:[t?(0,n.jsxs)(n.Fragment,{children:["Scanned ",a.length," files inside ",t," "]}):(0,n.jsxs)(n.Fragment,{children:["Read ",a.length," files "]}),c?(0,n.jsx)(W.y,{className:"ml-1 h-3 w-3"}):(0,n.jsx)(G.c,{className:"ml-1 h-3 w-3"})]})})}),(0,n.jsx)(q,{className:"border-l border-gray-200",children:(0,n.jsx)(_.N,{children:(0,n.jsx)("ul",{className:"m-0 flex list-none flex-col gap-2 p-0",children:a.map(e=>(0,n.jsx)("li",{className:"m-0 list-none p-0 text-sm",children:e},e))})})})]})})}let Y=s.memo(e=>{let{source:t,streaming:a}=e,s=t.replace(/[^]*Tool call result:\n/,""),r=t.replace(/\nTool call result:[^]+/,""),l=null,i=null;try{l=JSON.parse(r),i=JSON.parse(s)}catch(e){}if(i&&((null==l?void 0:l.type)==="read_dir"||(null==l?void 0:l.type)==="read_file"))return(0,n.jsx)(Z,{name:"read_dir"===l.type?l.dir:void 0,files:"read_dir"===l.type?"files"in i?i.files:[]:Object.keys(("content"in i?i.content:{})||{}),animated:a||!1});let o=(null==l?void 0:l.type)==="computer"&&"screenshot"===l.action&&i&&"data"in i;return(0,n.jsx)("p",{className:"inline-flex cursor-pointer rounded bg-cyan-600/10 px-1.5 py-0.5 text-sm text-cyan-700",children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{className:"inline-flex items-center gap-2",children:[(0,n.jsx)(B.A,{className:"h-3.5 w-3.5"}),r]}),(0,n.jsx)("div",{className:"mb-1 rounded bg-cyan-800/10 p-1 font-mono text-xs",children:o?(0,n.jsx)("img",{className:"max-h-64 max-w-full",src:"data:image/png;base64,".concat(i.data),alt:"Tool call result"}):s})]})})});Y.displayName="Toolcall";var K=a(95393),J=a(32790),Q=a(49848),X=a(31761),ee=a(25951),et=a(99066),ea=a(66948),en=a(38312),es=a(23503),er=a(8153),el=a(74118),ei=a(20125),eo=a(47540),ec=a(99466),ed=a(88639),eu=a(93660),em=a(13729),eh=a(16894),ep=a(16292),ex=a(80672);let ef=(0,a(57560).eU)(new Set),eg={enter:e=>({y:e>0?40:-40,opacity:0}),center:{y:0,opacity:1},exit:e=>({y:e<0?40:-40,opacity:0})},ev=new Intl.ListFormat("en",{style:"long",type:"conjunction"});function ej(e){var t;let a,{messageId:r,names:l}=e;a="string"==typeof l?[l]:l||[];let o=(0,el.Pk)(),c=(0,I.tZ)(),{user:d}=(0,R.J)(),u=o.activeForkKey,m=!!u&&u[u.length-1],h=m&&m===r,p=null==u?void 0:u.indexOf(r),x=void 0!==p&&p<u.length?u[p+1]:void 0,f=x&&(null==(t=o.messages.find(e=>e.id===x))?void 0:t.type)==="added-environment-variables",[g,v]=(0,s.useState)({}),[j,b]=(0,s.useState)({}),[y,w]=(0,s.useState)(!1),[N,k]=(0,s.useState)(0),{selectedProjectId:C}=(0,ee._t)(),{submit:S}=(0,et.yI)(),[M,A]=(0,s.useState)(h?"unsubmit":f?"submitted":"cancelled");(0,s.useEffect)(()=>{h?A("unsubmit"):f?A("submitted"):A("cancelled")},[h,f]);let{project:D,canWriteToChat:L}=(0,I.tZ)(),z=null==D?void 0:D.vercelProjectId,{projects:E,isReady:P}=(0,ed.D)(),T=null==E?void 0:E.find(e=>e.id===z),F=a.map(e=>({key:e,alreadyExists:null==T?void 0:T.env.find(t=>t===e)})),U=async()=>{if(!Object.keys(g).length)return em.o.error("No environment variables to create. Please try again.");if(!Object.values(g).every(e=>e))return;let e=C;if(w(!0),!C){let t=await (0,eh.g)({projectName:c.title||"New V0 Project",chatId:o.chatId,includeSuccessToast:!1});if(!t.id)return em.o.error("Failed to create v0 Project. Please add this chat to a project");e=t.id,await c.setMetadata({...c,project:{projectId:t.id,vercelProjectId:t.vercelProjectId||null,name:c.title||"New V0 Project",settings:{icon:"icon-wand-sparkles",color:null},isCreator:!0}})}if(!e)return em.o.error("v0 Project ID not found. Please try again.");let t=[],n=await (0,X.g)({envVars:Object.entries(g).map(e=>{let[t,a]=e;return{key:t,value:a}}),v0ProjectId:e,autoCreateVercelProject:!1,chatId:o.chatId}).catch(e=>(t.push(e.message),[{success:!1}]));if(t.length)return w(!1),em.o.error(t.join(". ")||"Failed to create environment variables.");if(!n){w(!1),em.o.error("Failed to create environment variables.");return}"success"in n&&n.success?(v({}),k(-1),A("submitted"),await S({action:"new",attachments:[],input:"The environment variable".concat(a.length>1?"s":""," ").concat(ev.format(a)," ").concat(a.length>1?"have":"has"," been added to the [Vercel Project]()."),type:"added-environment-variables",revalidateVercelEnvAndIntegrations:!0})):(console.error(t),em.o.error(t.join(". ")||"Failed to create environment variables."))};return P?(0,n.jsx)(J.Zp,{className:"w-full max-w-[360px] overflow-hidden shadow-sm","data-seg":"skip",children:(0,n.jsxs)(J.Wu,{className:"my-0 p-3",children:[(0,n.jsxs)(_.N,{custom:N,mode:"wait",children:["submitted"===M&&(0,n.jsx)(K.P.div,{custom:N,variants:eg,initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-center space-y-4",children:(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-2 py-3 text-center",children:[(0,n.jsx)("span",{className:"rounded-full border border-green-200 bg-green-100 p-1.5",children:(0,n.jsx)(i.r,{className:"!text-green-600"})}),(0,n.jsxs)("h2",{className:"flex items-center gap-1 text-sm font-medium",children:[(0,n.jsx)("span",{children:"Environment Variables Added"}),(0,n.jsx)(ei.Tooltip,{content:(0,n.jsx)("ul",{children:a.map(e=>(0,n.jsx)("li",{className:"flex items-center space-x-1",children:(0,n.jsx)("span",{children:e})},e))}),children:(0,n.jsx)("span",{className:"text-gray-500",children:(0,n.jsx)(er.f,{})})})]})]})},"info"),("unsubmit"===M||!C)&&h&&(0,n.jsxs)(K.P.form,{custom:N,variants:eg,initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col space-y-4",children:[z||T||!C?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"text-center",children:["This v0 Project has no"," ",(0,n.jsx)(eo.N,{href:"https://vercel.com/docs/projects/overview",external:!0,children:"Vercel Project"})," ","associated."]}),(0,n.jsx)(ec.KF,{currentProject:T,projects:E||[],v0ProjectId:C,readOnly:!L})]}),(0,n.jsxs)(n.Fragment,{children:[F.map((e,t)=>{let{key:a,alreadyExists:s}=e;return(0,n.jsx)("div",{className:"relative flex w-full",children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("label",{className:"text-xs font-medium text-gray-500",children:[a," ",s&&(0,n.jsx)("span",{children:"*"})]}),(0,n.jsx)(eb,{messageId:r,index:t,value:g[a]||"",onChange:e=>v({...g,[a]:e.target.value}),placeholder:"Value",type:j[a]?"text":"password",required:!0,name:a,minLength:1,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:"false","data-lpignore":"true","data-1p-ignore":"true",disabled:!L,size:"sm"}),(0,n.jsx)(_.N,{children:g[a]&&(0,n.jsx)(ei.Tooltip,{content:j[a]?"Hide":"Show",children:(0,n.jsx)(K.P.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},type:"button",onClick:()=>b({...j,[a]:!j[a]}),className:"absolute right-2 top-8 text-gray-500",children:j[a]?(0,n.jsx)(en.X,{size:14}):(0,n.jsx)(ea.k,{size:14})},a)})})]})},a)}),F.some(e=>{let{alreadyExists:t}=e;return t})&&(0,n.jsx)("span",{className:"text-xs text-gray-500",children:"* Environment variable already exists and will be updated."}),(0,n.jsxs)("span",{className:"flex items-center justify-between",children:[(0,n.jsx)("hr",{className:"border-border m-2 border-dashed py-2"}),(0,n.jsx)(ep.x,{onClick:U,pending:y,disabled:!L,type:"submit",size:"sm",children:"Submit"})]})]})]},"value"),"cancelled"===M&&(0,n.jsx)(K.P.div,{custom:N,variants:eg,initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-center",children:(0,n.jsx)("div",{className:"flex flex-col items-center text-center",children:(0,n.jsxs)("p",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:"Environment Variables Not Added"}),(0,n.jsx)(ei.Tooltip,{content:(0,n.jsx)("ul",{children:a.map(e=>(0,n.jsx)("li",{className:"flex items-center space-x-1",children:(0,n.jsx)("span",{children:e})},e))}),children:(0,n.jsx)("span",{className:"text-gray-500",children:(0,n.jsx)(es.$,{})})})]})})},"info")]}),(null==d?void 0:d.isAdminMode)?(0,n.jsxs)("span",{className:"text-xs text-gray-500",children:[(0,n.jsx)("span",{className:"font-medium",children:"Internal:"}),(0,n.jsxs)("p",{children:["Is most recent message:"," ",h?(0,n.jsx)("span",{children:"True"}):(0,n.jsx)("span",{children:"False"}),(0,n.jsx)("br",{}),(0,n.jsxs)("span",{children:["Is next message added env vars:"," ",f?(0,n.jsx)("span",{children:"True"}):(0,n.jsx)("span",{children:"False"})]}),(0,n.jsx)("br",{}),(0,n.jsxs)("span",{children:[" State: ",M]}),(0,n.jsx)("br",{}),(0,n.jsxs)("span",{children:[" Message ID: ",r]})]})]}):null]})}):(0,n.jsx)(J.Zp,{className:"text-muted-foreground bg-muted w-full max-w-[360px] overflow-hidden shadow-sm","data-seg":"skip",children:(0,n.jsx)(J.Wu,{className:"my-0 p-2",children:(0,n.jsx)(eu.E,{className:"h-[130px] w-full"})})})}function eb(e){let{messageId:t,index:a,...r}=e,l=(0,s.useRef)(null),[i,o]=(0,ex.useAtom)(ef);return(0,s.useEffect)(()=>{!i.has(t)&&l.current&&0===a&&(l.current.focus(),o(e=>new Set(e).add(t)))},[t,a,i,o]),(0,n.jsx)(Q.p,{ref:l,...r})}var ey=a(35486),ew=a(49119),eN=a(57965),ek=a(5628),eC=a.n(ek);let eS={0:"hsl(var(--red-600))",50:"hsl(var(--amber-600))",90:"hsl(var(--green-600))"},eM={tiny:20,small:32,medium:64,large:128},eI={tiny:3,small:2,medium:1,large:1};function eA(e){let{colors:t=eS,value:a,placeholder:r,className:l,arcPriority:i="primary",style:o,size:c,deprecatedSize:d,children:u,showValue:m=!1,...h}=e,x=void 0!==d?d:eM[c],[f,g]=(0,s.useMemo)(()=>{if("primary"in t)return[t.primary,t.secondary];let e=Object.keys(t).map(Number);if(0===e.length)return[void 0,void 0];let n=e.filter(e=>a>=e).pop();return[void 0!==n?t[n]:void 0,void 0]},[t,a]),{circleProps:v,circumference:j,offsetFactor:b,segmentGap:y,primaryStrokePercent:w,secondaryStrokePercent:N}=(0,s.useMemo)(()=>{let e=x<=eM.tiny?15:10,t=2*Math.PI*(50-e/2),n=Math.round(100/t*e)+eI[c];(0===a||a>=100)&&(n=0);let s=.5*("equal"===i),r=a-2*n*s,l=100-a-2*n*(1-s)-Math.max(1-r,0);return{circleProps:{cx:50,cy:50,r:50-e/2,strokeWidth:e,strokeDashoffset:0,strokeLinecap:"round",strokeLinejoin:"round"},circumference:t,segmentGap:n,primaryStrokePercent:r,secondaryStrokePercent:l,offsetFactor:s}},[i,x,c,a]);return(0,n.jsxs)("div",{className:(0,p.$)(eC().circle,l,{[eC().animate]:!r}),"data-geist-progress-circle":"","data-version":"v1",style:{...o,"--circle-size":"".concat(100,"px"),"--circumference":j,"--percent-to-px":"".concat(j/100,"px"),"--gap-percent":y,"--offset-factor":b},...h,children:[(0,n.jsxs)("svg",{fill:"none",height:x,strokeWidth:"2",viewBox:"0 0 ".concat(100," ").concat(100),width:x,children:[(0,n.jsx)("circle",{style:{opacity:N<0||100===a?0:1,"--stroke-percent":N},...v,className:eC().arcSecondary,stroke:g||"hsl(var(--alpha-400))"}),(0,n.jsx)("circle",{...v,className:eC().arc,"data-geist-progress-circle-fg":"",stroke:f||"var(--geist-foreground)",style:{opacity:+(0!==a),"--stroke-percent":Math.min(100-y,w)}})]}),u||m?(0,n.jsx)("div",{className:eC().content,children:u||(0,n.jsx)("div",{className:"text-[11px] font-medium text-gray-500",children:a})}):null]})}let eD={firstContentfulPaint:[1.8,3],largestContentfulPaint:[2.5,4],totalBlockingTime:[200,600],cumulativeLayoutShift:[.1,.25]},eL=(e,t)=>{let a=parseFloat(e);return a<t[0]?"good":a<t[1]?"needsImprovement":"poor"};function ez(){return(0,n.jsxs)(J.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:[(0,n.jsx)(J.aR,{className:"flex p-3",children:(0,n.jsxs)(J.ZB,{className:"mx-0.5 flex flex-col gap-1 text-sm font-medium text-gray-800",children:[(0,n.jsx)("span",{children:"Lighthouse Report"}),(0,n.jsx)(eu.E,{className:"h-4 w-16"})]})}),(0,n.jsxs)(J.Wu,{className:"p-0",children:[(0,n.jsx)("div",{className:"grid grid-cols-1 gap-3 p-3 pt-0 sm:grid-cols-2",children:Array.from({length:4}).map((e,t)=>(0,n.jsxs)("div",{className:"bg-background-subtle flex items-center gap-3 rounded-[6px]  border p-2",children:[(0,n.jsx)(eA,{value:0,size:"small",children:(0,n.jsx)(eN.M,{className:"font-bold text-[hsl(var(--gray-500))]",size:18})}),(0,n.jsx)(eu.E,{className:"h-4 w-16"})]},t))}),(0,n.jsxs)("div",{className:"flex flex-col border-t border-gray-200 p-3 text-gray-500",children:[(0,n.jsx)(eT,{label:"First Contentful Paint",isLoading:!0,hasMutedBackground:!0}),(0,n.jsx)(eT,{label:"Largest Contentful Paint",isLoading:!0}),(0,n.jsx)(eT,{label:"Total Blocking Time",isLoading:!0,hasMutedBackground:!0}),(0,n.jsx)(eT,{label:"Cumulative Layout Shift",isLoading:!0})]})]})]})}function eE(e){let{data:t,href:a}=e;if(!t)return(0,n.jsx)(J.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:(0,n.jsx)(J.Wu,{className:"p-3",children:(0,n.jsxs)("div",{className:"bg-muted flex flex-col items-center justify-center rounded-[6px] p-8",children:[(0,n.jsx)("div",{className:"mb-4 rounded-full border border-red-200 bg-red-50 p-2 text-red-600",children:(0,n.jsx)(o.$,{})}),(0,n.jsx)("h3",{className:"mb-2 font-medium text-gray-900",children:"Lighthouse Report Failed"}),(0,n.jsx)("p",{className:"max-w-96 text-center text-gray-500",children:"Something went wrong while analyzing the performance of the website. Please try again later."})]})})});let{categories:s,firstContentfulPaint:r,largestContentfulPaint:l,totalBlockingTime:i,cumulativeLayoutShift:c}=JSON.parse(decodeURIComponent(t));return(0,n.jsxs)(J.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:[(0,n.jsx)(J.aR,{className:"flex p-3",children:(0,n.jsxs)(J.ZB,{className:"mx-0.5 flex flex-col gap-1 text-sm font-medium text-gray-800",children:[(0,n.jsx)("span",{children:"Lighthouse Report"}),(0,n.jsxs)("a",{href:a,className:"flex items-center font-normal hover:opacity-70",children:[a,(0,n.jsx)(ew.m,{})]})]})}),(0,n.jsxs)(J.Wu,{className:"p-0",children:[(0,n.jsx)("div",{className:"grid grid-cols-1 gap-3 p-3 pt-0 sm:grid-cols-2",children:Object.entries(s).map(e=>{let[t,a]=e;return(0,n.jsxs)("div",{className:"bg-background-subtle flex items-center gap-3 rounded-[6px]  border p-2",children:[(0,n.jsx)(eA,{value:100*a.score,size:"small",placeholder:!1,showValue:!0}),(0,n.jsx)("div",{className:"flex flex-col",children:(0,n.jsx)("p",{className:"text-[14px] font-medium leading-[20px]",children:a.title})})]},t)})}),(0,n.jsxs)("div",{className:"flex flex-col border-t border-gray-200 p-3",children:[(0,n.jsx)(eT,{label:"First Contentful Paint",value:r.displayValue,thresholds:eD.firstContentfulPaint,hasMutedBackground:!0}),(0,n.jsx)(eT,{label:"Largest Contentful Paint",value:l.displayValue,thresholds:eD.largestContentfulPaint}),(0,n.jsx)(eT,{label:"Total Blocking Time",value:i.displayValue,thresholds:eD.totalBlockingTime,hasMutedBackground:!0}),(0,n.jsx)(eT,{label:"Cumulative Layout Shift",value:c.displayValue,thresholds:eD.cumulativeLayoutShift})]})]})]})}let eP=e=>{let{value:t}=e;return(0,n.jsx)("div",{className:"flex h-4 w-4 flex-row rounded-full p-1 ".concat("good"===t?"bg-green-100":"needsImprovement"===t?"bg-amber-100":"poor"===t?"bg-red-100":"bg-gray-100"),children:(0,n.jsx)("div",{className:"h-2 w-2 rounded-full ".concat("good"===t?"bg-green-600":"needsImprovement"===t?"bg-amber-600":"poor"===t?"bg-red-600":"bg-gray-400")})})};function eT(e){let{label:t,value:a,thresholds:s,hasMutedBackground:r,isLoading:l=!1}=e;return(0,n.jsxs)("div",{className:"flex flex-row justify-between rounded-[6px] p-2 ".concat(r?"bg-muted":""),children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,n.jsx)(eP,{value:l?"skeleton":eL(a,s)}),(0,n.jsx)("div",{className:"text-[14px] font-medium leading-[20px]",children:t})]}),(0,n.jsx)("div",{className:"text-[14px] leading-[20px] text-gray-500",children:l?(0,n.jsx)(eu.E,{className:"h-4 w-10"}):a})]})}var eF=a(16330);function eR(e){let{children:t,isLoading:a,seconds:s}=e,r=void 0===s?void 0:Math.floor(s),l=(0,D.k)();return(0,n.jsx)(eF.p,{forceOpen:a,text:a?l("messages.thinking"):l("messages.thoughtFor")(r),isLoading:a,children:t})}var eU=a(80381),eV=a(67702),eB=a(10838),e_=a(37758),eO=a(51368),eH=a(73655),e$=a(62080),eq=a(81966),eW=a(40209),eG=a(19243),eZ=a(940),eY=a(16979),eK=a(16983),eJ=a(28824),eQ=a(40445),eX=a(68481),e0=a(27194),e1=a(40711);let e5={id:"manual",name:"Add environment variables?",description:"Manually add environment variables",icon:"/placeholder.svg",slug:"manual"};function e2(e){var t,a,l;let{messageId:i,category:o,namesProp:c,starter:d}=e,u=(0,s.useMemo)(()=>"string"==typeof c?[c]:c,[c]),m=(0,I.tZ)(),{chatId:h}=(0,el.xz)(),{isStreaming:p,activeForkKey:x}=(0,el.Pk)(),{activeScope:f}=(0,eH.k6)(),{refresh:g}=(0,e1.Z)(),v=(0,e$._)(),j=null==(t=m.project)?void 0:t.vercelProjectId,{vercelProjectWithDashboard:b}=(0,ee.Ok)(null==(a=m.project)?void 0:a.projectId),{stores:y}=(0,e0.B)(),{submit:w}=(0,et.yI)(),{expectUser:N}=(0,R.J)(),{setShowSignInDialog:k}=(0,eK.AO)(),[C,S]=(0,s.useState)({}),M=(e,t)=>{S(a=>({...a,[e]:t}))},A=null==u?void 0:u.filter(e=>e&&e_.ud.some(t=>t.toLowerCase()===e.toLowerCase())),D=A&&A.length>1,{connectedLinks:L,refetchLinks:z,isLoading:E}=(0,eW.d)({source:"add-integration",messageId:i},async e=>{var t;let a;if(M(e[0].integrationId,"none"),e.forEach(e=>{(0,eG.u)("AddIntegration",{integrationSlug:e.integrationName,chatId:e.chatId||"",source:e.source})}),!D){switch(null==(t=e[0])?void 0:t.integrationName){case"Supabase":case"Neon":a="add-sql-db";break;case"Upstash for Redis":a="add-nonsql-store";break;case"Grok":case"Groq":case"DeepInfra":case"fal":a="add-ai";break;default:a=void 0}d&&(a="add-starter-integration"),g(),await w({action:"new",attachments:[],input:"The integration".concat(e.length>1?"s":""," ").concat(eZ.Y.format(e.map(e=>e.integrationName))," ").concat(e.length>1?"have":"has"," been added to the [Vercel Project](").concat(null==b?void 0:b.project.url,")."),type:"added-integration",workflowState:a,revalidateVercelEnvAndIntegrations:!0})}}),{integrations:P,isLoading:T,error:F,refetch:U}=(0,eV.A)({integrationIds:e_.ud,isEnabled:!0}),{connections:V,stores:{data:{marketplaceStores:B,nativeStores:_},refetch:O},isLoading:H}=(0,eB.g)({vercelProjectId:null!=j?j:void 0,v0ProjectId:null==(l=m.project)?void 0:l.projectId,refreshInterval:0}),$=(0,s.useMemo)(()=>!j||H?[]:[...V.data.map(e=>e.slug),...B.map(e=>{var t;return null==(t=e.product)?void 0:t.slug}).filter(Boolean),..._.map(e=>e.type)],[V.data,B,H,j,_]),q=null==x?void 0:x.indexOf(i),W=void 0!==q&&q<x.length-1,G=(0,s.useMemo)(()=>T?[]:[...P.filter(e=>{let t=!(null==A?void 0:A.length)||A.some(t=>t&&e_.fY[t.toLowerCase()]===e.name),a=!o||!e_.k$[e.name]||e_.k$[e.name].includes(o.toLowerCase());return t&&a}),e5],[T,P,A,o]),Z=(0,s.useMemo)(()=>T||!L?[]:P.filter(e=>L.some(t=>t.connected&&t.integrationId===e.id)),[P,L,T]),Y=T||E||void 0===L,K=(0,s.useMemo)(()=>Y?[]:Z.length>0?Z:G,[Z,G,Y]),Q=async(e,t,a,n)=>{(0,eG.u)("ClickAddIntegration",{integration:e}),M(e.slug,"linking_integration");try{if("blob"===e.slug){let t=await fetch("/chat/api/integrations/marketplace/storage/create-blob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(a.name,"-blob"),projectId:a.id})});if(!t.ok){var s;let a=await t.json();throw M(e.slug,"none"),Error(null!=(s=a.error)?s:"Failed to create blob store")}O(),g(),em.o.success("Blob storage connected successfully"),await w({action:"new",attachments:[],input:"A blob store has been added to the [Vercel Project](".concat(null==b?void 0:b.project.url,")."),type:"added-integration",workflowState:"add-nonsql-store",revalidateVercelEnvAndIntegrations:!0}),(0,eG.u)("AddIntegration",{integrationSlug:e.slug,chatId:h||"",source:"add-integration"});return}let r=e_.Dk.some(t=>t.has(e.slug)&&$.find(e=>t.has(e))),l=await (0,eO.P)({integration:e,chatId:h||"",v0ProjectId:t||"",teamSlug:(0,eQ.W)(f)?v||"":(null==f?void 0:f.slug)||"",dashboardProject:a,source:"add-integration",messageId:i,needPrefix:r});await z(),n?n.location.href=l:window.open(l,"_blank")}catch(e){em.o.error(e instanceof Error?e.message:"Failed to add integration")}},X=!c||o?"supabase":c.length>0&&Array.isArray(c)&&c[0]in e_.fY&&e_.fY[c[0]]in e_.eV?e_.fY[c[0]]:"supabase";if(!N)return(0,n.jsx)(J.Zp,{className:"max-w-[500px]","data-seg":"skip",children:(0,n.jsx)(J.Wu,{className:"p-4",children:(0,n.jsx)("div",{className:"@container/add-integration space-y-4",children:(0,n.jsxs)("div",{className:"@[300px]/add-integration:flex-row @[300px]/add-integration:items-center @[300px]/add-integration:justify-between @[300px]/add-integration:space-y-0 flex flex-col space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md border",children:X?(0,n.jsx)(eU.default,{src:e_.eV[X]||"/placeholder.svg",alt:X,width:16,height:16}):(0,n.jsx)(eX.g,{className:"h-full min-w-[25px] -translate-x-px"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,n.jsx)("p",{className:"m-0 text-sm font-medium ",children:"Log in"}),(0,n.jsx)("p",{className:"m-0 text-xs text-gray-500",children:"You must be logged in to connect an integration."})]})]}),(0,n.jsx)(r.$,{size:"sm",variant:"secondary",onClick:()=>k({prompt:!1}),children:"Login"})]})})})});let ea=(null==c?void 0:c.length)===2;return F||Y?(0,n.jsx)(J.Zp,{className:"max-w-[450px]","data-seg":"skip",children:(0,n.jsxs)(J.Wu,{className:"p-4",children:[(0,n.jsx)("div",{className:"@container/add-integration space-y-4",children:Array.from({length:Y?(null==c?void 0:c.length)?c.length+1:o?Object.entries(e_.k$).filter(e=>{let[t,a]=e;return a.toLowerCase()===o.toLowerCase()}).length+1:2:1}).map((e,t,a)=>(0,n.jsxs)(s.Fragment,{children:[(0,n.jsxs)("div",{className:"@[300px]/add-integration:flex-row @[300px]/add-integration:items-center @[300px]/add-integration:justify-between @[300px]/add-integration:space-y-0 flex flex-col space-y-3",children:[(0,n.jsx)("div",{className:"flex items-center gap-3",children:F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md border",children:(0,n.jsx)(eY.V,{className:"size-4 !text-red-700"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,n.jsx)("p",{className:"m-0 text-sm font-medium ",children:"Error"}),(0,n.jsx)("p",{className:"m-0 text-xs text-gray-500",children:"Failed to fetch integration options."})]})]}):t===a.length-1?(0,n.jsx)(eu.E,{className:"h-3.5 w-32"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eu.E,{className:"size-8 rounded-md"}),(0,n.jsxs)("div",{className:"my-[3px]",children:[(0,n.jsx)(eu.E,{className:"mb-1.5 h-3.5 w-24"}),(0,n.jsx)(eu.E,{className:"h-2.5 w-32"})]})]})}),F?(0,n.jsx)(r.$,{size:"sm",variant:"secondary",onClick:()=>U(),children:"Retry"}):t===a.length-1?(0,n.jsx)(eu.E,{className:"@[300px]/add-integration:w-8 h-8 rounded-md"}):(0,n.jsx)(eu.E,{className:"@[300px]/add-integration:w-20 h-8 rounded-md"})]},t),t<a.length-1&&(0,n.jsx)(eq.Separator,{className:"my-2"})]},t))}),ea&&(0,n.jsx)(eu.E,{className:"mt-4 h-8 w-full"})]})}):(0,n.jsx)(J.Zp,{className:"max-w-[450px] shadow-sm","data-seg":"skip",children:(0,n.jsx)(J.Wu,{className:"p-4",children:(0,n.jsxs)("div",{className:"@container/add-integration space-y-4",children:[K.map((e,t)=>{var a,l;let i=$.includes(e.slug)||(null==L?void 0:L.some(t=>t.integrationId===e.id));return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsxs)("div",{className:"@[300px]/add-integration:flex-row @[300px]/add-integration:items-center @[300px]/add-integration:justify-between @[300px]/add-integration:space-y-0 flex flex-col space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:["manual"!==e.slug?(0,n.jsx)("div",{className:"flex h-8 w-8 items-center justify-center overflow-hidden rounded-md",children:(0,n.jsx)(eU.default,{src:e.icon||"placeholder.svg",alt:"".concat(e.name," logo"),width:32,height:32})}):null,(0,n.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,n.jsx)("p",{className:"m-0 text-sm ".concat("manual"===e.slug?"text-muted-foreground":"font-medium"),children:e.name}),"manual"!==e.slug?(0,n.jsx)("p",{className:"m-0 text-xs text-gray-500",children:i&&((null==(a=B.find(t=>t.product.slug===e.slug))?void 0:a.name)||(null==(l=_.find(t=>t.type===e.slug))?void 0:l.name))||e.description}):null]})]}),i?(0,n.jsx)(r.$,{size:"sm",disabled:!0,variant:"secondary",children:"Connected"}):(0,n.jsx)(eJ.V,{allTeamStores:y,integration:e,onConnect:Q,status:C[e.slug],vercelProjectId:null!=j?j:void 0,onStatusChange:M,source:"add-integration",starter:d,disabled:p||W,sendFollowUp:!D})]}),t<K.length-1&&(0,n.jsx)(eq.Separator,{className:"my-2"})]},e.id)}),D&&(0,n.jsx)(r.$,{size:"sm",className:"w-full",disabled:W,onClick:()=>{let e=[...V.data.map(e=>e.name),...B.map(e=>e.product.name),..._.map(e=>e.integrationName)].filter(e=>e in e_.r2);w({action:"new",attachments:[],input:0===e.length?"No integrations were added.":"The integration".concat(e.length>1?"s":""," ").concat(eZ.Y.format(e)," ").concat(e.length>1?"have":"has"," been added to the Vercel Project."),type:"added-integration",revalidateVercelEnvAndIntegrations:!0})},children:"Continue"})]})})})}function e3(e){let{options:t}=e,{submit:a}=(0,et.yI)(),s=async e=>{await a({action:"new",attachments:[],input:e})};return(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsx)("p",{className:"my-0 pl-0.5 text-sm text-gray-500",children:"Next Steps"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-3",children:t.map((e,t)=>(0,n.jsx)(e6,{onClick:()=>s(e.prompt),children:e.title},t))})]})}function e6(e){let{onClick:t,children:a,...s}=e;return(0,n.jsxs)(r.$,{size:"xs",variant:"outline",className:"bg-muted dark:bg-subtle hover:bg-alpha-200 h-7 gap-1 rounded-full border-none !pl-3 !pr-2 text-sm font-normal shadow-sm",onClick:t,...s,children:[a,(0,n.jsx)(ew.m,{height:16,width:16,color:"currentColor",className:"!text-gray-600"})]})}var e7=a(86943);function e9(e){var t,a;let{integration:s}=e,l=(0,I.tZ)(),i=null==(t=l.project)?void 0:t.vercelProjectId,{stores:o,isLoading:c,error:d}=(0,eB.g)({vercelProjectId:null!=i?i:void 0,v0ProjectId:null==(a=l.project)?void 0:a.projectId,refreshInterval:0}),u=o.data.marketplaceStores.find(e=>e.product.slug===s);if(c||!u||d)return(0,n.jsx)(J.Zp,{className:"h-10 w-44",children:(0,n.jsxs)(J.Wu,{className:"flex  h-full items-center gap-2 px-4 py-0 pl-3",children:[(0,n.jsx)(eu.E,{className:"h-5 w-5 rounded-md"}),c?(0,n.jsx)(eu.E,{className:"h-5 w-24"}):(0,n.jsx)("div",{className:"text-red-700",children:"No data found"})]})});let m="https://vercel.com/api/www/avatar/".concat(u.product.iconUrl),h="https://vercel.com/api/marketplace/sso?integrationConfigurationId=".concat(u.product.integrationConfigurationId,"&teamId=").concat(u.ownerId);return(0,n.jsx)("a",{href:h,target:"_blank",children:(0,n.jsxs)(r.$,{className:"gap-2 pl-3",variant:"outline",children:[(0,n.jsx)("div",{className:"flex h-5 w-5 items-center justify-center overflow-hidden rounded-md",children:(0,n.jsx)(eU.default,{src:m,alt:"".concat(u.product.name," logo"),width:20,height:20})}),"Open ",u.product.name]})})}var e4=a(5052),e8=a(56496),te=a(56508),tt=a(18858),ta=a(13443),tn=a(95251);let ts=!1;var tr=a(15894),tl=a(34034),ti=a(37707),to=a(25887),tc=a(19434),td=a(53663);function tu(e){let{elementProps:t,children:a,isLast:r,messageId:l}=e,[i,o]=(0,tr.l)(),{canWriteToChat:c}=(0,I.tZ)(),d=function(){let[e,t]=(0,s.useState)(ts);return(0,s.useEffect)(()=>{ts=!0,t(!0)},[]),e}(),[u]=(0,tl.YI)(),{dm:m}=(0,ti.D)();return((0,s.useEffect)(()=>{o(!0)},[l]),(!u||!m)&&r&&c&&d)?(0,n.jsx)(e8.Z,{container:document.getElementById("prompt-actions"),asChild:!0,children:(0,n.jsx)(_.N,{initial:!1,mode:"wait",children:i&&(0,n.jsx)(th,{elementProps:t,closeHandler:()=>o(!1),children:a})})}):null}function tm(e){let{name:t,description:a,elementProps:r,messageId:l}=e,[i]=(0,tt.d)(),o=!!((null==i?void 0:i.remaining)!==void 0&&i.remaining<=0),{setShowSignInDialog:c}=(0,eK.AO)(),{submit:d}=(0,et.yI)(),u=(0,s.useCallback)(()=>{c({prompt:a})},[a,c]),m=!!(0,s.useMemo)(()=>(0,ta.C)(),[]),h=(0,s.useCallback)(()=>m?void u():o?void(0,to.D)({type:"upgradePlan"}):void(d({action:"new",input:a}),(0,eG.u)("ClickSuggestedAction",{actionName:t,actionDescription:a,messageId:l})),[m,o,d,a,t,l,u]);return(0,n.jsx)(e6,{...r,onClick:h,children:t})}function th(e){let{elementProps:t,children:a,closeHandler:s}=e,{containerRef:l,showLeftBorder:i,showRightBorder:o,leftRef:c,rightRef:d}=(0,td.Y)("horizontal");return(0,n.jsxs)(K.P.div,{...t,"data-slot":"prompt-actions-container",className:"bg-background relative rounded-lg pb-2.5 pt-2 [&_[data-slot=integrations-connect-button]>div]:!w-full [&_[data-slot=integrations-connect-button]]:w-fit [&_button]:h-7 [&_button]:rounded-lg",initial:{opacity:0,y:32},animate:{opacity:1,y:0},exit:{opacity:0,y:32},transition:{duration:.25,ease:"easeInOut"},children:[(0,n.jsx)("div",{className:"from-background absolute -top-8 left-0 right-2 z-10 h-8 bg-gradient-to-t to-transparent"}),(0,n.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,n.jsx)("h3",{className:"w-fit self-start py-1 text-xs text-gray-500",children:"Suggestions"}),(0,n.jsxs)(r.$,{"aria-label":"Close banner",className:"aspect-square h-5 px-0 text-gray-500 has-[>svg]:px-0",onClick:s,variant:"ghost",children:[(0,n.jsx)(tn.a,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close suggestions"})]})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:(0,tc.cn)("from-background absolute left-0 right-0 z-10 h-full bg-gradient-to-r to-10% to-transparent pointer-events-none transition-opacity",i?"opacity-100":"opacity-0")}),(0,n.jsx)("div",{className:(0,tc.cn)("from-background absolute left-0 right-0 z-10 h-full bg-gradient-to-l to-10% to-transparent pointer-events-none transition-opacity",o?"opacity-100":"opacity-0")}),(0,n.jsxs)(e4.F,{ref:l,children:[(0,n.jsxs)("div",{className:"relative flex w-fit gap-2 py-1.5 pr-1",children:[(0,n.jsx)("div",{ref:c,className:"absolute left-0 inset-y-0 w-1.5"}),(0,n.jsx)(te.C,{text:"Add Integration"}),a,(0,n.jsx)("div",{ref:d,className:"absolute right-0 inset-y-0 w-1.5"})]}),(0,n.jsx)(e4.$,{orientation:"horizontal",className:"sr-only"})]})]})]})}var tp=a(68547),tx=a(66152),tf=a(36323),tg=a(60574),tv=a(15154),tj=a(35853),tb=a(61872),ty=a(20717),tw=a(25603);function tN(e){let{className:t,...a}=e;return(0,n.jsxs)("svg",{className:(0,l.cn)("h-5 w-5 shrink-0",t),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"none",...a,children:[(0,n.jsx)("g",{clipPath:"url(#clip0_8291_77575)",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10ZM14.4129 8.16291L15.0758 7.5L13.75 6.17417L13.0871 6.83709L8.125 11.7992L6.91291 10.5871L6.25 9.92418L4.92417 11.25L5.58709 11.9129L7.46209 13.7879C7.8282 14.154 8.4218 14.154 8.78791 13.7879L14.4129 8.16291Z",fill:"#15803D"})}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_8291_77575",children:(0,n.jsx)("rect",{width:"20",height:"20",fill:"white"})})})]})}function tk(e){let{className:t,...a}=e;return(0,n.jsx)("svg",{className:(0,l.cn)("h-5 w-5 shrink-0",t),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"none",...a,children:(0,n.jsx)("circle",{cx:"10",cy:"10",r:"9.25",stroke:"#71717A",strokeWidth:"1.5",strokeDasharray:"3.75 3.75"})})}var tC=a(5759),tS=a(38509);let tM=e=>{var t;let{steps:a,messageId:s}=e,{messages:r}=(0,el.Pk)(),l=r.find(e=>e.id===s),i=tW(null!=(t=null==l?void 0:l.content)?t:"",s).filter(e=>{var t;return!e7.kX.includes(null!=(t=e.meta.type)?t:"")}),o=i.length>0?i[i.length-1]:null;return o?(0,n.jsx)(tI,{steps:a,messageId:s,currentBlock:o}):null},tI=e=>{var t,a,r,l;let{steps:i,messageId:o,currentBlock:c}=e,{stores:d}=(0,e0.B)(),{isStreaming:u}=(0,el.Pk)(),{refresh:m}=(0,e1.Z)(),h=(0,I.tZ)(),p=(0,tf.oQ)(),{chatId:x}=(0,el.xz)(),{activeScope:f}=(0,eH.k6)(),g=(0,e$._)(),[v,j]=(0,s.useState)(null),{data:b,isLoading:y}=function(e){let t=e.join(","),{data:a,isLoading:n,error:s}=(0,tw.Ay)(e.length>0?["integrations:completed-executions",t]:null,async()=>{let e=await fetch("/chat/api/integrations/completed-executions?identifiers=".concat(t)),{results:a}=await e.json();return a});return{data:a,isLoading:n,error:s}}((0,s.useMemo)(()=>i.filter(e=>"run-script"===e.type).map(e=>"".concat(c.id,":").concat(e.stepName)),[i,c.id])),{project:w}=(0,I.tZ)(),{envVars:N,isLoading:k}=(0,ee.Ok)(null!=(r=null==w?void 0:w.projectId)?r:void 0),{setActiveTab:C,activeTab:S}=(0,tx.P5)({blockId:c.id,isPreviewable:!1}),{appendCodeOutputEvents:M,expandConsole:A}=(0,ty.t)(c.id),{setActiveFilePath:D}=(0,tp.m)({blockId:c.id}),{saveLastOpenedBlock:L}=(0,tg.e)(),z=null==(t=h.project)?void 0:t.vercelProjectId,{integrations:E}=(0,eV.A)({integrationIds:e_.ud,isEnabled:!0}),{connections:P,stores:{data:{marketplaceStores:T,nativeStores:F},refetch:R},isLoading:U}=(0,eB.g)({vercelProjectId:null!=z?z:void 0,v0ProjectId:null==(a=h.project)?void 0:a.projectId,refreshInterval:0}),V=(0,s.useMemo)(()=>!z||U?[]:[...P.data.map(e=>e.name),...T.map(e=>e.product.name),...F.map(e=>e.integrationName)],[P.data,T,U,z,F]),B=(0,s.useMemo)(()=>!!N&&(0,tC.$)(Object.keys(N)).length>0,[N]),{clearTimeout:_}=(0,tS.cP)(null!=(l=null==w?void 0:w.projectId)?l:""),{refetchLinks:O}=(0,eW.d)({source:"add-integration",messageId:o},async e=>{let t=i.findIndex(t=>"add-integration"===t.type&&t.stepName===e[0].integrationName);-1!==t&&q(t,"connected_integration"),_(e[0].integrationName),e.forEach(e=>{(0,eG.u)("AddIntegration",{integrationSlug:e.integrationName,chatId:e.chatId||"",source:e.source})}),m()}),[H,$]=(0,s.useState)({}),q=(e,t)=>{$(a=>({...a,[e]:t}))};(0,s.useEffect)(()=>{i.forEach((e,t)=>{switch(e.type){case"add-integration":V.includes(e.stepName)&&q(t,"connected_integration");break;case"add-env-var":(null==N?void 0:N[e.stepName])&&q(t,"added_env_vars");break;case"run-script":(null==b?void 0:b["".concat(c.id,":").concat(e.stepName)])&&q(t,"applied_script")}})},[i,V,N,b,c.id]),(0,s.useEffect)(()=>{if(!y&&!k&&!U){let e=new Set(["connected_integration","added_env_vars","applied_script"]),t=i.findIndex(t=>!e.has(H[i.indexOf(t)]));-1!==t&&j(t)}},[y,k,U,i,H]);let W=async(e,t,a,n,s)=>{if(void 0===s)throw Error("Index is required within steps");(0,eG.u)("ClickAddIntegration",{integration:e}),q(s,"linking_integration");try{if("blob"===e.slug){let t=await fetch("/chat/api/integrations/marketplace/storage/create-blob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(a.name,"-blob"),projectId:a.id})});if(!t.ok){var r;let e=await t.json();throw q(s,"none"),Error(null!=(r=e.error)?r:"Failed to create blob store")}R(),m(),em.o.success("Blob storage connected successfully"),(0,eG.u)("AddIntegration",{integrationSlug:e.slug,chatId:x||"",source:"add-integration"});return}let l=e_.Dk.some(t=>t.has(e.name)&&V.find(e=>t.has(e))),i=await (0,eO.P)({integration:e,chatId:x||"",v0ProjectId:t||"",teamSlug:(0,eQ.W)(f)?g||"":(null==f?void 0:f.slug)||"",dashboardProject:a,source:"add-integration",messageId:o,needPrefix:l});await O(),n?n.location.href=i:window.open(i,"_blank")}catch(e){em.o.error(e instanceof Error?e.message:"Failed to add integration")}},G=async e=>{p(!0,c),L(c.id),await D(e),C("code")},Z=async e=>{if(!v)return;let t=null==w?void 0:w.projectId;try{if(!t){q(v,"creating_project");let e=await (0,eh.g)({projectName:h.title,chatId:x||"",onSuccess:()=>{},includeSuccessToast:!1});if(!e.id)return em.o.error("Failed to create project. ".concat(e.errors?Object.values(e.errors).flat().join(", "):"Please add this chat to a project")),q(v,"none"),null;await h.setMetadata({...h,project:{projectId:e.id,vercelProjectId:e.vercelProjectId||null,name:h.title,settings:{icon:"icon-wand-sparkles",color:null},isCreator:!0}}),t=e.id}if(q(v,"applying_script"),await G(e),"code-project"!==c.meta.type)throw Error("SQL execution is only supported for code blocks");let a=(0,tb.A2)({source:c.source,blockType:"code-project",blockId:c.id}).find(t=>t.meta.file===e);if(!a)throw Error("Script file not found");let n=V.filter(e=>e_.uk.includes(e))[0],s=c.id+":"+e,r=await (0,tv.W)({props:{language:a.lang,source:a.source,meta:{file:e,transaction:a.meta.transaction},closed:!0,originalCode:a.source,isPreviewable:!0},sqlExecProvider:n,v0ProjectId:t,operationId:s});if("error"in r)M([{type:"output",blockId:c.id,fileName:e,content:r.error,timestamp:new Date().toISOString(),method:"stderr"}],S),em.o.error("Error",{description:r.error}),q(v,"none");else{let t=await (0,tj.e)(r,c.id,e);M(t,S),q(v,"applied_script")}null==A||A()}catch(e){em.o.error("Error applying script",{description:e instanceof Error?e.message:"Unknown error"}),q(v,"none")}},Y=(e,t)=>{switch(e.type){case"add-integration":let a=E.find(t=>t.name===e.stepName);return{stepTitle:"Install ".concat(e.stepName),stepActions:a?(0,n.jsx)(eJ.V,{allTeamStores:d,integration:a,onConnect:W,status:H[t],vercelProjectId:null!=z?z:void 0,onStatusChange:q,source:"steps-card",starter:!1,disabled:u,sendFollowUp:!1,stepIndex:t}):(0,n.jsx)(eu.E,{className:"h-8 w-20 rounded-md"})};case"run-script":let s=e.stepName.substring(e.stepName.lastIndexOf("/")+1),r="Apply",l=!1,i=!1;switch(H[t]){case"creating_project":r="Creating project",l=!0,i=!0;break;case"applying_script":r="Applying",l=!0,i=!0;break;case"applied_script":r="Applied",i=!0;break;default:r="Apply",l=!1,i=!1}return{stepTitle:"Run ".concat(null!=s?s:e.stepName),stepActions:y?(0,n.jsx)(eu.E,{className:"h-8 w-[77px]"}):(0,n.jsx)("div",{className:"flex flex-row gap-2",children:(0,n.jsx)(ei.Tooltip,{content:B?void 0:"No database connected",children:(0,n.jsx)(ep.x,{size:"sm",pending:l,disabled:i||!B,onClick:()=>Z(e.stepName),children:r})})})};case"add-env-var":return{stepTitle:"Add ".concat(e.stepName),stepActions:(0,n.jsx)(eJ.V,{allTeamStores:d,integration:e5,onConnect:W,status:H[t],vercelProjectId:null!=z?z:void 0,onStatusChange:q,source:"steps-card",starter:!1,disabled:u,sendFollowUp:!1,stepIndex:t,envVarKeys:[e.stepName]})}}},K=(e,t)=>{let a=H[t];if("add-integration"===e.type&&U||"run-script"===e.type&&y||"add-env-var"===e.type&&k)return(0,n.jsx)("div",{className:"h-5 w-5 animate-pulse rounded-full bg-gray-200"});if("added_env_vars"===a||"connected_integration"===a||"applied_script"===a)return(0,n.jsx)(tN,{});if("add-integration"===e.type){var s,r;let t=E.find(t=>t.name===e.stepName);return(0,n.jsx)("div",{className:"flex h-5 w-5 items-center justify-center overflow-hidden rounded-full",children:(0,n.jsx)(eU.default,{src:null!=(s=null==t?void 0:t.icon)?s:"/placeholder-icon.png",alt:null!=(r=null==t?void 0:t.name)?r:"Integration",width:20,height:20})})}return(0,n.jsx)(tk,{})};return(0,n.jsx)(J.Zp,{className:"max-w-[500px] border-[1px] border-gray-500 px-3 py-[10px] shadow-none ring-2 ring-gray-200",children:i.map((e,t)=>{let{stepTitle:a,stepActions:r}=Y(e,t);return(0,n.jsxs)(s.Fragment,{children:[" ",(0,n.jsxs)("div",{className:"flex h-8 cursor-pointer items-center gap-2 py-[2px]",onClick:()=>{j(t),"run-script"===e.type&&G(e.stepName)},children:[K(e,t),(0,n.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-2",children:[(0,n.jsx)("div",{className:"min-w-0 shrink overflow-hidden text-ellipsis text-nowrap text-sm font-medium hover:text-gray-900 ".concat(v===t?"text-gray-900":"text-gray-500"),children:a}),v===t&&r]})]}),t!==i.length-1&&(0,n.jsx)("div",{className:"h-4 w-full",children:(0,n.jsx)("div",{className:"ml-2 h-full w-px bg-gray-200"})})]},t)})})};var tA=a(44825),tD=a(95702),tL=a(69894),tz=a(35214);function tE(e){let{data:t,href:a,trace:s}=e;if(!t||!s)return(0,n.jsx)(J.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:(0,n.jsx)(J.Wu,{className:"p-3",children:(0,n.jsxs)("div",{className:"bg-muted flex flex-col items-center justify-center rounded-[6px] p-8",children:[(0,n.jsx)("div",{className:"mb-4 rounded-full border border-red-200 bg-red-50 p-2 text-red-600",children:(0,n.jsx)(o.$,{})}),(0,n.jsx)("h3",{className:"mb-2 font-medium text-gray-900",children:"Trace Analysis Failed"}),(0,n.jsx)("p",{className:"max-w-96 text-center text-red-500",children:"Something went wrong while analyzing the trace. Please try again later."})]})})});let r=JSON.parse(decodeURIComponent(t)),l=JSON.parse(decodeURIComponent(s));return(0,n.jsxs)(J.Zp,{className:"not-prose w-full max-w-3xl shadow-sm",children:[(0,n.jsx)(J.aR,{className:"flex p-3",children:(0,n.jsxs)(J.ZB,{className:"mx-0.5 flex flex-col gap-1 text-sm font-medium text-gray-800",children:[(0,n.jsx)("span",{children:"Trace Analysis"}),(0,n.jsxs)("a",{href:a,className:"flex items-center font-normal hover:opacity-70",children:[a,(0,n.jsx)(ew.m,{})]})]})}),(0,n.jsxs)(J.Wu,{className:"p-0",children:[(0,n.jsx)("div",{className:"relative !col-span-full border-y border-y-gray-300",children:(0,n.jsx)(tz.m4,{className:"absolute left-0 top-0 w-full",height:"50vh",scrollLock:!0,trace:l,highlightedSpans:r.map(e=>e.spanId)})}),(0,n.jsxs)("section",{className:"p-3",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:"Performance Impact"}),(0,n.jsx)("p",{className:"mb-6 text-sm text-gray-500",children:"The following spans are the most performance-impacting spans in the trace."}),(0,n.jsx)("ul",{className:"flex flex-col gap-2",children:r.map(e=>(0,n.jsxs)("li",{className:"flex flex-col gap-2",children:[(0,n.jsx)("b",{children:e.spanName}),(0,n.jsx)("span",{children:e.description})]},e.spanId))})]})]})]})}function tP(e){let{data:t,isLast:a}=e,s=JSON.parse(decodeURIComponent(t));return a?(0,n.jsx)(J.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:(0,n.jsx)(J.Wu,{className:"p-3",children:(0,n.jsx)("ul",{className:"bg-muted flex flex-col gap-2 rounded-[6px] p-4",children:s.map(e=>(0,n.jsxs)("li",{className:"flex items-center gap-2",children:["pending"===e.status?(0,n.jsx)(tD.A,{className:"size-4"}):null,"loading"===e.status?(0,n.jsx)(V.y,{size:16}):null,"loaded"===e.status?(0,n.jsx)(tL.A,{className:"size-4"}):null,(0,n.jsx)("span",{children:e.label})]},e.label))})})}):null}let tT=(0,f.default)(()=>Promise.all([a.e(42411),a.e(58072)]).then(a.t.bind(a,58072,23)).then(e=>e.InlineMath)),tF=(0,f.default)(()=>Promise.all([a.e(42411),a.e(58072)]).then(a.t.bind(a,58072,23)).then(e=>e.BlockMath)),tR=(0,f.default)(()=>Promise.all([a.e(91267),a.e(64774),a.e(88856)]).then(a.bind(a,88856)).then(e=>e.Mermaid),{loadableGenerated:{webpack:()=>[88856]}}),tU=(0,f.default)(()=>Promise.all([a.e(40831),a.e(5213),a.e(11544)]).then(a.bind(a,11544)).then(e=>e.Table),{loadableGenerated:{webpack:()=>[11544]}}),tV=String.fromCharCode(65535);function tB(e,t){if(void 0===e)return e;let a=e+"\0";for(;;)if(t>=65535)a+=tV,t-=65535;else{a+=String.fromCharCode(t+1);break}return a}let t_=s.memo(function(e){let t,{messageId:a,role:s,streaming:r,rows:l,isLastMessage:i=!1,v3:o=!1}=e,{authorId:c,from:d}=(0,I.tZ)(),{user:u}=(0,R.J)(),m=!1,h=[],p=l.map((e,t)=>{let[l,c]=e,u=tB("",t);return 0===l?(m=!0,(0,n.jsx)(tO.Provider,{value:o,children:(0,n.jsx)(t$,{data:c,id:u,messageId:a,streaming:r,chatOrigin:d,isLastMessage:i})},u)):(1===l&&"assistant"===s&&c.context&&Array.isArray(c.context)&&c.context.length>0&&(h=c.context),null)});if(!m)if(0===h.length)return null;else t=(0,n.jsx)(U.vg,{urls:h.map(e=>{let{url:t}=e;return t})});let x=(0,n.jsxs)(n.Fragment,{children:[t,p]});return"assistant"===s?(0,n.jsx)(P,{messageId:a,readonly:!!c&&(null==u?void 0:u.id)!==c,streaming:r,children:x}):x}),tO=s.createContext(!1),tH=()=>s.use(tO);function t$(e){let t,{data:a,id:s,messageId:r,streaming:l,chatOrigin:i,isLastMessage:o}=e,c=a.map((e,i)=>{let c=tB(s,i);return"string"!=typeof e&&"Codeblock"===e[0]&&e[1].blockId&&o&&void 0===t&&(t=e[1].blockId),(0,n.jsx)(tq,{data:e,id:c,isLast:i===a.length-1,index:i,messageId:r,streaming:l,isLastMessage:o},c)});return c}function tq(e){let{data:t,id:a,index:r,messageId:l,isLast:i,streaming:o,isLastMessage:c}=e,d=function(e){let{id:t,content:a,type:n,props:r}=e,{animate:l}=(0,s.use)(L),i=(0,s.useRef)(null),o=(0,s.useRef)(a),[c,d]=(0,s.useState)(!1),u=(0,s.useId)();(0,s.useEffect)(()=>(k.c.set(u,{type:n,props:r}),()=>{k.c.delete(u)}));let m={"data-seg":u};return((0,s.useEffect)(()=>{if(E){let e=i.current;if(!e)return;e.style.transition="",d(!0),"string"==typeof a&&(e.textContent=a);return}if(o.current=a,!l||void 0===t)return;let e=setTimeout(()=>{l(t,i,o,()=>d(!0))},20);return()=>clearTimeout(e)},[l,t,a]),l&&void 0!==t)?(m.style={opacity:+!!c,transition:"opacity .5s ease"},m.ref=i,"string"==typeof a&&(m.children="\xa0")):"string"==typeof a&&(m.children=a),{elementProps:m}}({id:a,content:"string"==typeof t?t:void 0,type:"string"==typeof t?"text":t[0],props:"string"==typeof t?{}:t[1]}),u="string"!=typeof t&&"Codeblock"===t[0]&&t[1].blockId?t[1].source:void 0;if("string"==typeof t)return t;let[m,p,...f]=t;if(void 0===m)return null;let v=(0,n.jsx)(t$,{data:f,id:a,messageId:l,isLastMessage:c});switch(m){case"text":return(0,n.jsx)("span",{...d.elementProps,children:v});case"span":case"p":case"blockquote":case"strong":case"em":case"del":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"ul":case"ol":case"li":return(0,n.jsx)(m,{...d.elementProps,...p,children:v});case"code":if(1===f.length&&"string"==typeof f[0]&&(0,ey.TN)(f[0]))return(0,n.jsx)(ey.br,{...d.elementProps,value:f[0]});return(0,n.jsx)("code",{...d.elementProps,className:"rounded-[0.375rem] border bg-gray-100 px-[0.25rem] py-[0.15rem] font-mono text-xs font-normal before:hidden after:hidden",...p,children:v});case"a":let y=p.href;if("string"==typeof y&&y.startsWith("/"))return(0,n.jsx)("span",{...d.elementProps,children:v});if("string"==typeof y&&y.startsWith("#"))return(0,n.jsx)("a",{...d.elementProps,className:"font-normal text-blue-600 no-underline decoration-from-font underline-offset-2 transition-colors hover:text-blue-600",href:y,children:v});return(0,n.jsxs)("a",{...d.elementProps,className:"font-normal text-blue-600 no-underline decoration-from-font underline-offset-2 transition-colors hover:text-blue-600",href:p.href||"#",rel:"noopener noreferrer",target:"_blank",children:[v,(0,n.jsx)(T.i,{className:"mb-0.5 ml-0.5 inline h-3 w-3"})]});case"img":return(0,n.jsx)("img",{...d.elementProps,...p,className:"rounded-xl"});case"hr":return(0,n.jsx)("hr",{...d.elementProps});case"table":return(0,n.jsx)("table",{...d.elementProps,className:"table-fixed",children:v});case"tr":return(0,n.jsx)("tr",{...d.elementProps,children:v});case"td":return(0,n.jsx)("td",{...d.elementProps,children:v});case"th":return(0,n.jsx)("th",{...d.elementProps,children:v});case"thead":return(0,n.jsx)("thead",{...d.elementProps,children:v});case"tbody":return(0,n.jsx)("tbody",{...d.elementProps,children:v});case"Codeblock":let w=u||f.join("");if(p.blockId&&p.meta.type&&!e7.kX.includes(p.meta.type))return(0,n.jsx)("div",{className:"block-preview flex flex-col gap-3 [&:not(:last-child)]:mb-4",...d.elementProps,children:(0,n.jsx)(b.Q,{blockId:p.blockId,closed:p.closed,language:p.lang,remoteInfo:p.remoteInfo,messageId:l,meta:p.meta,resultId:p.resultId,source:w,type:p.meta.type,latestDeploymentInfo:p.latestDeploymentInfo,isStreaming:o||!1},p.blockId)});if(!w)return(0,n.jsx)("div",{...d.elementProps});switch(p.lang){case"mermaid":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(s.Suspense,{fallback:null,children:(0,n.jsx)(tR,{source:w,title:p.meta.title})})});case"math":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(tF,{math:w})});case"csv":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(g,{title:"Loading table..."}),children:(0,n.jsx)(tU,{source:w})})});case"toolcall":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(Y,{source:w,streaming:o||!1})});default:return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(j,{language:p.lang,blockId:p.blockId,closed:p.closed,sqlExecutionState:p.meta.sqlExecutionState,transaction:p.meta.transaction,type:p.meta.type,fileName:p.meta.name,children:w})})}case"InlineMath":return(0,n.jsx)("span",{...d.elementProps,children:(0,n.jsx)(tT,{math:f.join("")})});case"Math":return(0,n.jsx)("span",{...d.elementProps,children:(0,n.jsx)(tF,{math:f.join("")})});case"LinearProcessFlow":case"Steps":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(x,{children:v})});case"Thinking":case"DevThinking":case"V0Info":return(0,n.jsx)(eR,{isLoading:void 0===p.closed&&!!o||!p.closed,seconds:p.chars?p.chars/170:void 0,children:(0,n.jsx)("div",{...d.elementProps,className:"[&>p:first-child]:mt-0 [&>p:last-child]:mb-0",children:v})});case"Solution":case"footnoteDefinition":return null;case"Quiz":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(h,{...p,children:v})});case"V0LoadingImage":return i?(0,n.jsx)(tA.Q,{}):null;case"Spinner":let N=null,C=p.message||"Generating...";return C.toLowerCase().includes("search")||C.toLowerCase().startsWith("added")?N=null:r>0&&(N=(0,n.jsx)(V.y,{})),i&&o?(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[N,(0,n.jsx)("span",{className:"animate-pulse",children:C})]})}):null;case"MathInstructions":case"MathBlock":return(0,n.jsx)("div",{...d.elementProps,children:v});case"footnoteReference":return(0,n.jsx)("span",{...d.elementProps,children:(0,n.jsx)(F.O,{idPrefix:"cite-".concat(l,"-"),label:p.label})});case"AddEnvironmentVariables":case"AddEnvironmentVariable":return(0,n.jsx)(ej,{names:p.names,messageId:l});case"AddIntegration":return(0,n.jsx)(e2,{category:p.category,namesProp:p.names,messageId:l,starter:p.starter});case"StepsCard":return(0,n.jsx)(tM,{steps:p.steps,messageId:l});case"OpenExternalDashboard":return(0,n.jsx)(e9,{integration:p.integration});case"SuggestedNextSteps":return c?(0,n.jsx)(e3,{options:p.options}):null;case"LoadingLighthouse":return i?(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(ez,{})}):null;case"Lighthouse":case"LighthouseReport":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(eE,{...p})});case"TraceAnalysis":case"TraceAnalysisReport":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(tE,{...p})});case"TraceAnalysisStatus":return(0,n.jsx)("div",{...d.elementProps,children:(0,n.jsx)(tP,{...p,isLast:i})});case"br":return(0,n.jsx)("br",{...d.elementProps});case"Action":return(0,n.jsx)(tm,{name:p.name,elementProps:d.elementProps,description:p.description,messageId:l});case"Actions":if(!c)return null;return(0,n.jsx)(tu,{elementProps:d.elementProps,isLast:i,messageId:l,children:v});default:return(0,n.jsxs)("div",{...d.elementProps,children:[(0,n.jsx)("h5",{children:"<".concat(m,">")}),v,(0,n.jsx)("h5",{children:"</".concat(m,">")})]})}}function tW(e,t){let a=[];if(!Array.isArray(e)||!e.length)return a;if(0===e[0][0])for(let n of e[0][1])!function e(t,a){if(Array.isArray(t)){let[n,s,...r]=t;"string"==typeof n&&a(t),r.map(t=>e(t,a))}}(n,e=>{let[n,s,...r]=e;if("Codeblock"===n&&s.meta.type){let e=r.join(""),n=s.blockId;n&&a.push({id:n,meta:s.meta,type:s.meta.type,messageId:t,source:s.source||e,language:s.lang,resultId:s.resultId,remoteInfo:s.remoteInfo,lastEditedAt:s.lastEditedAt,lastDeployedAt:s.lastDeployedAt,closed:void 0!==s.closed&&!!s.closed,createdAt:s.createdAt,latestDeploymentInfo:void 0,forkedFromBlockId:void 0,needsBlockSource:s.needsBlockSource||!1})}});return a}function tG(e){return e&&0===e[0]?"markdown":e&&1===e[0]?"metadata":void 0}function tZ(e){var t;let a,n,s,r,l,i,o,c=[],d="",u=null==(t=e.find(e=>"metadata"===tG(e)))?void 0:t[1];return u&&("context"in u&&void 0!==u.context&&Array.isArray(u.context)&&(c=u.context),"title"in u&&"string"==typeof u.title&&(d=u.title),"finishReason"in u&&(a=u.finishReason),"usage"in u&&(n=u.usage),"loadingText"in u&&"string"==typeof u.loadingText&&(o=u.loadingText),"relevantFiles"in u&&Array.isArray(u.relevantFiles)&&(r=u.relevantFiles),"grepQueries"in u&&Array.isArray(u.grepQueries)&&(l=u.grepQueries),"notifications"in u&&Array.isArray(u.notifications)&&(i=u.notifications),"modelId"in u&&(s=u.modelId)),{docsContext:c,loadingText:o,title:d,modelId:s,finishReason:a,relevantFiles:r,grepQueries:l,notifications:i,usage:n}}},77363:(e,t,a)=>{"use strict";a.d(t,{SettingsSection:()=>u});var n=a(97667),s=a(49848),r=a(91220),l=a(66692),i=a(28819),o=a(7086),c=a(86943),d=a(4868);function u(e){let{label:t,description:a,type:u,defaultValue:m,disabled:h=!1,value:p,placeholder:x,buttonLabel:f,onChange:g,onClick:v,options:j=[],className:b,children:y,innerClassName:w,name:N}=e;return(0,n.jsxs)("div",{className:(0,i.cn)("flex items-center gap-4 sm:gap-16",b),children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("label",{className:"text-sm font-medium leading-none",children:t}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:a})]}),(0,n.jsx)("div",{className:(0,i.cn)("w-32 justify-items-end md:w-48",w),children:y||("input"===u?(0,n.jsx)(s.p,{id:"string"==typeof t?t.replace(/\s/g,"-").toLowerCase():N,placeholder:x,value:"string"==typeof p?p:"",defaultValue:m,disabled:!0,name:N}):"select"===u?(0,n.jsxs)(r.l6,{defaultValue:m,value:"string"==typeof p?p:"",disabled:h,onValueChange:g,children:[(0,n.jsx)(r.bq,{className:"h-9",children:(0,n.jsx)(r.yv,{placeholder:x})}),(0,n.jsx)(r.gC,{children:j.map(e=>{let{value:t,label:a}=e;return(0,n.jsx)(r.eb,{value:t,children:a},t)})})]}):"textarea"===u?(0,n.jsx)(o.T,{className:"w-full",disabled:h,defaultValue:m,value:"string"==typeof p?p:"",onChange:e=>null==g?void 0:g(e.target.value),id:"string"==typeof t?t.replace(/\s/g,"-").toLowerCase():N,placeholder:x,minLength:0,maxLength:c._C,name:N}):"toggle"===u?(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(d.Switch,{disabled:h,checked:"boolean"==typeof p?p:"true"===p,onCheckedChange:g,"aria-label":"Toggle "+t})}):(0,n.jsx)("div",{className:"flex w-full justify-end",children:(0,n.jsx)(l.$,{size:"sm",variant:"secondary",onClick:v,disabled:h,children:f})}))})]})}},77635:(e,t,a)=>{"use strict";a.d(t,{S:()=>r});var n=a(16894),s=a(32136);function r(e){let{chatId:t,activeBlock:a}=e,{project:r,title:l,setMetadata:i}=(0,s.tZ)();return async()=>{if(!a||!t)return;let e=function(e,t){var a;let n="Fork of ",s=null!=(a=null==e?void 0:e.meta.title)?a:t;return s.startsWith(n)&&(s=s.slice(n.length)),s}(a,l);if(!(null==r?void 0:r.vercelProjectId)){let a=await (0,n.g)({existingProjectId:null==r?void 0:r.projectId,projectName:e,onSuccess:()=>{},chatId:t,includeSuccessToast:!1});if(a.id){var s,o;await i({project:{projectId:a.id,vercelProjectId:null!=(s=a.vercelProjectId)?s:null,name:null!=(o=a.name)?o:e,settings:{color:null,icon:"icon-wand-sparkles"},isCreator:!0,...r}})}}}}},78517:(e,t,a)=>{"use strict";a.d(t,{X:()=>S,a:()=>C});var n=a(97667),s=a(25603),r=a(19243),l=a(33571),i=a(74118),o=a(70676);let c=(0,o.createServerReference)("4095e20d8102b29128a7a76b54e9f4e04947826608",o.callServer,void 0,o.findSourceMapURL,"deleteMessage");var d=a(13729),u=a(50942),m=a(35441),h=a(69114),p=a(70158),x=a(28963),f=a(66692),g=a(97396),v=a(36323),j=a(12507),b=a(99066),y=a(27693),w=a(45586),N=a(28488),k=a(41956);function C(){let{data:e,mutate:t}=(0,s.Ay)("showDeleteMessageDialog",null,{fallbackData:null});return{showConfirmDelete:e,setConfirmDelete:t}}function S(){let{chatId:e,messages:t,activeForkKey:a,isStreaming:s,isLoading:o}=(0,i.Pk)(),S=(0,i.jo)(),M=(0,v.eu)(),{showConfirmDelete:I,setConfirmDelete:A}=C(),{setData:D,data:L}=(0,h.m)(),[z,E]=(0,l.useTransition)(),P=(0,v.oQ)(),{stopLlmResponse:T}=(0,b.yI)(),F=(0,p.useRouter)(),R=(0,k.al)(),U=(0,y.k)(),{history:V}=(0,w.P6)({blockId:null==M?void 0:M.id,searchAll:!0}),{scrollToHash:B}=(0,N.r)(),{setPulsePreview:_}=(0,w.f8)(),O=(0,l.useCallback)(e=>{let t=V.toReversed().find(t=>t.messageId===e[e.length-1]);t&&!t.isLoading&&(P(!0,t),_({blockId:t.id}),B(t.messageId,150,!0,e))},[V,B,P,_]),H=(0,l.useMemo)(()=>{let e=t.find(e=>"user"===e.role&&e.id===I);if(!e)return null;let a=(0,g.RA)(t).get(e.parentId||g.pe)||[],n=a.findIndex(t=>t&&t.some(t=>t===e.id)),s=a[n];return a.length>1?(0,g.C1)([...t],a[0===n?1:n-1]):e.parentId&&s?s.slice(0,-1):null},[t,I]),$=(0,l.useCallback)(()=>{I&&!z&&(A(null),(s||o)&&T(),E(async()=>{let n=L?[...L]:[],s=[...t],l=M?{...M}:null;if(!t.find(e=>"user"===e.role&&e.id===I))return void d.o.error("Message not found. Please try again.");try{if((0,r.u)("SubmitDeleteUserMessage",{messageId:I}),H){R||setTimeout(()=>{var e;null==(e=document.getElementById("chat-main-textarea"))||e.focus()},0);let a=new Set((0,g.Ir)(t.map(e=>({...e,messageId:e.id})),I)),n=t.filter(e=>!("user"===e.role&&e.id===I||a.has(e.id)));O(H),S({messages:n,activeForkKey:H,saveLeafMessageId:!0}),await c({payload:{messageId:I,chatId:e}}),d.o.success("Messages successfully deleted.")}else P(!1),D(t=>t.filter(t=>t.chatId!==e)),await (0,m._)({payload:{chatId:e}}),d.o.success("Messages successfully deleted."),F.push("/chat");A(void 0)}catch(t){let e=(0,j.z)(t);D(e=>n),S({messages:s,activeForkKey:a}),l&&P(!0,l),e||d.o.error("Something went wrong. Please try again.")}}))},[M,a,L,e,o,R,z,s,t,H,F,P,D,S,A,I,T,O]),q=null!==H?{TITLE:U("deleteMessageDialog.deleteMessageTitle"),DESCRIPTION:U("deleteMessageDialog.deleteMessageDescription")}:{TITLE:U("deleteMessageDialog.deleteChatTitle"),DESCRIPTION:U("deleteMessageDialog.deleteChatDescription")};return(0,n.jsxs)(x.Modal,{onOpenChange:e=>{e||A(null)},open:null!==I,children:[(0,n.jsxs)(x.ModalHeader,{children:[(0,n.jsx)(x.ModalTitle,{children:q.TITLE}),(0,n.jsx)(x.ModalDescription,{children:q.DESCRIPTION})]}),(0,n.jsxs)(x.ModalFooter,{children:[(0,n.jsx)(x.ModalClose,{asChild:!0,children:(0,n.jsx)(f.$,{size:"sm",variant:"secondary",children:U("deleteMessageDialog.cancel")})}),(0,n.jsx)(f.$,{"data-testid":"confirm-delete-message",disabled:z,onClick:$,size:"sm",variant:"destructive",children:z?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.X,{className:"size-4"}),U("deleteMessageDialog.deleting")]}):U("deleteMessageDialog.delete")})]})]})}},79463:(e,t,a)=>{"use strict";a.d(t,{y:()=>l});var n=a(74118),s=a(25603),r=a(33571);function l(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,s.Ay)(["block:createdAt",e]);return{getBlockCreatedAt:(0,r.useCallback)(e=>{var a;return null!=(a=null==t?void 0:t.get(e))?a:void 0},[t]),setBlockCreatedAt:(0,r.useCallback)((e,n)=>{a(new Map(null==t?void 0:t.set(e,n)))},[t,a])}}},79844:(e,t,a)=>{"use strict";a.d(t,{f:()=>r});var n=a(16720),s=a.n(n);let r=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return a-e.getTime()<1e3?"Just now":"".concat(s()(a-e.getTime(),{long:n})).concat(t?" ago":"")}},80155:(e,t,a)=>{"use strict";a.d(t,{ScopeSwitcher:()=>F});var n=a(97667),s=a(33571),r=a(39929),l=a(66692),i=a(28819),o=a(73655),c=a(23351),d=a(34825),u=a(93660),m=a(1731),h=a(2995),p=a(65744),x=a(56179),f=a(25887),g=a(40445),v=a(70119),j=a(1221),b=a(95393);function y(e){let{children:t}=e;return(0,n.jsx)(b.P.div,{exit:{opacity:0,transition:{duration:.1}},initial:{opacity:0,filter:"blur(1px)",scale:.9},animate:{opacity:1,scale:1,filter:"blur(0px)"},className:"text-gray-500",transition:{duration:.3},children:t})}function w(e,t){return(0,g.W)(e)||t&&(0,v.f)(e,t)}var N=a(74162),k=a(55274),C=a(17773),S=a(23423),M=a(70158),I=a(80574),A=a(19243);function D(e){let{onRequestAccess:t,onUpgradeTeam:a,user:l,scope:o,onSelect:c,isCurrentlyActive:d,className:u,suspense:h}=e,[p,x]=(0,s.useTransition)(),f=(0,M.useRouter)(),g=(0,j.sJ)(o),v=g&&(0,j.s0)(o),{scopeMembershipRole:b,isLoading:D,hasV0Seat:L,accessRequested:z,scopeSlug:E,scopePlan:P}=(0,N.f)({scope:o,user:l,suspense:h}),T=e=>"".concat(o.id,"-").concat(e),F=(0,s.useMemo)(()=>d?"check":g?"locked":p?"loading":null,[d,g,p]),R=(0,s.useCallback)(e=>(e.preventDefault(),g)?v?void(0,j.v2)({push:f.push}):void(0,j.qm)({slug:E,push:f.push}):L?void x(()=>c(o)):void("OWNER"===b?((0,A.u)("OpenTeamUpgradeModal",{teamId:o.id}),a(o)):z||((0,A.u)("OpenRequestAccessModal",{teamId:o.id}),t(o))),[g,v,L,b,z,E,f.push,c,o,a,t]),U=w(o,l);return!D||U||g||"OWNER"===b?l&&(g||P||U||"OWNER"===b)?(0,n.jsx)("div",{"data-loading":p,className:(0,i.cn)("relative flex h-[44px] cursor-pointer items-center justify-between transition-opacity duration-150",u),children:(0,n.jsx)(r.DropdownMenuItem,{className:(0,i.cn)("bg-background-subtle h-[44px] cursor-pointer"),disabled:z,onSelect:R,children:(0,n.jsx)(m.X,{scope:o,user:l,children:(0,n.jsxs)(k.N,{mode:"wait",children:["locked"===F?(0,n.jsx)(y,{children:(0,n.jsx)(S.C,{})},T("locked")):null,"check"===F?(0,n.jsx)(y,{children:(0,n.jsx)(C.J,{})},T("check")):null,"loading"===F?(0,n.jsx)(y,{children:(0,n.jsx)(I.y,{size:16})},T("loading")):null]})})})}):null:(0,n.jsx)(m.G,{variant:"list-item"})}var L=a(12029),z=a(71543),E=a(37707),P=a(73641),T=a(25951);function F(e){let{className:t,variant:a}=e,{scopes:c,activeScope:d,setActiveScope:v,isActiveScopeReady:b,user:y}=(0,o.k6)(),{expectUser:N}=(0,z.J)(),[k]=(0,p.Q3)(d,300),C=(0,s.useMemo)(()=>c?(0,x.n)(c,(e,t)=>(e.id===(null==k?void 0:k.id)?-1:0)-(t.id===(null==k?void 0:k.id)?-1:0)):[],[c,null==k?void 0:k.id]),S=(0,P.x)(),{projectId:M}=(0,T.M9)(),I=(0,s.useRef)(null),[A,L]=(0,s.useState)(!1),E=(0,s.useCallback)(e=>!!b&&e===(null==k?void 0:k.id),[null==k?void 0:k.id,b]),F=(0,s.useCallback)(e=>{L(!1),(0,f.D)({type:"requestAccess",data:{slug:e.slug,name:e.name||e.slug}})},[]),U=(0,s.useCallback)(async e=>{await v(e,{currentChatId:S,currentProjectId:M}),L(!1)},[S,M,v]),V=(0,s.useCallback)(e=>{L(!1),(0,f.D)({type:"upgradeTeam",data:{id:e.id,name:e.name||e.slug,slug:e.slug}})},[]),B=(0,s.useCallback)(()=>{L(!1),(0,f.D)({type:"upgradePlan"})},[]),_=(0,s.useMemo)(()=>C.filter(e=>w(e,y)),[C,y]),O=(0,s.useMemo)(()=>{var e,t;let a=C.filter(e=>!w(e,y));return e=a,t=a=(0,x.n)(e,(e,t)=>{var a,n,s;return null!=(s=null==(a=e.name)?void 0:a.localeCompare(null!=(n=t.name)?n:""))?s:0}),a=(0,x.n)(t,(e,t)=>{let a=(0,j.sJ)(e),n=(0,g.W)(e)?"OWNER":e.membership.role,s=(0,j.sJ)(t),r=(0,g.W)(t)?"OWNER":t.membership.role;return(a||"OWNER"===n?-1:0)-(s||"OWNER"===r?-1:0)})},[C,y]),H=(0,s.useMemo)(()=>(0,n.jsx)(u.E,{className:(0,i.cn)("mx-2 my-1 h-6 w-[8.8125rem] rounded-lg",t)}),[t]);if(!N)return null;if(!d||!k||!y)return H;let $=O.length>0,q=(0,g.W)(d);return(0,n.jsxs)(r.DropdownMenu,{modal:!0,open:A,onOpenChange:L,children:[(0,n.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(l.$,{ref:I,"aria-label":"Scope Switcher",className:(0,i.cn)("hover:bg-gray-150 focus-visible:bg-gray-150 data-[state=open]:bg-gray-150 active:bg-gray-150","relative h-8 min-h-8 gap-0 rounded-md !pl-1.5 !pr-0","header"===a?"max-w-fit shrink grow basis-32":"w-fit",q&&"v0-level0"===y.v0plan?"min-w-32":"min-w-20",t),variant:"ghost",children:(0,n.jsx)(m.X,{scope:d,user:y,trigger:!0,skeleton:H})})}),(0,n.jsx)(r.DropdownMenuContent,{onCloseAutoFocus:e=>e.preventDefault(),onEscapeKeyDown:()=>setTimeout(()=>{var e;return null==(e=I.current)?void 0:e.focus()},0),align:"start",className:"w-[224px]",side:"top",sideOffset:8,children:(0,n.jsx)(R,{onUpgradeActiveScope:B,activeScope:k,user:y,children:(0,n.jsxs)(h.rX,{className:(0,i.cn)("gap-1 overflow-y-auto transition-opacity has-[[data-loading=true]]:pointer-events-none has-[[data-loading=true]]:opacity-70",$?"max-h-[min(400px,calc(100vh-100px))]":"max-h-[min(375px,calc(100vh-100px))]"),children:[_.map(e=>(0,n.jsx)(D,{user:y,scope:e,isCurrentlyActive:E(e.id),onSelect:U,onRequestAccess:F,onUpgradeTeam:V,suspense:!1},"menu-item-".concat(e.id))),$?(0,n.jsx)(r.lp,{className:"flex-none",children:"Other Teams"}):null,O.map(e=>(0,n.jsx)(D,{user:y,scope:e,isCurrentlyActive:E(e.id),onSelect:U,onRequestAccess:F,onUpgradeTeam:V,suspense:!1},"menu-item-".concat(e.id)))]})})})]})}function R(e){let{activeScope:t,onUpgradeActiveScope:a,user:i,children:o}=e,{scopeSlug:u,scopePlan:m}=(0,N.f)({scope:t,user:i}),{tbb:p}=(0,E.D)(),x=(0,s.useMemo)(()=>{let e=!!m,t="v0-level0"===m,a="v0-platinum"===m,n=t||"v0-level3"===m||a;return{hasScope:e,isFree:t,isUltra:a,isIndividual:n}},[m]),f=(0,s.useMemo)(()=>x.hasScope&&x.isIndividual&&!x.isUltra&&(!p||x.isFree)?(0,n.jsx)(L._2,{className:"outline-none [&[data-highlighted]_button]:bg-gray-700",onSelect:a,children:(0,n.jsxs)(l.$,{size:"sm",className:"w-full rounded-lg",children:["Upgrade to"," ",x.isFree?(0,n.jsx)("span",{children:"Premium"}):(0,n.jsx)("span",{children:"Ultra"})]})}):null,[a,x,p]),g=(0,s.useMemo)(()=>{if(!m)return null;let e=x.isIndividual?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.xG,{label:"Team Billing",Icon:(0,n.jsx)(c.y,{}),sameTab:!1,href:"https://vercel.com/".concat(u,"/~/settings/invoices")}),(0,n.jsx)(h.xG,{label:"Manage Members",Icon:(0,n.jsx)(d.z,{}),external:!0,sameTab:!1,href:"https://vercel.com/".concat(u,"/~/settings/members")})]});return f||e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.mB,{}),(0,n.jsxs)(h.rX,{children:[e,f]})]}):null},[x.isIndividual,m,u,f]);return(0,n.jsxs)(n.Fragment,{children:[o,g]})}},80464:(e,t,a)=>{"use strict";a.d(t,{t:()=>l});var n=a(74118),s=a(25603),r=a(33571);function l(){let{chatId:e}=(0,n.xz)(),{data:t,mutate:a}=(0,s.Ay)(["block:forked-from",e]);return{getBlockForked:(0,r.useCallback)(e=>{var a;return null!=(a=null==t?void 0:t.get(e))?a:void 0},[t]),setBlockForked:(0,r.useCallback)((e,n)=>{a(new Map(null==t?void 0:t.set(e,n)))},[t,a])}}},80693:(e,t,a)=>{"use strict";a.d(t,{q:()=>s});var n=a(97667);function s(){return(0,n.jsxs)("svg",{className:"download-icon overflow-visible",fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("style",{children:".download-icon {\n            cursor: pointer;\n            transform-origin: center;\n        }\n        .download-icon .arrow-part {\n            transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n             transform-origin: center;\n        }\n        button:has(.download-icon):hover .download-icon .arrow-part, button:has(.download-icon):focus-visible .download-icon .arrow-part {\n          transform: translateY(-1.5px);\n        }\n        "}),(0,n.jsx)("g",{className:"arrow-part",children:(0,n.jsx)("path",{clipRule:"evenodd",d:"M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75Z",fill:"currentColor",fillRule:"evenodd"})}),(0,n.jsx)("g",{className:"rectangle-part",children:(0,n.jsx)("path",{clipRule:"evenodd",d:"M13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z",fill:"currentColor",fillRule:"evenodd"})})]})}a(33571)},81195:(e,t,a)=>{"use strict";a.d(t,{DS:()=>n,Of:()=>r,_b:()=>s});let n=["javascript","typescript","python","sql"],s=["js","jsx","mjs","cjs","ts","tsx","mts","cts","py","sql"];function r(e){switch(e){case"plaintext":case"png":case"jpg":case"jpeg":case"slim":case"shaderlab":return"text";case"bat":return"batch";case"dockercompose":return"yaml";case"git-rebase":case"git-commit":return"markdown";case"typescriptreact":return"tsx";case"javascriptreact":case"svelte":case"astro":return"jsx";case"jsonc":return"json5";case"objective-c":case"objective-cpp":return"objectivec";case"perl6":return"perl";case"shellscript":return"bash";case"terraform":return"hcl";case"bibtex":return"tex";case"cuda-cpp":return"cpp";case"jade":return"pascal";case"vue":case"vue-html":return"html";case"xsl":return"xml";default:return e}}},81614:(e,t,a)=>{"use strict";a.d(t,{p:()=>s});var n=a(97667);function s(e){let{title:t,children:a,icon:s,variant:l="default"}=e;return(0,n.jsxs)("div",{className:"border-alpha-200 bg-muted flex min-h-[200px] flex-col items-center justify-center gap-4 text-balance rounded-md border px-6 py-8 text-center",children:[s?(0,n.jsx)("div",{className:r({variant:l}),children:s}):null,(0,n.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,n.jsx)("span",{className:"text-label-16 font-medium",children:t}),(0,n.jsx)("span",{className:"text-label-14 text-gray-500",children:a})]})]})}let r=(0,a(60914).F)("bg-background border-alpha-400 flex size-8 items-center justify-center rounded-[6px] border",{variants:{variant:{default:"text-gray-900",warning:"text-amber-600",error:"text-red-600",success:"text-green-600"}},defaultVariants:{variant:"default"}})},81966:(e,t,a)=>{"use strict";a.d(t,{Separator:()=>i});var n=a(97667),s=a(33571),r=a(53210),l=a(28819);let i=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:i=!0,...o}=e;return(0,n.jsx)(r.b,{className:(0,l.cn)("bg-border shrink-0","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),decorative:i,orientation:s,ref:t,...o})});i.displayName=r.b.displayName},82974:(e,t,a)=>{"use strict";a.d(t,{B:()=>n});let n=e=>"user"===e.role?e.id:e.continuingMessageId||e.id},83195:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o,N:()=>i});var n=a(25603),s=a(19434);let r=e=>fetch(e).then(e=>e.json()),l=()=>{let{data:e,isLoading:t}=(0,n.Ay)("/api/auth/info",r);return{user:null==e?void 0:e.user,isLoggedIn:t?void 0:!!(null==e?void 0:e.user),agreementStatus:t||null==e?void 0:e.agreementStatus}};function i(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,{isLoggedIn:i}=l(),{data:o,isLoading:c,mutate:d}=(0,n.Ay)(()=>{let n;if((null==t?void 0:t.startsWith("team_"))&&(n=t),e&&i){let e=new URLSearchParams;return n&&e.set("teamId",n),a&&e.set("paymentMethod","true"),"/api/plan?".concat(e.toString())}return null},s.GO,{revalidateOnFocus:!1,dedupingInterval:r});return{planInfo:o,planSlug:null==o?void 0:o.currentPlanSlug,isLoading:c,update:d}}function o(e){return"subscription"in e.current}},83945:(e,t,a)=>{"use strict";a.d(t,{p:()=>s});var n=a(56179);function s(e,t){return(0,n.n)(e,(e,a)=>null===e[t]?1:null===a[t]?-1:new Date(a[t]).getTime()-new Date(e[t]).getTime())}},84031:(e,t,a)=>{"use strict";a.d(t,{j:()=>r});var n=a(97667),s=a(28819);function r(e){let{count:t,max:a,className:r,displayThreshold:l,alertThreshold:i,message:o,messageThreshold:c,...d}=e;return l=null!=l?l:.75*a,c=null!=c?c:.9*a,i=null!=i?i:.95*a,(0,n.jsxs)("div",{className:(0,s.cn)("pointer-events-none items-center gap-2 rounded-md px-2 py-1 text-xs",t>=l?"flex":"hidden",t>=i?"text-red-500":"text-gray-500",r),...d,children:[o&&t>=c&&(0,n.jsx)("span",{children:o}),(0,n.jsxs)("span",{className:"ml-auto tabular-nums",children:[t.toLocaleString(),"/",a.toLocaleString()]})]})}},84371:(e,t,a)=>{"use strict";a.d(t,{q:()=>i});var n=a(71543),s=a(33571),r=a(74118),l=a(97396);function i(e){let{messageId:t}=e,{chatId:a,messages:i,activeForkKey:o}=(0,r.Pk)(),{user:c}=(0,n.J)(),{botText:d,userMessageId:u}=(0,s.useMemo)(()=>{let e={botText:void 0,userMessageId:void 0};if(!t||!o)return e;let a=i.findIndex(e=>"id"in e&&e.id===t);return a<0?e:{botText:i[a].content,userMessageId:(0,l.qR)(o,t)}},[i,t,o]),m=(0,s.useMemo)(()=>(0,l.K1)(o),[o]);return{chatId:a,messageText:d,promptMessageId:u,messageId:t,userId:null==c?void 0:c.id,leafMessageId:m}}},84618:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m,oR:()=>u});var n=a(33571);let s=0,r=new Map,l=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=i(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_VALUE).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||n()}}}),{id:a,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=n.useState(c);return n.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},85984:(e,t,a)=>{"use strict";a.d(t,{_:()=>c});var n=a(97667),s=a(66692),r=a(33571),l=a(16983),i=a(27693),o=a(3125);function c(){let{loginUrl:e}=(0,l.AO)(),[t,a]=(0,r.useState)(!1),o=(0,i.k)();if((0,l.Zu)())return(0,n.jsx)(d,{});let c=(0,n.jsx)("a",{href:"".concat(e,"&action=signup"),onClick:()=>a("signup"),children:o("chatAuthButtons.signup")}),u=(0,n.jsx)("a",{href:e,onClick:()=>a("login"),children:o("chatAuthButtons.signin")});return(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(s.$,{className:"h-7 rounded-md",asChild:!0,disabled:"login"===t,size:"sm",variant:"secondary",children:u}),(0,n.jsx)(s.$,{className:"h-7 rounded-md",asChild:!0,disabled:"signup"===t,size:"sm",children:c})]})}function d(){let e=(0,i.k)(),[t,a]=(0,r.useState)(!1);return(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(s.$,{size:"sm",onClick:()=>{a(!0),(0,o.Jv)("vercel")},disabled:t,children:e("signInDialog.authConnect")})})}},86184:(e,t,a)=>{"use strict";a.d(t,{wJ:()=>eW,BW:()=>eO,q6:()=>eH,Q1:()=>eK});var n=a(97667),s=a(69077),r=a(33571),l=a(28819),i=a(55274),o=a(95393),c=a(74118),d=a(19243),u=a(99066),m=a(85906),h=a(66418),p=a(37879),x=a(57157),f=a(77529),g=a(72002),v=a(74567),j=a(23680),b=a(16983),y=a(66692),w=a(84089),N=a(87501),k=a(90654),C=a(15941),S=a(19716),M=a(80381),I=a(80574),A=a(32136),D=a(8689),L=a(18858),z=a(25603),E=a(93660),P=a(21715),T=a(27693),F=a(90962),R=a(16799),U=a(17509),V=a(9285),B=a(19434),_=a(63476),O=a(25951),H=a(71543),$=a(74377),q=a(13443),W=a(57716),G=a(13729),Z=a(50251),Y=a(37707),K=a(83195),J=a(17253),Q=a(73655);let X=e=>{let{isSignedIn:t,userOnFree:a,uploadFiles:n,isFigmaUrl:s,handleFigmaImport:l,showSignInDialog:i,setUpgradePromptOpen:o}=e,{setImportFigmaModalOpen:c}=(0,Z.C)();return(0,r.useCallback)(async e=>{let r=e.clipboardData.getData("text");if(!r)return;if(s(r)){if(!t)return void i();if(a)return void o(!0)}if(s(r)){(0,d.u)("FigmaUrlPaste",{url:r,valid:!0}),e.preventDefault(),c(null),await new Promise(e=>setTimeout(e,0)),l(r);return}let u=r.split("\n").length,m=r.length;if(u>200||m>2e4){e.preventDefault();let a=function(e){let t=(e,t)=>e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").toLowerCase()+t;if(!e)return null;let a=e.includes("<")&&e.includes(">"),n="typescript";for(let s of((e.includes("def ")||e.includes("class ")&&e.includes(":\n"))&&(n="python"),({typescript:[{regex:/export\s+default\s+function\s+(\w+)/,extension:".tsx"},{regex:/export\s+default\s+(\w+)/,extension:".tsx"},{regex:/export\s+function\s+(\w+)/,extension:".tsx"},{regex:/export\s+const\s+(\w+)\s*=/,extension:".tsx"},{regex:/export\s+class\s+(\w+)/,extension:".tsx"},{regex:/class\s+(\w+)/,extension:a?".tsx":".ts"},{regex:/function\s+(\w+)/,extension:a?".tsx":".ts"},{regex:/const\s+(\w+)\s*=/,extension:a?".tsx":".ts"}],python:[{regex:/class\s+(\w+)\s*[:(]/,extension:".py"},{regex:/def\s+(\w+)\s*\(/,extension:".py"}]})[n])){let a=e.match(s.regex);if(a&&a[1])return t(a[1],s.extension)}let s=e.match(/^\s*(?:const|let|var|function|class)\s+(\w+)/m);return s?t(s[1],"python"===n?".py":a?".tsx":".ts"):e.includes("<html")?"index.html":null}(r),s=a&&t?prompt('The pasted text will be saved as a file named "'.concat(a,'". Please enter a new file name or press OK to continue.'),a):"snippet.txt";if(s&&!s.includes(".")&&(s+=".txt"),null===s)return;n([new File([new Blob([r],{type:"text/plain"})],s,{type:"text/plain"})])}},[l,s,t,c,n,a])};var ee=a(89385),et=a(10034),ea=a(51205),en=a.n(ea),es=a(42274),er=a(93187),el=a(86943),ei=a(25887);function eo(e){let{disabled:t,isSignedIn:a,reachedRateLimit:s,planSlug:r,currentPrompt:i,setPrompt:o,setLoading:c,hasEnhancedCurrentPrompt:u,handleRevert:m,recentUserMessages:h}=e,{setShowSignInDialog:p}=(0,b.AO)(),{complete:x,isLoading:f}=(0,es.sQ)({api:"/chat/api/prompt-enhancement",onResponse:()=>{c(!0)},onError:e=>{try{let t=JSON.parse(e.message);if("error"in t&&t.error===er.oO)return void G.o.error("Invalid prompt");G.o.error(e.message||"Something went wrong")}catch(e){G.o.error("Something went wrong")}c(!1)},streamProtocol:"text",body:{prev:h},onFinish:(e,t)=>{c(!1);let a=JSON.parse(t);o(a.prompt),(0,d.u)("EnhancePromptSuccess",{originalPromptLength:e.length,enhancedPromptLength:a.prompt.length})}}),g=i.length>el.EA,v=i.length<el.A1,j=t||f||!i||g||v;return u?(0,n.jsxs)(y.$,{className:"group h-7 w-7 md:w-auto",size:"sm",variant:"ghost",type:"button",onClick:m,children:[(0,n.jsx)(ed,{}),(0,n.jsx)("span",{className:"sr-only md:not-sr-only",children:"Undo"})]}):(0,n.jsx)(y.$,{className:(0,l.cn)("group size-7 rounded-md data-[loading=true]:bg-gray-100"),disabled:j||f,"data-loading":f,size:"sm",type:"button",tooltip:{className:"pr-1.5",side:"bottom",content:(0,n.jsx)("div",{className:"flex flex-col items-center justify-center gap-1",children:g?(0,n.jsxs)("span",{className:"text-gray-100",children:["Prompt is too long. Max length is ",el.EA," ","characters."]}):v?(0,n.jsx)("span",{className:"text-gray-100",children:"This prompt is too short to enhance."}):(0,n.jsx)("span",{className:"text-gray-100",children:"Enhance prompt"})})},variant:"ghost",onClick:()=>a?s&&"v0-enterprise"!==r?(0,ei.D)({type:"upgradePlan"}):void(i&&((0,d.u)("EnhancePrompt",{promptLength:i.length}),c(!0),x(i))):p({prompt:i}),children:(0,n.jsx)(ec,{isLoading:f})})}function ec(e){let{className:t,isLoading:a}=e;return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,n.jsx)("path",{d:"M12.8281 1C12.8281 2.10747 11.7632 3.17235 10.6558 3.17235C11.7632 3.17235 12.8281 4.23724 12.8281 5.34471C12.8281 4.23724 13.893 3.17235 15.0005 3.17235C13.893 3.17235 12.8281 2.10747 12.8281 1Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:a?{transformOrigin:"12.8281px 3.17235px",animation:"twinkle1 0.6s ease-in-out infinite"}:void 0}),(0,n.jsx)("path",{d:"M13 12C13 12.5098 12.5098 13 12 13C12.5098 13 13 13.4902 13 14C13 13.4902 13.4902 13 14 13C13.4902 13 13 12.5098 13 12Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:a?{transformOrigin:"13px 13px",animation:"twinkle2 0.7s ease-in-out infinite 0.2s"}:void 0}),(0,n.jsx)("path",{d:"M5.10285 3.89648C5.10285 5.98837 3.0914 7.99982 0.999512 7.99982C3.0914 7.99982 5.10285 10.0113 5.10285 12.1032C5.10285 10.0113 7.1143 7.99982 9.20619 7.99982C7.1143 7.99982 5.10285 5.98837 5.10285 3.89648Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:a?{transformOrigin:"5.10285px 7.99982px",animation:"twinkle3 0.8s ease-in-out infinite 0.4s"}:void 0}),a&&(0,n.jsx)(en(),{id:"73931606915e20c4",children:"@keyframes twinkle1{0%,100%{transform:scale(1)rotate(0deg);opacity:1}50%{transform:scale(.7)rotate(20deg);opacity:.7}}@keyframes twinkle2{0%,100%{transform:scale(1)rotate(0deg);opacity:1}50%{transform:scale(.6)rotate(-25deg);opacity:.6}}@keyframes twinkle3{0%,100%{transform:scale(1)rotate(0deg);opacity:1}50%{transform:scale(.75)rotate(-18deg);opacity:.8}}"})]})}function ed(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.46967 9.09099L5 9.62132L6.06066 8.56066L5.53033 8.03033L3.56063 6.06063H10.125C11.989 6.06063 13.5 7.57167 13.5 9.43563C13.5 11.2996 11.989 12.8106 10.125 12.8106H4.5H3.75V14.3106H4.5H10.125C12.8174 14.3106 15 12.128 15 9.43563C15 6.74324 12.8174 4.56063 10.125 4.56063H3.56069L5.53033 2.59099L6.06066 2.06066L5 1L4.46967 1.53033L1.21967 4.78033C0.926777 5.07322 0.926777 5.5481 1.21967 5.84099L4.46967 9.09099Z",fill:"currentColor"})})}var eu=a(39929),em=a(92461),eh=a(29412),ep=a(83823),ex=a(95251),ef=a(44369);function eg(e){let{icon:t,content:a,shortContent:s,action:r,onDismiss:i,showDismiss:o=!0,className:c,type:d="regular"}=e,u=(0,ef.tF)(),m=r?(0,n.jsx)(y.$,{className:(0,l.cn)("@[420px]/banner:flex inline-flex","error"===d&&"text-primary"),onClick:r.onAction,size:"sm",variant:"link","data-testid":"banner-action",children:r.label}):null;return(0,n.jsxs)("div",{className:(0,l.cn)("banner @container/banner flex items-center justify-between gap-2 py-1.5 pl-3 pr-2 text-sm",c,{"banner-regular text-gray-900":"regular"==d&&u,"banner-error text-red-700":"error"==d&&u}),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[t,(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:(0,l.cn)(s&&"@[540px]/banner:inline hidden"),children:a}),s&&(0,n.jsx)("span",{className:"@[540px]/banner:hidden",children:s}),(0,n.jsxs)("span",{className:"@[420px]/banner:hidden",children:[" ",m]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("div",{className:"@[420px]/banner:block hidden",children:m}),o&&i&&(0,n.jsxs)(y.$,{"aria-label":"Close banner",className:"aspect-square h-5 px-0 text-gray-500 has-[>svg]:px-0",onClick:i,variant:"ghost",children:[(0,n.jsx)(ex.a,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close banner"})]})]})]})}function ev(e){let{almostAtLimit:t,reachedLimit:a,isAnonymous:s,resetDate:l}=e,[i]=(0,L.d)(),{dismissBannerLimit:o,dismissBannerGeneral:c,userOnFree:d}=(0,L.f)(),u=(0,T.k)(),{user:m}=(0,H.J)(),h=(null==m?void 0:m.v0plan)==="v0-level0",{ml:p,tbb:x}=(0,Y.D)(),[f,g]=(0,r.useMemo)(()=>{if(x){let e=l?new Date(l).toLocaleDateString("en-US",{month:"long",day:"numeric"}):void 0;return[a?u("rateLimit.bannerTextDesktopOutOfCredits")({resetTime:e}):u("rateLimit.bannerTextDesktopLowOnCredits")({resetTime:e}),a?u("rateLimit.bannerTextMobileOutOfCredits"):u("rateLimit.bannerTextMobileLowOnCredits")]}if(!i)return[null,null];if(s&&a)return[u("rateLimit.reachedLimitAnonymous"),u("rateLimit.reachedLimitAnonymousMobile")];let e=[u("rateLimit.bannerTextDesktop"),u("rateLimit.bannerTextMobile")];if(!m)return e;let n=new Date(i.reset),r=d&&p;if(a){let e=r?(0,ep.GP)(n,"MMMM d h:mm a"):(0,ep.GP)(n,"h:mm a");return[u("rateLimit.reachedLimit")({resetTime:e,free:d}),u("rateLimit.reachedLimitMobile")({resetTime:e,free:d})]}return t?[u("rateLimit.almostAtLimit")({count:Math.max(i.remaining,0),plural:i.remaining>1,free:d}),null]:e},[i,s,a,u,x,l,m,d,p,t]);return i||x?(0,n.jsx)(eg,{content:f,shortContent:g,action:{label:h?u("rateLimit.upgradeButtonText"):u("rateLimit.buyMoreButtonText"),onAction:()=>h?(0,ei.D)({type:"upgradePlan"}):(0,ei.D)({type:"buyMoreCredits",data:{onSuccess:()=>{o()}}})},onDismiss:a?void 0:t?o:c,showDismiss:!a}):null}var ej=a(70676);let eb=(0,ej.createServerReference)("60c58159982e60dcd994f1c717580cefd781076468",ej.callServer,void 0,ej.findSourceMapURL,"forkMostRecentBlock");var ey=a(70158),ew=a(8153);function eN(e){let{activeForkKey:t,currentMessages:a}=e,{lcw:s}=(0,Y.D)(),l=(0,T.k)(),{canWriteToChat:i}=(0,A.tZ)(),{chatId:o}=(0,c.xz)(),d=(0,ey.useRouter)(),[u,m]=(0,r.useMemo)(()=>[l("longContextBanner.bannerTextDesktop"),l("longContextBanner.bannerTextMobile")],[l]);return!(a.length<100)&&s&&i&&o?(0,n.jsx)(eg,{icon:(0,n.jsx)(ew.f,{className:"!text-gray-600"}),content:u,shortContent:m,className:"pl-2 pr-2.5",action:{label:(0,n.jsx)("span",{className:"text-gray-900",children:l("longContextBanner.forkChat")}),onAction:()=>{(0,r.startTransition)(async()=>{let e=await eb(o,t);return e?"string"!=typeof e?void G.o.error(e.error):void d.push("/chat/".concat(e)):void G.o.error("Failed to fork chat")})}},onDismiss:void 0,showDismiss:!1}):null}function ek(e){let{className:t,...a}=e;return(0,n.jsx)("svg",{className:(0,l.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 15 14",width:"16",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.65625 2.40625C4.65625 1.80219 5.14594 1.3125 5.75 1.3125C6.35406 1.3125 6.84375 1.80219 6.84375 2.40625V4.375C6.84375 5.46231 5.96231 6.34375 4.875 6.34375V7.65625C6.68718 7.65625 8.15625 6.18718 8.15625 4.375V2.40625C8.15625 1.80219 8.64594 1.3125 9.25 1.3125C9.85406 1.3125 10.3438 1.80219 10.3438 2.40625C10.3438 2.60656 10.2905 2.79244 10.1978 2.95265C10.0163 3.26638 10.1236 3.66782 10.4373 3.8493C10.751 4.03079 11.1525 3.92358 11.3339 3.60985C11.4252 3.4521 11.499 3.28302 11.5529 3.10542C12.1159 3.25322 12.5312 3.7656 12.5312 4.375C12.5312 4.66418 12.4382 4.93116 12.2795 5.14826C12.1859 5.12155 12.0905 5.09917 11.9936 5.08136C11.6371 5.01588 11.295 5.25177 11.2295 5.60825C11.1641 5.96472 11.4 6.30678 11.7564 6.37226C12.5706 6.52181 13.1875 7.23624 13.1875 8.09338C13.1875 9.05988 12.404 9.84338 11.4375 9.84338C11.328 9.84338 11.2215 9.83341 11.1186 9.8145C10.7621 9.74903 10.42 9.98492 10.3545 10.3414C10.2891 10.6979 10.525 11.0399 10.8814 11.1054C11.0622 11.1386 11.2481 11.1559 11.4375 11.1559C11.6502 11.1559 11.8578 11.1342 12.0582 11.0929C11.8835 12.0013 11.0844 12.6875 10.125 12.6875C9.03769 12.6875 8.15625 11.8061 8.15625 10.7188V10.5C8.15625 9.41269 9.03769 8.53125 10.125 8.53125V7.21875C8.31282 7.21875 6.84375 8.68782 6.84375 10.5V10.7188C6.84375 11.8061 5.96231 12.6875 4.875 12.6875C3.91563 12.6875 3.11654 12.0013 2.94177 11.0929C3.14222 11.1342 3.34983 11.1559 3.5625 11.1559C3.75186 11.1559 3.93776 11.1386 4.11856 11.1054C4.47503 11.0399 4.71093 10.6979 4.64545 10.3414C4.57997 9.98492 4.23791 9.74903 3.88144 9.8145C3.7785 9.83341 3.67195 9.84338 3.5625 9.84338C2.596 9.84338 1.8125 9.05988 1.8125 8.09338C1.8125 7.23624 2.42938 6.52181 3.24356 6.37226C3.60003 6.30678 3.83593 5.96472 3.77045 5.60825C3.70497 5.25177 3.36291 5.01588 3.00644 5.08136C2.90945 5.09917 2.81406 5.12155 2.7205 5.14826C2.56182 4.93116 2.46875 4.66418 2.46875 4.375C2.46875 3.7656 2.88406 3.25321 3.44708 3.10542C3.50096 3.28302 3.57481 3.4521 3.66606 3.60985C3.84755 3.92358 4.24899 4.03079 4.56272 3.8493C4.87645 3.66782 4.98365 3.26638 4.80217 2.95265C4.7095 2.79244 4.65625 2.60656 4.65625 2.40625ZM13.4391 5.77559C14.0889 6.33702 14.5 7.16693 14.5 8.09338C14.5 9.04025 14.0703 9.88675 13.3952 10.4485C13.4025 10.5377 13.4062 10.6279 13.4062 10.7188C13.4062 12.5309 11.9372 14 10.125 14C9.05164 14 8.09865 13.4846 7.5 12.6878C6.90135 13.4846 5.94836 14 4.875 14C3.06282 14 1.59375 12.5309 1.59375 10.7188C1.59375 10.6279 1.59746 10.5377 1.60476 10.4485C0.929711 9.88675 0.5 9.04025 0.5 8.09338C0.5 7.16693 0.911134 6.33702 1.56087 5.77559C1.30484 5.37039 1.15625 4.88986 1.15625 4.375C1.15625 3.04512 2.14519 1.94622 3.42778 1.77359C3.70556 0.751575 4.64001 0 5.75 0C6.43951 0 7.06129 0.290015 7.5 0.754716C7.93871 0.290015 8.56049 0 9.25 0C10.36 0 11.2944 0.751577 11.5722 1.7736C12.8548 1.94622 13.8438 3.04512 13.8438 4.375C13.8438 4.88986 13.6952 5.37039 13.4391 5.77559Z",fill:"currentColor"})})}function eC(e){let{className:t,...a}=e;return(0,n.jsx)("svg",{className:(0,l.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 15 14",width:"16",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.75 1.3125C5.14594 1.3125 4.65625 1.80219 4.65625 2.40625C4.65625 2.60656 4.7095 2.79244 4.80217 2.95265C4.98365 3.26638 4.87645 3.66782 4.56272 3.8493C4.24899 4.03079 3.84755 3.92358 3.66606 3.60985C3.57481 3.4521 3.50096 3.28302 3.44708 3.10542C2.88406 3.25321 2.46875 3.7656 2.46875 4.375C2.46875 4.66418 2.56182 4.93116 2.7205 5.14826C2.81406 5.12155 2.90945 5.09917 3.00644 5.08136C3.36291 5.01588 3.70497 5.25177 3.77045 5.60825C3.83593 5.96472 3.60003 6.30678 3.24356 6.37226C2.42938 6.52181 1.8125 7.23624 1.8125 8.09338C1.8125 9.05988 2.596 9.84338 3.5625 9.84338C3.67195 9.84338 3.7785 9.83341 3.88144 9.8145C4.23791 9.74903 4.57997 9.98492 4.64545 10.3414C4.71093 10.6979 4.47503 11.0399 4.11856 11.1054C3.93776 11.1386 3.75186 11.1559 3.5625 11.1559C3.34983 11.1559 3.14222 11.1342 2.94177 11.0929C3.11654 12.0013 3.91563 12.6875 4.875 12.6875C5.96231 12.6875 6.84375 11.8061 6.84375 10.7188V10.5C6.84375 8.68782 8.31282 7.21875 10.125 7.21875V8.53125C9.03769 8.53125 8.15625 9.41269 8.15625 10.5V10.7188C8.15625 11.8061 9.03769 12.6875 10.125 12.6875C11.0844 12.6875 11.8835 12.0013 12.0582 11.0929C11.8578 11.1342 11.6502 11.1559 11.4375 11.1559C11.2481 11.1559 11.0622 11.1386 10.8814 11.1054C10.525 11.0399 10.2891 10.6979 10.3545 10.3414C10.42 9.98492 10.7621 9.74903 11.1186 9.8145C11.2215 9.83341 11.328 9.84338 11.4375 9.84338C12.404 9.84338 13.1875 9.05988 13.1875 8.09338C13.1875 7.23624 12.5706 6.52181 11.7564 6.37226C11.4 6.30678 11.1641 5.96472 11.2295 5.60825C11.295 5.25177 11.6371 5.01588 11.9936 5.08136C12.0905 5.09917 12.1859 5.12155 12.2795 5.14826C12.4382 4.93116 12.5312 4.66418 12.5312 4.375H13.8438C13.8438 4.88986 13.6952 5.37039 13.4391 5.77559C14.0889 6.33702 14.5 7.16693 14.5 8.09338C14.5 9.04025 14.0703 9.88675 13.3952 10.4485C13.4025 10.5377 13.4062 10.6279 13.4062 10.7188C13.4062 12.5309 11.9372 14 10.125 14C9.05164 14 8.09865 13.4846 7.5 12.6878C6.90135 13.4846 5.94836 14 4.875 14C3.06282 14 1.59375 12.5309 1.59375 10.7188C1.59375 10.6279 1.59746 10.5377 1.60476 10.4485C0.929711 9.88675 0.5 9.04025 0.5 8.09338C0.5 7.16693 0.911134 6.33702 1.56087 5.77559C1.30484 5.37039 1.15625 4.88986 1.15625 4.375C1.15625 3.04512 2.14519 1.94622 3.42778 1.77359C3.70556 0.751575 4.64001 0 5.75 0C6.43951 0 7.06129 0.290015 7.5 0.754716C7.93871 0.290015 8.56049 0 9.25 0H9.6875V1.3125H9.25C8.64594 1.3125 8.15625 1.80219 8.15625 2.40625V4.375C8.15625 6.18718 6.68718 7.65625 4.875 7.65625V6.34375C5.96231 6.34375 6.84375 5.46231 6.84375 4.375V2.40625C6.84375 1.80219 6.35406 1.3125 5.75 1.3125ZM12.75 3.5V3.0625C12.75 2.57925 13.1418 2.1875 13.625 2.1875H14.0625V1.75V1.3125H13.625C13.1418 1.3125 12.75 0.920749 12.75 0.4375V0H12.3125H11.875V0.4375C11.875 0.920749 11.4832 1.3125 11 1.3125H10.5625V1.75V2.1875H11C11.4832 2.1875 11.875 2.57925 11.875 3.0625V3.5H12.75Z",fill:"currentColor"})})}function eS(e){let{className:t,...a}=e;return(0,n.jsx)("svg",{className:(0,l.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 15 14",width:"16",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.65625 2.40625C4.65625 1.80219 5.14594 1.3125 5.75 1.3125C6.35406 1.3125 6.84375 1.80219 6.84375 2.40625V4.375C6.84375 5.46231 5.96231 6.34375 4.875 6.34375V7.65625C6.68718 7.65625 8.15625 6.18718 8.15625 4.375V2.40625C8.15625 1.80219 8.64594 1.3125 9.25 1.3125H9.6875V0H9.25C8.56049 0 7.93871 0.290015 7.5 0.754716C7.06129 0.290015 6.43951 0 5.75 0C4.64001 0 3.70556 0.751575 3.42778 1.77359C2.14519 1.94622 1.15625 3.04512 1.15625 4.375C1.15625 4.88986 1.30484 5.37039 1.56087 5.77559C0.911134 6.33702 0.5 7.16692 0.5 8.09338V8.74957H1.8125V8.09338C1.8125 7.23624 2.42938 6.52181 3.24356 6.37226C3.60003 6.30678 3.83593 5.96472 3.77045 5.60825C3.70497 5.25177 3.36291 5.01588 3.00644 5.08136C2.90945 5.09917 2.81406 5.12155 2.7205 5.14826C2.56182 4.93116 2.46875 4.66418 2.46875 4.375C2.46875 3.7656 2.88406 3.25321 3.44708 3.10542C3.50096 3.28302 3.57481 3.4521 3.66606 3.60985C3.84755 3.92358 4.24899 4.03079 4.56272 3.8493C4.87645 3.66782 4.98365 3.26638 4.80217 2.95265C4.7095 2.79244 4.65625 2.60656 4.65625 2.40625ZM4.875 12.6875C5.96231 12.6875 6.84375 11.8061 6.84375 10.7188V10.5C6.84375 8.68782 8.31282 7.21875 10.125 7.21875V8.53125C9.03769 8.53125 8.15625 9.41269 8.15625 10.5V10.7188C8.15625 11.8061 9.03769 12.6875 10.125 12.6875C11.0844 12.6875 11.8835 12.0013 12.0582 11.0929C11.8578 11.1342 11.6502 11.1559 11.4375 11.1559C11.2481 11.1559 11.0622 11.1386 10.8814 11.1054C10.525 11.0399 10.2891 10.6979 10.3545 10.3414C10.42 9.98492 10.7621 9.74903 11.1186 9.8145C11.2215 9.83341 11.328 9.84338 11.4375 9.84338C12.404 9.84338 13.1875 9.05988 13.1875 8.09338C13.1875 7.23624 12.5706 6.52181 11.7564 6.37226C11.4 6.30678 11.1641 5.96472 11.2295 5.60825C11.295 5.25177 11.6371 5.01588 11.9936 5.08136C12.0905 5.09917 12.1859 5.12155 12.2795 5.14826C12.4382 4.93116 12.5312 4.66418 12.5312 4.375H13.8438C13.8438 4.88986 13.6952 5.37039 13.4391 5.77559C14.0889 6.33702 14.5 7.16693 14.5 8.09338C14.5 9.04025 14.0703 9.88675 13.3952 10.4485C13.4025 10.5377 13.4062 10.6279 13.4062 10.7188C13.4062 12.5309 11.9372 14 10.125 14C9.05164 14 8.09865 13.4846 7.5 12.6878C6.90135 13.4846 5.94836 14 4.875 14V12.6875ZM12.75 3.0625V3.5H11.875V3.0625C11.875 2.57925 11.4832 2.1875 11 2.1875H10.5625V1.75V1.3125H11C11.4832 1.3125 11.875 0.920749 11.875 0.4375V0H12.3125H12.75V0.4375C12.75 0.920749 13.1418 1.3125 13.625 1.3125H14.0625V1.75V2.1875H13.625C13.1418 2.1875 12.75 2.57925 12.75 3.0625ZM2.6875 8.75V9.1875C2.6875 10.154 1.904 10.9375 0.9375 10.9375H0.5V11.375V11.8125H0.9375C1.904 11.8125 2.6875 12.596 2.6875 13.5625V14H3.125H3.5625V13.5625C3.5625 12.596 4.346 11.8125 5.3125 11.8125H5.75V11.375V10.9375H5.3125C4.346 10.9375 3.5625 10.154 3.5625 9.1875V8.75H2.6875Z",fill:"currentColor"})})}function eM(e){let t,a,{thinkingMode:s,setThinkingMode:i}=e,{tme:o}=(0,Y.D)(),c=(0,r.useCallback)(()=>{o&&(null===s?i("medium"):"medium"===s?i("high"):i(null))},[o,s,i]);return o?(t="medium"===s?(0,n.jsx)(eC,{}):"high"===s?(0,n.jsx)(eS,{}):(0,n.jsx)(ek,{}),a="medium"===s?"Think hard":"high"===s?"Think harder":"Thinking",(0,n.jsxs)(y.$,{type:"button",className:(0,l.cn)("h-7 w-min rounded-md !bg-gray-100 !px-1.5 text-[13px] text-gray-500 hover:!bg-gray-200 hover:!text-gray-900",null!==s&&"!bg-blue-100 text-blue-700 hover:!bg-blue-200 hover:!text-blue-800"),onClick:c,variant:"ghost",children:[t,(0,n.jsx)("span",{children:a})]})):null}var eI=a(69894),eA=a(41956),eD=a(24389),eL=a(8810);function ez(e){let{onChange:t}=e,[a,s]=(0,r.useState)("build"),[l,i]=(0,r.useState)(!1),o=(0,eA.al)(),c=(0,T.k)(),d=[{icon:eD.L2,text:c("message.buildText"),description:c("message.buildDescription"),value:"build"},{icon:eL.Q,text:c("message.askText"),description:c("message.askDescription"),value:"ask"}],u=(0,r.useMemo)(()=>{var e;return null!=(e=d.find(e=>e.value===a))?e:d[0]},[a]),m=(0,n.jsx)(y.$,{"aria-label":"Select mode",className:"flex h-7 max-w-[200px] justify-start pl-1.5 transition-colors has-[>svg]:pr-3",size:"sm",variant:"secondary",children:(0,n.jsxs)("span",{className:"flex gap-2 items-center",children:[(0,n.jsx)(u.icon,{}),u.text]})}),h=(0,n.jsx)("div",{className:"p-1",children:(0,n.jsx)("div",{className:"max-h-[400px] space-y-2 overflow-y-auto text-left",children:d.map(e=>(0,n.jsxs)("button",{className:"flex w-full gap-3 items-center justify-between rounded-md px-2 py-2.5 hover:bg-gray-100",onClick:()=>{s(e.value),null==t||t(e.value),i(!1)},children:[(0,n.jsx)("span",{className:"flex min-w-0 flex-1 items-center",children:(0,n.jsxs)("span",{className:"flex gap-3 items-center",children:[(0,n.jsx)(e.icon,{}),(0,n.jsxs)("span",{className:"flex flex-col items-start",children:[(0,n.jsx)("span",{className:"block text-sm",children:e.text}),(0,n.jsx)("span",{className:"block text-gray-500 text-xs",children:e.description})]})]})}),a===e.value&&(0,n.jsx)("span",{className:"flex shrink-0 items-center text-gray-500",children:(0,n.jsx)(eI.A,{className:"h-4 w-4 group-hover:hidden"})})]},e.value))})});return(0,n.jsx)("div",{className:"hidden w-full min-w-0 md:block",children:(0,n.jsxs)(eu.DropdownMenu,{onOpenChange:e=>i(e),open:l&&!o,children:[(0,n.jsx)(eu.DropdownMenuTrigger,{asChild:!0,className:"max-w-[200px]",children:m}),(0,n.jsx)(eu.DropdownMenuContent,{align:"start",side:"bottom",sideOffset:4,children:(0,n.jsx)(eu.DropdownMenuGroup,{children:h})})]})})}var eE=a(6902),eP=a(16078),eT=a(72770),eF=a(13089),eR=a(80672),eU=a(2783),eV=a(34034),eB=a(16979);function e_(e){let{content:t,onDismiss:a,planSlug:s}=e,r=(0,T.k)();return(0,n.jsx)(eg,{icon:(0,n.jsx)(eB.V,{}),type:"error",content:t,action:"v0-level0"===s?{label:r("rateLimit.upgradeButtonText"),onAction:()=>(0,ei.D)({type:"upgradePlan"})}:void 0,onDismiss:a,showDismiss:!0})}function eO(e){let{submit:t,stop:a,scrollDownButton:u,isMobile:h,isNewChat:x,isHome:f,isSignedIn:w,isAnonymous:N,className:k,clearOnSubmit:S=!0,placeholder:M,dragContainerRef:I,onInputChange:$,maxLength:ee,isPending:et,isTemplateLoading:ea=!1}=e,{showZipModal:en,setShowZipModal:es}=(0,eh.A)(),er=(0,eF.UY)(),el=(0,eR.useAtomValue)(er.dialogOpen),[ec,ed]=(0,r.useState)(void 0),eu=(0,eR.useAtomValue)(eU.uH),{blobs:em,reset:ep,localFileInfos:ex,removeFile:ef,isDraggingFile:eg,inputFileRef:ej,onInputChange:eb,uploading:ey,uploadFiles:ew}=(0,j.Ay)({isSignedIn:w,dragContainerRef:I,disableDrag:(null==el?void 0:el.type)==="shareBlock"||en||eu,onSuccess:(e,t)=>{let a=t.filter(e=>"application/zip"===e.contentType);if(a.length>1)return void G.o.error("Only one zip file is supported.");let n=a[0];n&&(ed(n),es(!0))},onError(e){t1(e)}}),{initialStreamPromise:ek,activeForkKey:eC,isLoading:eS,isStreaming:eI,messages:eA,isContinuing:eD}=(0,c.Pk)(),eL=(0,r.useMemo)(()=>eA.filter(e=>null==eC?void 0:eC.includes(e.id)),[eA,eC]),{quote:eB,setQuote:eO}=(0,A.sC)(),eW=(0,r.useRef)(null),eG=(0,r.useRef)(()=>{}),{setShowSignInDialog:eZ}=(0,b.AO)(),{showBannerLimit:eQ,showBannerGeneral:eX}=(0,L.f)(),e0=eQ&&w,e1=eX&&w,e5=e0||e1,{handleSavePromptDraft:e2,draft:e3}=(0,P.jh)(),[e6,e7]=(0,r.useState)(!0),{selectedProjectId:e9}=(0,O._t)(),{project:e4,canWriteToChat:e8}=(0,A.tZ)(),{user:te,expectUser:tt}=(0,H.J)(),{activeScope:ta}=(0,Q.k6)(),{planSlug:tn}=(0,K.N)(!0,null==ta?void 0:ta.id),{fi:ts,pe:tr,mpe:tl,mme:ti,ape:to,dm:tc,tbb:td}=(0,Y.D)(),[tu,tm]=(0,r.useState)(!1),[th,tp]=(0,r.useState)(!1),[tx,tf]=(0,r.useState)(),[tg,tv]=(0,r.useState)(""),tj="";(null==e3?void 0:e3.source)!=="cookie"||e3.isMessageTrimmed||(tj=e3.message);let[tb]=(0,eP.s)();(0,eT.t)(()=>{tb&&!document.hasFocus()&&new Audio("/chat-static/assets/sfx/streaming-complete.mp3").play()});let[ty,tw]=(0,r.useState)(tj),{autopilotEnabled:tN,setAutopilotEnabled:tk}=function(){let{data:e,mutate:t}=(0,z.Ay)("state:autopilot",{fallbackData:!1});return{autopilotEnabled:e,setAutopilotEnabled:t}}(),tC=(0,r.useMemo)(()=>eL.findLast(e=>"assistant"===e.role),[eL]),[tS,tM]=(0,r.useState)(tC&&"thinkingMode"in tC&&tC.thinkingMode||null),tI="v0-level0"===tn&&!(null==te?void 0:te.isAdminMode),tA=ex.length>0,{tokenUsage:tD,percentage:tL,exceededCharCount:tz,onlyImageFiles:tE,onlyTextFiles:tP}=function(e){let{localFiles:t}=e,a=(0,U.f)(),{messages:n,activeForkKey:s,chatId:l}=(0,c.Pk)(),i=(0,r.useMemo)(()=>n.filter(e=>null==s?void 0:s.includes(e.id)),[n,s]),{tokens:o,isLoading:d}=function(e,t,a){let n=(0,_.x)(),{data:s,isLoading:r}=(0,z.Ay)(n&&!a?"/chat/api/chat/cstu?chatId=".concat(e,"&messageId=").concat(t):null,B.GO,{shouldRetryOnError:!1});return{tokens:s,isLoading:r}}(l,(0,r.useMemo)(()=>{var e;return null==(e=i[i.length-1])?void 0:e.id},[i]),0===t.length),u=(0,r.useMemo)(()=>t.reduce((e,t)=>e+(t.tokens||0),0),[t]),m=(0,r.useMemo)(()=>d?0:o&&o>0?o:(0,R.Z)(i),[i,o,d]),h=(0,r.useMemo)(()=>m+u,[m,u]),p=t.every(e=>e.isImage),x=t.every(e=>void 0!==e.content),f=(0,r.useMemo)(()=>{if(h<=a.contextWindow)return 0;let e=h-a.contextWindow;return(0,V.Cy)(e)},[h,a.contextWindow]);return{total:a.contextWindow,used:h,available:a.contextWindow-h,percentage:Math.round(h/a.contextWindow*100),onlyImageFiles:p,onlyTextFiles:x,exceededCharCount:f,tokenUsage:m}}({localFiles:ex}),tT=tA&&tL>80,tF=(0,r.useMemo)(()=>{var e;return null==(e=function(e,t){for(let a=e.length-1;a>=0;a--)if(t(e[a]))return e[a]}(eL,e=>"user"===e.role))?void 0:e.content},[eL]),tR=(0,c.Pk)().chatId,tU=(0,q.C)(),tV=(0,r.useCallback)(function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=s?a:(null==(e=eW.current)?void 0:e.value)||a;tw(r),e7(!r),null==$||$(r),n&&e2({message:r,inputHeight:(null==(t=eW.current)?void 0:t.style.height)?parseInt(eW.current.style.height):void 0})},[e2,$,tw]),{planInfo:tB}=(0,J.z)(),[t_]=(0,L.d)(),tO=!!((null==t_?void 0:t_.remaining)!==void 0&&t_.remaining<=0)||void 0!==(null==tB?void 0:tB.balance)&&tB.balance.remaining<=0&&"number"==typeof tB.onDemand.balance&&tB.onDemand.balance<=0,tH=eS||eI||et,t$=e6&&0===ex.length&&!(null==e3?void 0:e3.message),tq=tH||ey||t$||ea||tt&&!te||tu;(0,r.useEffect)(()=>{tq&&tV(void 0,!1)},[]);let tW=eg&&!en,{promptFormInput:tG,setPromptFormInput:tZ}=eK(),{setImportFigmaModalOpen:tY}=(0,Z.C)();(0,r.useEffect)(()=>{if(!eW.current||void 0===tG||void 0===tG.input)return;let e=eW.current;if(e.value&&tG.doNotClear)return void tZ(void 0);e.value=e.value?"".concat(e.value,"\n").concat(tG.input):tG.input,tZ(void 0),e.style.height="".concat(e.scrollHeight,"px"),e.focus(),tV()},[tG,tZ,tV]);let tK=(null==e3?void 0:e3.source)==="cookie"&&e3.isMessageTrimmed;(0,r.useEffect)(()=>{if("string"==typeof(null==e3?void 0:e3.message)&&"localStorage"===e3.source&&e3.message&&eW.current){if(eW.current.value!==e3.message&&!e3.isExpandedDraft)return void tV();let e=eW.current;tw(e3.message),e.style.height="".concat(e3.inputHeight,"px"),e.scrollTop=1e7,e.focus(),e.setSelectionRange(e3.message.length,e3.message.length),e3.quote&&eO(e3.quote)}},[tZ,tw,e3,tV,eO]),(0,r.useEffect)(()=>{let e=eW.current;e&&ex.length>0&&e.focus()},[ex]),(0,r.useEffect)(()=>{let e=eW.current;if(!e)return;let t=t=>{"/"===t.key&&(t.target&&(["INPUT","TEXTAREA"].includes(t.target.nodeName)||"contentEditable"in t.target&&"true"===t.target.contentEditable)||(t.preventDefault(),t.stopPropagation(),e.focus()))},a=t=>{"Escape"===t.key&&""===e.value.trim()&&eO(null)},n=t=>{x||tH||"ArrowUp"===t.key&&""===e.value.trim()&&tF&&(0,r.startTransition)(()=>{e.value=String(tF),requestAnimationFrame(()=>e.select())})};return document.addEventListener("keydown",t),e.addEventListener("keydown",n),e.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",t),e.removeEventListener("keydown",n),e.removeEventListener("keydown",a)}},[a,tF,x,tH,eO]);let tJ=(0,T.k)(),[tQ,tX]=(0,r.useState)(void 0),[t0,t1]=(0,r.useState)(),[,t5]=(0,eV.YI)(),[t2,t3]=(0,eV.qo)(),t6=(0,r.useCallback)((e,a)=>{var n,s,r;if(e&&e.preventDefault(),tH&&!a)return;let l=null!=(s=null!=(n=null==a?void 0:a.trim())?n:ty.trim())?s:"";if(l||0!==ex.length){if(tO)return void(N?eZ({prompt:l}):td?tI?(0,ei.D)({type:"upgradePlan"}):(0,ei.D)({type:"buyMoreCredits",data:{onSuccess:()=>{t({action:"new",input:l,attachments:em,figmaContext:tQ,thinkingMode:tS||void 0,onFailToPrompt:()=>tV(l,!0,!1),messageMode:tx,autopilot:to&&tN,revalidateVercelEnvAndIntegrations:x})}}}):(0,ei.D)({type:"upgradePlan"}));(!tq||a)&&(t2?(postMessage({__v0_remote__:1,type:"refine",prompt:l,...t2},location.origin),t5(!1)):t({action:"new",input:l,attachments:em,figmaContext:tQ,thinkingMode:tS||void 0,onFailToPrompt:()=>tV(l,!0,!1),messageMode:tx,autopilot:to&&tN,revalidateVercelEnvAndIntegrations:x}),(0,d.u)("SubmitNewUserMessage",{text:l,index:eA.length,imageOnly:ex.length>0&&""===l.trim(),projectId:x?e9:null!=(r=null==e4?void 0:e4.projectId)?r:null,anonId:tU}),S&&(w||N)&&(eW.current&&(eW.current.value="",eG.current()),ep(),e7(!0),tp(!1),tw(""),tv("")))}},[t2,tH,ty,ex.length,tO,tq,t,em,tQ,tS,tx,to,tN,eA.length,x,e9,null==e4?void 0:e4.projectId,tU,S,w,N,eZ,t5,tV,ep,tw]),{formRef:t7,onKeyDown:t9}=(0,s.w)({localFileInfos:ex,submitMessage:t6});(0,r.useEffect)(()=>{eB&&t7.current&&t7.current.content&&t7.current.content.focus()},[t7,eB]);let{handleFigmaUrl:t4,isFigmaUrl:t8,isLoading:ae,getNodeContext:at}=(0,W.q)(eW);(0,r.useEffect)(()=>{let e;return ae&&(e=G.o.loading("Fetching design tokens from Figma")),()=>{e&&G.o.dismiss(e)}},[ae]);let aa=(0,r.useCallback)(async e=>{if(!t8(e))return;if(tI)return void(0,ei.D)({type:"upgradePlan"});let[t,a]=await Promise.all([t4(e),at(e)]);if(!t.success)return;let n=a.nodes.colors.map(e=>"".concat(e.hex,")")).join(", ")||"",s=a.nodes.designTokens.map(e=>"".concat(e.hex,")")).join(", ")||"";tX([n&&"Colors: ".concat(n),s&&"Design tokens: ".concat(s)].filter(Boolean).join(", "));let{base64:r,originalUrl:l,fileName:i}=t.data,o=i.replace(/[^a-zA-Z0-9.]/g,"_"),c=r.split(",")[1],d=window.atob(c),u=new Uint8Array(d.length);for(let e=0;e<d.length;e++)u[e]=d.charCodeAt(e);let m=new File([new Blob([u],{type:"image/png"})],"".concat(o,".png"),{type:"image/png"});m.isFigmaFile=!0,m.figmaUrl=l,m.v0Type="figma",await ew([m])},[t8,tI,t4,at,ew]);(0,r.useEffect)(()=>{if(!ts)return;let e=new URLSearchParams(window.location.search),t=e.get("figma_connected"),a="import"===e.get("from");if("true"!==t||a||tY({open:!0,onImport:aa}),"true"===t){let e=new URL(window.location.href);e.searchParams.delete("figma_connected"),e.searchParams.delete("from"),window.history.replaceState({},"",e)}},[ts,tY,aa]);let an=X({isSignedIn:w,userOnFree:tI,uploadFiles:ew,isFigmaUrl:t8,handleFigmaImport:aa,setUpgradePromptOpen:()=>(0,ei.D)({type:"upgradePlan"}),showSignInDialog:()=>eZ({prompt:!1})}),as=!x,ar=(0,r.useCallback)(()=>{ed(void 0),(null==ec?void 0:ec.id)&&ef(ec.id)},[ec,ef]),al="mx-auto max-w-3xl px-2 sm:px-3 md:px-4";return(0,n.jsxs)("div",{className:(0,l.cn)("group/form-container content-center",k),children:[(0,n.jsx)("div",{id:"prompt-actions",className:(0,l.cn)("contain-inline-size",al)}),(0,n.jsx)(eh.e,{attachment:ec,onClose:ar,projectId:e9||void 0}),(0,n.jsxs)("div",{className:(0,l.cn)("relative z-10 flex w-full flex-col",!x&&["bg-background pb-2 sm:pb-3 md:pb-4",al],as&&"pb-0 sm:pb-0 md:pb-0"),children:[(0,n.jsxs)(i.N,{mode:"sync",children:[!e5&&e8&&(0,n.jsx)(o.P.div,{animate:{opacity:1,height:"auto"},className:(0,l.cn)("peer relative rounded-t-xl bg-gray-100 text-gray-600"),exit:{opacity:0,height:0},initial:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,n.jsx)(eN,{currentMessages:eL,activeForkKey:eC})},"rate-limit"),t0?(0,n.jsx)(o.P.div,{animate:{opacity:1,height:"auto"},className:(0,l.cn)("peer relative rounded-t-xl bg-red-50"),exit:{opacity:0,height:0},initial:{opacity:0,height:"fit-content"},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,n.jsx)(e_,{content:t0,onDismiss:()=>t1(void 0),planSlug:tn})},"file-upload-error-message"):e5?(0,n.jsx)(o.P.div,{animate:{opacity:1,height:"auto"},className:(0,l.cn)("peer relative rounded-t-xl bg-gray-100 text-gray-600"),exit:{opacity:0,height:0},initial:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,n.jsx)(ev,{almostAtLimit:e0,reachedLimit:tO,isAnonymous:N,resetDate:null==tB?void 0:tB.billingCycle.end})},"rate-limit"):null]}),(0,n.jsx)("div",{className:(0,l.cn)("rounded-b-xl peer-has-[.banner-error]:bg-red-50 peer-has-[.banner-regular]:bg-gray-100"),children:(0,n.jsxs)("form",{className:(0,l.cn)("focus-within:border-alpha-600 bg-background-subtle border-alpha-400 relative rounded-xl border shadow-[0_2px_2px_rgba(0,0,0,0.04),0_8px_8px_-8px_rgba(0,0,0,0.04)] transition-shadow"),onSubmit:t6,ref:t7,children:[(0,n.jsx)(eY,{message:eL.find(e=>!!(eC&&eC[eC.length-1]===e.id)),isContinuing:eD,isLoading:eS,isStreaming:eI}),x?null:u,(0,n.jsxs)(i.N,{mode:"sync",children:[eB?(0,n.jsx)(o.P.div,{animate:{opacity:1,height:"auto"},className:"bg-muted relative rounded-t-xl border-b text-gray-600",exit:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,n.jsx)(e$,{className:(0,l.cn)(tA&&"pb-1"),onClose:()=>void eO(null),quote:eB,shouldNotAnimate:(null==e3?void 0:e3.quote)===eB},"quote-component-".concat(eB))},"quote-animate-".concat(eB)):null,tA||tW?(0,n.jsxs)(o.P.div,{animate:{opacity:1,height:"auto"},className:(0,l.cn)("bg-muted relative rounded-t-xl text-gray-600"),exit:{opacity:0,height:0},initial:((null==e3?void 0:e3.localFileInfos.length)||0)>0?{opacity:1,height:"auto"}:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:[(0,n.jsx)(eq,{files:ex,removeFile:ef,showDropzone:tW}),tT?(0,n.jsxs)("p",{className:(0,l.cn)("flex items-center gap-1 p-3 pt-0 text-xs text-gray-600"),children:[(0,n.jsx)(C.N,{className:"size-3.5",color:"amber-500"}),function(e){let{exceedsContextWindow:t,isNewChat:a,onlyTextFiles:n,onlyImageFiles:s,exceededCharCount:r,tokenUsage:l,numAttachments:i}=e,o=null==r?void 0:r.toLocaleString(),c=1===i?"":"s",d="Your message and attachment".concat(c," ").concat(t?"exceed":"are close to exceeding"," ").concat(a?"the chat context window":"the context window for this chat");return n&&t?d+=" by an estimated ".concat(o," character").concat(1===r?"":"s","."):d+=".",l>5e4&&!a?d+=" Try starting a new chat.":s?d+=" Try resizing or removing attached images.":n?d+=" Try uploading a smaller snippet of your attachment".concat(c,"."):d+=" Try reducing the size of your attachment".concat(c,"."),d}({exceedsContextWindow:!1,isNewChat:x,onlyTextFiles:tP,onlyImageFiles:tE,exceededCharCount:tz,tokenUsage:tD,numAttachments:ex.length})]}):null]},"attachments-".concat(tW,"-").concat(ex.length)):null]}),(0,n.jsxs)("div",{className:(0,l.cn)("@container/textarea bg-background-subtle relative z-10 grid min-h-0 rounded-xl"),children:[(0,n.jsx)("label",{className:"sr-only",htmlFor:"chat-main-textarea",children:tJ("promptForm.chatInput")}),t3,tK&&e3.inputHeight?(0,n.jsx)("div",{className:"flex w-full flex-col gap-0 px-3",style:{height:"".concat(e3.inputHeight,"px")},children:Array.from({length:Math.floor((e3.inputHeight-12)/20)}).map((e,t)=>(0,n.jsx)("div",{className:(0,l.cn)("flex h-5 items-center justify-center",0===t?"mt-3":""),style:{width:"".concat([45,35,50,60,42,70,48][t%7],"%")},children:(0,n.jsx)(E.E,{className:"h-3 w-full"},t)},"prompt-skeleton-"+t))}):(0,n.jsx)(D.o,{value:ty,resizeFunctionRef:eG,autoFocus:!h,"data-enhancing":tu,className:(0,l.cn)("data-[enhancing=true]:text-shimmer data-[enhancing=true]:animate-shimmer-text w-full flex-1 bg-transparent p-3 pb-1.5 text-sm outline-none ring-0 placeholder:text-gray-500"),id:"chat-main-textarea",maxLength:ee,name:"content",onChange:e=>{tw(e.target.value),tp(!1),tV(e.target.value)},onKeyDown:t9,onPaste:an,placeholder:M||tJ(x?"ask"===tx?"promptForm.askQuestion":"promptForm.askBuild":t3?"promptForm.askRefine":"promptForm.askFollowup"),ref:eW,style:{height:void 0!==tj&&(null==e3?void 0:e3.inputHeight)?"".concat(e3.inputHeight,"px"):"42px",caretColor:tj?"transparent":void 0},spellCheck:!1},tR),(0,n.jsxs)(eH,{className:"p-3",children:[(0,n.jsxs)("div",{className:"flex items-end gap-1.5",children:[f&&(0,n.jsx)("div",{className:"shrink-1 min-w-0 grow-0",children:ti?(0,n.jsx)(ez,{onChange:e=>{var t;tf(e),null==(t=eW.current)||t.focus()}}):(0,n.jsx)(F.o,{onLoggedOutClick:w?void 0:()=>{var e;eZ({prompt:(null==(e=eW.current)?void 0:e.value)||""})},disabled:tO})}),tc&&tR&&!x&&!f?(0,n.jsx)(eV.uu,{}):null,(0,n.jsx)(eM,{thinkingMode:tS,setThinkingMode:tM}),tl&&(0,n.jsx)(y.$,{variant:"outline",className:(0,l.cn)("focus:bg-muted size-7 hover:bg-gray-100 focus-visible:bg-gray-100"),size:"sm",tooltip:{content:null==te?void 0:te.modelPreview,side:"bottom"},disabled:!0,children:(0,n.jsx)(v.n,{})})]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-1",children:[(0,n.jsxs)(i.N,{children:[tr&&(0,n.jsx)(o.P.div,{animate:{opacity:1},className:(0,l.cn)("flex items-center gap-2",tu?"animate-pulse":""),exit:{opacity:0},initial:{opacity:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,n.jsx)(eo,{disabled:tH||tu||th||tO,currentPrompt:ty||"",isSignedIn:w,planSlug:tn,reachedRateLimit:tO,setPrompt:e=>{th||tv(ty||""),tV(e,!0,!0),tp(!0);let t=eW.current;if(!t)return;let a=Math.min(20*Math.floor(e.length/40)+42,200);t.style.height="".concat(a,"px"),t.scrollTop=1e7,t.focus(),t.setSelectionRange(e.length,e.length)},hasEnhancedCurrentPrompt:th,setLoading:tm,handleRevert:()=>{let e=eW.current;if(!e)return;let t=Math.min(20*Math.floor(tg.length/40)+42,200);e.style.height="".concat(t,"px"),e.scrollTop=1e7,e.focus(),e.setSelectionRange(tg.length,tg.length),tV(tg,!0,!0),tp(!1)},recentUserMessages:eL.filter(e=>"user"===e.role&&e.content).slice(-3).map(e=>e.content)})},"enhance-prompt"),to&&(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(eE.Label,{htmlFor:"autopilot-toggle",className:"sr-only",children:"Autopilot Mode"}),(0,n.jsx)("div",{className:"flex items-center space-x-1",children:(0,n.jsx)(y.$,{onClick:e=>{e.preventDefault(),tk(!tN)},variant:"ghost",type:"button",className:"size-7 p-0 transition-all duration-300",tooltip:{className:"pr-1.5",side:"bottom",content:(0,n.jsx)("div",{className:"flex flex-col items-center justify-center gap-1",children:(0,n.jsxs)("span",{className:"text-gray-100",children:["Cook mode"," ",tN?(0,n.jsx)("span",{children:"enabled"}):(0,n.jsx)("span",{children:"disabled"})]})})},children:(0,n.jsx)("span",{className:"text-lg transition-all duration-300 ".concat(tN?"":"grayscale"),children:"\uD83E\uDDD1\uD83C\uDF73"})})})]})]}),(0,n.jsx)(eJ,{disabled:tH||tO||ea,onFileChange:e=>{var t,a;eb(e),null==(t=eW.current)||t.focus(),(0,d.u)("AttachFiles",{count:null==(a=e.target.files)?void 0:a.length,fileNames:Array.from(e.target.files||[]).map(e=>e.name)})},handleFigmaImport:aa,isFigmaLoading:ae,inputFileRef:ej,textAreaRef:eW,uploadFiles:ew,isGenerating:tH||!1,isSignedIn:w,isAnonymous:N,userOnFree:tI}),tH?(0,n.jsxs)(y.$,{className:"ml-auto h-7 shrink-0 rounded-md",disabled:void 0!==ek||eS&&eA.length<2||et,onClick:e=>{e.preventDefault(),a()},size:"sm",type:"button",children:[(0,n.jsx)(g.X,{})," ",tJ("promptForm.stop"),(0,n.jsx)("span",{className:"sr-only",children:tJ("promptForm.stopGeneration")})]}):tO&&!N?(0,n.jsxs)(y.$,{className:"h-7 rounded-md","data-testid":"prompt-form-upgrade-button",onClick:()=>(0,ei.D)({type:"upgradePlan"}),size:"sm",type:"submit",children:[(0,n.jsx)(p.l,{}),(0,n.jsx)("span",{className:"hidden text-sm md:inline",children:tJ("promptForm.upgradePlan")}),(0,n.jsx)("span",{className:"inline text-sm md:hidden",children:tJ("promptForm.upgradePlanMobile")})]}):(0,n.jsxs)(y.$,{className:"ml-1 size-7 rounded-md","data-testid":"prompt-form-send-button",disabled:tq,size:"sm",type:"submit",children:[(0,n.jsx)(m.D,{}),(0,n.jsx)("span",{className:"sr-only",children:tJ("promptForm.sendMessage")})]})]})]})]})]})}),as?(0,n.jsx)("p",{className:"py-2 text-center text-xs text-gray-500",children:tJ("promptForm.disclaimer")}):null]})]})}function eH(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex items-center gap-2",t),...a})}function e$(e){let{quote:t,onClose:a,className:s,shouldNotAnimate:r}=e,i=(0,T.k)();return(0,n.jsx)("div",{className:(0,l.cn)("p-3",s),children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"w-1 shrink-0 self-stretch rounded-full bg-gray-300"}),(0,n.jsx)("div",{className:(0,l.cn)(r?"":"mask-animation","line-clamp-2 flex-1 whitespace-pre-wrap text-sm text-gray-600"),title:t,children:t},"quote-".concat(r)),(0,n.jsxs)(y.$,{className:"m-[3px]",onClick:e=>{e.preventDefault(),a()},rounded:!0,size:"tiny",tooltip:i("promptForm.removeQuote"),variant:"secondary",children:[(0,n.jsx)(w.F,{}),(0,n.jsx)("span",{className:"sr-only",children:i("promptForm.remove")})]})]})})}function eq(e){let{files:t,removeFile:a,showDropzone:s}=e,r=(0,T.k)();return(0,n.jsxs)("div",{className:"no-scrollbar h-16 overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute inset-0 p-3 transition-opacity",style:{opacity:+!!s,pointerEvents:s?"auto":"none"},children:(0,n.jsx)("div",{className:"flex h-10 flex-col items-center justify-center gap-1 rounded-md border border-dashed border-gray-300 p-3 text-center text-xs text-gray-400",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 font-medium text-gray-500",children:[(0,n.jsx)(k.f,{className:"size-3.5"})," ",r("promptForm.dropFilesHere")]})})}),t.length?(0,n.jsx)("div",{className:"flex items-center gap-3 overflow-x-auto p-3 transition-opacity",style:{opacity:+!s},children:t.slice().reverse().map(e=>(0,n.jsx)(eZ,{file:e,onRemoveButtonClicked:()=>a(e.id)},e.id))}):null]})}function eW(e){let{files:t,removeFile:a,showDropzone:s,existingAttachments:l,removeExistingAttachment:c}=e,d=(0,T.k)(),u=(0,r.useMemo)(()=>(l?t.length+l.length:t.length)>0,[t,l]);return(0,n.jsx)("div",{className:"no-scrollbar h-16 w-full flex-1 overflow-auto",children:(0,n.jsx)(i.N,{initial:!1,children:s?(0,n.jsx)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"w-full p-3",children:(0,n.jsx)("div",{className:"flex h-10 flex-col items-center justify-center gap-1 rounded-md border border-dashed border-gray-300 p-3 text-center text-xs text-gray-400",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 font-medium text-gray-500",children:[(0,n.jsx)(k.f,{className:"size-3.5"})," ",d("promptForm.dropFilesHere")]})})},"dropzone"):u?(0,n.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex items-center gap-3 overflow-x-auto p-3",children:[l&&eG(l).map(e=>(0,n.jsx)(eZ,{file:e,onRemoveButtonClicked:()=>null==c?void 0:c(e.url)},e.id)),[...t].reverse().map(e=>(0,n.jsx)(eZ,{file:e,onRemoveButtonClicked:()=>a(e.id)},e.id))]},"attachments"):null})})}let eG=e=>(null==e?void 0:e.map(e=>{var t;return{id:(0,$.$C)(),name:e.name||"Unnamed file",url:e.url,status:"done",size:e.size,v0Type:e.v0Type,isImage:(null==(t=e.contentType)?void 0:t.startsWith("image/"))||!1,isSavedDraft:!0}}))||[];function eZ(e){let{file:t,onRemoveButtonClicked:a,className:s}=e,i="uploading"===t.status,o="compressing"===t.status,[c,d]=(0,r.useState)(!i&&!t.isSavedDraft&&!o),[u,m]=(0,r.useState)(0),[h,p]=(0,r.useState)(0),[f,g]=(0,r.useState)(null),{content:v}=(0,ee.k)(f),[j,b]=(0,r.useState)(!1),k=(0,l.QY)(t.name,18),C=(0,T.k)(),A=(0,n.jsx)(N.Z,{});i||o?A=(0,n.jsx)(I.y,{size:16}):"figma"===t.v0Type?(A=(0,n.jsx)(x.Y,{}),k=k.split(".png")[0]):t.isImage&&(A=(0,n.jsx)(M.default,{alt:t.name,className:"border-alpha-400 aspect-square rounded-sm border object-cover",fill:!0,src:t.url}));let D=(0,l.v7)(t.size);i?D=C("promptForm.uploading"):o&&(D=C("promptForm.compressing"));let L=(0,n.jsx)(y.$,{asChild:!0,className:(0,l.cn)("w-full gap-1 py-1 pl-1 pr-3 text-gray-500 hover:bg-gray-100 focus:bg-gray-100 focus-visible:bg-gray-100"),variant:"secondary",onClick:e=>{b(!0),v||(e.preventDefault(),g(t.url))},children:(0,n.jsxs)("div",{tabIndex:0,children:[(0,n.jsx)("div",{className:(0,l.cn)("flex size-8 shrink-0 -translate-x-px items-center justify-center overflow-hidden rounded-sm bg-gray-100 text-gray-500"),children:A}),(0,n.jsxs)("div",{className:"grid flex-1 gap-1 py-0.5 text-xs leading-none",children:[(0,n.jsx)("div",{className:"overflow-hidden text-ellipsis font-medium",children:k}),(0,n.jsx)("div",{className:"line-clamp-1 font-normal",children:D})]})]})});return(0,n.jsxs)("div",{className:(0,l.cn)("relative h-10 w-[150px] shrink-0",s),children:[t.isImage?(0,n.jsxs)(S.jc,{closeDelay:0,onOpenChange:d,open:c,openDelay:0,children:[(0,n.jsx)(S.d0,{asChild:!0,children:L}),(0,n.jsx)(S.Et,{className:"text-muted w-fit overflow-hidden rounded-xl bg-black p-0.5 text-xs",side:"top",sideOffset:8,children:(0,n.jsx)(M.default,{alt:t.name,className:"h-auto max-h-[300px] w-auto max-w-[300px] rounded-lg object-contain",src:t.url,width:300,height:300,onLoad:e=>{let t=e.target,a=t.naturalWidth/t.naturalHeight,n=.8*window.innerWidth,s=.8*window.innerHeight,r=s*a,l=s;a>1&&(r=n,l=n/a),m(r),p(l)}})})]},t.id):L,(0,n.jsxs)(y.$,{className:(0,l.cn)("absolute right-0 top-0 -translate-y-1/3 translate-x-1/3 hover:bg-gray-100 focus:bg-gray-100 focus-visible:bg-gray-100",i&&"invisible"),onClick:e=>{e.preventDefault(),a()},rounded:!0,size:"tiny",tooltip:C("promptForm.remove"),variant:"secondary",children:[(0,n.jsx)(w.F,{}),(0,n.jsx)("span",{className:"sr-only",children:C("promptForm.remove")})]}),j?(0,n.jsx)(et.pj,{setOpen:b,attachment:t,open:j,width:u,height:h,content:v}):null]})}function eY(e){let{message:t,isContinuing:a,isLoading:s,isStreaming:r}=e,{submit:l}=(0,u.yI)(),i=(0,T.k)(),[o]=(0,L.d)(),c=!!((null==o?void 0:o.remaining)!==void 0&&o.remaining<=0),m=a||s||r;return t&&"assistant"===t.role&&("length"===t.finishReason||a)&&!c?(0,n.jsxs)(y.$,{"aria-label":i("promptForm.continueGeneratingMessage"),className:"absolute -top-10 right-0 flex w-min items-center",disabled:m,onClick:()=>{Promise.all([l({action:"continue",assistantMessageId:t.id}),(0,d.u)("ContinueMessage",{messageId:t.id})])},size:"sm",children:[m&&(0,n.jsx)(I.y,{size:16}),i("promptForm.continueGenerating"),(0,n.jsx)("span",{className:"sr-only",children:i("promptForm.continueGeneratingMessage")})]}):null}function eK(){let e=(0,c.Pk)().chatId,{data:t,mutate:a}=(0,z.Ay)([e,"prompt-form-input"],null);return{promptFormInput:t,setPromptFormInput:(0,r.useCallback)((e,t)=>{a({input:e,doNotClear:t})},[a]),chatId:e}}function eJ(e){let{disabled:t,onFileChange:a,inputFileRef:s,textAreaRef:r,handleFigmaImport:i,isFigmaLoading:o,isGenerating:c,isSignedIn:u,isAnonymous:m,userOnFree:p}=e,{setShowSignInDialog:g}=(0,b.AO)(),{planSlug:v}=(0,K.N)(!0,void 0),[j]=(0,L.d)(),w=!!((null==j?void 0:j.remaining)!==void 0&&j.remaining<=0),{setImportFigmaModalOpen:N}=(0,Z.C)(),k=()=>{var e;g({prompt:(null==(e=r.current)?void 0:e.value)||"",customMessage:m?"To upload files to your chat, create a Vercel account or log into an existing one.":void 0})};return(0,n.jsxs)(eu.DropdownMenu,{children:[(0,n.jsx)(eu.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(y.$,{asChild:!0,className:(0,l.cn)("focus:bg-muted hover:text-foreground ml-[-2px] h-7 w-7 rounded-md hover:bg-gray-100 focus-visible:bg-gray-100",t&&"pointer-events-none bg-gray-100 text-gray-400 ring-0"),disabled:t,size:"sm",tooltip:{content:"Attach images, Figma files, etc.",side:"bottom"},variant:"ghost",children:(0,n.jsx)("span",{children:(0,n.jsx)(f.x,{className:"size-4"})})})}),(0,n.jsx)(eu.DropdownMenuContent,{side:"bottom",align:"end",children:(0,n.jsxs)(eu.DropdownMenuGroup,{children:[(0,n.jsxs)(eu.DropdownMenuItem,{className:"h-8 justify-between px-2 py-1.5",onClick:()=>u?w&&"v0-enterprise"!==v||p?void(0,ei.D)({type:"upgradePlan"}):void((0,d.u)("FigmaModalOpen",{source:"button"}),N({open:!0,onImport:i})):void k(),children:[(0,n.jsxs)("div",{className:"mr-2 flex items-center gap-3",children:[o?(0,n.jsx)(I.y,{size:16}):(0,n.jsx)(x.Y,{}),(0,n.jsx)("span",{children:"Add from Figma"})]}),(0,n.jsx)(em.E,{variant:"teal",size:"sm",children:"Premium"})]}),(0,n.jsx)(eu.DropdownMenuItem,{className:"h-8 px-2 py-1.5",onClick:()=>{var e;if(!u)return void k();null==(e=s.current)||e.click()},children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)(h.b,{}),"Upload from computer"]})})]})}),(0,n.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:c||w,ref:s,type:"file",multiple:!0,onChange:a})]})}},88639:(e,t,a)=>{"use strict";a.d(t,{D:()=>r});var n=a(19434),s=a(25603);function r(){let{data:e,isLoading:t}=(0,s.Ay)("/chat/api/projects",n.GO);return{projects:e,isReady:!t&&void 0!==e}}},88684:(e,t,a)=>{"use strict";a.d(t,{k:()=>y});var n=a(97667),s=a(23687),r=a(54810),l=a(4608),i=a(94719),o=a(65717),c=a(37294),d=a(69894),u=a(5518),m=a(35501),h=a.n(m),p=a(33571),x=a(84618),f=a(50206),g=a(41956),v=a(91981);function j(e,t){switch(t.type){case"submit":return{...e,status:"submitting"};case"added":return{...e,status:"new-card"};case"go-to-add-new":return{...e,status:"add-new"};case"go-to-use-existing":return{...e,status:"use-existing",paymentMethod:t.paymentMethod}}}let b=[[302,383],[522,304],[1/0,227]];function y(e){var t,a;let{paymentMethod:d,noPrefix:u,billingDetails:m}=e,[f,y]=(0,p.useReducer)(j,d?{status:"use-existing",paymentMethod:d}:{status:"add-new"}),{windowSize:N}=(0,g.lW)(),k=null!=(a=null==(t=b.find(e=>{var t;return(null!=(t=N.width)?t:1e3)<e[0]}))?void 0:t[1])?a:230,C=(0,c.useStripe)(),S=(0,c.useElements)(),{toast:M}=(0,x.dj)(),[I,A]=(0,p.useState)(!1),D=(0,v.Y)(),L=(0,o.c)({action:l.i}),z=(0,o.c)({action:i.h}),E="add-new"===f.status,P=(0,p.useCallback)(async e=>{if(!E||!C||!S)return null;try{y({type:"submit"});let t=await S.submit();if(t.error)throw t.error;let{client_secret:a}=await L.submit(e?{teamSlug:e}:void 0),n=await C.confirmSetup({elements:S,clientSecret:a,redirect:"if_required",confirmParams:{return_url:window.location.href,payment_method_data:{allow_redisplay:"always",billing_details:m}}});if(n.error)throw n.error;if(n.setupIntent.payment_method){let t="string"==typeof n.setupIntent.payment_method?n.setupIntent.payment_method:n.setupIntent.payment_method.id,a=await z.submit({paymentMethod:t,...e?{teamSlug:e}:void 0});return y({type:"added"}),a.paymentMethod}}catch(e){var t;null==(t=S.getElement("card"))||t.focus(),y({type:"go-to-add-new"}),function(e,t){let{code:a,message:s}=Object(t),l=!a;throw e({description:l?"An unknown error occurred. Please contact support.":s,action:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Qg,{altText:"Dismiss",variant:l?"secondary":"default",children:"Dismiss"}),l?(0,n.jsx)(r.Qg,{altText:"Contact Support",asChild:!0,children:(0,n.jsx)(h(),{href:"https://vercel.com/help",target:"_blank",children:"Contact Support"})}):null]}),duration:1/0,variant:"destructive"}),t}(M,e)}return null},[L,S,E,C,M,z]);return(0,p.useMemo)(()=>{switch(f.status){case"use-existing":return{status:"use-existing",form:(0,n.jsx)(w,{onAddNewCard:()=>y({type:"go-to-add-new"}),paymentMethod:f.paymentMethod,noPrefix:u})};case"add-new":case"submitting":case"new-card":return{status:f.status,form:(0,n.jsxs)("div",{style:{backgroundColor:D?"black":"white",...I?{minHeight:"".concat(k,"px")}:{height:"".concat(k,"px")}},children:[(0,n.jsx)(c.PaymentElement,{onReady:()=>A(!0),options:{terms:{card:"never"},wallets:{googlePay:"never",applePay:"never"},defaultValues:{billingDetails:m?{name:m.name,email:m.email}:void 0}}}),(0,n.jsxs)(s.Z,{children:[(0,n.jsx)("form",{...L.props}),(0,n.jsx)("form",{...z.props})]})]}),submit:P,useExisting:d?()=>y({type:"go-to-use-existing",paymentMethod:d}):void 0}}},[f.status,f.paymentMethod,I,k,L.props,z.props,P,u,d])}function w(e){let{paymentMethod:t,onAddNewCard:a,noPrefix:s}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[s?null:(0,n.jsx)("div",{className:"text-sm",children:"Use your Vercel account's default payment method or add a new one."}),(0,n.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-blue-700 bg-white p-4",children:[(0,n.jsxs)("span",{className:"flex items-center gap-4 text-sm",children:[(0,n.jsx)(f.d,{brand:t.brand}),(0,n.jsxs)("span",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{className:"text-xs",children:""}),(0,n.jsx)("span",{children:t.last4})]})]}),(0,n.jsx)(d.A,{className:"h-4 w-4 rounded-full bg-blue-700 p-0.5 text-white",size:16})]}),(0,n.jsxs)("button",{className:"flex items-center gap-2 text-sm text-blue-700",onClick:a,type:"button",children:[(0,n.jsx)(u.A,{size:16}),(0,n.jsx)("span",{children:"Use a different payment method"})]})]})}},89129:(e,t,a)=>{"use strict";a.d(t,{m:()=>r});var n=a(33571);let s=(e,t)=>({left:window.screenX+(window.outerWidth-e)/2,top:window.screenY+(window.outerHeight-t)/2});function r(e){let{url:t,width:a=600,height:r=700,title:l="Authentication",onClose:i,onMessage:o,onPoll:c}=e,[d,u]=(0,n.useState)(null),[m,h]=(0,n.useState)(!1),p=(0,n.useCallback)(()=>{if(d&&!d.closed)return void d.focus();let{left:e,top:n}=s(a,r),i=window.open(t,l,"width=".concat(a,",height=").concat(r,",left=").concat(e,",top=").concat(n,",resizable=yes,scrollbars=yes,status=yes"));i?(u(i),h(!0)):console.error("Failed to open popup. It might have been blocked by the browser.")},[t,l,a,r,d,s]),x=(0,n.useCallback)(()=>{d&&!d.closed&&d.close(),u(null),h(!1)},[d]);return(0,n.useEffect)(()=>{let e=e=>{var t;o&&o(e),(null==(t=e.data)?void 0:t.type)==="auth-complete"&&x()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[x,o]),(0,n.useEffect)(()=>{if(!d)return;let e=setInterval(()=>{d.closed&&(clearInterval(e),h(!1),u(null),i&&i())},500);return()=>{clearInterval(e)}},[d,i]),(0,n.useEffect)(()=>{if(!d||!c)return;let e=setInterval(()=>{try{c(d)}catch(t){console.warn("Error accessing popup window location, may be cross-origin:",t),clearInterval(e)}},500);return()=>{clearInterval(e)}},[d,c]),{isOpen:m,open:p,close:x,popupWindow:d}}},89385:(e,t,a)=>{"use strict";a.d(t,{k:()=>r});var n=a(13729),s=a(2066);function r(e){let{data:t,isLoading:a,error:r}=(0,s.A)(e||null,e=>fetch("/chat/api/chat/download?url=".concat(e)).then(e=>e.text()));return r&&n.o.error("Failed to load file content"),{content:t,isLoading:a}}},89547:(e,t,a)=>{"use strict";a.d(t,{y:()=>te});var n=a(97667),s=a(33571),r=a(80672),l=a(91211),i=a(57560),o=a(141),c=a(94282),d=a(70073),u=a(93187),m=a(32095),h=a(30230);function p(e){if(!e)return null;let t=e.replace(/\s+/g,"-");return"@"!==(t=(t=t.replace(/[\x00-\x1F\x7F~^\:\?\*\[\\\@\{]/g,"")).replace(/\.{2,}/g,"."))&&(t=t.replace(/^\.|\.$/g,""))?t:null}let x=new Map,f=(0,o.G)(x,()=>({isOpen:(0,i.eU)(!1),stageIntent:(0,i.eU)(null),isAutoSyncEnabled:(0,i.eU)(!1),createBranchName:(0,i.eU)(null),createBranchNameError:(0,i.eU)(null),selectedBranch:(0,i.eU)(null),selectedGitNamespaceName:(0,i.eU)(null),createRepoName:(0,i.eU)(null),createRepoNameError:(0,i.eU)(null),asyncActionLoading:(0,i.eU)(null),lastSyncedCommitSha:(0,i.eU)(null),isRefreshingGitHead:(0,i.eU)(!1),timeSinceLastSync:(0,i.eU)(null),switchBranchTarget:(0,i.eU)(null)})),g=new Map,v=(0,o.G)(g,(e,t)=>{let a=f(e),n=(0,d.jP)(e),s=(0,m.Nt)(),r=(0,h.Ig)(t),l=(0,i.eU)(e=>{let t=e(a.createBranchName);return!!t&&t===p(t)}),o=(0,i.eU)(e=>{let t=e(n.externalMeta);return t.git&&t.git.gitConnected&&t.git.ref?t.git.ref:null});return{...a,latestProjectGit:r.latestGit,externalChatMeta:n.externalMeta,gitNamespaces:s.gitNamespaces,stage:(0,i.eU)(e=>{let t=e(n.externalMeta);if(t.error&&t.error!==u.p2)return"error";if(!t.git){if(e(s.gitNamespaces).error)return"error";let t=e(s.gitNamespaces);return t.verifiedGitHubUser?t.userNamespace?"create-repo":"install-app":"sign-in"}let r=e(a.stageIntent);return e(o)?r||(t.git.gitConnected?"status":"select-branch"):"create-branch"===r?"create-branch":"select-branch"}),allBranches:(0,i.eU)(e=>{var t,a;let n=e(r.latestGit);if(n.error)return[];let s=e(o);return(null!=(a=null==(t=n.branches)?void 0:t.map(e=>e.name))?a:[]).sort((e,t)=>e===s?-1:+(t===s))}),isConnectedToGit:(0,i.eU)(e=>!!e(n.externalMeta).git),disableAsyncAction:(0,i.eU)(e=>e(n.isStreaming)),currentBranch:o,isAbleToCreateBranch:(0,i.eU)(e=>"creating-branch"!==e(a.asyncActionLoading)&&e(l)&&null!==e(a.createBranchName)),isNewBranchNameValid:l}}),j=null;function b(e){let t=f(e);return{setIsOpen:e=>c.M.set(t.isOpen,e),setStageIntent:e=>{j&&clearTimeout(j),c.M.set(t.stageIntent,e)},resetStageOnDelay:()=>{j&&clearTimeout(j),j=setTimeout(()=>{c.M.set(t.stageIntent,null)},1e3)},setAsyncActionLoading:e=>c.M.set(t.asyncActionLoading,e),setIsAutoSyncEnabled:e=>c.M.set(t.isAutoSyncEnabled,e),updateCreateBranchName:e=>{let a=p(e);c.M.set(t.createBranchName,a),c.M.set(t.createBranchNameError,null)},setCreateBranchNameError:e=>c.M.set(t.createBranchNameError,e),setSelectedBranch:e=>c.M.set(t.selectedBranch,e),setCreateRepoName:e=>{c.M.set(t.createRepoName,e),c.M.set(t.createRepoNameError,null)},setCreateRepoNameError:e=>c.M.set(t.createRepoNameError,e),setSelectedGitNamespaceName:e=>c.M.set(t.selectedGitNamespaceName,e),setLastSyncedCommitSha:e=>c.M.set(t.lastSyncedCommitSha,e),updateIsRefreshingGitHead:e=>{e&&c.M.set(t.timeSinceLastSync,Date.now()),c.M.set(t.isRefreshingGitHead,e)},setSwitchBranchTarget:e=>c.M.set(t.switchBranchTarget,e)}}function y(e,t){return!!(e&&t.includes(e))}var w=a(66692),N=a(53849),k=a(80574),C=a(77635),S=a(36323),M=a(13729),I=a(11322),A=a(19434),D=a(61112);let L=e=>{let{status:t="none"}=e;return"none"===t?(0,n.jsx)(D.P,{}):(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsxs)("g",{clipPath:"url(#clip)",children:[(0,n.jsx)("path",{d:"M7.99951 0.000366211C12.4194 0.000366211 15.9994 3.57903 15.9995 7.99744C15.9993 8.73285 15.8971 9.45983 15.7007 10.1595C15.0695 9.74288 14.3134 9.50046 13.5005 9.50037C13.2446 9.50037 12.994 9.52476 12.7515 9.57068C12.9836 9.05393 13.1196 8.40228 13.1196 7.57751C13.1196 6.69794 12.8093 5.98785 12.2993 5.4281C12.3795 5.22766 12.6589 4.40796 12.2192 3.30896C12.1956 3.3017 11.5216 3.10824 10.019 4.12927C9.37924 3.94946 8.6988 3.85876 8.01904 3.85876C7.33935 3.85885 6.65875 3.94942 6.01904 4.12927C4.50987 3.11373 3.83765 3.30364 3.81982 3.30896C3.3803 4.40782 3.6596 5.2277 3.73975 5.4281C3.23003 5.98779 2.9195 6.70816 2.91943 7.57751C2.91958 10.6357 4.7794 11.3267 6.55908 11.5267C6.3294 11.7268 6.11923 12.0769 6.04932 12.5961C5.58888 12.806 4.43889 13.1448 3.71924 11.9359C3.569 11.6958 3.11926 11.1067 2.48975 11.1166C1.82056 11.1267 2.21959 11.4969 2.49951 11.6469C2.8394 11.8369 3.22974 12.5457 3.31982 12.7758C3.47988 13.2256 4.00022 14.0856 6.00928 13.7162C6.00929 14.3857 6.01904 15.0156 6.01904 15.2054C6.01876 15.4152 5.86886 15.6552 5.46924 15.5853C2.2896 14.5256 -0.000331454 11.5359 -0.000488281 7.99744C-0.000368517 3.57919 3.5798 0.000613049 7.99951 0.000366211Z",fill:"currentColor"}),(0,n.jsx)("circle",{cx:"13.5",cy:"13.5",r:"2.5",className:(0,A.cn)("transition-all duration-300","synced"===t&&"fill-green-500","syncing"===t&&"fill-gray-400","error"===t&&"fill-red-500")})]})},"git-sync-icon")},z=(0,I.G4)('<path d="M3.95326 7.55195L4.48353 8.08223L3.1349 9.43086C2.18706 10.3794 2.18681 11.9171 3.1349 12.8654C4.08338 13.8137 5.62192 13.8136 6.57045 12.8654L7.91908 11.5168L8.97962 12.5773L7.63099 13.926C6.09668 15.46 3.60862 15.4601 2.07435 13.926C0.540479 12.3918 0.540731 9.90462 2.07435 8.37031L3.42298 7.0207L3.95326 7.55195ZM13.0255 11.966L11.965 13.0266L2.97377 4.03535L4.03431 2.9748L13.0255 11.966ZM8.3683 2.07539C9.90253 0.541161 12.3906 0.541391 13.9249 2.07539C15.4589 3.60964 15.4588 6.09677 13.9249 7.63105L12.5763 8.98066L12.046 8.44941L11.5158 7.91914L12.8644 6.57051C13.8125 5.62201 13.8126 4.0844 12.8644 3.13594C11.9158 2.18773 10.3773 2.18749 9.42884 3.13594L8.08021 4.48457L7.01966 3.42402L8.3683 2.07539Z" fill="currentColor"/>');function E(e){let{chatId:t,...a}=e,r=b(t),l=(0,S.eu)(),i=(0,C.S)({chatId:t,activeBlock:l}),[o,c]=(0,s.useState)(!1),d=(0,s.useCallback)(async()=>{if(!o)try{c(!0),await i(),r.setIsOpen(!0)}catch(e){M.o.error("Failed to create project")}finally{c(!1)}},[r,i,o]);return(0,n.jsx)(F,{...a,onClick:d,disabled:o,tooltip:"Connect to GitHub",children:(0,n.jsx)(N._r,{...N.fG.buttonContent,children:(0,n.jsx)(L,{})})})}function P(){return(0,n.jsx)(F,{disabled:!0,tooltip:{side:"bottom",content:"Loading GitHub connection"},children:(0,n.jsx)(L,{})})}function T(e){let{chatId:t,projectId:a,...l}=e,i=v(t,a),o=(0,r.useAtomValue)(i.asyncActionLoading),c=(0,r.useAtomValue)(i.isConnectedToGit),d=(0,r.useAtomValue)(i.currentBranch),{error:u}=(0,r.useAtomValue)(i.externalChatMeta),m=y(o,["sign-in","install-app","create-repo"]),h="".concat(m,"-").concat(c),p=(0,s.useMemo)(()=>y(o,["sign-in","install-app","create-repo"])?(0,n.jsx)(k.y,{size:16}):u?(0,n.jsx)(L,{status:"error"}):c?y(o,["pushing-to-branch","selecting-branch","switching-branch"])||!d?(0,n.jsx)(L,{status:"syncing"}):(0,n.jsx)(L,{status:"synced"}):(0,n.jsx)(L,{}),[o,d,u,c]);return(0,n.jsxs)(F,{tooltip:{side:"bottom",content:c&&d?"Connected to ".concat(d):"Connect to branch"},...l,children:[(0,n.jsx)(N._r,{...N.fG.buttonContent,renderKey:h,children:p}),(0,n.jsx)("span",{className:"sr-only",children:c?"Synced to ".concat(d):"Connect to branch"})]})}function F(e){let{children:t,...a}=e;return(0,n.jsx)(w.$,{size:"sm",variant:"secondary",className:"h-7 w-7 rounded-md",...a,children:t})}var R=a(25887),U=a(20125);function V(e){let{children:t,className:a}=e;return(0,n.jsx)("div",{className:(0,A.cn)("flex w-full flex-row justify-between gap-3 px-4 pb-4 [&>*]:flex-1",a),children:t})}function B(e){let{children:t,className:a,key:s}=e;return(0,n.jsx)("div",{className:(0,A.cn)("flex w-full flex-col gap-4 overflow-hidden p-4",a),children:t},s)}function _(e){let{children:t,className:a}=e;return(0,n.jsx)("div",{className:(0,A.cn)("flex flex-col gap-2",a),children:t})}function O(){return(0,n.jsx)(U.Tooltip,{content:"Git Sync is in beta. Click to share feedback.",children:(0,n.jsx)("button",{tabIndex:-1,className:"text border-alpha-200 hover:border-alpha-400 flex h-5 items-center justify-center overflow-hidden whitespace-nowrap rounded-full border px-1.5 text-[11px] font-medium text-gray-500 transition-all hover:bg-gray-200",type:"button",onClick:()=>(0,R.D)({type:"feedback"}),children:"Beta"})})}var H=a(70158),$=a(99772),q=a(89129),W=a(20630),G=a(35129),Z=a(48985),Y=a(70676);let K=(0,Y.createServerReference)("405a0903712188b18cc45ea1bfd775fe6ae4af7ee3",Y.callServer,void 0,Y.findSourceMapURL,"syncGitBranchToChat");var J=a(74118),Q=a(67121),X=a(19243);let ee=(0,Y.createServerReference)("60912d13843c52add33589aed45b03c8468b0e3c37",Y.callServer,void 0,Y.findSourceMapURL,"updateGitAutoCommit"),et=(0,Y.createServerReference)("60e38a397d32ec4d0be3bd39ee2b36432d1a6ff394",Y.callServer,void 0,Y.findSourceMapURL,"updateGitBranchConnection");function ea(e){let{chatId:t,projectId:a}=e,n=(0,H.useRouter)(),l=v(t,a),i=b(t),o=(0,r.useAtomValue)(l.stage),c=(0,r.useAtomValue)(l.asyncActionLoading),d=(0,r.useAtomValue)(l.currentBranch),u=(0,r.useAtomValue)(l.createRepoName),m=(0,r.useAtomValue)(l.createBranchName),h=(0,r.useAtomValue)(l.switchBranchTarget),p=(0,r.useAtomValue)(l.isNewBranchNameValid),x=(0,r.useAtomValue)(l.isConnectedToGit),f=(0,r.useAtomValue)(l.selectedGitNamespaceName),{git:g}=(0,r.useAtomValue)(l.externalChatMeta),{userNamespace:j,verifiedGitHubUser:y}=(0,r.useAtomValue)(l.gitNamespaces),w=(0,S.eu)(),N=(0,C.S)({chatId:t,activeBlock:w}),{activeForkKey:k}=(0,J.Pk)(),{revalidate:I,mutate:A}=(0,W.B)(["chat","externalMeta"],{chatId:t},{stopFetch:!0}),{revalidate:D}=(0,W.B)(["scoped","gitNamespaces"],{},{stopFetch:!0}),{revalidate:L}=(0,W.B)(["project","latestGit"],{projectId:a},{stopFetch:!0}),z="/chat/git/connected",E=window.location.origin+"/chat/git/callback",P="https://vercel.com/api/registration/login-with-github?next=".concat(encodeURIComponent(E)),T={next:"".concat(window.location.origin,"/github/installed")},F=(0,$.v)(JSON.stringify(T)),U=y?"https://github.com/apps/vercel/installations/new/permissions?target_id=".concat(y.userId,"&target_type=User&state=").concat(encodeURIComponent(F)):"",V=(0,s.useCallback)(async e=>{await Promise.all([D(),L(),I()]),null==e||e()},[D,L,I]),{open:B}=(0,q.m)({url:P,onPoll:e=>{e.location.pathname===z&&V(()=>{e.close(),i.setAsyncActionLoading(null)})},onClose:()=>{i.setAsyncActionLoading(null),D()}}),{open:_}=(0,q.m)({url:U,onPoll:e=>{e.location.pathname===z&&V(()=>{e.close(),i.setAsyncActionLoading(null)})},onClose:()=>{i.setAsyncActionLoading(null),D()}}),O=(0,s.useCallback)(()=>{if("sign-in"===c)return void M.o.error("Sign in already in progress");i.setAsyncActionLoading("sign-in"),B()},[B,i,c]),Y=(0,s.useCallback)(()=>{if("install-app"===c)return void M.o.error("App installation already in progress");i.setAsyncActionLoading("install-app"),_()},[_,i,c]),ea=(0,s.useCallback)(async()=>{try{if(a||await N(),!((null==j?void 0:j.name)&&j.ownerType))return void M.o.error("Repo owner not specified");if(!(null==w?void 0:w.id))return void M.o.error("You need to be viewing a block to create a repository");if(!u)return void M.o.error("Please enter a repository name");if(!f)return void M.o.error("Please select a Git scope");let e=await fetch("/chat/api/git/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({owner:f,repoName:u,projectId:a,blockId:w.id})});if(!e.ok){let t=await e.json();if("repo_alr_exists"===t.error)return void i.setCreateRepoNameError("Repository already exists. Try a new name.");throw Error("Failed to create repository.")}await V();let t=j.name&&u?"https://github.com/".concat(j.name,"/").concat(u):void 0;M.o.default("GitHub Connected",{description:"Click to view your repository",action:t?{children:"View",onClick:()=>{window.open(t,"_blank")}}:void 0})}catch(t){let e=t instanceof Error?t.message:"Failed to create repository";M.o.error(e)}finally{i.setAsyncActionLoading(null)}},[a,null==j?void 0:j.name,null==j?void 0:j.ownerType,null==w?void 0:w.id,u,f,V,N,i]),en=(0,s.useCallback)(async e=>{let n=null==w?void 0:w.id;if(!n)return void M.o.error("No block selected");(0,X.u)("GitSyncPushToBranch",{chatId:t,projectId:a,blockId:n,branch:e});try{await A({serverMutate:(async()=>{await (0,Z.k)({blockId:n,skipDeploy:!0,branch:e})})(),optimisticData:{git:{...g,ref:e,gitConnected:!0}}}),await V(),"create-branch"===o&&(i.setStageIntent(null),i.updateCreateBranchName(null))}catch(n){let e=n instanceof Error?n.message:"Failed to push changes";M.o.error(e),(0,X.u)("GitSyncError",{chatId:t,projectId:a,action:"push-to-branch",error:e})}},[null==w?void 0:w.id,A,g,V,o,i,t,a]),es=(0,s.useCallback)(async()=>{if(!m)return void i.setCreateBranchNameError("Please enter a branch name");if(!p)return void i.setCreateBranchNameError("Branch name can only contain letters, numbers, dashes, and underscores");(0,X.u)("GitSyncCreateBranch",{chatId:t,projectId:a,blockId:null==w?void 0:w.id,branchName:m});try{if(null==w?void 0:w.id){i.setCreateBranchNameError(null);let e=await (0,G.O)(w.id);"string"==typeof e&&(i.setIsOpen(!1),i.setStageIntent(null),M.o.success("Forked chat, creating branch '".concat(m,"'...")),n.push("/chat/".concat(e,"?assignBranch=").concat(encodeURIComponent(m))),i.updateCreateBranchName(null))}else throw Error("No block selected")}catch(n){let e=n instanceof Error?n.message:"Failed to create branch";i.setCreateBranchNameError(e),M.o.error(e),(0,X.u)("GitSyncError",{chatId:t,projectId:a,action:"create-branch",error:e})}},[m,p,i,null==w?void 0:w.id,n,t,a]),er=(0,s.useCallback)(async()=>{try{if(!h)return void M.o.error("No branch selected");(0,X.u)("GitSyncSwitchBranch",{chatId:t,projectId:a,fromBranch:d,toBranch:h}),i.resetStageOnDelay(),await A({serverMutate:(async()=>{await K({chatId:t,forkKey:k,branch:h})})(),optimisticData:{git:{...g,ref:h,gitConnected:!0}}}),await Promise.all([D(),L()])}catch(n){i.setStageIntent("switch-branch-confirmation");let e=n instanceof Error?n.message:"Failed to switch branch";M.o.error(e),(0,X.u)("GitSyncError",{chatId:t,projectId:a,action:"switch-branch",error:e})}},[h,t,a,d,i,A,g,D,L,k]),el=(0,s.useCallback)(async e=>{(0,X.u)("GitSyncSelectBranch",{chatId:t,projectId:a,branch:e});try{await K({chatId:t,forkKey:k,branch:e}),await V()}catch(n){let e=n instanceof Error?n.message:"Failed to sync to branch";M.o.error(e),(0,X.u)("GitSyncError",{chatId:t,projectId:a,action:"select-branch",error:e})}},[t,k,V,a]),ei=(0,s.useCallback)(async e=>{try{(0,X.u)("GitSyncToggleAutoCommit",{chatId:t,projectId:a,blockId:null==w?void 0:w.id,enabled:e}),await A({serverMutate:(async()=>{await ee(t,e)})(),optimisticData:{git:{...g,autoCommit:e}}}),i.setIsAutoSyncEnabled(e),await V(),M.o.success("Auto-commit ".concat(e?"enabled":"disabled"))}catch(n){let e=n instanceof Error?n.message:"Failed to toggle auto-commit";M.o.error(e),(0,X.u)("GitSyncError",{chatId:t,projectId:a,action:"toggle-auto-commit",error:e})}},[t,a,null==w?void 0:w.id,A,g,i,V]),eo=(0,s.useCallback)(async e=>{try{(0,X.u)("GitSyncUnlinkBranch",{chatId:t,projectId:a,branch:d}),await A({serverMutate:(async()=>{await et(t,e)})(),optimisticData:{git:{...g,gitConnected:e}}}),i.setIsOpen(!1),await V(),M.o.success("Branch unlinked from chat")}catch(n){let e=n instanceof Error?n.message:"Failed to unlink branch";M.o.error(e),(0,X.u)("GitSyncError",{chatId:t,projectId:a,action:"unlink-branch",error:e})}},[t,a,d,A,g,i,V]),ec=(0,s.useCallback)(()=>{i.setIsOpen(!1),(0,R.D)({type:"feedback",data:{feedback:"I'm having trouble with the Git sync feature in chat: ".concat(t),sentiment:"bad"}})},[i,t]);function ed(e,t){return async function(){for(var a=arguments.length,n=Array(a),s=0;s<a;s++)n[s]=arguments[s];if(e===c)return(0,Q.$)("git-async-action-".concat(e),1e4,()=>M.o.error("Git operation already in progress",{description:e}));i.setAsyncActionLoading(e);try{return await t(...n)}finally{i.setAsyncActionLoading(null)}}}return{handleRetry:(0,s.useCallback)(()=>{n.refresh()},[n]),handleReport:ec,handleSignInToGitHub:O,handleConnectAppGitHub:Y,handleSelectBranch:ed("selecting-branch",el),handleSwitchBranch:ed("switching-branch",er),handleCreateRepo:ed("create-repo",ea),handleCreateBranch:ed("creating-branch",es),handlePushToBranch:ed("pushing-to-branch",en),handleToggleAutoCommit:ed("toggle-auto-commit",ei),handleUpdateBranchConnection:ed("updating-branch-connection",eo),isConnectedToGit:x}}var en=a(61182),es=a(41199);function er(e){let{chatId:t,projectId:a}=e,s=v(t,a),l=(0,r.useAtomValue)(s.asyncActionLoading),{handleSignInToGitHub:i}=ea({chatId:t,projectId:a}),o="sign-in"===l;return(0,n.jsxs)("form",{id:"sign-in-form",onSubmit:function(e){e.preventDefault(),i()},children:[(0,n.jsx)(B,{children:(0,n.jsx)(es.M,{title:"Sign in with GitHub",titleSuffix:(0,n.jsx)(O,{}),children:"To connect this project to a GitHub repository, you need to sign in with your GitHub account."})}),(0,n.jsx)(V,{children:(0,n.jsx)(w.$,{size:"sm",type:"submit",disabled:o,children:(0,n.jsx)(en.V,{isLoading:o,loading:"Signing in",children:"Sign in"})})})]})}function el(e){let{chatId:t,projectId:a}=e,s=v(t,a),l=(0,r.useAtomValue)(s.asyncActionLoading),{handleConnectAppGitHub:i}=ea({chatId:t,projectId:a}),o="install-app"===l;return(0,n.jsxs)("form",{id:"install-app-form",onSubmit:function(e){e.preventDefault(),i()},children:[(0,n.jsx)(B,{children:(0,n.jsx)(es.M,{title:"Install GitHub App",titleSuffix:(0,n.jsx)(O,{}),children:"Install Vercel GitHub App on your personal GitHub account to create a repository."})}),(0,n.jsx)(V,{children:(0,n.jsx)(w.$,{size:"sm",type:"submit",disabled:o,children:(0,n.jsx)(en.V,{isLoading:o,loading:"Installing App",children:"Install Vercel App"})})})]})}var ei=a(49848),eo=a(6902),ec=a(35501),ed=a.n(ec),eu=a(91220);function em(e){let{chatId:t,projectId:a}=e,s=v(t,a),l=b(t),i=(0,r.useAtomValue)(s.asyncActionLoading),o=(0,r.useAtomValue)(s.createRepoName),c=(0,r.useAtomValue)(s.createRepoNameError),d=(0,r.useAtomValue)(s.selectedGitNamespaceName),u=(0,r.useAtomValue)(s.disableAsyncAction),{handleCreateRepo:m}=ea({chatId:t,projectId:a}),{userNamespace:h,orgNamespaces:p}=(0,r.useAtomValue)(s.gitNamespaces),x="create-repo"===i,f=e=>{l.setSelectedGitNamespaceName(e)};return(0,n.jsxs)("form",{id:"create-repo-form",onSubmit:function(e){e.preventDefault(),m()},children:[(0,n.jsxs)(B,{children:[(0,n.jsxs)(es.M,{title:"Create Repository",titleSuffix:(0,n.jsx)(O,{}),children:["Create a new"," ",(0,n.jsx)(ed(),{href:"https://docs.github.com/en/repositories/creating-and-managing-repositories/about-repositories",className:"text-blue-700 hover:underline",target:"_blank",children:"private repository"})," ","to sync changes to. v0 will push changes to a branch on this repository each time you send a message."]}),(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)(_,{children:[(0,n.jsx)(eo.Label,{children:"Git Scope"}),(0,n.jsxs)(eu.l6,{value:null!=d?d:"",disabled:x,onValueChange:e=>f(e),children:[(0,n.jsx)(eu.bq,{className:"h-8 transition-colors hover:bg-gray-100",children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,n.jsx)(D.P,{}),(0,n.jsx)(N._r,{...N.fG.inputSwitch,renderKey:"".concat(d),children:null!=d?d:"Select Git Scope"})]})}),(0,n.jsxs)(eu.gC,{children:[h&&(0,n.jsx)(eu.eb,{value:h.slug,children:h.name}),null==p?void 0:p.map(e=>{var t;return(0,n.jsx)(eu.eb,{value:e.slug,children:null!=(t=e.name)?t:e.slug},e.id)})]})]})]}),(0,n.jsxs)(_,{children:[(0,n.jsx)(eo.Label,{htmlFor:"create-repo-name",children:"Repository Name"}),(0,n.jsx)(ei.p,{id:"create-repo-name",size:"sm",placeholder:"your-repo-name",onChange:e=>{l.setCreateRepoName(e.target.value)},disabled:x,error:c})]})]})]}),(0,n.jsx)(V,{children:(0,n.jsx)(w.$,{size:"sm",type:"submit",form:"create-repo-form",disabled:x||!o||u,children:(0,n.jsx)(en.V,{isLoading:x,loading:"Creating Repository",children:"Create Repository"})})})]})}function eh(e){let{chatId:t,disabled:a,children:s="Cancel"}=e,r=b(t);return(0,n.jsx)(w.$,{size:"sm",variant:"secondary",type:"button",onClick:()=>r.setStageIntent(null),disabled:a,children:s})}function ep(e){let{chatId:t,projectId:a}=e,l=v(t,a),i=b(t),o=(0,r.useAtomValue)(l.currentBranch),c=(0,r.useAtomValue)(l.createBranchName),d=(0,r.useAtomValue)(l.createBranchNameError),u=(0,r.useAtomValue)(l.asyncActionLoading),m=(0,r.useAtomValue)(l.disableAsyncAction),{handleCreateBranch:h,handlePushToBranch:p}=ea({chatId:t,projectId:a}),x="creating-branch"===u||"pushing-to-branch"===u,f=(0,r.useAtomValue)(l.isAbleToCreateBranch),g=(0,s.useRef)(null);(0,s.useEffect)(()=>{g.current&&g.current.focus()},[]);let j=(0,s.useMemo)(()=>o?"Fork this chat onto a new branch and automatically start syncing changes with GitHub.":"Create and push to a new branch to automatically start syncing changes with GitHub.",[]);return(0,n.jsxs)("form",{id:"create-branch-form",onSubmit:function(e){e.preventDefault(),o?h():c?p(c):i.setCreateBranchNameError("Please enter a branch name")},children:[(0,n.jsxs)(B,{children:[(0,n.jsx)(es.M,{title:"Create a new branch",titleSuffix:(0,n.jsx)(O,{}),children:j}),(0,n.jsx)(ei.p,{value:c||"",onChange:e=>i.updateCreateBranchName(e.target.value),placeholder:"your-new-feature",size:"sm",disabled:x,error:d,ref:g})]}),(0,n.jsxs)(V,{children:[(0,n.jsx)(eh,{chatId:t,disabled:x}),(0,n.jsx)(w.$,{type:"submit",size:"sm",disabled:!f||x||m,children:(0,n.jsx)(en.V,{isLoading:x,loading:"Creating Branch",children:"Create Branch"})})]})]})}var ex=a(16979),ef=a(81657),eg=a(81614),ev=a(68163),ej=a(44812),eb=a(90654),ey=a(28819),ew=a(17773),eN=a(15353),ek=a(89371),eC=a(20393),eS=a(27831),eM=a(93660);let eI="flex h-7 items-center gap-2 duration-0 ";function eA(e){let{items:t,getItemId:a,getItemValue:r,selectedItemId:l,error:i,renderItem:o,onItemSelect:c,placeholder:d="Search...",emptyState:u="No items found",children:m,loading:h,childClassName:p,height:x=128,filterFunction:f,hideListWhenEmpty:g,searchTerm:v,onSearchChange:j,className:b,disabled:y=!1}=e,[w,k]=(0,s.useState)(""),C=void 0!==v?v:w,S=C?t.filter(e=>f?f(e,C):r(e).toLowerCase().includes(C.toLowerCase())):t,M=0===S.length,I=!!(g&&M&&!h);return(0,n.jsxs)(ek.uB,{className:(0,ey.cn)("text-label-14 flex flex-col",b),children:[(0,n.jsx)(ek.G7,{placeholder:d,onValueChange:e=>{j?j(e):k(e)},value:C,className:"h-10",divClassName:"px-3 gap-2",disabled:y,icon:(0,n.jsx)(eN.v,{})}),(0,n.jsx)("div",{className:(0,ey.cn)("relative flex flex-col overflow-hidden"),style:{height:I?0:x,...(0,eC.o)(!I),...(0,eS.iA)(["height"])},children:h?(0,n.jsx)(ek.oI,{tabIndex:-1,className:"overflow-y-hidden",children:(0,n.jsx)(ek.L$,{children:(0,n.jsx)("div",{className:"flex h-full flex-col items-center justify-center [mask-image:linear-gradient(to_bottom,black,transparent)]",children:Array.from({length:6}).map((e,t)=>{let a=[50,70,90][t%3];return(0,n.jsx)("div",{className:(0,ey.cn)("w-full",eI),children:(0,n.jsx)(eM.E,{className:"h-4",style:{width:"".concat(a,"%")}})},t)})})})}):(0,n.jsxs)(ek.oI,{tabIndex:-1,children:[(0,n.jsx)("div",{className:(0,ey.cn)("bg-muted border-alpha-200 absolute inset-2 flex items-center justify-center overflow-hidden rounded-md border p-2 text-gray-500",i&&"bg-red-50 text-red-700"),style:{transform:M?"scale(1)":"scale(0.95)",...(0,eC.o)(M),...(0,eS.iA)(["opacity","transform"],{delay:50*!!M,duration:200*!!M})},children:i?(0,n.jsxs)("span",{className:"flex flex-col items-center gap-2 overflow-hidden text-center",children:[(0,n.jsx)(ex.V,{})," ",(0,n.jsx)("span",{className:"line-clamp-3 text-ellipsis",children:i})]}):u}),(0,n.jsx)(ek.L$,{className:"overflow-y-scroll",children:S.map(e=>{let t=a(e),s=l===t;return(0,n.jsxs)(ek.h_,{value:r(e),onSelect:()=>{y||c(e)},className:(0,ey.cn)(eI,y&&"pointer-events-none opacity-50"),children:[(0,n.jsx)("span",{className:"truncate",children:o(e,s)}),s&&(0,n.jsx)(ew.J,{className:"ml-auto h-4 w-4 shrink-0"})]},t)})})]})}),(0,n.jsx)(N._r,{renderKey:"".concat(!!m),childClassName:"overflow-hidden",children:m?(0,n.jsx)("div",{className:(0,ey.cn)("border-t border-gray-200 p-2",I&&"border-transparent",p),children:m}):null})]})}var eD=a(63587),eL=a(41956);function ez(e){let{open:t,onOpenChange:a,trigger:s,children:r,contentClassName:i,drawerClassName:o="h-fit",forceMobile:c,popoverContentProps:d,drawerContentProps:u}=e,m=(0,eL.al)();return(void 0!==c?c:m)?(0,n.jsxs)(eD._s,{open:t,onOpenChange:a,children:[(0,n.jsx)(eD.Uz,{asChild:!0,children:s}),(0,n.jsx)(eD.zj,{className:(0,ey.cn)(o),...u,children:r})]}):(0,n.jsxs)(l.AM,{open:t,onOpenChange:a,children:[(0,n.jsx)(l.Wv,{asChild:!0,children:s}),(0,n.jsx)(l.hl,{className:(0,ey.cn)("p-0",i),align:"start",sideOffset:4,...d,children:r})]})}function eE(e){var t;let{chatId:a,projectId:l,onBranchSelect:i}=e,[o,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),m=v(a,l),h=(0,r.useAtomValue)(m.selectedBranch),x=(0,r.useAtomValue)(m.currentBranch),f=(0,r.useAtomValue)(m.disableAsyncAction),{data:{git:g},isLoading:j}=(0,W.B)(["chat","externalMeta"],{chatId:a},{stopFetch:!0}),{data:k,isLoading:C}=(0,W.B)(["project","latestGit"],{projectId:l,branch:null!=x?x:void 0},{stopFetch:!0}),S=b(a),I=y((0,r.useAtomValue)(m.asyncActionLoading),["creating-branch","selecting-branch","pushing-to-branch","switching-branch"]),A=j||C,D=(0,r.useAtomValue)(m.allBranches),L=D.map((e,t)=>({id:String(t),name:e})),z=(0,s.useMemo)(()=>p(d),[d]),E=!D.some(e=>e.toLowerCase()===(null!=z?z:"").toLowerCase()),P=(0,s.useMemo)(()=>{if(k.error)return"Failed to load branches"},[k.error]),T=(0,n.jsxs)(w.$,{variant:"outline",className:"min-h-8 flex-1 justify-between font-normal",role:"combobox",type:"button",size:"sm","aria-expanded":o,disabled:I||f,children:[(0,n.jsx)(N._r,{...N.fG.inputSwitch,children:h||x&&(null==g?void 0:g.gitConnected)?(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)(ej.Z,{}),null!=h?h:x]}):(0,n.jsx)("span",{children:"Select Branch"})}),(0,n.jsx)(ev.X,{})]});function F(){E?(S.setStageIntent("create-branch"),S.updateCreateBranchName(z)):M.o.error("Branch name is already taken")}let R=(0,n.jsx)(eA,{items:L,error:P,getItemId:e=>e.id,getItemValue:e=>{var t;return null!=(t=p(e.name))?t:""},selectedItemId:null==(t=L.find(e=>e.name===x))?void 0:t.id,loading:A,renderItem:e=>(0,n.jsx)(eP,{item:e}),onItemSelect:e=>{if(e.name===x)return void c(!1);i(e.name),c(!1)},filterFunction:e=>{var t,a,n,s;return null!=(s=null==(a=p(e.name))?void 0:a.toLowerCase().includes(null!=(n=null==(t=p(d))?void 0:t.toLowerCase())?n:""))&&s},hideListWhenEmpty:!0,disabled:A||I,placeholder:"Create or search branches",childClassName:"p-1",emptyState:"No branches found",searchTerm:d,onSearchChange:e=>{u(e)},children:E&&(0,n.jsxs)("button",{onClick:F,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),F())},className:(0,ey.cn)("flex h-8 w-full items-center gap-2 overflow-hidden rounded-[6px] px-2 text-blue-700 hover:bg-gray-100 focus:bg-gray-100 focus:outline-none "),tabIndex:0,role:"menuitem",children:[(0,n.jsx)(eb.f,{}),(0,n.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,n.jsxs)("span",{className:"whitespace-nowrap text-gray-900",children:["Create ",!z&&"Branch"]}),(0,n.jsx)("span",{className:"truncate text-gray-500",children:z})]})]})});return(0,n.jsx)(ez,{open:o,onOpenChange:c,trigger:T,contentClassName:"w-[var(--radix-popover-trigger-width)]",children:R})}function eP(e){let{item:t}=e;return(0,n.jsx)("div",{children:t.name})}function eT(e){let{children:t,className:a}=e;return(0,n.jsx)("span",{className:(0,ey.cn)("text-label-13-mono w-fit shrink-0 break-all rounded-md bg-gray-100 px-1.5 py-1",a),children:t})}var eF=a(98791),eR=a(79844),eU=a(95734),eV=a(12454),eB=a(32376),e_=a(57025),eO=a(11135),eH=a(40767),e$=a(15935),eq=a(65505),eW=a(2995),eG=a(39929);function eZ(e){let{projectId:t,chatId:a}=e,s=v(a,t),l=(0,r.useAtomValue)(s.currentBranch),{git:i}=(0,r.useAtomValue)(s.externalChatMeta);return i?(0,n.jsx)(w.$,{size:"sm",variant:"secondary",asChild:!0,type:"button",children:(0,n.jsxs)(ed(),{href:"https://github.com/".concat(i.ownerName,"/").concat(i.repoName),className:"group justify-between font-normal",target:"_blank",onClick:()=>{(null==i?void 0:i.ownerName)&&i.repoName&&(0,X.u)("GitSyncViewRepository",{chatId:a,repoName:i.repoName,ownerName:i.ownerName,branch:l||"main"})},children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(e$.P,{}),"".concat(i.ownerName,"/").concat(i.repoName)]}),(0,n.jsx)(eB.i,{className:"opacity-0 transition-opacity group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100"})]})}):(0,n.jsx)(eM.E,{className:"h-4 w-full"})}function eY(e){let{chatId:t,projectId:a}=e,s=v(t,a),l=(0,r.useAtomValue)(s.currentBranch),{handlePushToBranch:i}=ea({chatId:t,projectId:a}),o=(0,r.useAtomValue)(s.asyncActionLoading),c="pushing-to-branch"===o;return(0,n.jsx)(w.$,{size:"sm",variant:"secondary",disabled:!!(c||o),className:"w-full",onClick:()=>{l&&i(l)},children:(0,n.jsx)(en.V,{isLoading:c,loading:"Pushing",children:"Push Changes"})})}function eK(e){let{chatId:t,projectId:a,label:l,branchIcon:i,delayFocus:o,variant:c="secondary",className:d}=e,u=v(t,a),m=b(t),h=(0,r.useAtomValue)(u.asyncActionLoading),{tabIndex:p}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{delay:t=200,disabled:a=!1}=e,[n,r]=(0,s.useState)(a?0:-1),l=(0,s.useRef)(null),i=()=>{l.current&&(clearTimeout(l.current),l.current=null)};return(0,s.useEffect)(()=>(i(),l.current=setTimeout(()=>r(0),t),i),[]),{tabIndex:n}}({disabled:!o}),x=y(h,["creating-branch","selecting-branch","pushing-to-branch","switching-branch"]);return(0,n.jsx)(w.$,{size:"sm",tooltip:l?void 0:"Create a new branch",variant:c,disabled:x,type:"button",className:d,tabIndex:p,onClick:()=>m.setStageIntent("create-branch"),children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eb.f,{}),l]}):i?(0,n.jsx)(eV.x,{}):(0,n.jsx)(eH.F,{})})}function eJ(e){let{chatId:t,projectId:a}=e,l=v(t,a),{git:i}=(0,r.useAtomValue)(l.externalChatMeta),o=(0,r.useAtomValue)(l.asyncActionLoading),c=(0,r.useAtomValue)(l.disableAsyncAction),d=(0,r.useAtomValue)(l.currentBranch),u=!!(o||c),[m,h]=(0,s.useState)(!1),p=null==i?void 0:i.gitAutoCommitPush,x=!(null==i?void 0:i.gitConnected),{handleUpdateBranchConnection:f,handleToggleAutoCommit:g}=ea({chatId:t,projectId:a});return(0,n.jsxs)(eG.DropdownMenu,{open:m,onOpenChange:h,children:[(0,n.jsx)(eG.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(w.$,{size:"sm",variant:"secondary",type:"button",tooltipDirection:"bottom",tooltip:"Branch Options",children:(0,n.jsx)(eq.u,{})})}),(0,n.jsx)(eG.DropdownMenuContent,{align:"end",className:"w-[200px]",side:"bottom",sideOffset:8,children:(0,n.jsxs)(eW.rX,{children:[(0,n.jsx)(eW.Dr,{onSelect:e=>{e.preventDefault(),i&&g(!p).finally(()=>{h(!1)})},disabled:(null==i?void 0:i.onProductionBranch)||u,children:(null==i?void 0:i.onProductionBranch)?(0,n.jsx)(eW.sW,{label:"Auto-Commit Disabled",Icon:(0,n.jsx)(e_.Y,{})}):(0,n.jsx)(eW.sW,{label:"toggle-auto-commit"===o?"Updating Auto-Commit":(null==i?void 0:i.gitAutoCommitPush)?"Disable Auto-Commit":"Enable Auto-Commit",Icon:"toggle-auto-commit"===o?(0,n.jsx)(k.y,{size:16}):(0,n.jsx)(e_.Y,{})})}),(0,n.jsx)(eW.Dr,{disabled:x||!d||u,onSelect:e=>{e.preventDefault(),f(!1).finally(()=>{h(!1)})},children:(0,n.jsx)(eW.sW,{label:"updating-branch-connection"===o?"Unlinking Branch":"Unlink Branch",Icon:"updating-branch-connection"===o?(0,n.jsx)(k.y,{size:16}):(0,n.jsx)(z,{})})}),i&&!i.onProductionBranch?(0,n.jsx)(eW.Dr,{onSelect:()=>window.open("https://github.com/".concat(i.ownerName,"/").concat(i.repoName,"/pull/new/").concat(d),"_blank"),children:(0,n.jsx)(eW.sW,{label:"Create Pull Request",Icon:(0,n.jsx)(eO.D,{})})}):null]})})]})}function eQ(e){let{chatId:t,projectId:a}=e,l=v(t,a),i=b(t),{git:o}=(0,r.useAtomValue)(l.externalChatMeta),c=(0,r.useAtomValue)(l.currentBranch),d=(0,r.useAtomValue)(l.latestProjectGit),u=(0,r.useAtomValue)(l.timeSinceLastSync),m=(0,r.useAtomValue)(l.asyncActionLoading),{isLoading:h}=(0,eU.BG)(["project","latestGit"],{projectId:a,branch:null!=c?c:void 0},{stopFetch:!0}),p="pushing-to-branch"===m,x=(0,s.useMemo)(()=>{var e,t;return d.error?{icon:(0,n.jsx)(eF.m,{state:"error",stopPing:!0}),title:"Failed to Load GitHub",label:null!=(e=d.message)?e:""}:o?p||"selecting-branch"===m||"switching-branch"===m?{icon:(0,n.jsx)(eX,{}),title:p?"Syncing to Branch":"Syncing Changes",label:(0,n.jsx)(e0,{time:u})}:{icon:(0,n.jsx)(eF.m,{state:"green",stopPing:!0}),title:o.onProductionBranch?"Connected to GitHub":"Synced to GitHub",label:(0,n.jsx)(e0,{time:u})}:{icon:(0,n.jsx)(eF.m,{state:"error",stopPing:!0}),title:"Not Connected to GitHub",label:null!=(t=d.message)?t:"."}},[d.error,d.message,o,p,m,u]);return o?(0,n.jsxs)(B,{className:"gap-2.5 pt-2.5",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex h-5 flex-1 items-center gap-2",children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eF.m,{state:"queued"}),(0,n.jsx)(eM.E,{className:"h-5",style:{minWidth:"70%"}})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N._r,{...N.fG.buttonContent,enter:{scale:.5},children:x.icon}),(0,n.jsx)(N._r,{duration:.3,delay:.15,justify:"start",renderKey:x.title,children:(0,n.jsxs)("span",{className:"text-label-14 flex gap-2 whitespace-nowrap font-medium text-gray-900",children:[x.title,(0,n.jsx)("span",{className:"truncate font-normal text-gray-500",children:x.label})]})})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(O,{}),(0,n.jsx)(eK,{delayFocus:!0,chatId:t,projectId:a,variant:"ghost"})]})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)(_,{children:[(0,n.jsx)(eo.Label,{children:"Repository"}),(0,n.jsx)(eZ,{chatId:t,projectId:a})]}),c?(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)(_,{children:[(0,n.jsx)(eo.Label,{children:"Active Branch"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(eE,{chatId:t,projectId:a,onBranchSelect:function(e){i.setStageIntent("switch-branch-confirmation"),i.setSwitchBranchTarget(e)}}),(0,n.jsx)(eJ,{chatId:t,projectId:a})]})]}),(0,n.jsx)(N._r,{...N.fG.popoverContent,children:!o.onProductionBranch&&o.gitAutoCommitPush?(0,n.jsx)("div",{className:"text-label-13 flex items-center gap-1 pt-3 text-gray-500",children:"Changes will be automatically committed to this branch."}):(0,n.jsx)("div",{className:"flex w-full items-center gap-2 pt-4",children:(0,n.jsx)(eY,{chatId:t,projectId:a})})})]}):null]})]}):(0,n.jsx)(eg.p,{title:"Not Connected to GitHub",icon:(0,n.jsx)(ex.V,{}),variant:"error",children:"This chat is not connected to a branch or repository."})}function eX(){return(0,n.jsx)("div",{className:"flex h-4 w-4 items-center justify-center",children:(0,n.jsx)(ef.g,{className:"animate-spin ease-in-out",style:{animationDuration:"1.1s",animationTimingFunction:"cubic-bezier(.45,.04,.25,.99)"}})})}function e0(e){let{time:t,prefix:a}=e,[r,l]=(0,s.useState)(0);(0,s.useEffect)(()=>{let e=setInterval(()=>{(null!=t?t:Date.now()>Date.now()-65e3)&&l(r+1)},200);return()=>clearInterval(e)},[t,r,l]);let i=null!=t?t:Date.now(),o=i>Date.now()-15e3;return(0,n.jsxs)("span",{children:[a,o?(0,n.jsx)("span",{children:a?"just now":"Just now"}):(0,eR.f)(new Date(i),!0,Date.now(),!1)]})}function e1(e){let{chatId:t,projectId:a}=e,{handleRetry:s,handleReport:r}=ea({chatId:t,projectId:a});return(0,n.jsxs)("form",{id:"error-form",onSubmit:function(e){e.preventDefault(),s()},children:[(0,n.jsx)(B,{children:(0,n.jsx)(eg.p,{title:"Failed to load git data",variant:"error",icon:(0,n.jsx)(ex.V,{}),children:"An issue occurred with our servers or your network connection. Please reload or report the problem if it persists."})}),(0,n.jsxs)(V,{children:[(0,n.jsx)(w.$,{size:"sm",onClick:r,type:"button",variant:"secondary",children:"Report"}),(0,n.jsx)(w.$,{size:"sm",type:"submit",children:"Reload"})]})]})}function e5(e){let{chatId:t,projectId:a}=e,l=v(t,a),i=(0,r.useAtomValue)(l.selectedBranch),o=b(t),{branches:c}=(0,r.useAtomValue)(l.latestProjectGit),{handleSelectBranch:d}=ea({chatId:t,projectId:a}),u=(0,r.useAtomValue)(l.asyncActionLoading),m=(0,r.useAtomValue)(l.disableAsyncAction),h=y(u,["selecting-branch","pushing-to-branch","switching-branch","updating-branch-connection"]),p="selecting-branch"===u;return(0,s.useEffect)(()=>{(null==c?void 0:c.length)===1&&o.setSelectedBranch(c[0].name)},[o,c]),(0,n.jsxs)("form",{id:"sync-to-branch-form",onSubmit:function(e){if(e.preventDefault(),!i)return void M.o.error("Please select a branch to sync to");d(i).then(()=>{o.setSelectedBranch(null)})},children:[(0,n.jsxs)(B,{children:[(0,n.jsx)(es.M,{title:"Select a Branch",titleSuffix:(0,n.jsx)(O,{}),children:"Select which branch you want to sync changes to."}),(0,n.jsxs)(_,{children:[(0,n.jsx)(eo.Label,{children:"Project Repository"}),(0,n.jsx)(eZ,{chatId:t,projectId:a})]}),(0,n.jsxs)(_,{children:[(0,n.jsx)(eo.Label,{children:"Active Branch"}),(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)(eE,{chatId:t,projectId:a,onBranchSelect:e=>o.setSelectedBranch(e)}),(0,n.jsx)(eK,{chatId:t,projectId:a,branchIcon:!0})]})]})]}),(0,n.jsx)(V,{children:(0,n.jsx)(w.$,{size:"sm",disabled:!i||h||m,type:"submit",children:(0,n.jsx)(en.V,{isLoading:p,loading:"Setting Active Branch",children:"Set Active Branch"})})})]})}function e2(e){let{chatId:t,projectId:a}=e,l=v(t,a),{git:i}=(0,r.useAtomValue)(l.externalChatMeta),o=(0,r.useAtomValue)(l.currentBranch),c=(0,s.useRef)(o).current,d=(0,r.useAtomValue)(l.switchBranchTarget),{handleSwitchBranch:u}=ea({chatId:t,projectId:a}),m="switching-branch"===(0,r.useAtomValue)(l.asyncActionLoading);if(!c||!d)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(B,{children:(0,n.jsx)(es.M,{title:"Switch Active Branch",children:"No branch or target branch found, this should never happen."})}),(0,n.jsx)(V,{children:(0,n.jsx)(eh,{chatId:t,children:"Okay"})})]});let h=e=>i?"https://github.com/".concat(i.ownerName,"/").concat(i.repoName,"/tree/").concat(e):"#";return(0,n.jsxs)("form",{id:"switch-branch-form",onSubmit:function(e){e.preventDefault(),u()},children:[(0,n.jsxs)(B,{children:[(0,n.jsx)(es.M,{title:"Switch Active Branch",children:"The most recent changes from the new branch will be synced to this chat. This operation is not destructive."}),(0,n.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,n.jsx)(e3,{title:"Current branch",branch:c,href:h(c)}),(0,n.jsx)("span",{className:"w-full border-t border-gray-200"}),(0,n.jsx)(e3,{title:"New branch",branch:d,href:h(d)})]})]}),(0,n.jsxs)(V,{children:[(0,n.jsx)(eh,{chatId:t,disabled:m}),(0,n.jsx)(w.$,{size:"sm",disabled:m,type:"submit",children:(0,n.jsx)(en.V,{isLoading:m,loading:"Switching branch",children:"Switch Branch"})})]})]})}function e3(e){let{title:t,branch:a,href:s}=e;return(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,n.jsx)(eo.Label,{className:"whitespace-nowrap",children:t}),(0,n.jsx)(ed(),{href:s,target:"_blank",className:"decoration-gray-400 hover:underline",children:(0,n.jsx)(eT,{children:a})})]})}function e6(e){let{...t}=e,a=v(t.chatId,t.projectId),l=(0,r.useAtomValue)(a.stage);(0,s.useEffect)(()=>{(0,X.u)("GitSyncStageView",{chatId:t.chatId,stage:l,projectId:t.projectId})},[l,t.chatId,t.projectId]);let i=(0,s.useMemo)(()=>{switch(l){case"sign-in":return(0,n.jsx)(er,{...t});case"install-app":return(0,n.jsx)(el,{...t});case"create-repo":return(0,n.jsx)(em,{...t});case"create-branch":return(0,n.jsx)(ep,{...t});case"switch-branch-confirmation":return(0,n.jsx)(e2,{...t});case"status":return(0,n.jsx)(eQ,{...t});case"select-branch":return(0,n.jsx)(e5,{...t});case"error":return(0,n.jsx)(e1,{...t})}},[t,l]);return(0,n.jsx)(N._r,{...N.fG.popoverContent,childClassName:"overflow-hidden",children:(0,n.jsx)("div",{className:"flex flex-col overflow-hidden",children:i})})}var e7=a(32136),e9=a(37707),e4=a(24405);let e8=new Set;function te(e){let{chatId:t,activeBlock:a}=e,{project:r,isLoading:l}=(0,e7.tZ)(t),{gbs:i}=(0,e9.D)();return i?l?(0,n.jsx)(P,{}):r?(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(P,{}),children:(0,n.jsx)(tt,{chatId:t,projectId:r.projectId})}):(0,n.jsx)(E,{chatId:t}):(0,n.jsx)(e4.e,{chatId:t,activeBlock:a})}function tt(e){let{chatId:t,projectId:a}=e;(0,W.B)(["scoped","gitNamespaces"],{}),(0,W.B)(["chat","externalMeta"],{chatId:t}),function(e){let{chatId:t,projectId:a}=e,n=v(t,a),l=b(t),i=(0,r.useAtomValue)(n.isOpen),{handleSelectBranch:o}=ea({chatId:t,projectId:a}),{git:c}=(0,r.useAtomValue)(n.externalChatMeta),d=null==c?void 0:c.ref,u=!(null==c?void 0:c.gitConnected),m="selecting-branch"===(0,r.useAtomValue)(n.asyncActionLoading),{data:h,isLoading:p,isValidating:x}=(0,W.B)(["project","latestGit"],{projectId:a,branch:d},{refreshInterval:6e4,stopFetch:!a}),{head:f}=h,g=f&&f.sha&&c&&"sha"in c&&c.sha!==f.sha&&!m&&!e8.has(f.sha)&&d&&!u,j=(0,s.useCallback)(()=>{if(g){let e=o(d).then(()=>{e8.add(f.sha)});i||(0,Q.$)("git-sync-promise",5e3,()=>M.o.promise({promise:e,loading:"Syncing external changes",success:"Synced external changes",error:"Failed to sync external changes"}))}},[d,o,g,null==f?void 0:f.sha,i]);(0,s.useEffect)(()=>{j()},[g]),(0,s.useEffect)(()=>{l.updateIsRefreshingGitHead(p||x)},[l,p,x])}({chatId:t,projectId:a}),function(e){let{chatId:t,projectId:a}=e,n=(0,H.useRouter)(),l=(0,H.useSearchParams)(),i=v(t,a),o=(0,s.useRef)(!1),{handlePushToBranch:c}=ea({chatId:t,projectId:a}),d=(0,r.useAtomValue)(i.isConnectedToGit),u=(0,S.eu)(),m=(0,r.useAtomValue)(i.asyncActionLoading),h=(0,r.useAtomValue)(i.currentBranch),p=(0,s.useCallback)(()=>{let e=new URLSearchParams(l.toString());e.delete("assignBranch");let t=window.location.pathname+(e.toString()?"?".concat(e.toString()):"");n.replace(t)},[l,n]),x=(0,s.useMemo)(()=>{let e=l.get("assignBranch");return e&&"pushing-to-branch"!==m&&d&&(null==u?void 0:u.id)&&!h&&!o.current?e:null},[l,m,d,null==u?void 0:u.id,h]);(0,s.useEffect)(()=>{x&&!o.current&&(o.current=!0,c(x).finally(()=>{o.current=!1,p()}))},[x,c,p])}({chatId:t,projectId:a});let i=v(t,a),o=b(t),c=(0,r.useAtomValue)(i.isOpen),d=(0,r.useAtomValue)(i.isConnectedToGit),u=(0,r.useAtomValue)(i.stage);return(0,n.jsxs)(l.AM,{open:c,onOpenChange:e=>{o.setIsOpen(e),e?(0,X.u)("GitSyncPopoverOpen",{chatId:t,projectId:a,isConnectedToGit:d}):(0,X.u)("GitSyncPopoverClose",{chatId:t,stage:u})},children:[(0,n.jsx)(l.Wv,{asChild:!0,children:(0,n.jsx)(T,{chatId:t,projectId:a})}),(0,n.jsx)(l.hl,{className:"w-[400px] max-w-[100vw] origin-top-right",align:"end",alignOffset:1,children:(0,n.jsx)(e6,{chatId:t,projectId:a})})]})}},90323:(e,t,a)=>{"use strict";a.d(t,{o:()=>o});var n=a(97667),s=a(33571),r=a(13729),l=a(28819),i=a(13263);function o(e){let{hideIcon:t,displayLink:a,link:o,asChild:c,className:d,children:u,ref:m,suffix:h,iconPrefix:p,showToast:x,disabled:f,successMessage:g,...v}=e,[j,b]=(0,s.useState)(!1),y=(0,s.useCallback)(()=>{b(!0),r.o.promise({promise:navigator.clipboard.writeText(o),error:"Failed to copy link",success:x?null!=g?g:"Link copied":void 0,loading:"Copying link..."}),setTimeout(()=>b(!1),3e3)},[o,x]);return c?(0,n.jsx)("div",{className:d,onClick:y,children:u}):(0,n.jsxs)("button",{className:(0,l.cn)("group flex h-8 w-full items-center justify-between gap-1 rounded-md border border-gray-200 px-2 text-left text-sm font-normal transition-all hover:border-gray-300",f&&"pointer-events-none opacity-50",h?"pr-0":"pr-2",d),disabled:f,onClick:y,ref:m,...v,children:[p?(0,n.jsx)("div",{className:"-mr-1 h-full",children:p}):null,(0,n.jsx)("span",{className:"flex-1 truncate",children:null!=a?a:o}),(0,n.jsx)(i.U,{className:(0,l.cn)("text-gray-500 transition-colors group-hover:text-current group-focus-visible:text-current",t&&"hidden"),isCopied:j}),h?(0,n.jsx)("div",{className:"h-full pl-1",children:h}):null]})}},90516:(e,t,a)=>{"use strict";a.d(t,{default:()=>b,i:()=>j});var n=a(97667),s=a(33571),r=a(28963),l=a(49848),i=a(31761),o=a(25603),c=a(16292),d=a(25951),u=a(74118),m=a(40711),h=a(66692),p=a(40767),x=a(43447),f=a(32136),g=a(13729);let v={create:"Add Environment Variables",edit:"Edit Environment Variables",missing:"Missing Environment Variables"};function j(){var e;let{data:t,mutate:a}=(0,o.Ay)("showEnvModal",null,{fallbackData:!1}),{data:n,mutate:s}=(0,o.Ay)("envModalData",null,{fallbackData:{mode:"create",projectId:"",variables:[{key:"",value:""}]}}),r=null!=(e=null==n?void 0:n.variables)?e:[{key:"",value:""}];return{showEnvModal:t,setShowEnvModal:a,envModalData:n,setEnvModalData:s,envVars:r,setEnvVars:e=>{var t;s({...n,projectId:null!=(t=null==n?void 0:n.projectId)?t:"",variables:e})}}}function b(e){let{v0ProjectId:t}=e,{project:a,title:o}=(0,f.tZ)(),b=null!=t?t:null==a?void 0:a.projectId,{showEnvModal:y,setShowEnvModal:w,envModalData:N,setEnvModalData:k,envVars:C,setEnvVars:S}=j(),M=null==N?void 0:N.mode,{refetchVercelProject:I}=(0,d.Ok)(b),[A,D]=(0,s.useTransition)(),{refresh:L}=(0,m.Z)(),{chatId:z}=(0,u.xz)(),E=(e,t,a)=>{let n=[...C];n[e]={...n[e],[t]:a},S(n)},P=e=>{let t=[...C];t.splice(e,1),S(t.length?t:[{key:"",value:""}])},T=e=>{let t=e.split(/\r?\n/).filter(e=>e.trim()&&!e.trim().startsWith("#")),a=[];for(let e of t){let t=e.match(/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/);if(t){let[,e,n=""]=t;(n&&n.startsWith('"')&&n.endsWith('"')||n.startsWith("'")&&n.endsWith("'"))&&(n=n.substring(1,n.length-1)),a.push({key:e,value:n})}}return a.length?a:[{key:"",value:""}]},F=(e,t,a)=>{let n=e.clipboardData.getData("text");if(n.split(/\r?\n/).filter(Boolean).length>1&&"key"===a){e.preventDefault();let a=T(n);if(a.length>0){let e=[...C];e.splice(t,1,...a),S(e)}}};return(0,n.jsx)(r.Modal,{open:y,onOpenChange:()=>{w(!y),S([{key:"",value:""}]),k({mode:"create",projectId:b,variables:[{key:"",value:""}]})},children:(0,n.jsxs)("form",{action:()=>{D(async()=>{if(!N)return;let e=C.filter(e=>""!==e.key.trim());if(0===e.length)return void g.o.error("At least one environment variable with a key is required");let t=await (0,i.g)({envVars:e,v0ProjectId:N.projectId,autoCreateVercelProject:!0,chatId:z,autoCreateV0Project:!0,autoCreateV0ProjectName:(null==a?void 0:a.name)||o});if(t.success){var n;g.o.success("Environment variables saved successfully"),null==(n=N.onSave)||n.call(N,e)}else g.o.error(t.error);I(),w(!1),k({mode:"create",projectId:b,variables:[{key:"",value:""}]}),S([{key:"",value:""}]),L()})},children:[(0,n.jsxs)(r.ModalHeader,{children:[(0,n.jsx)(r.ModalTitle,{className:"flex items-center gap-2 text-xl font-medium",children:(0,n.jsx)("span",{children:M?(0,n.jsx)("span",{children:v[M]}):(0,n.jsx)("span",{children:"Add Environment Variables"})})}),"create"===M&&(0,n.jsx)(r.ModalDescription,{className:"text-muted-foreground text-left",children:"Environment variables will be encrypted and stored securely on Vercel."})]}),(0,n.jsxs)(r.ModalContent,{children:["missing"===M&&(0,n.jsx)("p",{className:"text-muted-foreground mb-4 text-[15px]",children:"The functionality of this app will be limited without the following environment variables:"}),(0,n.jsx)("div",{className:"max-h-[60vh] space-y-3 overflow-y-auto pr-2",children:C.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(l.p,{value:e.key,onChange:e=>E(t,"key",e.target.value),onPaste:e=>F(e,t,"key"),placeholder:"API_KEY",className:"h-9"})}),(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(l.p,{value:e.value,onChange:e=>E(t,"value",e.target.value),onPaste:e=>F(e,t,"value"),placeholder:"my-api-key",className:"h-9"})}),(0,n.jsx)(h.$,{type:"button",variant:"ghost",size:"sm",onClick:e=>{e.shiftKey?S([{key:"",value:""}]):P(t)},className:"h-9 w-9 shrink-0",children:(0,n.jsx)(x.l,{className:"text-muted-foreground h-4 w-4"})})]},t))}),(0,n.jsx)("div",{className:"flex justify-between pt-2",children:(0,n.jsxs)(h.$,{type:"button",variant:"outline",size:"sm",onClick:e=>{S([...C,{key:"",value:""}])},className:"flex items-center gap-1",children:[(0,n.jsx)(p.F,{className:"h-4 w-4"}),"Add Variable"]})})]}),(0,n.jsx)(r.ModalFooter,{className:"border-border bg-muted flex border-t !p-4",children:(0,n.jsx)(c.x,{size:"sm",pending:A,children:"Save"})})]})})}},90643:(e,t,a)=>{"use strict";a.d(t,{StripeProvider:()=>n});let n=(0,a(51311).default)(()=>a.e(73944).then(a.bind(a,73944)).then(e=>e.ClientStripeProvider),{loadableGenerated:{webpack:()=>[73944]},ssr:!1})},90962:(e,t,a)=>{"use strict";a.d(t,{o:()=>C});var n=a(97667),s=a(33571),r=a(39929),l=a(69894),i=a(66692),o=a(48118),c=a(68163),d=a(64935),u=a(68618),m=a(50391),h=a(28819),p=a(28963),x=a(25951),f=a(19243),g=a(27693),v=a(7909),j=a(41956),b=a(10037),y=a(56179),w=a(32136),N=a(36323);function k(e){var t;let{onClose:a,quickCreate:s=!1}=e,r=(0,g.k)(),{title:l}=(0,w.tZ)(),i=(0,N.eu)();return(0,n.jsx)("div",{className:"flex h-full items-center justify-center p-1 sm:p-2",children:(0,n.jsx)(m.Sv,{className:"bg-muted w-full rounded-md border border-gray-200 p-2",children:(0,n.jsxs)(m.HY,{className:"flex flex-col items-center space-y-4 p-4",children:[(0,n.jsxs)("span",{className:"flex flex-col items-center justify-between space-y-4",children:[(0,n.jsx)(m.Ft,{className:"bg-background mx-auto text-gray-400",children:(0,n.jsx)(u.z,{})}),(0,n.jsxs)("span",{className:"flex flex-col items-center space-y-2",children:[(0,n.jsx)(m.cz,{children:r("project.dropdown.noProjects")}),(0,n.jsx)(m.Ou,{className:"text-balance text-center text-gray-400",children:r("project.dropdown.createProject")})]})]}),(0,n.jsx)(o.NewProjectButton,{onAfterClick:a,numProjects:0,quickCreate:s,projectName:null!=(t=null==i?void 0:i.meta.title)?t:l})]})})})}function C(e){let{projectName:t,chatId:a,disabled:u,onLoggedOutClick:m,modalClassName:w,triggerButton:N,handleProjectSelect:C,variant:S="default",className:M,quickCreate:I=!1,onSuccess:A,align:D="start"}=e,{projects:L,selectedProjectId:z,setSelectedProjectId:E}=(0,x._t)(),[P,T]=(0,s.useState)(!1),[F,R]=(0,s.useState)(!1),U=(0,j.al)(),V=(0,g.k)(),B=()=>{T(!1),R(!1)},_=e=>{E((null==e?void 0:e.projectId)||null),B(),(0,f.u)("SelectProject",{projectId:(null==e?void 0:e.projectId)||null}),null==C||C(e?{projectId:e.projectId,name:e.name,settings:{icon:e.icon||void 0,color:e.color||void 0},vercelProjectId:e.vercelProjectId,creatorId:e.creatorId}:null)},O=z&&L.find(e=>e.projectId===z),H=N||(0,n.jsx)(i.$,{"aria-label":"Select project",className:(0,h.cn)("flex h-7 max-w-[200px] justify-start gap-0.5 rounded-md border-none bg-gray-100 pl-2 pr-1.5 text-[13px] transition-colors hover:bg-gray-200 hover:text-gray-900",{"text-gray-500":!O}),disabled:u,size:"sm",variant:"secondary",children:O?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.n,{name:(0,b.KI)(O.icon)}),(0,n.jsx)("span",{className:"ml-1 truncate",children:O.name}),(0,n.jsx)(c.X,{})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:V("project.noProjectSelected")}),(0,n.jsx)(c.X,{})]})}),$=(0,s.useMemo)(()=>(0,y.n)(L,(e,t)=>e.projectId===z?-1:+(t.projectId===z)),[L,z]),q=(0,n.jsxs)("div",{className:"p-1",children:[(0,n.jsx)("div",{className:"max-h-[400px] space-y-2 overflow-y-auto text-left",children:$.map(e=>(0,n.jsxs)("button",{className:"flex w-full items-center justify-between rounded-md px-2 py-2.5 hover:bg-gray-100",onClick:()=>_(z===e.projectId?null:e),children:[(0,n.jsxs)("span",{className:"flex min-w-0 flex-1 items-center",children:[(0,n.jsx)("div",{className:"[&>svg]:size-4",children:(0,n.jsx)(v.n,{name:(0,b.KI)(e.icon)})}),(0,n.jsx)("span",{className:"ml-2 max-w-[200px] truncate",children:e.name})]}),z===e.projectId?(0,n.jsxs)("span",{className:"flex shrink-0 items-center text-gray-500",children:[(0,n.jsx)(l.A,{className:"h-4 w-4 group-hover:hidden"}),(0,n.jsx)("span",{className:"hidden group-hover:inline",children:V("project.dropdown.unselect")})]}):(0,n.jsx)("span",{className:"hidden shrink-0 text-gray-500 group-hover:inline",children:V("project.dropdown.select")})]},e.projectId))}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(o.NewProjectButton,{assignToChatId:a,className:"w-full",onAfterClick:B,size:"sm",variant:"secondary",numProjects:L.length,quickCreate:I,projectName:t,onSuccess:e=>{null==A||A(e),B()}})})]}),W=0===L.length?(0,n.jsx)(k,{onClose:B,quickCreate:I}):q,G=(0,n.jsx)(r.DropdownMenuContent,{align:D,className:(0,h.cn)("w-[350px]"),side:"bottom",sideOffset:4,children:0===L.length?(0,n.jsx)(k,{onClose:B,quickCreate:I}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.DropdownMenuGroup,{className:(0,h.cn)("max-h-[225px] overflow-y-auto"),children:(0,y.n)(L,(e,t)=>(e.projectId===z?-1:0)-(t.projectId===z?-1:0)).map(e=>(0,n.jsxs)(r.DropdownMenuItem,{className:"group pl-2 pr-3",onClick:()=>_(z===e.projectId?null:e),children:[(0,n.jsxs)("span",{className:"flex w-full max-w-[200px] items-center",children:[(0,n.jsx)(v.n,{name:(0,b.KI)(e.icon)}),(0,n.jsx)("span",{className:"ml-3 min-w-0 flex-1",children:(0,n.jsx)("span",{className:"block truncate","data-testid":"project-option",children:e.name})})]}),z===e.projectId?(0,n.jsxs)("span",{className:"ml-auto flex shrink-0 items-center text-gray-500",children:[(0,n.jsx)(l.A,{className:"h-4 w-4 group-hover:hidden"}),(0,n.jsx)("span",{className:"hidden group-hover:inline",children:V("project.dropdown.unselect")})]}):(0,n.jsx)("span",{className:"ml-auto hidden shrink-0 text-gray-500 group-hover:inline",children:V("project.dropdown.select")})]},e.projectId))}),(0,n.jsx)(r.mB,{}),(0,n.jsx)(r.DropdownMenuGroup,{className:"bg-muted",children:(0,n.jsx)(o.NewProjectButton,{onAfterClick:B,size:"sm",variant:"secondary",className:"w-full",numProjects:L.length,quickCreate:I,projectName:t,onSuccess:e=>{null==A||A(e),B()}})})]})}),Z=(0,n.jsxs)(i.$,{variant:"ghost",size:"sm",className:"relative h-7 w-4 rounded-md text-gray-500",children:[(0,n.jsx)(d.R,{}),(0,n.jsx)("div",{className:"absolute -inset-x-2 inset-y-0"})]});return m?(0,n.jsx)("div",{onClick:m,children:H}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,h.cn)("flex w-full min-w-0 items-center gap-1 md:hidden",M),children:["split"===S?H:null,(0,n.jsx)(p.Modal,{onOpenChange:T,open:P&&U,trigger:"split"===S?Z:H,className:w,children:(0,n.jsx)(p.ModalContent,{className:(0,h.cn)("max-h-[80vh]",{"overflow-y-auto":L.length>0}),children:W})})]}),(0,n.jsx)("div",{className:(0,h.cn)("hidden w-full min-w-0 md:block",M),children:(0,n.jsxs)(r.DropdownMenu,{onOpenChange:R,open:F&&!U,children:["default"===S?(0,n.jsx)(r.DropdownMenuTrigger,{asChild:!0,className:"max-w-[200px]",children:H}):null,"split"===S?(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[H,(0,n.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:Z})]}):null,G]})})]})}},91211:(e,t,a)=>{"use strict";a.d(t,{AM:()=>i,Wv:()=>o,hl:()=>c});var n=a(97667),s=a(33571),r=a(69363),l=a(28819);let i=r.bL;r.Mz;let o=r.l9;r.bm;let c=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:i=4,withOverlay:o,...c}=e,d=(0,n.jsx)(r.UC,{align:s,className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 bg-background z-50 w-[21rem] overflow-hidden rounded-xl shadow-md outline-none",a),ref:t,sideOffset:i,...c});return(0,n.jsx)(r.ZL,{children:o?(0,n.jsx)("div",{className:"fixed inset-0 z-[2000]",children:d}):d})});c.displayName=r.UC.displayName},91581:(e,t,a)=>{"use strict";a.d(t,{F:()=>m,Ww:()=>h,qM:()=>p});var n=a(97667),s=a(25603),r=a(66692),l=a(33571),i=a(27693),o=a(18513),c=a(13729),d=a(28963),u=a(12);function m(){let{data:e,mutate:t}=(0,s.Ay)("showDeleteFileDialog",null,{fallbackData:!1}),{data:a,mutate:n}=(0,s.Ay)("deleteFileDialogData",null,{fallbackData:{fileName:""}});return{showDeleteFileDialog:e,setShowDeleteFileDialog:t,deleteFileDialogData:a,setDeleteFileDialogData:n}}async function h(e,t,a){let n=[...e];for(let e of n)if(e.meta.file===t.fileName){e.isDeleted=!0,e.isUserEdit=!0,e.isMerged=!1,e.moveToEnd=!0;break}if(!(await a(n)).success)throw Error("Failed")}function p(e){let{blockId:t,sourceFiles:a,onSuccess:s}=e,{showDeleteFileDialog:p,setShowDeleteFileDialog:x,deleteFileDialogData:f}=m(),g=(0,u.W)(t),[v,j]=(0,l.useState)(!1),b=(0,i.k)(),y=(0,l.useCallback)(async()=>{try{j(!0),await h(a,f,g),s()}catch(e){c.o.error(b("fileTreeActions.fileDeletedNotificationError"))}finally{j(!1)}},[f,a,s,g,b]);return(0,n.jsxs)(d.Modal,{onOpenChange:x,open:p,responsive:!1,children:[(0,n.jsx)(d.ModalHeader,{children:(0,n.jsx)(d.ModalTitle,{children:b("fileTreeActions.deleteFile")})}),(0,n.jsx)(d.ModalContent,{children:(0,n.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,n.jsx)("span",{className:"font-bold",children:f.fileName}),"?"]})}),(0,n.jsxs)(d.ModalFooter,{children:[(0,n.jsx)(d.ModalClose,{asChild:!0,children:(0,n.jsx)(r.$,{size:"sm",variant:"secondary",children:b("fileTreeActions.cancel")})}),(0,n.jsx)(r.$,{"data-testid":"confirm-delete-message",disabled:v,onClick:y,size:"sm",variant:"destructive",children:v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.IconSpinner,{className:"size-4"}),b("fileTreeActions.deleting")]}):b("fileTreeActions.delete")})]})]})}},91746:(e,t,a)=>{"use strict";a.d(t,{TemplateEditButton:()=>L,d:()=>z});var n=a(97667),s=a(33571),r=a(28963),l=a(66692),i=a(6902),o=a(27693),c=a(99151),d=a(7086),u=a(13729),m=a(55709),h=a(70676);let p=(0,h.createServerReference)("406323c73af1c8b9b8ca6e977c5ace788bd70b445e",h.callServer,void 0,h.findSourceMapURL,"deleteTemplateAction");var x=a(16292),f=a(70158),g=a(53663),v=a(28819),j=a(36323),b=a(39929),y=a(10649),w=a(43447),N=a(2757),k=a(58642),C=a(39257),S=a(91220),M=a(77292),I=a(25887),A=a(8689),D=a(22447);function L(e){let t=()=>{(0,I.D)({type:"templateEdit",data:e})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.$,{onClick:t,size:"sm",className:"size-7 rounded-md px-0 sm:hidden",tooltip:"Settings",variant:"secondary",children:(0,n.jsx)(k.H,{})}),(0,n.jsx)(l.$,{onClick:t,size:"sm",className:"hidden sm:block",tooltip:"Settings",variant:"secondary",children:(0,n.jsx)(k.H,{})})]})}function z(e){var t;let{templateCanonId:a,blockId:h,description:g,category:v,imageUrl:k,shouldReturnToCreatedDialog:L=!1,activeBlock:z}=e,P=(0,j.eu)(),T=null!=P?P:z,F=(0,o.k)(),[R,U]=s.useTransition(),{files:V,uploading:B,removeFile:_,inputFileRef:O,onInputChange:H}=(0,c.Lb)({initialImages:k?[{url:k,name:"Current Image"}]:[],disableDrag:!1}),[$,q]=(0,s.useState)({description:g,category:v}),W=(0,f.useRouter)(),G=(0,j.y6)(),[Z,Y]=(0,s.useState)(null===k),K=(0,s.useCallback)(()=>{U(async()=>{var e,t;let a=(null!=(t=null==(e=V[0])?void 0:e.url)?t:null)||(Z?k:null),n=await (0,m.D)({...$,blockId:h,imageUrl:a});if(n.error)return void u.o.error(n.error);W.refresh(),u.o.success("Update successful"),(0,I.z)()})},[V,Z,k,$,h,W,L,T]),J=s.useCallback(()=>{U(async()=>{let e=await p(h);if(e.error)return void u.o.error(e.error);u.o.success("Deleted successfully"),(0,I.z)(),L?setTimeout(()=>{T&&G({...T,templateCanonId:void 0,templateVersionId:void 0})},500):location.href="/community/submissions"})},[W,h,T,G,L]),Q=(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(i.Label,{htmlFor:"description",className:"font-medium text-gray-900",children:F("templateShareDialog.modalDescriptionLabel")}),(0,n.jsx)(d.T,{asChild:!0,children:(0,n.jsx)(A.o,{maxHeight:192,minHeight:80,disabled:R,id:"description",maxLength:C.Kx,name:"description",placeholder:F("templateShareDialog.modalDescriptionPlaceholder"),spellCheck:!1,onChange:e=>q(t=>({...t,description:e.target.value})),value:$.description||""})})]}),X=(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsxs)(S.l6,{defaultValue:null!=(t=$.category)?t:void 0,disabled:R,onValueChange:e=>q(t=>({...t,category:e})),required:!0,children:[(0,n.jsxs)(i.Label,{htmlFor:"category",className:"font-medium text-gray-900",children:[F("templateShareDialog.modalCategoryLabel"),(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)(S.bq,{id:"category",children:(0,n.jsx)(S.yv,{placeholder:"Select a category"})}),(0,n.jsx)(S.gC,{children:M.L.map(e=>(0,n.jsx)(S.eb,{value:e.value,children:e.text},e.value))})]})}),ee=(0,n.jsxs)("fieldset",{className:"flex flex-col items-start gap-2",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)("legend",{className:"flex items-center gap-0.5 text-sm font-medium",children:F("templateShareDialog.modalImageLabel")}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:F("templateShareDialog.modalImageDescription")})]}),(0,n.jsx)("div",{className:"h-32 w-full",children:V.length||Z?(0,n.jsxs)("div",{className:"flex h-full w-[169px] flex-col gap-2",children:[(0,n.jsx)("div",{className:"bg-muted relative flex-1 overflow-hidden rounded-md border",children:Z?(0,n.jsx)("div",{className:"pointer-events-none aspect-video",children:(0,n.jsx)(N.TemplateImage,{templateCanonId:a,alt:"Template Preview",src:void 0})}):(0,n.jsx)("div",{className:"pointer-events-none aspect-video data-[status=uploading]:opacity-50","data-status":V[0].status,children:(0,n.jsx)(N.TemplateImage,{alt:V[0].file.name,src:V[0].url,templateCanonId:a})})}),(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm font-medium",children:[(0,n.jsx)("div",{className:"min-w-0 flex-1 contain-inline-size",children:(0,n.jsx)("div",{className:"line-clamp-1 w-full break-all",children:Z?(0,n.jsx)("span",{children:"Current Image"}):(0,n.jsx)("span",{children:V[0].file.name})})}),(0,n.jsxs)(b.DropdownMenu,{children:[(0,n.jsx)(b.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsx)(l.$,{variant:"ghost",size:"xs",className:"size-6 rounded-md p-0",children:(0,n.jsx)(y.A,{className:"size-4"})})}),(0,n.jsx)(b.DropdownMenuContent,{align:"start",children:(0,n.jsx)(b.DropdownMenuGroup,{children:(0,n.jsxs)(b.DropdownMenuItem,{onClick:()=>Z?Y(!1):_(V[0].id),variant:"destructive",children:[(0,n.jsx)(w.l,{}),(0,n.jsx)("span",{children:"Remove Image"})]})})})]})]})]}):(0,n.jsxs)("label",{className:"hover:bg-muted data-[dragging=true]:bg-muted flex size-full cursor-pointer flex-col gap-1 rounded-md border border-dashed p-4 transition-colors duration-200",children:[(0,n.jsx)("div",{className:"pointer-events-none flex min-h-24 flex-col items-center justify-center text-sm",children:(0,n.jsx)("div",{className:"text-gray-500",children:F("templateShareDialog.modalImagePlaceholder")()})}),(0,n.jsx)("input",{accept:"image/*",className:"sr-only",max:1,type:"file",onChange:H,ref:O})]})})]}),et=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.$,{className:"mr-auto",onClick:J,disabled:R||B,variant:"ghost",size:"sm",children:(0,n.jsx)("span",{children:"Delete"})}),(0,n.jsx)(r.ModalClose,{asChild:!0,children:(0,n.jsx)(l.$,{size:"sm",variant:"secondary",disabled:R||B,onClick:()=>{(0,I.z)()},children:F("templateShareDialog.modalCancelButton")})}),(0,n.jsx)(x.x,{form:"template-edit-dialog",size:"sm",pending:R||B,children:(0,n.jsx)("span",{children:"Update"})})]});return(0,n.jsxs)(D._,{type:"templateEdit",className:"flex flex-col md:max-h-[90vh]",children:[(0,n.jsx)(r.ModalHeader,{children:(0,n.jsx)(r.ModalTitle,{children:(0,n.jsx)("span",{children:"Edit Details"})})}),(0,n.jsx)(E,{children:(0,n.jsxs)("form",{className:"flex flex-col gap-4",id:"template-edit-dialog",onSubmit:e=>{e.preventDefault(),K()},children:[X,Q,ee]})}),(0,n.jsx)("div",{className:"bg-muted border-alpha-400 sticky bottom-0 flex w-full items-center justify-end gap-2 border-t p-4 pl-3",children:et})]})}function E(e){let{children:t}=e,{showTopBorder:a,containerRef:s,topRef:l,bottomRef:i}=(0,g.Y)("vertical");return(0,n.jsx)(r.ModalContent,{ref:s,className:(0,v.cn)("flex flex-col overflow-y-auto border-t border-transparent transition-[border-color]",a&&"border-gray-200"),children:(0,n.jsxs)("div",{className:"relative flex h-fit w-full flex-col gap-4",children:[(0,n.jsx)("div",{ref:l,className:"absolute inset-x-0 top-0 h-px w-full"}),t,(0,n.jsx)("div",{ref:i,className:"absolute inset-x-0 bottom-0 h-px w-full"})]})})}},91981:(e,t,a)=>{"use strict";a.d(t,{Y:()=>s});var n=a(33571);function s(){let[e,t]=(0,n.useState)(document.documentElement.classList.contains("dark"));return(0,n.useEffect)(()=>{let e=new MutationObserver(e=>{for(let a of e)"attributes"===a.type&&"class"===a.attributeName&&t(document.documentElement.classList.contains("dark"))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>{e.disconnect()}},[]),e}},92071:(e,t,a)=>{"use strict";function n(e){return(null==e?void 0:e.type)==="code-project"||(null==e?void 0:e.type)==="react"||(null==e?void 0:e.type)==="v0"||(null==e?void 0:e.type)==="tsx"}a.d(t,{q:()=>n})},92095:(e,t,a)=>{"use strict";a.d(t,{q:()=>s});var n=a(71543);function s(){let{user:e,expectUser:t}=(0,n.J)();return t&&!e?{isLoading:!0}:(t||e)&&((null==e?void 0:e.v0plan)!=="v0-enterprise"||e.isVercelian)?{canVote:!0,isLoading:!1}:{canVote:!1,isLoading:!1}}},92647:(e,t,a)=>{"use strict";a.d(t,{y:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40b179085ab23b9da34d5d9999043a5b7e9249a8fa",n.callServer,void 0,n.findSourceMapURL,"unlinkVercelProject")},92871:(e,t,a)=>{"use strict";a.d(t,{N:()=>ee,c:()=>X});var n=a(97667),s=a(33571),r=a(28819),l=a(31693),i=a(49211);function o(e){let{className:t,headerClassName:a,language:s,actions:i,syntax:o}=e;return(0,n.jsx)("div",{className:(0,r.cn)("codeblock border-alpha-400 relative flex size-full flex-col overflow-hidden rounded-lg border font-sans",t),"data-seg":"root",children:(0,n.jsxs)("div",{className:"group/inline-code-block relative flex size-full flex-col overflow-hidden",children:[(0,n.jsxs)("div",{className:(0,r.cn)("bg-muted flex h-10 w-full shrink-0 items-center justify-between rounded-t-lg border-b pl-2.5 pr-1.5",a),"data-seg":"skip",children:[s?(0,n.jsx)("span",{className:"text-gray-500",children:(0,n.jsx)(l.o,{lang:s})}):null,(0,n.jsx)("div",{className:"flex items-center space-x-1 text-gray-500",children:i})]}),o]})})}function c(e){let{className:t,showLineNumbers:a,actions:s,fileName:l,syntax:o}=e,{isPublished:c}=(0,i.usePublishedPage)();return c?(0,n.jsxs)("div",{className:(0,r.cn)("codeblock bg-muted flex size-full flex-col overflow-hidden rounded-lg pt-3",t),"data-seg":"root",children:[(0,n.jsxs)("div",{className:"z-10 mx-3 flex translate-y-px justify-between","data-seg":"skip",children:[(0,n.jsx)(d,{active:!0,fileName:l}),(0,n.jsx)("div",{className:"flex -translate-y-1.5 items-center gap-1",children:s})]}),(0,n.jsx)("div",{className:(0,r.cn)("border-alpha-400 bg-background relative flex flex-1 flex-col overflow-hidden border-t px-3 font-sans",a&&"px-0"),children:o})]}):(0,n.jsx)("div",{className:(0,r.cn)("codeblock bg-muted flex size-full flex-col",t),"data-seg":"root",children:(0,n.jsx)("div",{className:(0,r.cn)("relative flex flex-1 flex-col overflow-hidden px-3 font-sans",a&&"px-0"),children:o})})}function d(e){let{active:t,fileName:a,onClick:s}=e;return(0,n.jsxs)("button",{className:(0,r.cn)("font-regular border-alpha-400 pointer-events-none relative h-full whitespace-nowrap rounded-t-md border border-b-0 px-4 pb-1 pt-1.5 text-[13px] text-gray-500 transition-colors",t?"bg-background font-medium":"border-transparent bg-transparent hover:bg-gray-200"),onClick:s,children:[(0,n.jsx)(u,{active:t,side:"left"}),a,(0,n.jsx)(u,{active:t,side:"right"})]})}function u(e){let{active:t,side:a}=e;if(!t)return null;let s="left"===a;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,r.cn)("bg-muted absolute bottom-0 z-20 h-[4px] w-[4px] border-b border-gray-200",s?"right-[-4px] rounded-bl-[3px] border-l":"left-[-4px] rounded-br-[3px] border-r")}),(0,n.jsx)("div",{className:(0,r.cn)("bg-background absolute bottom-0 z-10 h-[4px] w-[4px]",s?"right-[-4px]":"left-[-4px]")})]})}var m=a(81195),h=a(51311);a(51919);var p=a(98523),x=a(54483),f=a(89602),g=a(36863),v=a(66692),j=a(13729),b=a(73655),y=a(15154),w=a(32136),N=a(70676);let k=(0,N.createServerReference)("601c7e7dbeeecfec7a1d05b14a05a902ec98b43d09",N.callServer,void 0,N.findSourceMapURL,"updateSqlExecutionStateAction");var C=a(80574),S=a(17545),M=a(88790),I=a(618),A=a(94618),D=a(22482),L=a(25603),z=a(42438),E=a(13263),P=a(6447),T=a(37631),F=a(86184),R=a(29279),U=a(99066),V=a(91220),B=a(80381),_=a(10838),O=a(37758),H=a(74118);let $=(0,N.createServerReference)("6016b220899c625ebce2740acd288f72e153f729aa",N.callServer,void 0,N.findSourceMapURL,"updateChatSqlExecProvider");var q=a(93660),W=a(86943);let G=["CREATE","ALTER","DROP","TRUNCATE"];function Z(e){let{className:t,headerClassName:a,language:l,actions:i,blockId:o,source:c,fileName:d,closed:u,sqlExecutionState:m,transaction:h,highlightedCode:p}=e,{submit:x}=(0,U.yI)(),{activeScopeSlug:f}=(0,b.k6)(),{chatId:g}=(0,H.xz)(),{project:N,canWriteToChat:I}=(0,w.tZ)(),{projectId:A,vercelProjectId:D}=null!=N?N:{},[E,T]=(0,s.useState)(!1),{stores:{data:{marketplaceStores:V}}}=(0,_.g)({vercelProjectId:null!=D?D:void 0,v0ProjectId:null==N?void 0:N.projectId,refreshInterval:0}),B=(0,s.useMemo)(()=>V.filter(e=>e&&e.product&&O.o0.includes(e.product.slug)).map(e=>({id:e.id,slug:e.product.slug,name:e.product.name,icon:"upstash-kv"===e.product.slug?"https://vercel.com/api/www/avatar/".concat(e.product.integration.icon):"https://vercel.com/api/www/avatar/".concat(e.product.iconUrl)})),[V]),{sqlExecutionState:q,updateSqlExecutionState:Z}=(0,R.n)(o),[Q,X]=(0,s.useState)(!1),{sqlExecProvider:ee,refetchSqlExecProvider:et,isLoading:ea}=function(e){let{data:t,isLoading:a,mutate:n,error:s}=(0,L.Ay)(e?["chat:sql-exec-provider",e]:null,async()=>{let t=await fetch("/chat/api/chat/sql-exec-provider?chatId=".concat(e)),{sqlExecProvider:a}=await t.json();return a});return{sqlExecProvider:t,isLoading:a,error:s,refetchSqlExecProvider:n}}(I?g:void 0),[en,es]=(0,s.useState)(null!=ee?ee:V.length>0?V[0].id:"");(0,s.useEffect)(()=>{I&&ee&&es(ee)},[I,ee,es]);let er=Q||!o||!c||!u||ea,{data:el,mutate:ei}=(0,L.Ay)(["block:output",o]),eo="applied"===q||"error"===q,ec="cancelled"===q,ed="error"===q||"error"in(null!=el?el:{}),eu=!!(el&&!ed&&el.stderr.length>0);(0,s.useEffect)(()=>{o&&m&&void 0===q&&Z(m)},[o,m,q,Z]);let{isCopied:em,copyToClipboard:eh}=(0,z.j)({timeout:2e3}),{setPromptFormInput:ep}=(0,F.Q1)(),ex=async()=>{if(!o)return void j.o.error("Error",{description:"Missing block ID"});try{X(!1),Z("cancelled");let e=await k(o,"cancelled");"error"in e&&Z(q)}catch(e){j.o.error("Error",{description:"An unexpected error occurred"})}},ef=async()=>{if(!o||!c||!f||!A||!g){let e=o?c?f?A?"chat ID":"project ID":"active scope":"source":"block ID";j.o.error("Error",{description:"Missing ".concat(e)});return}X(!0);try{let e;if(!ee&&B.length>=2){let e=await $(g,en);if("error"in e)return void j.o.error("Error",{description:e.error||"An error occurred while updating the SQL integration provider"});et()}let t=await (0,y.W)({props:{language:"sql",blockId:o,source:c,meta:{file:d,transaction:h},closed:!1,originalCode:void 0,isPreviewable:!1},v0ProjectId:A,initialVercelProjectId:null!=D?D:void 0,sqlExecProvider:null!=ee?ee:void 0});ei(t);let a="error"in t||t.stderr.length>0,n=a?"error"in t?t.error:t.stderr[0].join("\n"):void 0;if(Z(a?"error":"applied"),a&&j.o.error("SQL Execution Failed",{description:n}),(async()=>{let e=await k(o,a?"error":"applied");"error"in e&&Z(q)})(),a)return void await x({action:"new",attachments:[],input:"The SQL code block failed to execute. The error was: ".concat(n,". "),type:"message"});let s=G.some(e=>RegExp("\\b".concat(e,"\\b"),"i").test(c));if(eo||!s){if(X(!1),!s){let e=(0,P.z)(t),a=e.length>W.WX?e.slice(0,W.WX)+"...":e;await x({action:"new",attachments:[],input:"The SQL code block executed successfully. Very concisely summarize what happened.\n\nOutput: ".concat(a),type:"added-integration",workflowState:"sql-executed"})}return}let r=[];try{e=await (0,y.W)({props:{language:"sql",source:"SQL_SCHEMA_QUERY",meta:{file:"",transaction:"false"},closed:!1,originalCode:void 0,isPreviewable:!1},v0ProjectId:A,initialVercelProjectId:null!=D?D:void 0,operationId:"".concat(o,"-schema-result")})}catch(t){e={error:t instanceof Error?t.message:"An unexpected error occurred"},j.o.error("Error",{description:"An error occurred while fetching the database schema."})}if(X(!1),!("error"in e)){let t=e.stdout[0][0],a=t.length>W.WX?t.slice(0,W.WX)+"...":t;r.push({name:"database-schema",content:a,url:"database-schema",size:a.length})}await x({action:"new",attachments:r,input:"The SQL code block executed successfully.".concat(r.length>0?" The database schema is attached to this message.":""),type:"added-integration",workflowState:"create-database-tables"})}catch(e){X(!1),Z("error"),console.error(e),await k(o,"error"),j.o.error("Error",{description:"An unexpected error occurred"})}},eg=async()=>{if(em)return;let e=(0,P.z)(el);await eh(e)},ev=(0,s.useMemo)(()=>B.length<2||!I?null:(0,n.jsx)(J,{stores:B,selectedStoreSlug:en,setSelectedStoreSlug:es,refetchSqlExecProvider:et,isLoading:ea}),[B,en,es,et,ea,I]);return(0,n.jsxs)("div",{className:(0,r.cn)("codeblock relative flex size-full !max-h-none flex-col overflow-hidden rounded-lg border font-sans",eo||ec||!I?"border-alpha-400":"border-gray-500 ring-2 ring-gray-100",t),"data-seg":"root",children:[(0,n.jsxs)("div",{className:"group/inline-code-block relative flex size-full flex-col overflow-hidden",children:[(0,n.jsxs)("div",{className:(0,r.cn)("bg-muted flex h-10 w-full shrink-0 items-center justify-between gap-2 rounded-t-lg border-b pl-2.5 pr-1.5",a),"data-seg":"skip",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[l?(0,n.jsx)("span",{className:"text-gray-500",children:u?(0,n.jsx)(M.W,{className:"size-3.5"}):(0,n.jsx)(C.y,{size:14})}):null,(0,n.jsx)("span",{className:"line-clamp-1 font-mono text-[13px] leading-none text-gray-500",children:d})]}),(0,n.jsx)("div",{className:"flex items-center space-x-1 text-gray-500",children:i})]}),(0,n.jsxs)("div",{className:(0,r.cn)("group relative size-full",!ec&&"pb-8",!E&&"!max-h-[250px] !overflow-y-hidden"),children:[!E&&(0,n.jsx)("div",{className:"code-wrapper-container absolute flex size-full items-end justify-center",children:(0,n.jsx)("div",{className:(0,r.cn)("expand-button from-background/90 via-background/75 z-10 hidden h-10 w-full translate-y-px items-center justify-center bg-gradient-to-t to-transparent px-1",ec||!I?"mb-0":"mb-10"),children:(0,n.jsxs)(v.$,{className:"h-7 w-full rounded-md",variant:"ghost",onClick:()=>T(!0),children:[(0,n.jsx)(S.y,{className:"size-3.5"}),(0,n.jsx)("span",{className:"sr-only",children:"Expand Code Block"})]})})}),p]}),I&&(0,n.jsx)(Y,{disabled:er,isExecuting:Q,isCancelled:ec,hasExecuted:eo,isBlockOutputError:ed,isAnyStdErr:eu,handleApplySql:ef,handleCancelSql:ex,handleFix:()=>{ep("The code:\n\n```\n".concat(c,"\n```\n\nProduced this output:\n\n").concat((0,P.z)(el),"\n\nPlease fix it."))},sqlDatabaseSelector:ev})]}),(0,n.jsx)(K,{blockOutput:el,hasExecuted:eo,isCancelled:ec,isCopied:em,onCopy:eg})]})}function Y(e){let{isExecuting:t,isCancelled:a,disabled:s,hasExecuted:l,isBlockOutputError:i,isAnyStdErr:o,handleCancelSql:c,handleApplySql:d,handleFix:u,sqlDatabaseSelector:m}=e;if(a)return null;let h=t||o?null:i?(0,n.jsx)("div",{className:"font-mono text-[13px] text-red-700",children:"Failed"}):l?(0,n.jsx)("div",{className:"font-mono text-[13px] text-gray-500",children:"Applied"}):(0,n.jsx)(v.$,{size:"sm",className:"h-7 rounded-md",disabled:s,variant:"outline",onClick:c,children:"Cancel"}),p=(0,n.jsxs)(v.$,{size:"sm",className:"h-7 rounded-md",onClick:d,disabled:s,variant:l?"outline":"default",children:[t?(0,n.jsx)(C.y,{size:16}):l?(0,n.jsx)(A._,{}):null,(0,n.jsx)("span",{children:t?"Applying":l?"Re-run":"Run Code"})," "]}),x=l&&o&&!t?(0,n.jsxs)(v.$,{onClick:u,size:"sm",className:"h-7 rounded-md",disabled:s,children:["Fix with ",(0,n.jsx)(I.o,{className:"-ml-0.5 mt-[1px]"})]}):null;return(0,n.jsxs)("div",{className:(0,r.cn)("bg-background absolute bottom-0 z-10 flex h-10 w-full shrink-0 items-center rounded-b-lg px-1.5",m?"justify-between":"justify-end"),children:[m,(0,n.jsxs)("div",{className:(0,r.cn)("flex items-center",l?"gap-3":"gap-1.5"),children:[h,p,x]})]})}function K(e){let{blockOutput:t,hasExecuted:a,isCancelled:s,isCopied:r,onCopy:l}=e;if(s)return null;let i=a&&t&&!("error"in t),o=i&&0===t.stdout.length&&0===t.stderr.length,c=i&&1===t.stdout.length&&1===t.stdout[0].length&&"[]"===t.stdout[0][0],d=i&&1===t.stdout.length&&1===t.stdout[0].length&&null===t.stdout[0][0];return i&&!(o||c||d)?(0,n.jsxs)("div",{className:"bg-muted group/sql-output relative flex w-full flex-col rounded-b-lg border-t",children:[(0,n.jsx)(T.Z,{"aria-label":"Copy",onClick:l,outline:!0,tooltip:"Copy",className:"absolute right-1.5 top-1.5 z-10 hidden group-hover/sql-output:flex",children:(0,n.jsx)(E.U,{isCopied:r,size:14})}),(0,n.jsx)(D.X3,{className:"h-full max-h-64",value:t,inline:!0})]}):null}function J(e){let{stores:t,selectedStoreSlug:a,setSelectedStoreSlug:r,refetchSqlExecProvider:l,isLoading:i}=e,{chatId:o}=(0,H.xz)(),c=(0,s.useMemo)(()=>t.find(e=>e.slug===a),[t,a]),d=async e=>{if(o){r(e);try{let t=await $(o,e);if("error"in t){j.o.error("Error",{description:t.error||"An error occurred while updating the SQL integration provider"}),r(a);return}await l()}catch(e){j.o.error("Error",{description:"An error occurred while updating the SQL integration provider"}),r(a)}}};return i?(0,n.jsx)(q.E,{className:"h-7 w-28 rounded-md"}):(0,n.jsx)("div",{children:(0,n.jsxs)(V.l6,{value:a,onValueChange:d,children:[(0,n.jsx)(V.bq,{className:"h-7 gap-2 pl-2 [&>svg]:!size-3",children:(0,n.jsx)(V.yv,{children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-1.5",children:[(null==c?void 0:c.icon)?(0,n.jsx)(B.default,{src:c.icon,alt:c.name,width:16,height:16,className:"rounded-full"}):(0,n.jsx)("div",{className:"size-4 rounded-full bg-gray-100"}),null==c?void 0:c.name]})})}),(0,n.jsx)(V.gC,{children:t.map(e=>(0,n.jsx)(V.eb,{value:e.slug,children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-1.5",children:[(0,n.jsx)(B.default,{src:e.icon,alt:e.name,width:16,height:16,className:"rounded-full"}),e.name]})},e.slug))})]})})}let Q=(0,h.default)(()=>Promise.all([a.e(95742),a.e(16676),a.e(11849),a.e(93405),a.e(73185),a.e(3374),a.e(78460),a.e(56403)]).then(a.bind(a,56403)).then(e=>e.MonacoEditor),{loadableGenerated:{webpack:()=>[56403]},ssr:!1}),X=(0,s.memo)(function(e){let t,{value:a,language:l,showLineNumbers:i,wrapLongLines:o,minLineNumberChars:c=2,isTabbed:d,originalCode:u,fixingBadLines:h,style:p}=e,x=a,g=(0,m.Of)(l),v=(0,s.useMemo)(()=>{if(u)return u.split("\n")},[u]),j=(x.match(/\n/g)||[]).length;if((!x||0===j)&&u)j=(u.match(/\n/g)||[]).length,t=e=>({className:(0,r.cn)("opacity-50",1===e&&void 0===h&&"block w-full animate-pulse bg-gray-100 opacity-100",(null==h?void 0:h.includes(e+1))&&"block w-full animate-pulse bg-red-100 opacity-100")}),x=u;else if(v&&v.length>j-1){x.endsWith("\n")&&(x=x.slice(0,-1));let e=x.lastIndexOf("\n"),a=(j=((x=x.slice(0,e>0?e:void 0)).match(/\n/g)||[]).length)+1,n=v.slice(j+1),s=n.join("\n");j+=n.length,t=e=>({className:(0,r.cn)(e===a&&"block w-full bg-blue-400/20",e>a&&"opacity-50")}),s&&(x=x+"\n"+s)}return(0,n.jsx)(f.A,{PreTag:"div",customStyle:{display:"flex",margin:0,width:"max-content",height:"min-content",padding:d?"12px 12px 10px 12px":"8px 10px",textShadow:"none",borderRadius:"0 0 calc(var(--radius) - 2px) calc(var(--radius) - 2px)",WebkitOverflowScrolling:"touch",backgroundColor:"transparent",fontFamily:"var(--font-geist-mono)",lineHeight:"1.55",fontSize:"0.8125rem",...p},language:g,lineNumberContainerStyle:{userSelect:"none",whiteSpace:"break-spaces",textAlign:"right",display:"flex",flexDirection:"column"},lineNumberStyle:{display:"inline-block",minWidth:"".concat(Math.max(j.toString().length,c),"ch"),padding:0,margin:"0 12px 0 0",color:"hsl(var(--gray-400))",userSelect:"none"},lineProps:t,showLineNumbers:i,useInlineStyles:!1,wrapLines:!0,wrapLongLines:o,children:x})}),ee=(0,s.memo)(e=>{let{language:t,value:a,blockId:l,originalCode:i,allowQuoting:d=!1,allowCopyCode:u=!0,allowDownloadCode:h=!0,allowClose:f=!1,closeHandler:v=null,className:j,headerClassName:b,fixingBadLines:y,codeWrapperClassName:w,fileName:N,showLineNumbers:k=!1,wrapLongLines:C=!1,additionalHeaderActions:S,caller:M,editable:I,showQuickEditAnimation:A,closed:D,onEdit:L,editValue:z,type:E,onExecutionComplete:P,sqlExecutionState:T,transaction:F}=e,R="inline"!==M,U=(0,g.F)(L),V=(0,s.useCallback)(e=>{if(void 0!==e){var t;null==(t=U.current)||t.call(U,e)}},[U]),{showDiffs:B}=(0,x.s)({blockId:l,fileName:N||"file.txt",originalCode:i,newCode:a}),_=(0,m.Of)(t),O=D&&null!=z?z:a,H=(0,n.jsx)(p.C,{additionalHeaderActions:S,allowClose:f,allowCopyCode:u,allowDownloadCode:h,originalCode:i,blockId:l,closed:D,caller:M,closeHandler:v,fileName:N||"file.txt",isTabbed:R,value:O,isExecutable:"script"===E,language:t,onExecutionComplete:P}),$=(0,n.jsx)("div",{className:"size-full text-gray-500 group-has-[.language-text]:text-black group-has-[.token]:text-black","data-seg":d?"code-root":void 0,children:(0,n.jsx)(X,{isTabbed:R,originalCode:i,fixingBadLines:y,language:t,showLineNumbers:k,value:a,wrapLongLines:C})}),q={className:j,headerClassName:b,language:t,showLineNumbers:k,fileName:N||("inline-sql"===E?"script.sql":"file.txt"),actions:H,syntax:i&&A||"inline"===M?(0,n.jsx)("div",{className:(0,r.cn)("group size-full overflow-scroll",w),children:$}):(0,n.jsx)(Q,{language:_,value:O,diffOriginalCode:B?i:null,closed:D,onEdit:V,disabled:!I})};return R?(0,n.jsx)(c,{...q}):"inline-sql"===E?(0,n.jsx)(Z,{...q,highlightedCode:$,blockId:l,source:a,closed:D,sqlExecutionState:T,transaction:F}):(0,n.jsx)(o,{...q})});ee.displayName="CodeBlock"},93119:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Checkbox:()=>c});var n=a(97667),s=a(33571),r=a(10336),l=a(28819),i=a(17773);let o=(0,a(60914).F)("disabled:bg-gray-150 disabled:hover:bg-gray-150 bg-background focus-visible:ring-offset-background peer size-4 shrink-0 rounded-sm border border-gray-400 text-gray-900 ring-blue-600 hover:border-gray-500 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:border-gray-300 disabled:hover:border-gray-300 data-[state=checked]:text-white",{variants:{variant:{default:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600",black:"data-[state=checked]:border-gray-900 data-[state=checked]:bg-gray-900"}},defaultVariants:{variant:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,...c}=e;return(0,n.jsx)(r.bL,{className:(0,l.cn)(o({variant:s,className:a})),ref:t,...c,children:(0,n.jsx)(r.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(i.J,{className:"size-2.5"})})})});c.displayName=r.bL.displayName},93929:(e,t,a)=>{"use strict";a.d(t,{a:()=>i});var n=a(97667),s=a(28819),r=a(66692),l=a(17773);function i(e){let{children:t,Icon:a,selected:i,className:o,onClick:c}=e;return(0,n.jsxs)(r.$,{className:(0,s.cn)("focus:bg-background flex h-12 items-center justify-between gap-1 px-4 font-medium text-gray-900 shadow-none transition-colors hover:focus:bg-gray-100",i&&"border border-blue-700 bg-blue-100 text-blue-600 hover:border-blue-700 hover:bg-blue-100 hover:brightness-[97%] focus:border-blue-700 focus:bg-blue-100 hover:focus:bg-blue-100 focus-visible:border-blue-700",o),onClick:c,size:"sm",type:"button",variant:"secondary",children:[(0,n.jsxs)("div",{className:"shrink-1 flex items-center gap-2 overflow-hidden",children:[a&&(0,n.jsx)(a,{className:"h-4 w-4 shrink-0"}),(0,n.jsx)("span",{className:"overflow-hidden text-ellipsis",children:t})]}),(0,n.jsx)("div",{className:(0,s.cn)("flex size-4 shrink-0 items-center justify-center rounded-sm border text-white",i&&"border-0 bg-blue-600"),children:i?(0,n.jsx)(l.J,{className:"stroke-background h-2 w-2"}):null})]})}},94669:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h,useDeleteSourceModal:()=>p});var n=a(97667),s=a(66692),r=a(28963),l=a(25603),i=a(16292),o=a(13729),c=a(70676);let d=(0,c.createServerReference)("403fe5d0efc2728b287109bd9955728682fe5a2992",c.callServer,void 0,c.findSourceMapURL,"deleteSource");var u=a(19243),m=a(25951);function h(e){let{projectId:t}=e,[a,l]=p(),{projectId:c}=(0,m.M9)(),h=t||c,{revalidateSources:x}=(0,m.py)(h);return a&&h?(0,n.jsx)(r.Modal,{onOpenChange:e=>!e&&l(null),open:!!a,children:(0,n.jsxs)("form",{action:async()=>{(0,u.u)("ClickDeleteSource",{targetSourceId:a});try{await d({sourceId:a,projectId:h}),x(),o.o.success("Source deleted")}catch(e){o.o.error("Failed to delete source")}await l(null)},children:[(0,n.jsxs)(r.ModalHeader,{children:[(0,n.jsx)(r.ModalTitle,{children:"Are you sure you want to delete this source?"}),(0,n.jsx)(r.ModalDescription,{children:"This action cannot be undone."})]}),(0,n.jsxs)(r.ModalFooter,{children:[(0,n.jsx)(r.ModalClose,{asChild:!0,children:(0,n.jsx)(s.$,{onClick:()=>l(null),size:"sm",variant:"secondary",children:"Cancel"})}),(0,n.jsx)(i.Q,{size:"sm",variant:"destructive",children:"Delete"})]})]})}):null}function p(){let{data:e,mutate:t}=(0,l.Ay)("deleteSourceModalId",null);return[e,t]}},94719:(e,t,a)=>{"use strict";a.d(t,{h:()=>s});var n=a(70676);let s=(0,n.createServerReference)("40c17419bb5a1c4fcbc984b8e49f71730a0a78de93",n.callServer,void 0,n.findSourceMapURL,"upsertPaymentMethodAction")},94906:(e,t,a)=>{"use strict";a.d(t,{H5:()=>p,Rm:()=>x,kP:()=>h});var n=a(97667),s=a(25603),r=a(66692),l=a(33571),i=a(27693),o=a(18513),c=a(13729),d=a(28963),u=a(49848),m=a(12);function h(){let{data:e,mutate:t}=(0,s.Ay)("showRenameFileDialog",null,{fallbackData:!1}),{data:a,mutate:n}=(0,s.Ay)("renameFileDialogData",null,{fallbackData:{fileName:""}});return{renameFileDialogData:a,setRenameFileDialogData:n,showRenameFileDialog:e,setShowRenameFileDialog:t}}async function p(e,t,a,n){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=[...e],l=r.findIndex(e=>e.meta.file===t.fileName);if(-1===l)throw Error("File not found");let i=t.fileName.split("/").slice(0,-1).join("/"),o=s?a:i?"".concat(i,"/").concat(a):a;if(r[l].meta.file=o,r[l].isMoved=!0,r[l].isUserEdit=!0,!(await n([...r],{moveFile:{from:t.fileName,to:o}})).success)throw Error("Failed");return o}function x(e){let{blockId:t,sourceFiles:a,onSuccess:s}=e,{renameFileDialogData:x,showRenameFileDialog:f,setShowRenameFileDialog:g}=h(),v=(0,m.W)(t),[j,b]=(0,l.useState)(!1),[y,w]=(0,l.useState)(""),N=(0,i.k)();(0,l.useEffect)(()=>{w(x.fileName.split("/").slice(-1)[0])},[x.fileName]);let k=(0,l.useCallback)(async e=>{e.preventDefault();try{b(!0);let e=await p(a,x,y,v);s(e)}catch(e){c.o.error(N("fileTreeActions.renameFileNotificationError"))}finally{b(!1)}},[a,s,x,N,v,y]);return(0,n.jsxs)(d.Modal,{onOpenChange:g,open:f,responsive:!1,children:[(0,n.jsx)(d.ModalHeader,{children:(0,n.jsx)(d.ModalTitle,{children:N("fileTreeActions.renameFile")})}),(0,n.jsx)(d.ModalContent,{children:(0,n.jsx)("form",{className:"flex flex-col gap-6",onSubmit:k,children:(0,n.jsx)(u.p,{onChange:e=>w(e.target.value),disabled:j,value:y})})}),(0,n.jsxs)(d.ModalFooter,{children:[(0,n.jsx)(d.ModalClose,{asChild:!0,children:(0,n.jsx)(r.$,{size:"sm",variant:"secondary",children:N("fileTreeActions.cancel")})}),(0,n.jsx)(r.$,{"data-testid":"confirm-delete-message",disabled:j,onClick:k,size:"sm",children:j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.IconSpinner,{className:"size-4"}),N("fileTreeActions.renaming")]}):N("fileTreeActions.rename")})]})]})}},95734:(e,t,a)=>{"use strict";a.d(t,{nH:()=>h,BG:()=>m});var n=a(33571),s=a(25603),r=a(94282),l=a(80672),i=a(19182),o=a(2230);let c=new Map,d=new Map,u=new Set;function m(e,t,a){var m;let h=(0,n.useId)(),p=e[0],x=e[1],f=(0,o.mO)(),g=(0,o.$Q)(p);if(!f)throw Error("useContextSWR: Missing top level ContextSWR");let v=(0,n.useMemo)(()=>f.routes[p][x],[f.routes,p,x]),j=(0,n.useMemo)(()=>!!g&&0!==Object.keys(g).length&&x in g.promises,[g,x]),b=(0,n.useMemo)(()=>j?g.promises[x]:null,[g,x,j]),y=(0,n.useMemo)(()=>{let e=null;return j&&(e=g.params),{...e,...t}},[t,j,g.params]),w=(0,n.useMemo)(()=>f.getAtoms[p](y),[f.getAtoms,p,y])[x],N=(0,l.useAtomValue)(w),k=(0,n.useCallback)(e=>r.M.set(w,e),[w]),C=(0,n.useMemo)(()=>g?(0,s.WI)([g.serverContextCreationTime]):"client-only",[g]),S=(0,n.useMemo)(()=>(0,s.WI)([x,y]),[x,y]),M=(0,n.useMemo)(()=>(0,s.WI)([S,C]),[C,S]),I=(0,n.useMemo)(()=>(0,s.WI)([x,h]),[x,h]),A=(0,n.useCallback)(async()=>{let e;return d.get(S)?N:(c.set(S,I),!u.has(C)&&b?(e=await b,u.add(C)):e=await (0,i.createRouteFetcherForAction)(v)(y),c.get(S)===I&&(d.get(S)||k(e),c.delete(S)),e)},[S,I,C,b,N,v,y,k]),D=(0,s.Ay)(M,(null==a?void 0:a.stopFetch)?null:A,{...(null==a?void 0:a.revalidateNever)?{revalidateOnFocus:!1,revalidateIfStale:!1,revalidateOnMount:!1,revalidateOnReconnect:!1,revalidateNever:!0}:{},...a}),L=(0,n.useCallback)(async e=>{let t,{serverMutate:a,optimisticData:n}=e;d.set(S,I),null!==n&&k(n);try{t=await a}catch(e){throw d.delete(S),D.mutate(A),e}return d.get(S)===I&&d.delete(S),await D.mutate(A),t},[A,D,k,I,S]),z=(0,n.useCallback)(async()=>D.mutate(A),[A,D]),E=b&&void 0===D.data;if(!b&&r.M.get(w)&&(null==(m=r.M.get(w))?void 0:m.__ASSERT_SWR_DATA)===!0)throw Error("useContextSWR:    You are trying to access asserted data for "+"   ".concat(p,".").concat(String(x)," ")+"   promise: ".concat(b," ")+"   response.data: ".concat(D.data," ")+"   uniqueKey: ".concat(S," ")+"   fetchKey: ".concat(M," ")+"   store.get(atom): ".concat(r.M.get(w)," ")+"   but no promise was found.    This is probably because you are trying to access data from a server component.");if(E){let e=(0,n.use)(b);d.get(S)||k(e),u.add(C)}let P=r.M.get(w);if(!b&&void 0===P)throw z();return{...D,data:P,mutate:L,revalidate:z}}let h={__ASSERT_SWR_DATA:!0}},95820:(e,t,a)=>{"use strict";a.d(t,{ChatActions:()=>R,$:()=>B});var n=a(97667),s=a(33571),r=a(66692),l=a(28819),i=a(39929),o=a(19243),c=a(43573),d=a(43447),u=a(94177),m=a(19807),h=a(74883),p=a(41956),x=a(99647),f=a(73832);let g={hover:{opacity:1,y:[0,2,0],transition:{...x.Ez,y:{...x.Ez,duration:1.1,repeat:Number.POSITIVE_INFINITY}}}},v=e=>({opacity:[0,1],y:[16,0],scaleX:1,scaleY:1,interruptible:!1,transition:{ease:[.13,.65,.14,1],duration:.25,delay:e}}),j=(0,f.G)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75011 3.56062L11.2501 6.06062L12.3108 4.99996L8.70722 1.39641C8.3167 1.00588 7.68353 1.00588 7.29301 1.39641L3.68945 4.99996L4.75011 6.06062L7.25011 3.56062V13.5H8.75011V3.56062Z" fill="currentColor"/>'),b=(0,f.G)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75011 3.56062L11.2501 6.06062L12.3108 4.99996L8.70722 1.39641C8.3167 1.00588 7.68353 1.00588 7.29301 1.39641L3.68945 4.99996L4.75011 6.06062L7.25011 3.56062V11H8.75011V3.56062Z" fill="currentColor"/>'),y=(0,f.G)('<path clip-rule="evenodd" d="M13.5 13.5L13.5 8.5L15 8.5L15 14C15 14.5523 14.5523 15 14 15L2 15C1.44771 15 1 14.5523 1 14L1 8.5L2.5 8.5L2.5 13.5L13.5 13.5Z" fill="currentColor" fill-rule="evenodd"/>'),w=(0,n.jsxs)(x.kd,{hideOverflow:!0,children:[(0,n.jsx)(x.Dp,{variants:{...g,idle:{opacity:0},tap:{opacity:0,y:-16,interruptible:!1,transition:{ease:[.33,.03,.94,.42],duration:.5}}},children:(0,n.jsx)(j,{})}),(0,n.jsx)(x.Dp,{variants:{...g,idle:{opacity:1},tap:v(.4)},children:(0,n.jsx)(b,{})}),(0,n.jsx)(x.Dp,{variants:{hover:{opacity:0,y:4,scaleX:0,scaleY:.5,transition:x.Ez},idle:{opacity:1,scaleX:1,scaleY:1},tap:v(.47)},children:(0,n.jsx)(y,{})})]});var N=a(25887),k=a(27693),C=a(13729),S=a(69114),M=a(70158),I=a(71543),A=a(42438),D=a(73655),L=a(70676);let z=(0,L.createServerReference)("400485e6ae6af9f34a9679c22c7c8fc6dcc82eff05",L.callServer,void 0,L.findSourceMapURL,"unfavoriteChat"),E=(0,L.createServerReference)("40b7cbd2ddf6e32eb6de5313c8786a4c47589df273",L.callServer,void 0,L.findSourceMapURL,"favoriteChat");var P=a(83945),T=a(20630);function F(e){let{chat:t,setChatHistoryData:a}=e,{user:r}=(0,I.J)(),{activeScope:l}=(0,D.k6)(),c=(0,k.k)(),m=t.authorId===(null==r?void 0:r.id),h=(0,s.useMemo)(()=>!!(l&&"membership"in l&&"OWNER"===l.membership.role),[l]),p=m||h,{copyToClipboard:x}=(0,A.j)({timeout:2e3});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.DropdownMenuItem,{onSelect:()=>{if(p){var e;(0,N.D)({type:"shareChat",data:{chatId:t.chatId,privacy:null!=(e=t.privacy)?e:"private"}})}else x(window.location.href),C.o.success("Share link copied!")},children:[w,(0,n.jsx)("span",{children:c("chatActions.share")})]}),m&&(0,n.jsxs)(i.DropdownMenuItem,{onSelect:()=>{(0,o.u)("RenameChat",{targetChatId:t.chatId}),(0,N.D)({type:"updateChatTitle",data:{chatId:t.chatId}})},children:[(0,n.jsx)(u.Y,{}),(0,n.jsx)("span",{children:c("chatActions.rename")})]}),m?(0,n.jsx)(B,{chat:t,setChatHistoryData:a}):null,m&&(0,n.jsxs)(i.DropdownMenuItem,{onSelect:()=>{(0,N.D)({type:"deleteChat",data:{chatId:t.chatId}})},variant:"destructive",children:[(0,n.jsx)(d.l,{}),(0,n.jsx)("span",{children:c("chatActions.delete")})]})]})}function R(e){let{chat:t,onOpenChange:a,open:s,className:o,side:d="bottom",setChatHistoryData:u,disabled:m,...h}=e,x=(0,p.al)();return(0,n.jsxs)(i.DropdownMenu,{onOpenChange:a,open:s,children:[(0,n.jsx)(i.DropdownMenuTrigger,{asChild:!0,disabled:m,children:(0,n.jsxs)(r.$,{className:(0,l.cn)("relative z-10 size-7 shrink-0 rounded-md p-0 transition-none has-[>svg]:p-0 ",o),"cmdk-item-actions":"",size:"sm",variant:"ghost",...h,children:[(0,n.jsx)(c.a,{}),(0,n.jsx)("span",{className:"sr-only",children:"Open chat actions"})]})}),(0,n.jsx)(i.DropdownMenuContent,{align:x?"end":"right"===d?"start":"end",side:x?"bottom":d,sideOffset:8,children:(0,n.jsx)(i.DropdownMenuGroup,{children:(0,n.jsx)(F,{chat:t,side:d,setChatHistoryData:u})})})]})}function U(e){let{setChatHistoryData:t,setChatFavoritesData:a,chat:r}=e,l=(0,k.k)(),c=(0,M.usePathname)(),d=(0,M.useRouter)(),{data:{favorites:u,history:p},mutate:x}=(0,T.B)(["scoped","chats"],{}),[f,g]=(0,s.useTransition)(),[v,j]=(0,s.useOptimistic)(r.favorite);return(0,n.jsxs)(i.DropdownMenuItem,{variant:v?"gold":"default",disabled:f,onSelect:async()=>{let e={...r,title:r.title||"",privacy:"private",shareable:!1,authorId:"",updatedAt:r.updatedAt||new Date};r.favorite?((0,o.u)("UnfavoriteChat",{targetChatId:r.chatId}),await x({serverMutate:z(r.chatId),optimisticData:{favorites:u.filter(e=>e.chatId!==r.chatId),history:(0,P.p)([...p,e],"updatedAt")}})):((0,o.u)("FavoriteChat",{targetChatId:r.chatId}),await x({serverMutate:E(r.chatId),optimisticData:{favorites:(0,P.p)([...u,e],"updatedAt"),history:p.filter(e=>e.chatId!==r.chatId)}})),g(()=>{j(e=>!e),r.favorite?(t(e=>{let t=e.findIndex(e=>e.updatedAt&&r.updatedAt&&e.updatedAt<r.updatedAt),a={...r,authorId:"",privacy:"private",shareable:!1,favorite:!1};return t<0?[...e,a]:[...e.slice(0,t),a,...e.slice(t)]}),a(e=>e.filter(e=>e.chatId!==r.chatId))):(t(e=>e.filter(e=>e.chatId!==r.chatId)),a(e=>{let t=e.findIndex(e=>e.updatedAt&&r.updatedAt&&e.updatedAt<r.updatedAt),a={...r,authorId:"",privacy:"private",shareable:!1,favorite:!0};return t<0?[...e,a]:[...e.slice(0,t),a,...e.slice(t)]})),"/chat/history"===c&&d.refresh()})},children:[v?(0,n.jsx)(h.e,{}):(0,n.jsx)(m.F,{}),(0,n.jsx)("span",{children:l(v?"chatActions.unfavorite":"chatActions.favorite")})]})}function V(e){let{...t}=e,{setData:a}=(0,S.m)(),{setData:s}=(0,S.r)();return(0,n.jsx)(U,{...t,setChatHistoryData:a,setChatFavoritesData:s})}function B(e){let{...t}=e;return t.setChatHistoryData&&t.setChatFavoritesData?(0,n.jsx)(U,{...t,setChatHistoryData:t.setChatHistoryData,setChatFavoritesData:t.setChatFavoritesData}):(0,n.jsx)(V,{...t})}},95995:(e,t,a)=>{"use strict";a.d(t,{W:()=>p,h:()=>f});var n=a(97667),s=a(33571),r=a(51311),l=a(94906),i=a(11946),o=a(12),c=a(91581),d=a(30227),u=a(75997),m=a(36863),h=a(74118);function p(){return Promise.all([a.e(83167),a.e(95742),a.e(16676),a.e(44387),a.e(11849),a.e(93405),a.e(73185),a.e(48892),a.e(92178),a.e(18150),a.e(78460),a.e(40933),a.e(91256)]).then(a.bind(a,40933)).then(async e=>(await e.init(),e.VSCodeEditor))}let x=(0,r.default)(p,{ssr:!1});function f(e){let{blockId:t,source:a,files:r,activeFilePath:p,editValueMap:f,onEdit:g,reloadIframe:v}=e,j=(0,s.useRef)(),b=(0,m.F)((0,o.W)(t)),y=(0,s.useRef)(a),w=(0,s.useRef)(t),{isStreaming:N}=(0,h.Pk)(),k=(0,s.useState)(()=>{let e=Promise.resolve();return t=>{e=e.then(()=>t((0,u.A2)({source:y.current,blockType:"code-project",blockId:w.current})))}})[0],C=(0,s.useMemo)(()=>({onRename:(e,t)=>{k(async a=>{await (0,l.H5)(a,{fileName:e},t,b.current,!0),v()})},onDeleteFolder(e){k(async t=>{await (0,d.sE)(t,{folderName:e},b.current),v()})},onDeleteFile(e){k(async t=>{await (0,c.Ww)(t,{fileName:e},b.current),v()})},onNewFolder:e=>{},onNewFile:(e,t,a)=>{k(async n=>{n.some(a=>a.meta.file==="".concat(e,"/").concat(t))||(await (0,i.x3)(w.current,n,{folderName:e},t,a,b.current),v())})}}),[]);return(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)("div",{children:"Loading..."}),children:(0,n.jsx)(x,{onEdit:g,diffOriginalCode:null,disabled:!1,readOnly:N,files:r,editValueMap:f,activeFilePath:p,ref:j,blockId:t,eventCallbacks:C})})}},96151:(e,t,a)=>{"use strict";a.d(t,{k:()=>k,y:()=>C});var n=a(97667),s=a(33571),r=a(66692),l=a(7086),i=a(13729),o=a(6902),c=a(93929),d=a(74702),u=a(74118),m=a(28819),h=a(28963),p=a(27693),x=a(71543),f=a(71741),g=a(39929),v=a(70676);let j=(0,v.createServerReference)("40a8ee7047a5b1822427e2280830cf624a1476eedf",v.callServer,void 0,v.findSourceMapURL,"sendFlag");var b=a(8689),y=a(22447),w=a(25887);function N(e){let{children:t,value:a,reasons:s}=e;return(0,n.jsx)(c.a,{className:"is-mobile:text-xs",onClick:()=>s.toggle(a),selected:s.has(a),children:t})}function k(e){let{blockId:t}=e,{chatId:a}=(0,u.xz)(),{user:c}=(0,x.J)(),[f,g]=(0,s.useState)(""),v=(0,d.L)(),k=(0,p.k)(),C=(0,s.useCallback)(()=>{g(""),v.clear(),(0,w.z)()},[v]),S=(0,s.useCallback)(async e=>{if(e.preventDefault(),!a)return void i.o.error("Failed to submit flag. Please try again later.");try{await Promise.all([C(),j({feedback:f,reasons:v.values,chatId:a,blockId:t,userId:null==c?void 0:c.id}),i.o.success("Successfully flagged Block")])}catch(e){console.error(e),i.o.error("Failed to submit flag. Please try again later.")}},[C,f,v.values,a,t,null==c?void 0:c.id]),M=(0,s.useMemo)(()=>(0,n.jsxs)("form",{className:(0,m.cn)("flex flex-col","is-mobile:gap-3 is-not-mobile:gap-6"),onSubmit:S,children:[(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsxs)("div",{className:"grid w-full grid-cols-2 items-center justify-start gap-2",children:[(0,n.jsx)(N,{reasons:v,value:"inappropriate",children:"Inappropriate Content"}),(0,n.jsx)(N,{reasons:v,value:"copyright",children:"Copyright Violation"}),(0,n.jsx)(N,{reasons:v,value:"illegal",children:"Illegal Content"}),(0,n.jsx)(N,{reasons:v,value:"other",children:"Other"})]})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(o.Label,{className:"text-sm font-normal text-gray-500",htmlFor:"downvote-feedback",children:"Please provide your reasoning for flagging this generation."}),(0,n.jsx)(l.T,{asChild:!0,children:(0,n.jsx)(b.o,{id:"downvote-feedback",name:"feedback",onChange:e=>g(e.target.value),placeholder:"Additional information...",minHeight:80,maxHeight:192,value:f})})]}),(0,n.jsxs)("div",{className:"is-mobile:flex-col-reverse is-not-mobile:flex-row flex w-full items-center justify-end gap-2",children:[(0,n.jsx)(r.$,{className:"is-mobile:w-full",onClick:e=>{e.preventDefault(),C()},size:"sm",variant:"secondary",children:k("downvoteDialog.cancel")}),(0,n.jsx)(r.$,{className:"is-mobile:w-full",size:"sm",type:"submit",children:k("downvoteDialog.submit")})]})]}),[S,v,k,f,C]);return(0,n.jsx)(y._,{type:"flagBlock",children:(0,n.jsxs)("div",{className:"overflow-auto",children:[(0,n.jsxs)(h.ModalHeader,{children:[(0,n.jsx)(h.ModalTitle,{children:"Flag a generation"}),(0,n.jsx)(h.ModalDescription,{children:"Flag a generation for inappropriate, abusive, or illegal content."})]}),(0,n.jsx)(h.ModalContent,{children:M})]})})}function C(e){let{blockId:t,isMenuItem:a=!1,closeMenu:l,...i}=e,o=(0,s.useCallback)(()=>{l&&l(),(0,w.D)({type:"flagBlock",data:{blockId:t}})},[l,t]);return a?(0,n.jsxs)(g.DropdownMenuItem,{onClick:o,children:[(0,n.jsx)(f.l,{}),(0,n.jsx)("span",{children:"Flag"})]}):(0,n.jsx)(r.$,{"aria-label":"Flag Generation",onClick:o,size:"sm",className:"size-7 rounded-md",tooltip:"Flag",variant:"ghost",...i,children:(0,n.jsx)(f.l,{})})}},97396:(e,t,a)=>{"use strict";a.d(t,{C1:()=>m,Ir:()=>u,K1:()=>r,Mb:()=>n,RA:()=>d,_z:()=>s,n1:()=>h,pe:()=>o,qQ:()=>l,qR:()=>i});let n=(e,t,a)=>{if(!e)return;let n=e.findIndex(e=>e===t);return n<0?e:[...e.slice(0,n),a]},s=(e,t)=>void 0===e?[t]:[...e,t],r=e=>e&&e.length>0?e[e.length-1]:void 0,l=(e,t)=>e?[...e.slice(0,e.length-1),t]:s(void 0,t),i=(e,t)=>{if(!e)return;let a=e.findIndex(e=>e===t);if(!(a<0))return e[a-1]},o="<ROOT_MESSAGE>";function c(e){let t=new Map;for(let a of e){let e=a.parentId||o;t.set(e,[...t.get(e)||[],a])}return t}function d(e){let t=c(e),a=new Set,n=new Map,r=(e,l)=>{var i;if(e&&a.has(e.id))return;let c=t.get(e?e.id:o);e&&a.add(e.id);let d=[];for(let e=0;e<(null!=(i=null==c?void 0:c.length)?i:0);e++){let t=c[e],a=s(l,t.id);d.push(a),r(t,a)}n.set(e?e.id:o,d)};return r(void 0,void 0),n}function u(e,t){let a=c(e),n=new Set,s=[];return!function e(t){if(!n.has(t))for(let r of(n.add(t),a.get(t)||[]))s.push(r.messageId),e(r.messageId)}(t||o),s}function m(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",n=t,l=c(e),i=r(n)||o,d=l.get(i)||[],u=new Set;for(;d.length>0;){let{id:e}=d["left"===a?0:d.length-1];if(u.has(e))break;u.add(e),n=s(n,e),d=l.get(e)||[]}return n}function h(e,t){let a,n=t;if(0===e.length)return;let l=c(e);null!==n&&e.some(e=>e.messageId===n)||(n=e.reduce((e,t)=>e.createdAt>t.createdAt?e:t).messageId);let i=new Set;return!function e(t,r){if(!i.has(t||o))for(let c of(i.add(t||o),l.get(t||o)||[])){let t=s(r,c.messageId);if(c.messageId===n){a=t;return}e(c.messageId,t)}}(void 0,void 0),(e=>{var t,a;let n=new Set,i=null==(t=l.get(e&&r(e)||o))?void 0:t[0],c=e;for(;i&&!n.has(i.messageId);)n.add(i.messageId),c=s(c,i.messageId),i=null==(a=l.get(i.messageId))?void 0:a[0];return c})(a)}},98523:(e,t,a)=>{"use strict";a.d(t,{C:()=>k});var n=a(97667),s=a(42438),r=a(33571),l=a(37631),i=a(84089),o=a(8088),c=a(80693),d=a(13263),u=a(27693),m=a(54483),h=a(86943),p=a(28819);let x=e=>{let{size:t=16,className:a}=e;return(0,n.jsxs)("svg",{className:(0,p.cn)("trash-icon overflow-visible",a),fill:"none",stroke:"currentColor",height:t,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M10.0001 1.33203H4.00008C3.64646 1.33203 3.30732 1.47251 3.05727 1.72256C2.80722 1.9726 2.66675 2.31174 2.66675 2.66536V13.332C2.66675 13.6857 2.80722 14.0248 3.05727 14.2748C3.30732 14.5249 3.64646 14.6654 4.00008 14.6654H12.0001C12.3537 14.6654 12.6928 14.5249 12.9429 14.2748C13.1929 14.0248 13.3334 13.6857 13.3334 13.332V4.66536L10.0001 1.33203Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M6 6.66797H10",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"square",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M8 8.66797V4.66797",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"square",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M6 11.332H10",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"square",strokeLinejoin:"round"})]})};var f=a(15154),g=a(25426),v=a(35853),j=a(80574),b=a(19243),y=a(73655),w=a(32136),N=a(13729);function k(e){let{fileName:t="file.txt",value:a,caller:p,additionalHeaderActions:k,allowCopyCode:C,allowDownloadCode:S,closeHandler:M,isTabbed:I,allowClose:A,blockId:D,originalCode:L,closed:z,isExecutable:E,transactionMeta:P,language:T,onExecutionComplete:F}=e,{isCopied:R,copyToClipboard:U}=(0,s.j)({timeout:2e3}),{setShowDiffs:V,hasDiffs:B,showDiffs:_}=(0,m.s)({blockId:D,fileName:t,originalCode:L,newCode:a}),O=(0,u.k)(),[H,$]=(0,r.useState)(!1),{activeScopeSlug:q}=(0,y.k6)(),{project:W}=(0,w.tZ)(),G=null==W?void 0:W.projectId,Z=async()=>{if(T&&!H){$(!0);try{let e;if("sql"===T){if(!q)return void N.o.error("Error",{description:"Missing active scope"});if(!G)return void N.o.error("Error",{description:"Missing project ID"});e=await (0,f.W)({props:{language:T,blockId:D,source:a,meta:{file:t,transaction:P},closed:z,originalCode:L,isPreviewable:!0},v0ProjectId:G})}else e=await (0,g.M)({language:T,blockId:D,source:a,meta:{file:t,transaction:P},closed:z,originalCode:L,isPreviewable:!0});if("error"in e)N.o.error("Error",{description:"Error executing code"}),null==F||F([{type:"output",blockId:D,fileName:t||"untitled",content:e.error,timestamp:new Date().toISOString(),method:"stderr"}]);else{let a=await (0,v.e)(e,D,t||"untitled");null==F||F(a)}}finally{$(!1)}}},Y=async()=>{if(!R)switch(await U(a),p){case"inline":return(0,b.u)("CopyCodeInline",{code:a});case"executable":return(0,b.u)("CopyCodeExecutable",{code:a});case"v0":return(0,b.u)("CopyCodeV0",{code:a})}};return(0,n.jsxs)(n.Fragment,{children:[k&&k.length>0?k:null,E&&T&&(0,n.jsx)(l.Z,{"aria-label":"Run Code",onClick:Z,disabled:H,tooltip:{side:"bottom",content:H?"Running...":"Run Code"},children:(0,n.jsx)("span",{"aria-hidden":!0,children:H?(0,n.jsx)(j.y,{size:16}):(0,n.jsx)(o.N,{})})}),z&&B&&(0,n.jsx)(l.Z,{"aria-label":O(_?"codeBlockActions.hideDiff":"codeBlockActions.showDiff"),active:_,onClick:()=>{V(!_),setTimeout(()=>{let e=document.getElementById(h.yj);e&&e.scrollIntoView({behavior:"instant"})},0)},outline:!I,tooltip:I?{side:"bottom",content:O(_?"codeBlockActions.hideDiff":"codeBlockActions.showDiff")}:O(_?"codeBlockActions.hideDiff":"codeBlockActions.showDiff"),children:(0,n.jsx)(x,{size:"inline"===p?14:void 0})}),C&&(0,n.jsx)(l.Z,{"aria-label":O("codeBlockActions.copy"),onClick:Y,outline:!I,tooltip:I?{side:"bottom",content:O("codeBlockActions.copy")}:O("codeBlockActions.copy"),children:(0,n.jsx)(d.U,{isCopied:R,size:"inline"===p?14:void 0})}),S&&(0,n.jsx)(l.Z,{"aria-label":O("codeBlockActions.download"),onClick:()=>{let e=t.split("/").pop(),n=window.prompt("Enter file name",e);if(!n)return;let s=new Blob([a],{type:"text/plain"}),r=URL.createObjectURL(s),l=document.createElement("a");switch(l.download=n,l.href=r,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),p){case"executable":return(0,b.u)("DownloadCodeExecutable",{code:a});case"v0":return(0,b.u)("DownloadCodeV0",{code:a})}},outline:!I,tooltip:I?{side:"bottom",content:O("codeBlockActions.download")}:O("codeBlockActions.download"),children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(c.q,{})})}),A&&M&&(0,n.jsx)(l.Z,{"aria-label":O("codeBlockActions.close"),onClick:M,outline:!I,tooltip:I?{side:"bottom",content:O("codeBlockActions.close")}:O("codeBlockActions.close"),children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(i.F,{})})})]})}},98791:(e,t,a)=>{"use strict";a.d(t,{m:()=>c});var n=a(97667),s=a(60914),r=a(28819),l=a(27831),i=a(33571);let o=(0,s.F)("flex h-4 w-4 items-center justify-center overflow-hidden rounded-full [&>*]:absolute [&>*]:rounded-full",{variants:{state:{queued:"[&>div]:bg-gray-100 group-hover:[&>div]:bg-gray-200  [&>span]:bg-gray-700",ready:"[&>div]:bg-blue-100 group-hover:[&>div]:bg-blue-200 [&>span]:bg-blue-600",error:"[&>div]:bg-red-100 group-hover:[&>div]:bg-red-200 [&>span]:bg-red-600",building:"[&>div]:bg-amber-100 group-hover:[&>div]:bg-amber-200 [&>span]:bg-amber-600",green:"[&>div]:bg-green-100 group-hover:[&>div]:bg-green-200 [&>span]:bg-green-600"}}});function c(e){let{state:t="queued",className:a,stopPing:s=!1,...c}=e,[d,u]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{s&&setTimeout(()=>u(!1),1e3)},[s]),(0,n.jsxs)("span",{...c,className:o({state:t,className:a}),children:[(0,n.jsx)("div",{className:"h-4 w-4 transition-colors duration-200"}),(0,n.jsx)("span",{className:"h-2 w-2"}),(0,n.jsx)("span",{className:(0,r.cn)("h-2 w-2 animate-ping",!d&&"animate-none"),style:{...(0,l.iA)(["opacity"],{duration:1e3})}})]})}},99066:(e,t,a)=>{"use strict";a.d(t,{tg:()=>V,vX:()=>q,pN:()=>_,Co:()=>H,yI:()=>O});var n=a(33571),s=a(75513),r=a(69114),l=a(74118),i=a(13729),o=a(76727),c=a(36323),d=a(36863),u=a(70158),m=a(32136),h=a(97396),p=a(12160),x=a(18858),f=a(93187),g=a(12507),v=a(19243),j=a(21715),b=a(25951),y=a(52520),w=a(73655),N=a(40445);async function k(e){return new Promise((t,a)=>{let n=new FileReader;n.onload=e=>{var a;t(null==(a=e.target)?void 0:a.result)},n.onerror=e=>a(e),n.readAsDataURL(e)})}var C=a(688),S=a(25603),M=a(70676);let I=(0,M.createServerReference)("00f41d91f04e17951ccc547d71271b3b84d8383de2",M.callServer,void 0,M.findSourceMapURL,"invalidateRouterCache");var A=a(13443);function D(e){if(!e||/[^0-9-\s]+/.test(e)||"0000000000000000"===e)return!1;let t=0,a=!1;e=e.replace(/\D/g,"");for(let n=e.length-1;n>=0;n--){let s=parseInt(e.charAt(n),10);a&&(s*=2)>9&&(s-=9),t+=s,a=!a}return t%10==0}var L=a(79463),z=a(86943),E=a(4842),P=a(72770),T=a(86184),F=a(76603),R=a(10838),U=a(84002);let V="opt-retry-message",B=[{name:"creditCardDetector",action:function(e){return(e.match(/\b(?:\d{4}[-\s]?){3}\d{4}\b/g)||[]).filter(D).length>0},confirm:"We've detected a credit card number in your message. Are you sure you want to continue?"}];async function _(e,t){let a=[];if(!e&&t)if(t instanceof FileList)for(let e of Array.from(t)){let{name:t,type:n,size:s}=e,r=await k(e);a.push({name:t,contentType:n,url:r,size:s})}else if(Array.isArray(t))for(let e of t){let{name:t,url:n,contentType:s,size:r,v0Type:l,content:i}=e;a.push({name:t,contentType:s,v0Type:l,url:n,size:r,content:i})}else throw Error(f.Jk);return a}function O(){let{onSubmit:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeScope:t,user:a}=(0,w.k6)(),h=(0,c.y6)(),{setPromptFormInput:y}=(0,T.Q1)(),{setEditPromptForm:k}=(0,F.KM)(),M=(0,c.oQ)(),{chatId:D,messages:V,chatIdToken:O,activeForkKey:$,isLoading:W,undo:G}=(0,l.Pk)(),Z=(0,l.jo)(),{setMetadata:Y,project:K}=(0,m.tZ)(),{setDraft:J}=(0,j.jh)(),{quote:Q,setQuote:X}=(0,m.sC)(),{revalidate:ee,setData:et}=(0,r.m)(),ea=(0,d.F)(e),en=(0,d.F)(V),[,es]=(0,x.d)(),{selectedProjectId:er}=(0,b._t)(),{mutate:el}=(0,S.Ay)("text-area-value",null),ei=function(){let e=(0,c.eu)();var t="activeBlockIdRef",a=null==e?void 0:e.id;let s=function(e){let t=(0,n.useRef)(),{data:a,mutate:s}=(0,S.Ay)(e);return(0,n.useEffect)(()=>{a||s(t)},[a,s]),a}(t);return(0,n.useEffect)(()=>{s&&(s.current=a)},[s,a]),s}(),{setBlockCreatedAt:eo}=(0,L.y)(),ec=(0,u.useRouter)(),ed=(0,n.useMemo)(()=>(0,A.C)(),[]),{stores:eu,refetch:em}=(0,R.g)({v0ProjectId:null==K?void 0:K.projectId,vercelProjectId:null==K?void 0:K.vercelProjectId,refreshInterval:0}),{refetchVercelProject:eh,envVars:ep}=(0,b.Ok)(null==K?void 0:K.projectId),ex=(0,d.F)(ep);return{submit:(0,n.useCallback)(async(e,n)=>{var r,l,c,d;if(e.revalidateVercelEnvAndIntegrations){let[[e,t],a]=await Promise.all([em(),eh()]);t&&(eu.data=t),(null==a?void 0:a.envVars)&&(ex.current=a.envVars)}for(let t of B)if("input"in e&&e.input&&t.action(e.input)&&!confirm(t.confirm))return;if((null==a?void 0:a.id)||!ed||(a={id:ed,username:"anon",avatar:"",plan:"anon",email:"",name:"Anonymous",teams:[],createdAt:"1970-01-01T00:00:00.000Z"}),!(null==a?void 0:a.id))return;let u=a.id,m=[...en.current],x=!1;try{let a,i,d=en.current;await es();let m=(0,C.vA)(D,()=>Z({isLoading:!1,isStreaming:!1,isContinuing:!1})),g=await _(!!ed,"attachments"in e?e.attachments:void 0),y=0===d.length||void 0!==n;n||null==(c=ea.current)||c.call(ea),Z({isLoading:!0}),y&&(window.history.pushState(null,"","/chat/".concat(D)),(0,j.hN)({chatId:void 0})),J(null);let w=H({input:"input"in e?e.input:void 0,chatSubmitData:e,quote:Q,messages:d,activeForkKey:$,authorId:u});if(!w)return void Z({isLoading:!1,isStreaming:!1,isContinuing:!1});X(null),Z({prefillOptions:{query:void 0,projectId:void 0},isContinuing:"continue"===e.action,isLoading:"continue"!==e.action,isStreaming:"continue"===e.action,undo:{messages:d,forkKey:$,editingUserMessageId:"edit"===e.action?e.userMessageId:null,newPromptContent:("new"===e.action||"edit"===e.action)&&e.input||null}}),"new"!==e.action&&"edit"!==e.action&&((null==(l=w.newUserMessage)||null==(r=l.attachments)?void 0:r.length)||0)>0&&g.push(...w.newUserMessage.attachments);let{action:k,continueAssistantMessage:S,newUserMessage:A,newActiveForkKey:L}=w,T=[...d];"type"in e&&A&&(A.type=e.type),A&&!w.isFromQParam&&T.push(A),Z({messages:T,activeForkKey:w.newActiveForkKey});let F=document.getElementById(E.Q);F&&F.click();let R={};if(n)a=n.readableStream.getReader(),R=n.headers;else{let n=eu.error?[]:[...eu.data.marketplaceStores,...eu.data.nativeStores].map(e=>({type:e.type,product:{name:"product"in e?e.product.name:e.integrationName,slug:"slug"in e?e.slug:void 0}})),s=[..."integrations"in e&&e.integrations?e.integrations:[],...n],r=[...Object.values(ex.current||[]).map(e=>({id:e.id,key:e.key})),..."envVars"in e&&e.envVars?e.envVars:[]],l=t&&!(0,N.W)(t)?t.slug:void 0,i=await fetch("/chat/api/chat",{method:"POST",body:JSON.stringify({message:(null==A?void 0:A.content)||void 0,messageId:null==A?void 0:A.id,forceResponse:"forceResponse"in e?e.forceResponse:void 0,chatId:D,chatIdToken:O,isNew:y,thinkingMode:w.thinkingMode,messageMode:"new"===e.action?e.messageMode:void 0,figmaContext:"figmaContext"in e?e.figmaContext:void 0,userMessageType:"type"in e?e.type:void 0,forkKey:null==L?void 0:L.slice(0,-1),...er?{projectId:er}:{},action:k,...g.length>0?{attachments:g}:{},team:l,..."workflowState"in e?{workflowState:e.workflowState}:{},..."new"===e.action&&void 0!==e.autopilot?{autopilot:e.autopilot}:{},integrations:s,envVars:r}),headers:{"Content-Type":"application/json"},signal:m});if(!i.ok||!i.body){if(402===i.status)throw Error(f.QV);let e=await i.text();throw Error(e)}(0,j.hN)({chatId:D}),R=Object.fromEntries(i.headers.entries()),a=i.body.getReader()}let V=R["x-v0-url-attachments"]?JSON.parse(atob(R["x-v0-url-attachments"])):void 0;V&&void 0!==A&&(T[T.length-1].attachments=[...T[T.length-1].attachments||[],...V||[]],Z({messages:T}));let B=function(e,t){let a=e["x-v0-project-id"],n=e["x-v0-project-name-base64"],s=e["x-v0-project-color"],r=e["x-v0-project-icon"],l=e["x-v0-project-creator-id"],i=e["x-v0-project-vercel-project-id"]||null;if(a&&n)return{projectId:a,name:atob(n),settings:{color:s,icon:r},vercelProjectId:i,isCreator:t===l}}(R,null==t?void 0:t.id);B&&Y({project:B});let W=R["x-v0-user-message-id"];if(!W)throw Error(f.RK);S&&(T=T.filter(e=>"assistant"!==e.role||e.id!==S.id));let G=!1,K=new TextDecoder,el=R["x-v0-response-message-id"];if(!el)throw Error(f.Og);let ec=q({responseMessageId:el,action:k,newActiveForkKey:L,userMessageServerId:W}),em=[],eh="continue"===e.action,ep=()=>eh?null==S?void 0:S.content:em;function b(t){m.throwIfAborted();try{var a;let n=JSON.parse(t);em=(0,s.F)(em,n),eh&&(null==(a=em.find(e=>"markdown"===(0,o.h)(e)))?void 0:a[1])&&(eh=!1);let r=(0,o.sY)(em,el),l=(0,o.LU)(em);if(!G&&"string"==typeof l.title&&l.title&&(G=!0,Y({title:l.title}),y&&l.title&&et(e=>[{title:l.title,chatId:D,updatedAt:new Date,shareable:!1,privacy:"private",favorite:!1,optimistic:!0,authorId:u},...e.filter(e=>e.chatId!==D)],!1)),i={parentId:W,role:"assistant",content:ep(),context:l.docsContext,id:el,blocks:r.map(e=>e.id),loadingText:l.loadingText,streaming:!1===eh,finishReason:l.finishReason||null,relevantFiles:l.relevantFiles,grepQueries:l.grepQueries,notifications:l.notifications,usage:l.usage,modelId:l.modelId,thinkingMode:null==w?void 0:w.thinkingMode,continuingMessageId:null==S?void 0:S.id,type:"type"in e&&"added-integration"===e.type?"added-integration":"message"},Z({messages:[...T,i],isLoading:!1,isStreaming:!0}),r.length>=1){let e=r[r.length-1];return e.id!==(null==ei?void 0:ei.current)||z.kX.includes(e.type)||h(e),r}}catch(e){(0,v.u)("ChatHookError",{chatId:D,errorCode:f.mB,errorMsg:"Failed to read row: ".concat(t)}),"production"!==U.env.VERCEL_ENV&&console.error(e,"Error reading row:",t)}}i={parentId:W,role:"assistant",content:ep(),id:el,streaming:void 0===S,finishReason:null,continuingMessageId:null==S?void 0:S.id,type:"message"},Z({messages:[...T,i],activeForkKey:ec,saveLeafMessageId:!0}),x=!0;let ef="",eg=null;for(;;){m.throwIfAborted();let{done:e,value:t}=await a.read();if(e)break;let n=ef+(t instanceof Uint8Array?K.decode(t):t),{isLlmError:s,isRetried:r,errorCategory:l="default"}=(0,p.c)(n);if(s)throw Z({messages:[...T,{...i,finishReason:r?"retry_provider_server_error:".concat(l):"provider_server_error:".concat(l)}]}),Error(f.kR);let o=n.split("\n");for(let e=0;e<o.length-1;e++){let t=b(o[e]),a=(null==t?void 0:t.length)&&t[t.length-1].id!==eg;(!eg||(null==ei?void 0:ei.current)===eg)&&a&&(eo(t[t.length-1].id,new Date().toISOString()),eg=t[t.length-1].id,z.kX.includes(t[t.length-1].type)||M(!0,t[t.length-1]))}ef=o[o.length-1]}ef&&b(ef),Z({messages:[...T,{...i,streaming:!1}],isStreaming:!1,isContinuing:!1,initialStreamPromise:void 0}),(0,P.j)(),y&&(await I(),ee()),(0,C.$p)(D)}catch(n){if(n instanceof Error&&"AbortError"===n.name)return;(0,P.j)(),!x&&"onFailToPrompt"in e&&(null==(d=e.onFailToPrompt)||d.call(e)),Z({isLoading:!1,undo:null,isStreaming:!1,isContinuing:!1,initialStreamPromise:void 0,prefillOptions:{query:void 0,projectId:void 0},...!x?{activeForkKey:$,messages:m}:{}}),(0,C.mU)(D),(0,g.z)(n,ec,"Failed to submit message. Start a new chat, retry, or edit your message.",{scopeSlug:(0,N.W)(t)||null==t?void 0:t.slug,lastUserInput:"input"in e?e.input:void 0,chatId:D,projectId:er||void 0,userPlan:a.v0plan||"v0-level0"})||i.o.error("An unexpected error occurred. Please refresh the page and try again."),x||0!==m.length||ec.push("/chat")}},[a,$,en,es,D,Z,J,Q,X,ea,Y,t,O,er,et,ei,h,M,ec,ee,el]),stopLlmResponse:(0,n.useCallback)(()=>{let e=en.current;if((0,C.mU)(D),W&&G)Z({activeForkKey:G.forkKey,messages:G.messages}),G.editingUserMessageId&&G.newPromptContent?k(G.editingUserMessageId,G.newPromptContent):G.newPromptContent&&y(G.newPromptContent,!0);else if(e.length>0){let t=e[e.length-1];"assistant"===t.role&&Z({messages:[...e.slice(0,-1),{...t,streaming:!1}]})}setTimeout(()=>Z({isStreaming:!1,isLoading:!1}),0)},[D,k,en,G,Z,W,y])}}function H(e){let{input:t,chatSubmitData:a,quote:n,messages:s,activeForkKey:r,authorId:l}=e;switch(a.action){case"continue":case"retry":{let e;if(!r)throw Error(f.R2);let t=a.assistantMessageId,n=s.find(e=>"id"in e&&e.id===t&&"assistant"===e.role);if(!n||"assistant"!==n.role||!n.parentId)throw Error(f.p2);"continue"===a.action&&(e={...n,continuingMessageId:t});let l="retry"===a.action?(0,h.Mb)(r,t,V+(0,y.Ok)()):r;return{action:{type:a.action,userMessageId:n.parentId,assistantMessageId:t},continueAssistantMessage:e,newActiveForkKey:l,thinkingMode:n.thinkingMode}}case"edit":{if(!t)throw Error(f.FD);if(!r)throw Error(f.tK);let e=t?$(t,n):null,l=a.userMessageId,i=s.find(e=>e.id===l);if((null==i?void 0:i.role)!=="user")throw Error(f.p2);let o=s.find(e=>e.parentId===i.id&&"assistant"===e.role),c=(0,y.Ok)();return{newUserMessage:{role:"user",content:e,id:c,attachments:a.attachments,parentId:i.parentId,type:"message",authorId:i.authorId},thinkingMode:o&&"thinkingMode"in o?o.thinkingMode:void 0,action:{type:"edit",userMessageId:i.id},newActiveForkKey:(0,h.Mb)(r,i.id,c)}}case"fix-with-v0":{let e=t?$(t,n):null;if(!t)throw Error(f.FD);let a=(0,y.Ok)(),s=(0,h._z)(r,a);return{newUserMessage:{role:"user",content:e||"",id:a,attachments:[],parentId:(0,h.K1)(r),type:"fix-with-v0",authorId:l},newActiveForkKey:s,action:{type:"fix-with-v0"}}}case"new":{let e=t?$(t,n):null;if(1===s.length&&"user"===s[0].role)return{isFromQParam:!0,newUserMessage:s[0],newActiveForkKey:(0,h._z)(void 0,s[0].id)};if(!t&&(!a.attachments||0===a.attachments.length))throw Error(f.FD);let i=(0,y.Ok)(),o=(0,h._z)(r,i);return{newUserMessage:{role:"user",content:e||"",id:i,attachments:a.attachments,parentId:(0,h.K1)(r),type:"message",authorId:l},newActiveForkKey:o,thinkingMode:a.thinkingMode}}default:throw Error(f.dD)}}function $(e,t){return t?"".concat(t.split("\n").map(e=>"> "+e).join("\n"),"\n\n").concat(e):e}function q(e){let{responseMessageId:t,action:a,newActiveForkKey:n,userMessageServerId:s}=e;if((null==a?void 0:a.type)==="continue"||(null==a?void 0:a.type)==="retry")return(0,h.qQ)(n,t);let r=(0,h.qQ)(n,s);return(0,h._z)(r,t)}},99151:(e,t,a)=>{"use strict";a.d(t,{Lb:()=>o});var n=a(70676);let s=(0,n.createServerReference)("40af526bf52f346ba0a289e4fd20a57b78f29f6021",n.callServer,void 0,n.findSourceMapURL,"uploadAssetAction");var r=a(33571),l=a(13729);let i=["png","jpg","jpeg","webp"],o=e=>{let{initialImages:t,disableDrag:a=!1,containerRef:n}=e,o=r.useRef(null),[d,u]=r.useState(!1),[m,h]=r.useState(!1),[p,x]=r.useState(()=>{var e;return null!=(e=null==t?void 0:t.map(e=>({id:crypto.randomUUID(),file:new File([],e.name),size:e.size,status:"success",url:e.url})))?e:[]}),f=r.useCallback(e=>{x(e.map(e=>({id:crypto.randomUUID(),file:new File([],e.name),size:e.size,status:"success",url:e.url})))},[]),g=r.useCallback(async e=>{if(p.length+e.length>1)return e.forEach(e=>{URL.revokeObjectURL(URL.createObjectURL(e))}),l.o.error("File limit exceeded",{description:"You can only upload up to ".concat(1," images.")});if(e.find(e=>{var t;let a=null==(t=e.name.split(".").pop())?void 0:t.toLowerCase();return!a||!i.includes(a)}))return e.forEach(e=>{URL.revokeObjectURL(URL.createObjectURL(e))}),l.o.error("Invalid file type",{description:"Allowed file types: ".concat(i.join(", "))});let t=e.find(e=>e.size>1048576);if(t)return e.forEach(e=>{URL.revokeObjectURL(URL.createObjectURL(e))}),l.o.error("File too large",{description:"The file ".concat(t.name," is larger than ").concat("1 MB",".")});u(!0);let a=e.map(e=>({id:crypto.randomUUID(),file:e,status:"pending",url:URL.createObjectURL(e),size:e.size}));for(let e of(x(e=>[...e,...a]),a)){x(t=>t.map(t=>t.id===e.id?{...t,status:"uploading"}:t));try{let t=new FormData;t.append("file",e.file,e.file.name);let a=await s(t);if(a.error){x(t=>t.map(t=>t.id===e.id?{...t,status:"error",error:a.error}:t)),l.o.error("Failed to upload file",{description:a.error});continue}let n=a.url;x(t=>t.map(t=>t.id===e.id?{...t,status:"success",url:n}:t))}catch(t){x(t=>t.map(t=>t.id===e.id?{...t,status:"error",error:"Upload failed"}:t))}}u(!1)},[p.length]),v=r.useCallback(async e=>{if(h(!1),d||(e.preventDefault(),e.stopPropagation(),!e.dataTransfer))return;let{files:t}=e.dataTransfer;c(t)&&await g(Array.from(t))},[g,d]);r.useEffect(()=>{if(a)return;let e=()=>h(!0),t=()=>h(!1),s=e=>{e.preventDefault(),e.stopPropagation()},r=e=>{v(e).catch(console.error)},l=(null==n?void 0:n.current)||window;return l.addEventListener("dragenter",e),document.documentElement.addEventListener("mouseleave",t),l.addEventListener("dragover",s),l.addEventListener("drop",r),()=>{l.removeEventListener("dragenter",e),document.documentElement.removeEventListener("mouseleave",t),l.removeEventListener("dragover",s),l.removeEventListener("drop",r)}},[a,v,g,n]);let j=async e=>{c(e.target.files)&&e.target.files&&await g(Array.from(e.target.files))},b=r.useCallback(e=>{x(t=>{let a=t.find(t=>t.id===e);return(null==a?void 0:a.url)&&URL.revokeObjectURL(a.url),t.filter(t=>t.id!==e)})},[]);return{files:p,setFiles:x,setInitialFiles:f,uploading:d,isDraggingFile:m,inputFileRef:o,onInputChange:j,removeFile:b}};function c(e){if(!(null==e?void 0:e.length))return!1;if(e.length>1)return l.o.error("File limit exceeded",{description:"You can only upload up to ".concat(1," images at a time.")}),!1;for(let t of e)if(!t.type.startsWith("image/"))return l.o.error("Invalid file type",{description:"Please upload image files only"}),!1;return!0}},99466:(e,t,a)=>{"use strict";a.d(t,{Dm:()=>P,oL:()=>E,e$:()=>T,KF:()=>U});var n=a(97667),s=a(94541),r=a(69894),l=a(5518),i=a(80823),o=a(84492),c=a(74293);c.z.object({error:c.z.object({message:c.z.string().optional().default(""),code:c.z.string().optional().default("")})}),a(22315);var d=function(e){return e.Plain="plain",e.Secret="secret",e.System="system",e.Encrypted="encrypted",e.Sensitive="sensitive",e}({}),u=a(66692),m=a(33571),h=a(43573),p=a(99542),x=a(28435),f=a(70158),g=a(76106),v=a(92647),j=a(73655),b=a(28963);a(88639);var y=a(50391),w=a(28819),N=a(39929),k=a(49848),C=a(59190),S=a(55274),M=a(95393),I=a(22975),A=a(13729),D=a(16292),L=a(71543),z=a(93660);function E(e){let{envVar:t}=e;return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Key"}),(0,n.jsx)("p",{className:"text-muted-foreground break-all",children:null==t?void 0:t.key})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Value"}),(0,n.jsx)("p",{className:"text-muted-foreground break-all",children:(null==t?void 0:t.type)===d.Encrypted?t.decrypted?t.value:"*** Encrypted ***":null==t?void 0:t.value})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Targets"}),(0,n.jsx)("p",{className:"text-muted-foreground break-words",children:Array.isArray(null==t?void 0:t.target)?t.target.join(", "):null==t?void 0:t.target})]}),(null==t?void 0:t.comment)&&(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Comment"}),(0,n.jsx)("p",{className:"text-muted-foreground break-words",children:t.comment})]})]})}function P(e){let{v0ProjectId:t,onClose:a,open:s,onProjectCreated:r}=e,[l,i]=(0,m.useState)(""),{activeScopeSlug:o}=(0,j.k6)(),c=(0,f.useRouter)();return t?(0,n.jsx)(b.Modal,{onOpenChange:a,open:s,children:(0,n.jsxs)("form",{action:async()=>{try{let e=await (0,I.p)(t,l);if(!e.id)return void A.o.error("Failed to create project");await (0,g.t)({v0ProjectId:t,vercelProjectId:e.id}),r({id:e.id,name:l,url:"https://vercel.com/".concat(o,"/").concat(l),env:[]}),A.o.success("Project created and linked successfully"),c.refresh()}catch(e){A.o.error("Failed to create project")}a()},children:[(0,n.jsx)(b.ModalHeader,{children:(0,n.jsx)(b.ModalTitle,{children:"Create New Vercel Project"})}),(0,n.jsx)(b.ModalContent,{children:(0,n.jsx)(k.p,{autoFocus:!0,onChange:e=>i(e.target.value),placeholder:"Project Name",required:!0,value:l})}),(0,n.jsxs)(b.ModalFooter,{children:[(0,n.jsx)(b.ModalClose,{asChild:!0,children:(0,n.jsx)(u.$,{onClick:a,size:"sm",variant:"secondary",children:"Cancel"})}),(0,n.jsx)(D.Q,{size:"sm",variant:"default",children:"Create"})]})]})}):null}function T(e){let{filteredProjects:t,searchQuery:a,setSearchQuery:i,isLoading:o,selectedProject:c,handleLinkProject:d,setShowCreateModal:m,onCreateModalOpen:h}=e,{user:p}=(0,L.J)(),f=(null==p?void 0:p.v0plan)==="v0-enterprise";return(0,n.jsxs)("div",{className:"flex size-full flex-col",children:[!f&&(0,n.jsxs)("div",{className:"border-border flex w-full items-center border-b py-1.5 pl-4 pr-3.5",children:[(0,n.jsx)("span",{className:"text-gray-500",children:(0,n.jsx)(x.e,{})}),(0,n.jsx)(k.p,{className:"flex-1 border-none bg-inherit",onChange:e=>i(e.target.value),placeholder:"Search projects...",value:a}),(0,n.jsx)(S.N,{mode:"wait",children:a&&(0,n.jsx)(M.P.button,{animate:{opacity:1},className:"sp-1 text-gray-500 hover:text-gray-700 focus:outline-none",exit:{opacity:0},initial:{opacity:0},onClick:()=>i(""),children:(0,n.jsx)(C.A,{size:16})})})]}),!f&&(0,n.jsx)("div",{className:"relative flex max-h-[225px] min-h-[225px] flex-1 flex-col overflow-y-auto p-2",onWheel:e=>{e.stopPropagation()},onTouchMove:e=>{e.stopPropagation()},children:(0,n.jsx)(S.N,{children:o?(0,n.jsx)(R,{}):0===t.length?(0,n.jsx)(F,{title:"No Projects Found"}):t.map(e=>(0,n.jsxs)(N.DropdownMenuItem,{className:(0,w.cn)("group flex items-center justify-between md:px-2","w-full rounded-md p-2 hover:bg-gray-100 md:w-auto"),onClick:()=>d((null==c?void 0:c.id)===e.id?null:e),children:[(0,n.jsxs)("span",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,n.jsx)(s.A,{className:"size-4"}),(0,n.jsx)("span",{className:"max-w-[200px] truncate",children:e.name})]}),(null==c?void 0:c.id)===e.id?(0,n.jsxs)("span",{className:"flex shrink-0 items-center text-gray-500",children:[(0,n.jsx)(r.A,{className:"h-4 w-4 group-hover:hidden"}),(0,n.jsx)("span",{className:"hidden group-hover:inline",children:"Unlink"})]}):(0,n.jsx)("span",{className:"hidden shrink-0 font-medium text-gray-500 group-hover:inline",children:"Link"})]},e.id))})}),f&&(0,n.jsx)("div",{className:"flex flex-col gap-2 p-4 text-center text-sm",children:(0,n.jsx)("span",{className:"font-medium text-gray-500",children:"Enterprise customers can't connect existing Vercel projects at the moment."})}),(0,n.jsx)("div",{className:"sticky bottom-0 w-full border-t p-1.5",children:(0,n.jsxs)(u.$,{onClick:()=>{m(!0),null==h||h()},className:"w-full gap-0.5",variant:"secondary",children:[(0,n.jsx)(l.A,{className:"size-4 shrink-0"}),(0,n.jsx)("span",{className:"px-1.5",children:"New Project"})]})})]})}function F(e){let{title:t}=e;return(0,n.jsx)(y.Sv,{className:"bg-muted flex-1 rounded-lg",children:(0,n.jsx)(y.HY,{children:(0,n.jsx)(y.cz,{className:"text-sm text-gray-500",children:t})})})}function R(){return(0,n.jsx)(n.Fragment,{children:Array.from({length:10}).map((e,t)=>(0,n.jsx)(N.DropdownMenuItem,{className:(0,w.cn)("group flex items-center justify-between md:px-2","w-full rounded-md p-2 hover:bg-gray-100 md:w-auto"),disabled:!0,children:(0,n.jsxs)("span",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,n.jsx)(s.A,{className:"size-4"}),(0,n.jsx)(z.E,{className:"h-4 w-full"})]})},t))})}function U(e){let{v0ProjectId:t,currentProject:a,projects:s,readOnly:r,size:l="default",alias:c,children:d}=e,[x,j]=(0,m.useState)(a),[b,y]=(0,m.useState)(""),[k,C]=(0,m.useState)(!1),[S,M]=(0,m.useState)(!1),[I,D]=(0,m.useState)(!1),L=(0,f.useRouter)(),z=async e=>{if(!r){if(!e)return E();C(!0);try{let a=await (0,g.t)({v0ProjectId:t,vercelProjectId:e.id});"error"in a||!a.success||(j(e),A.o.success("Project linked successfully"))}catch(e){A.o.error("Failed to link project. Please try again.")}finally{M(!1),C(!1),L.refresh()}}},E=async()=>{if(!r){C(!0),j(void 0);try{let e=await (0,v.y)({v0ProjectId:t});"error"in e||!e.success?(j(a),A.o.error("Failed to unlink project. Please try again.")):A.o.success("Project unlinked successfully")}catch(e){j(a),A.o.error("Failed to unlink project. Please try again.")}finally{M(!1),C(!1),L.refresh()}}},F=s.filter(e=>e.name.toLowerCase().includes(b.toLowerCase())),R=x?(0,n.jsx)("div",{className:"rounded-lg p-2 text-sm sm:p-0",children:(0,n.jsxs)("div",{className:"bg-muted flex flex-col rounded-lg text-sm",children:[d,(0,n.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsxs)("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm hover:underline",children:[(0,n.jsx)("span",{className:"font-medium",children:x.name}),(0,n.jsx)(p.F,{className:"size-4"})]}),c?(0,n.jsx)("a",{href:(0,w.sT)(c),target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground flex items-center gap-1 text-sm hover:underline",children:c}):null]}),(0,n.jsxs)(N.DropdownMenu,{children:[(0,n.jsx)(N.DropdownMenuTrigger,{asChild:!0,children:(0,n.jsxs)(u.$,{className:"relative size-8",size:"sm",variant:"ghost",disabled:r,tooltip:r?"You don't have permission to modify this project":void 0,children:[(0,n.jsx)(h.a,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Open project actions"})]})}),(0,n.jsx)(N.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,n.jsxs)(N.DropdownMenuGroup,{children:[(0,n.jsx)(N.DropdownMenuItem,{asChild:!0,children:(0,n.jsxs)("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,n.jsx)(i.A,{}),(0,n.jsx)("span",{children:"View on Vercel"})]})}),(0,n.jsxs)(N.DropdownMenuItem,{variant:"destructive",onClick:E,disabled:r,children:[(0,n.jsx)(o.A,{}),(0,n.jsx)("span",{children:"Unlink Vercel Project"})]})]})})]})]})]})}):(0,n.jsx)("div",{className:"p-2 md:p-0",children:(0,n.jsx)(u.$,{className:"w-full","aria-label":"Add a Vercel Project",variant:"outline",disabled:k||r,size:l,type:"button",children:(0,n.jsx)("span",{children:"Add Vercel Project"})})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P,{v0ProjectId:t,onClose:()=>D(!1),open:I,onProjectCreated:e=>{j(e),M(!1)}}),(0,n.jsx)("div",{className:"w-full min-w-0",children:x||r?R:(0,n.jsxs)(N.DropdownMenu,{onOpenChange:M,open:S,children:[(0,n.jsx)(N.DropdownMenuTrigger,{asChild:!0,children:R}),(0,n.jsx)(N.DropdownMenuContent,{align:"center",className:"w-[400px]",side:"bottom",children:(0,n.jsx)(T,{filteredProjects:F,searchQuery:b,setSearchQuery:y,isLoading:k,selectedProject:x,handleLinkProject:z,setShowCreateModal:D,onCreateModalOpen:()=>M(!1)})})]})})]})}},99647:(e,t,a)=>{"use strict";a.d(t,{Dp:()=>m,Ez:()=>c,eJ:()=>u,kd:()=>h});var n=a(97667),s=a(33571),r=a(10175),l=a(6659),i=a(95393),o=a(33365);let c={duration:.35,ease:[.35,.2,.14,.95]},d={x:0,y:0,z:0,rotate:0,scale:1,skew:0,opacity:1};function u(e){let{children:t,preventAnimation:a=!1}=e;return(0,n.jsx)(i.P.span,{animate:{opacity:1},initial:{opacity:+!!a},children:t})}function m(e){let{children:t,variants:a,transition:u}=e,{ref:m,controls:h,fullVariants:p}=function(e,t,a){let n=(0,r.I)(),i=(0,s.useContext)(o.w),u=(0,l.E)(),m=(0,s.useRef)(null),h=(0,s.useRef)("idle"),p=(0,s.useRef)(!1),x=(0,s.useRef)(!1),f=(0,s.useMemo)(()=>({idle:{...d,...t.idle},hover:{...d,...t.hover},tap:{...d,...t.tap}}),[t]),g=(0,s.useCallback)(async e=>{let t=f[h.current],n=f[e];if(p.current&&!1===t.interruptible||x.current||e===h.current&&p.current)return;p.current=!0;let s=h.current;h.current=e;try{await u.start({...n,transition:n.transition||a||c})}catch(e){h.current=s}finally{if(p.current=!1,n.after&&h.current===e){let{state:e,delay:t=0}=n.after;x.current=!0,setTimeout(()=>{x.current=!1,g(e)},1e3*t)}else h.current!==e&&g(h.current)}},[u,a,f]);return(0,s.useEffect)(()=>{if(!i||n)return;let t=function e(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t?"BUTTON"===t.tagName||"A"===t.tagName?t:a>10?(console.warn("Animated Icon can't find valid parent element (<button> or <a>) after 10 iterations. Falling back to root element."),null):e(t.parentElement,a+1):null}(m.current);if(t)return i.registerIcon(e,{parent:t,transitionTo:g}),()=>{i.unregisterIcon(e)}},[]),{ref:m,controls:u,fullVariants:f}}((0,s.useRef)(Math.random().toString(36).substr(2,9)).current,a,u);return(0,n.jsx)(i.P.span,{animate:h,className:"transition-none",initial:"idle",ref:m,variants:p,children:t})}function h(e){let{children:t,hideOverflow:a}=e;return(0,n.jsx)("span",{className:"grid [&>*]:[grid-area:1/1] ".concat(a?"overflow-hidden":""),children:t})}},99772:(e,t,a)=>{"use strict";function n(e){return window.btoa(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}a.d(t,{v:()=>n})},99997:(e,t,a)=>{"use strict";a.d(t,{E:()=>u,i:()=>m});var n=a(97667),s=a(25296),r=a(34825),l=a(57765),i=a(69519),o=a(27693),c=a(92461),d=a(25887);let u={private:{babyIcon:(0,n.jsx)(l.F,{size:14}),icon:(0,n.jsx)(l.F,{size:16})},team:{babyIcon:(0,n.jsx)(r.z,{className:"p-[3px]",size:16}),icon:(0,n.jsx)(r.z,{size:12})},"team-edit":{babyIcon:(0,n.jsx)(r.z,{className:"p-[3px]",size:16}),icon:(0,n.jsx)(r.z,{size:12}),visibleInPicker:!1},unlisted:{babyIcon:(0,n.jsx)(i.N,{className:"p-[3px]",size:16}),icon:(0,n.jsx)(i.N,{size:12})},public:{babyIcon:(0,n.jsx)(s.q,{className:"p-[3px]",size:16}),icon:(0,n.jsx)(s.q,{size:12})}};function m(e){let{chatId:t,privacy:a}=e,s=(0,o.k)();return a&&t?(0,n.jsxs)(c.E,{className:"sm:@[21rem]/chat-header:flex pointer-events-auto hidden gap-0 text-[11px]",onClick:function(){t&&a&&(0,d.D)({type:"shareChat",data:{chatId:t,privacy:a}})},size:"sm",variant:"outline",children:[u[a].babyIcon,(0,n.jsx)("p",{children:s("chatPrivacy.label")(a)})]}):null}}}]);