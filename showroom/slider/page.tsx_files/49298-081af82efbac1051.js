(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49298],{3696:(e,t,l)=>{"use strict";l.d(t,{Ke:()=>a,Nt:()=>n,R6:()=>s});var i=l(60877);let n=i.bL,s=i.R6,a=i.Ke},17022:(e,t,l)=>{"use strict";l.d(t,{h:()=>j});var i=l(97667),n=l(28819),s=l(87501),a=l(23423),r=l(33571),o=l(3696),c=l(66692),d=l(80574);function u(e){let{className:t}=e;return(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,n.cn)(t),children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V8H3V1.5H8V5V6.5H9.5H13V13.5C13 14.0523 12.5523 14.5 12 14.5H6V16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM2.31885 12.8194H0V11.3194H2.31885V9H3.81885V11.3194H6.13775V12.8194H3.81885V15.1377H2.31885V12.8194Z",fill:"currentColor"})})}function m(e){let{className:t}=e;return(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,n.cn)(t),children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 6.5V13.5C14.5 14.8807 13.3807 16 12 16H5V14.5H12C12.5523 14.5 13 14.0523 13 13.5V6.5H9.5H8V5V1.5H3V9H1.5V1.5V0H3H8H9.08579C9.351 0 9.60536 0.105357 9.79289 0.292893L14.2071 4.70711C14.3946 4.89464 14.5 5.149 14.5 5.41421V6.5ZM9.5 2.12132V5H12.3787L9.5 2.12132ZM0 11.25V12.75H6V11.25H0Z",fill:"currentColor"})})}var f=l(98135),p=l(56179),h=l(77302);function x(e){let{added:t,removed:l,className:s}=e;if(!t&&!l)return null;let a=t?(0,i.jsx)("div",{className:"text-green-700",children:"number"==typeof t?"+".concat(t):"+"}):null,r=l?(0,i.jsx)("div",{className:"text-red-700",children:"number"==typeof l?"-".concat(l):"-"}):null;return(0,i.jsxs)("div",{className:(0,n.cn)("flex items-center gap-0.5 text-xs text-gray-500",s),children:[a,a&&r?(0,i.jsx)("div",{children:"/"}):null,r]})}function v(e){return e?(0,p.n)(e,(e,t)=>e.items&&!t.items?-1:!e.items&&t.items?1:e.title.localeCompare(t.title)):[]}let g=(0,r.createContext)(void 0),b=()=>{let e=(0,r.useContext)(g);if(void 0===e)throw Error("useFileTree must be used within a FileTreeProvider");return e};function j(e){let{loading:t,active:l,items:s,onSelect:a,FileActions:o,FolderActions:c,TreeActions:d,className:u,lockingStatus:m}=e,p=(0,r.useMemo)(()=>v(s),[s]),h=(0,i.jsx)("ul",{className:(0,n.cn)("group flex list-none flex-col",u),children:p.map(e=>(0,i.jsx)(y,{item:e},e.value))}),x=h;return d&&(x=(0,i.jsxs)(f.tz,{children:[(0,i.jsx)(f.Rc,{asChild:!0,children:h}),(0,i.jsx)(f.Ip,{children:(0,i.jsx)(f.Q2,{children:(0,i.jsx)(d,{})})})]})),(0,i.jsx)(g.Provider,{value:{onSelect:a,active:l,lockingStatus:m,loading:t,FileActions:null!=o?o:()=>null,FolderActions:null!=c?c:()=>null,TreeActions:null!=d?d:()=>null},children:x})}function y(e){let{item:t}=e;return t.items?(0,i.jsx)(w,{item:t}):(0,i.jsx)(k,{item:t})}function w(e){var t;let{className:l,item:s}=e,{active:a,FolderActions:c}=b(),[d,u]=(0,r.useState)(!0),m=!!s.items&&function e(t,l){return t.some(t=>t.value===l||!!t.items&&e(t.items,l))}(s.items,a);(0,r.useEffect)(()=>{m&&u(!0)},[m]);let p=(0,r.useMemo)(()=>v(s.items),[s.items]),x=(null==(t=s.items)?void 0:t.length)?(0,i.jsx)("div",{"data-sidebar":"menu-sub",className:"border-alpha-400 group-hover:border-l-alpha-400 duration-250 ml-3 flex min-w-0 translate-x-[0.5px] flex-col border-l border-l-transparent pl-1 transition-colors",children:p.map(e=>(0,i.jsx)(y,{item:e},e.value))}):null;return(0,i.jsxs)(f.tz,{children:[(0,i.jsxs)(o.Nt,{className:"flex flex-col gap-0",open:d,onOpenChange:u,children:[(0,i.jsx)(o.R6,{asChild:!0,children:(0,i.jsx)(f.Rc,{asChild:!0,children:(0,i.jsx)(N,{icon:(0,i.jsx)(h.A,{className:(0,n.cn)("h-4 w-4 transition-transform",{"rotate-90":d})}),onClick:e=>{e.currentTarget instanceof HTMLButtonElement&&e.currentTarget.blur(),u(e=>!e)},className:l,status:null,children:s.title})})}),(0,i.jsx)(o.Ke,{children:x})]}),(0,i.jsx)(f.Ip,{children:(0,i.jsx)(f.Q2,{children:(0,i.jsx)(c,{item:s})})})]})}function k(e){let t,{item:l,className:o,...c}=e,{onSelect:p,active:h,loading:v,FileActions:g,lockingStatus:j}=b(),y=(0,r.useMemo)(()=>v===l.value?(0,i.jsx)(d.y,{size:16}):"binary"===l.type?(0,i.jsx)(s.Z,{}):l.addedCount&&!l.removedCount?(0,i.jsx)(u,{}):!l.addedCount&&l.removedCount?(0,i.jsx)(m,{}):(0,i.jsx)(s.Z,{}),[l.addedCount,l.removedCount,l.type,l.value,v]);return l.value?(t=(null==j?void 0:j.type)==="locking-all"||(null==j?void 0:j.type)==="unlocking-all"||((null==j?void 0:j.type)==="locking"||(null==j?void 0:j.type)==="unlocking")&&j.fileName===l.value||((null==j?void 0:j.type)==="locking-folder"||(null==j?void 0:j.type)==="unlocking-folder")&&l.value.startsWith(j.folderName)?(0,i.jsx)("div",{className:"flex items-center justify-end",children:(0,i.jsx)(d.y,{size:14,className:"m-0 w-fit p-0"})}):l.isLocked?(0,i.jsx)("div",{className:"flex items-center justify-end",children:(0,i.jsx)(a.C,{size:14,className:"m-0 w-fit p-0"})}):l.addedCount&&"binary"===l.type?(0,i.jsx)("div",{className:"flex items-center gap-0.5 text-xs text-green-700",children:"Added"}):(0,i.jsx)(x,{added:l.addedCount,removed:l.removedCount}),(0,i.jsxs)(f.tz,{children:[(0,i.jsx)(f.Rc,{asChild:!0,children:(0,i.jsx)(N,{active:l.value===h,onClick:()=>p(l.value),className:(0,n.cn)(o,l.isLocked&&"text-gray-500"),icon:y,status:t,...c,children:l.title})}),(0,i.jsx)(f.Ip,{children:(0,i.jsx)(f.Q2,{children:(0,i.jsx)(g,{item:l})})})]})):null}function N(e){let{className:t,active:l,icon:s,status:a,children:r,...o}=e;return(0,i.jsx)("li",{children:(0,i.jsxs)(c.$,{className:(0,n.cn)("data-[active=true]:bg-alpha-200 mb-0 h-[26px] w-full min-w-36 justify-between gap-2 pl-0.5 pr-1",t),"data-active":l,size:"sm",variant:"ghost",title:r,...o,children:[(0,i.jsxs)("div",{className:"flex min-w-0 items-center gap-1",children:[(0,i.jsx)("div",{className:"p-0.5 text-gray-500 group-focus:text-gray-900 group-[[data-active=true]]:text-gray-900",children:s}),(0,i.jsx)("span",{className:"truncate font-normal",children:r})]}),a]})})}},21190:(e,t,l)=>{"use strict";l.d(t,{JS:()=>o,Yv:()=>c,wb:()=>r});var i=l(97667),n=l(33571),s=l(28819),a=l(20125);function r(e){let{tabs:t,activeTabKey:l,setActiveTabKey:s,disableOverflow:a=!1,isLoading:r}=e;return(0,n.useEffect)(()=>{let e=t.find(e=>e.key===l);if(!(null==e?void 0:e.disabled))return;let i=t.find(e=>!e.disabled);i&&s(i.key)},[t,l,s]),(0,i.jsxs)("div",{className:"relative flex w-fit min-w-0 flex-1 items-center gap-2 overflow-x-auto",children:[t.map(e=>(0,i.jsx)(d,{active:e.key===l,onClick:()=>s(e.key),disabled:e.disabled,tooltip:e.tooltip,isLoading:r,children:e.display},e.key)),!a&&(0,i.jsx)("div",{className:"from-muted pointer-events-none sticky -right-2 z-10 h-full min-w-8 bg-gradient-to-l via-80% bg-blend-lighten",style:{backgroundImage:"linear-gradient(to left, var(--tw-gradient-stops))"}})]})}function o(e){let{className:t,tabFiles:l,activeTabKey:n}=e;return(0,i.jsx)("div",{className:(0,s.cn)("relative size-full min-h-0 flex-1",t),children:l.map(e=>(0,i.jsx)("div",{className:(0,s.cn)("size-full",n===e.key?"block":"invisible h-0 overflow-hidden"),children:e.content},e.key))})}function c(e){let{tabFiles:t,activeTabKey:l,className:n,setActiveTabKey:a,isLoading:c}=e,d=t.find(e=>e.key===l),u=d?(0,i.jsx)("div",{className:"flex h-full items-center justify-end gap-1",children:d.actions}):null;return(0,i.jsxs)("div",{className:(0,s.cn)("bg-muted flex size-full flex-col",n),children:[(0,i.jsxs)("div",{className:"border-alpha-200 relative flex justify-between border-y p-2",children:[(0,i.jsx)(r,{tabs:t,activeTabKey:null==d?void 0:d.key,setActiveTabKey:a,isLoading:c}),u]}),(0,i.jsx)(o,{tabFiles:t,activeTabKey:null==d?void 0:d.key})]})}function d(e){let{active:t,children:l,disabled:n,onClick:r,tooltip:o,isLoading:c}=e,d=(0,i.jsx)("button",{className:(0,s.cn)("font-regular group h-7 max-w-56 select-none whitespace-nowrap rounded-md px-2 text-sm font-medium transition-all",t?"bg-alpha-200 text-gray-900":"hover:bg-alpha-200 bg-transparent text-gray-500",n&&!t&&"cursor-not-allowed hover:bg-transparent"),onClick:r,disabled:n,"data-testid":"tab-file-button","data-active-tab":t,children:(0,i.jsx)("div",{className:"truncate",children:l})});return o||n?(0,i.jsx)(a.Tooltip,{side:"bottom",className:"max-w-[250px] text-wrap text-center",content:o||(c?"Preview is loading":"Preview is disabled"),children:d}):d}},27037:(e,t,l)=>{"use strict";l.d(t,{sw:()=>o,tC:()=>m,yQ:()=>f});var i=l(57560),n=l(141),s=l(94282),a=l(70073),r=l(32095);let o=10,c=new Map,d=(0,n.G)(c,()=>({editors:(0,i.eU)([]),contentHtml:(0,i.eU)(null),contentJson:(0,i.eU)(null),contentText:(0,i.eU)(null),context:(0,i.eU)([])})),u=new Map,m=(0,n.G)(u,e=>{let t=d(e),l=(0,a.jP)(e),n=(0,r.Nt)();return{...t,isAbleToSubmit:(0,i.eU)(e=>{let i=e(t.editors);if(!e(n.rateLimit)||!i.length||!i.every(e=>e.isEditorReady)||e(l.isStreaming))return!1;let s=e(t.contentText);return!!s&&(null==s?void 0:s.trim())!==""}),areEditorsReady:(0,i.eU)(e=>e(t.editors).every(e=>e.isEditorReady)),contextLimitReached:(0,i.eU)(e=>e(t.context).length>=o),sortedContext:(0,i.eU)(e=>(function(e){let t=["refinement-element","attachment"];return e.sort((e,l)=>t.indexOf(e.type)-t.indexOf(l.type))})(e(t.context)))}});function f(e){let t=d(e),l=m(e),i=(e,l)=>{let i=s.M.get(t.editors);l&&(s.M.set(t.contentHtml,l.getHTML()),s.M.set(t.contentJson,l.getJSON()),s.M.set(t.contentText,l.getText()),i.forEach(t=>{let{id:i,editor:n}=t;i!==e&&n.commands.setContent(l.getHTML())}))};return{clearEditorContent:()=>{let l=s.M.get(t.editors);l.length&&l.forEach((t,l)=>{let{editor:n}=t;n.commands.clearContent(),0===l&&i(e,n)})},registerEditor:e=>s.M.set(t.editors,[...s.M.get(t.editors),e]),unregisterEditor:e=>s.M.set(t.editors,s.M.get(t.editors).filter(t=>t.id!==e)),updateContentStates:i,focusPrompt:()=>{requestAnimationFrame(()=>{let e=s.M.get(t.editors);if(!e.length)return console.warn("Cannot focus prompt: editor not initialized");e.forEach(e=>e.editor.commands.focus())})},addRefinementElementToContext:e=>{if(s.M.get(l.contextLimitReached))return;let i=s.M.get(t.context).filter(t=>"refinement-element"!==t.type||t.data.id!==e.id);s.M.set(t.context,[...i,{type:"refinement-element",data:e}])},clearRefinementElements:()=>{let e=s.M.get(t.context);s.M.set(t.context,e.filter(e=>"refinement-element"!==e.type))},addFileAttachmentsToContext:e=>{let l=s.M.get(t.context),i=o-l.length;if(i<=0)return;let n=e.slice(0,i);s.M.set(t.context,[...l,...n.map(e=>{let{file:t,upload:l}=e;return{type:"attachment",data:{file:t,name:t.name,type:t.type,size:t.size,upload:l}}})])},removeIndexFromContext:e=>{let l=s.M.get(t.context);s.M.set(t.context,l.filter((t,l)=>l!==e))},clearAttachments:()=>{let e=s.M.get(t.context);s.M.set(t.context,e.filter(e=>"attachment"!==e.type))}}}},33541:(e,t,l)=>{"use strict";l.d(t,{Nq:()=>u,w3:()=>m});var i=l(57560),n=l(40391),s=l(94282),a=l(141),r=l(81008);let o=new Map,c=(0,a.G)(o,()=>({toasts:(0,i.eU)([])})),d=new Map,u=(0,a.G)(d,e=>{let t=c(e),l=(0,n.Op)(e),s=(0,r.l1)(e),a=e=>"compact"===e,o=l.composerLayout;return{...t,composerLayoutState:o,isComposerUnfurled:(0,i.eU)(e=>a(e(o))),isPromptVisible:(0,i.eU)(e=>a(e(o))),isComposerVisible:(0,i.eU)(e=>!e(s.visiblePanels).includes("chat"))}});function m(e){let t=c(e),l=(0,n.Op)(e);return{setComposerLayoutState:e=>{s.M.set(l.composerLayout,e)},setToasts:e=>s.M.set(t.toasts,e),toast:function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=Date.now(),n=s.M.get(t.toasts);s.M.set(t.toasts,[...n,{content:e,timestamp:i,variant:l}]),setTimeout(()=>{s.M.set(t.toasts,s.M.get(t.toasts).filter(e=>e.timestamp!==i))},3e3)}}}},35591:(e,t,l)=>{"use strict";l.d(t,{DataProvider:()=>a,Q:()=>r});var i=l(97667),n=l(33571);let s=(0,n.createContext)({});function a(e){let{children:t}=e;return(0,i.jsx)(s.Provider,{value:{},children:t})}function r(){return(0,n.use)(s)}},49298:(e,t,l)=>{"use strict";l.r(t),l.d(t,{BlockContent:()=>lz,getBlockLogic:()=>lM,useRenderedBlock:()=>lD});var i=l(97667),n=l(33571),s=l(92871),a=l(22482),r=l(25426),o=l(19243),c=l(25603),d=l(17773),u=l(79168),m=l(95393),f=l(28819),p=l(65744);function h(e){let{show:t,axis:l,side:n,resizing:s,dotsHandle:a,onMouseDown:r,onFocus:o,onBlur:c,ref:d}=e,u={"aria-orientation":"x"===l?"vertical":"horizontal",onBlur:c,onFocus:o,onMouseDown:r,ref:d,role:"separator",tabIndex:0};return a?(0,i.jsx)("div",{className:(0,f.cn)("group absolute flex items-center justify-center focus:outline-none","x"===l?(0,f.cn)("inset-y-0 w-5 cursor-col-resize flex-col","start"===n?"left-[-19px]":"right-[-19px]"):(0,f.cn)("inset-x-0 h-5 cursor-row-resize flex-row","start"===n?"top-[-19px]":"bottom-[-19px]")),...u,children:(0,i.jsxs)("div",{className:"flex gap-0.5",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,i.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,i.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,i.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,i.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,i.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,i.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"})]})]})}):t?(0,i.jsx)("div",{className:(0,f.cn)("group absolute z-10 focus:outline-none","x"===l&&(0,f.cn)("inset-y-0 w-3 cursor-col-resize","start"===n?"-left-1.5":"-right-1.5"),"y"===l&&(0,f.cn)("inset-x-0 h-3 cursor-row-resize","start"===n?"-top-1.5":"-bottom-1.5")),...u,children:(0,i.jsx)("div",{className:(0,f.cn)("absolute inset-0 transition-all duration-200 group-hover:bg-gray-300 group-focus:bg-gray-400","x"===l&&(0,f.cn)("mx-auto group-hover:w-[3px] group-focus:w-[3px]",s?"w-1":"w-0"),"y"===l&&(0,f.cn)("my-auto group-hover:h-[3px] group-focus:h-[3px]",s?"h-1":"h-0"))})}):null}let x=(0,n.memo)(e=>{var t,l;let{show:s,innerClassName:a,dotsHandle:r=!1,onTrack:o,className:c,initialSize:d,animated:x=!0,minSizePx:v,minNegativeSpace:g,axis:b,side:j,children:y,cookieName:w,snapTo:k,forceInitialSize:N,onResize:P,ref:E}=e,T=(0,n.useRef)(null),C=(0,n.useRef)(null),S=(0,n.useRef)(null),[R,I]=(0,n.useState)(!1),[U,A]=(0,n.useState)(!1),[L,_]=(0,n.useState)(0),[O,M]=(0,n.useState)(0),[D,z]=(0,n.useState)(!1),V=(0,n.useState)(()=>{if("undefined"==typeof document)return null;let e=u.A.get(w);if(null===e)return null;let t=Number(e);return isNaN(t)?null:t})[0],F=(0,n.useRef)(N?d:null!=V?V:d);(0,n.useEffect)(()=>{E&&(E.current={setSize:e=>{F.current=e,T.current&&("x"===b?T.current.style.width="".concat(e,"%"):T.current.style.height="".concat(e,"%")),null==P||P(e)},getSize:()=>F.current,getContainer:()=>T.current})},[E,b,P]);let H=(0,n.useCallback)(e=>{var t,l,i,n;e.stopPropagation(),e.preventDefault(),null==(t=C.current)||t.focus(),A(!0),I(!0),_("x"===b?e.clientX:e.clientY),S.current=F.current,M(null!=(n="x"===b?null==(l=T.current)?void 0:l.clientWidth:null==(i=T.current)?void 0:i.clientHeight)?n:0),z(!0)},[b]),B=(0,n.useCallback)(e=>{var t,l;if(!R||!U)return;let i=null==(t=T.current)?void 0:t.parentElement,n=null!=(l="x"===b?null==i?void 0:i.clientWidth:null==i?void 0:i.clientHeight)?l:0,s=O+(L-("x"===b?e.clientX:e.clientY))*("start"===j?1:-1);k&&"y"===b&&s<k.threshold&&(s=k.size);let a=s/n*100;if(void 0!==g){let e=(n-g)/n*100;a>e&&(a=e)}"x"===b?T.current.style.width="".concat(a,"%"):T.current.style.height="".concat(a,"%"),F.current=a,null==P||P(a)},[b,U,R,j,L,O,k,g,P]),W=(0,n.useCallback)(()=>{var e;R&&(I(!1),A(!1),null==(e=C.current)||e.blur(),u.A.set(w,String(F.current),{expires:7}),null==o||o(S.current,F.current))},[w,o,R]);(0,p.ML)("mousemove",B),(0,p.ML)("mouseup",W),(0,p.ML)("keydown",e=>{var t,l,i,n,s;if(!R||"ArrowLeft"!==e.key&&"ArrowRight"!==e.key)return;let a=(e.shiftKey?12:4)*("ArrowLeft"===e.key?1:-1)*("start"===j?1:-1),r=null==(t=T.current)?void 0:t.parentElement,o=null!=(n="x"===b?null==r?void 0:r.clientWidth:null==r?void 0:r.clientHeight)?n:0,c=(null!=(s="x"===b?null==(l=T.current)?void 0:l.clientWidth:null==(i=T.current)?void 0:i.clientHeight)?s:0)/o*100+a;if(k&&"y"===b&&c/100*o<k.threshold&&(c=k.size/o*100),void 0!==g){let e=(o-g)/o*100;c>e&&(c=e)}"x"===b?T.current.style.width="".concat(c,"%"):T.current.style.height="".concat(c,"%"),F.current=c},C);let G=(0,n.useCallback)(()=>{var e;if(void 0===g)return;let t=null==(e=T.current)?void 0:e.parentElement,l="x"===b?null==t?void 0:t.clientWidth:null==t?void 0:t.clientHeight;if(l)return(l-g)/l*100},[b,g]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,f.cn)("fixed inset-0 z-50",R?"x"===b?"cursor-col-resize":"cursor-row-resize":"pointer-events-none")}),(0,i.jsxs)(m.P.div,{animate:"x"===b?{width:s?"".concat(null!=(t=F.current)?t:d,"%"):"0%",height:"100%",minWidth:s?"".concat(v,"px"):0,maxWidth:s&&g?"".concat(G(),"%"):void 0,opacity:+!!s}:{height:s?"".concat(null!=(l=F.current)?l:d,"%"):"0%",width:"100%",minHeight:s?"".concat(v,"px"):0,maxHeight:s&&g?"".concat(G(),"%"):void 0,opacity:+!!s},"aria-hidden":!s,className:(0,f.cn)("relative",c),inert:!s,initial:!1,layout:"size",onAnimationComplete:()=>{D&&z(!1)},ref:T,transition:D||!x?{type:!1}:{type:"spring",damping:25,stiffness:180,mass:1},children:[(0,i.jsx)(h,{axis:b,dotsHandle:r,onBlur:W,onFocus:()=>{I(!0),z(!0)},onMouseDown:H,ref:C,resizing:R,show:s,side:j}),(0,i.jsx)("div",{className:(0,f.cn)("absolute inset-0",a),children:y})]})]})});x.displayName="Resizable";var v=l(37631),g=l(42438),b=l(66692),j=l(80574),y=l(8088);function w(e){let{buttonText:t="Run Code",variant:l="default",setOutput:s,codeExecutionBlockProps:a,execute:r,editedValue:c,disabled:d}=e,[u,m]=(0,n.useState)(!1);return(0,i.jsxs)(b.$,{className:"ghost"===l?"h-6 text-gray-500 has-[>svg]:px-1":"","data-testid":"run-code-button",disabled:u||d,onClick:async()=>{try{m(!0),(0,o.u)("ClickRunCode",{code:c||a.source});let e=await r(a,c);s(e)}finally{m(!1)}},size:"sm",variant:"ghost"===l?"ghost":"secondary",children:[u?(0,i.jsx)(j.y,{size:16,wrapperClassName:"text-gray-500"}):(0,i.jsx)(y.N,{className:(0,f.cn)("translate-y-[-0.5px] [&_circle]:[vector-effect:non-scaling-stroke]","ghost"===l?"text-gray-500 [&_path]:fill-gray-500":"text-gray-900 [&_path]:fill-gray-900")}),t]},"execute")}var k=l(81195),N=l(86943),P=l(49211),E=l(80693),T=l(70770);function C(e){let{size:t=16,className:l}=e;return(0,i.jsxs)("svg",{className:(0,f.cn)("trash-icon overflow-visible",l),fill:"currentColor",height:t,viewBox:"0 0 16 16",width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("style",{children:"\n        .trash-icon .trash-lid {\n            transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n            transform-origin: center;\n        }\n\n        button:has(.trash-icon):hover .trash-lid, button:has(.trash-icon):focus-visible .trash-lid {\n          transform: translate(-0px, -2px) rotate(-10deg);\n        }\n            \n       "}),(0,i.jsx)("path",{className:"trash-lid",clipRule:"evenodd",d:"M6.75 2.75C6.75 2.0596 7.3096 1.5 8 1.5 8.6904 1.5 9.25 2.0596 9.25 2.75V3H6.75V2.75ZM5.25 3V2.75C5.25 1.2312 6.4812 0 8 0 9.5188 0 10.75 1.2312 10.75 2.75V3H12.9201 13 15V4.5H14.25 13.8846 1.75 1V3H1.75 3.0799 5.25Z",fill:"currentColor",fillRule:"evenodd"}),(0,i.jsx)("path",{clipRule:"evenodd",d:"M2.1154 4.5H13.8846L13.1776 13.6917C13.0774 14.9942 11.9913 16 10.6849 16H5.3151C4.0087 16 2.9226 14.9942 2.8224 13.6917L2.1154 4.5ZM4.318 13.5767 3.6198 4.5H12.3802L11.682 13.5767C11.6419 14.0977 11.2075 14.5 10.6849 14.5H5.3151C4.7925 14.5 4.3581 14.0977 4.318 13.5767Z",fill:"currentColor",fillRule:"evenodd"})]})}var S=l(21190),R=l(98523),I=l(48882),U=l(48339),A=l(99715),L=l(38312),_=l(5083),O=l(81657),M=l(27693);let D=e=>{if(!e)return;let t=document.getElementById((0,U.j)(e));if(t instanceof HTMLIFrameElement)if(t.contentDocument)t.contentDocument.location.reload();else if(t.srcdoc){let e=t.srcdoc;t.srcdoc="",setTimeout(()=>{t.srcdoc=e},10)}else t.src=t.src};function z(e){let{blockId:t}=e,l=(0,M.k)(),s=(0,n.useCallback)(()=>{t&&D(t)},[t]);return(0,i.jsx)(v.Z,{"aria-label":l("previewBlock.refresh"),onClick:()=>s(),tooltip:{side:"bottom",content:l("previewBlock.refresh")},children:(0,i.jsx)("span",{children:(0,i.jsx)(O.g,{})})})}var V=l(67572),F=l(54146);function H(){let{setFullscreenResult:e}=(0,V.S)(),t=(0,M.k)();return(0,i.jsx)(v.Z,{"aria-label":t("previewBlock.fullscreen"),className:"hidden md:flex",onClick:()=>e(!0),tooltip:{side:"bottom",content:t("previewBlock.fullscreen")},children:(0,i.jsx)(F.g,{})})}var B=l(78799),W=l(39918),G=l.n(W),Z=l(51311),K=l(13729),Q=l(55274),$=l(15941),q=l(71916),X=l(61872);let Y=(0,Z.default)(()=>Promise.all([l.e(34837),l.e(87852)]).then(l.bind(l,87852)).then(e=>e.ConflictEditor),{loadableGenerated:{webpack:()=>[87852]}});function J(e){let{hasUnappliedChanges:t,blockId:l,source:s,onApply:a,showFadeOut:r}=e,[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),f=(0,M.k)(),[p,h]=(0,n.useState)(null),[x,v]=(0,n.useState)(null),g=async()=>{c(!0);let e=await fetch("/chat/api/chat/remote/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bid:l,blockSource:s})});if(c(!1),e.ok){let t=await e.json();t.success?(u(!0),setTimeout(()=>u(!1),2e3),K.o.success(f("unappliedChanges.savedChanges"))):(K.o.error("Local: conflict detected. Check your console"),h(t.conflicts)),a()}else K.o.error(f("unappliedChanges.failedToApplyChanges"))},y=async()=>{if(x)try{let e=[...(0,X.A2)({source:s,blockType:"local",blockId:l})];for(let t of x){let l=e.find(e=>e.meta.file===t.file);l&&(l.source=t.content)}let t=(0,X.L5)({files:e,blockType:"local"}),i=await fetch("/chat/api/chat/remote/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bid:l,blockSource:t,resolvedConflicts:!0})});i.ok&&(await i.json()).success?(u(!0),setTimeout(()=>u(!1),2e3),K.o.success(f("unappliedChanges.savedChanges")),a(),h(null)):K.o.error(f("unappliedChanges.failedToApplyChanges"))}catch(e){K.o.error(f("unappliedChanges.failedToApplyChanges"))}},w=(0,n.useCallback)(e=>{e.every(e=>e.resolved)?v(e):v(null)},[]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q.N,{children:t&&!d?(0,i.jsxs)(i.Fragment,{children:[r?(0,i.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"from-muted pointer-events-none absolute inset-x-0 bottom-0 z-10 flex h-36 items-end justify-center bg-gradient-to-t to-transparent"},"unsaved-changes-bg"):null,(0,i.jsx)(m.P.div,{initial:{opacity:0,y:20,scale:.95,width:320},animate:{opacity:1,y:0,scale:1,width:o?96:320},exit:{opacity:0},transition:{duration:.15,ease:"easeOut",width:{type:"spring",stiffness:300,damping:30}},className:"shadow-modal bg-background absolute inset-x-0 bottom-3 z-50 mx-auto flex h-11 items-center justify-between rounded-full p-2 pl-3 text-sm font-medium",children:o?(0,i.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,i.jsx)(j.y,{size:16}),"Saving"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)($.N,{className:"!text-gray-500"}),"Unsaved Changes"]}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(b.$,{size:"sm",className:"h-7",rounded:!0,disabled:o,onClick:g,children:f("unappliedChanges.apply")})})]})},"unsaved-changes-island")]}):null}),(0,i.jsx)(q.lG,{open:null!==p,children:(0,i.jsxs)(q.Cf,{className:"max-h-[90vh] w-full max-w-[90vw] overflow-auto",children:[(0,i.jsxs)(q.c7,{children:[(0,i.jsx)(q.L3,{children:"Conflict Detected"}),(0,i.jsx)(q.rr,{children:"Please resolve them before saving."})]}),(0,i.jsx)(n.Suspense,{fallback:(0,i.jsx)(j.y,{}),children:p?(0,i.jsx)(Y,{conflicts:p,onEdit:w}):null}),(0,i.jsxs)(q.Es,{children:[(0,i.jsx)(b.$,{variant:"secondary",onClick:()=>{alert("You must resolve conflicts before continuing")},children:"Cancel"}),(0,i.jsx)(b.$,{onClick:y,disabled:null===x,children:"Confirm"})]})]})})]})}var ee=l(73311),et=l(17022),el=l(54026),ei=l(88109),en=l(15746),es=l(11909),ea=l(23423),er=l(99407),eo=l(43447),ec=l(98135),ed=l(80992);let eu=(e,t)=>{let l=e.split("\n"),i=t.split("\n");if(l.length>2e3||i.length>2e3)return{diffs:[],addedCount:Math.max(i.length-l.length,0),removedCount:Math.max(l.length-i.length,0)};let n=ed.Pp(e.trim(),t.trim(),{ignoreWhitespace:!0});return{addedCount:n.filter(e=>e.added).length,removedCount:n.filter(e=>e.removed).length,diffs:n}};var em=l(10506);function ef(e){return(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V8H3V1.5H8V5V6.5H9.5H13V13.5C13 14.0523 12.5523 14.5 12 14.5H6V16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM2.31885 12.8194H0V11.3194H2.31885V9H3.81885V11.3194H6.13775V12.8194H3.81885V15.1377H2.31885V12.8194Z",fill:"currentColor"})})}var ep=l(97128),eh=l(11946),ex=l(91581),ev=l(30227),eg=l(18513),eb=l(28963),ej=l(49848);function ey(){let{data:e,mutate:t}=(0,c.Ay)("showNewFolderDialog",null,{fallbackData:!1}),{data:l,mutate:i}=(0,c.Ay)("newFolderDialogData",null,{fallbackData:{folderName:""}});return{newFolderDialogData:l,setNewFolderDialogData:i,showNewFolderDialog:e,setShowNewFolderDialog:t}}function ew(e){let{onSuccess:t}=e,{newFolderDialogData:l,showNewFolderDialog:s,setShowNewFolderDialog:a}=ey(),[r,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),u=(0,M.k)();(0,n.useEffect)(()=>{s&&d("")},[s]);let m=(0,n.useCallback)(e=>{e.preventDefault(),o(!0),t(l.folderName?"".concat(l.folderName,"/").concat(c):c),o(!1)},[l,t,c]);return(0,i.jsxs)(eb.Modal,{onOpenChange:a,open:s,responsive:!1,children:[(0,i.jsx)(eb.ModalHeader,{children:(0,i.jsx)(eb.ModalTitle,{children:u("fileTreeActions.newFolder")})}),(0,i.jsx)(eb.ModalContent,{children:(0,i.jsx)("form",{className:"flex flex-col gap-6",onSubmit:m,children:(0,i.jsx)(ej.p,{onChange:e=>d(e.target.value),disabled:r,value:c})})}),(0,i.jsxs)(eb.ModalFooter,{children:[(0,i.jsx)(eb.ModalClose,{asChild:!0,children:(0,i.jsx)(b.$,{size:"sm",variant:"secondary",children:u("fileTreeActions.cancel")})}),(0,i.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:r,onClick:m,size:"sm",children:r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eg.IconSpinner,{className:"size-4"}),u("fileTreeActions.creating")]}):u("fileTreeActions.create")})]})]})}var ek=l(94906);function eN(e){let{className:t,...l}=e;return(0,i.jsxs)("svg",{className:(0,f.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...l,children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 10.4V11.2H10.6V10.4C10.6 9.73726 11.1373 9.2 11.8 9.2C12.4627 9.2 13 9.73726 13 10.4ZM9.4 11.2V10.4C9.4 9.07452 10.4745 8 11.8 8C13.1255 8 14.2 9.07452 14.2 10.4V11.2H15V14.8C15 15.4627 14.4627 16 13.8 16H9.8C9.13726 16 8.6 15.4627 8.6 14.8V11.2H9.4Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 7V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H7V14.5H4C3.44772 14.5 3 14.0523 3 13.5V1.5H8V5V6.5H9.5H13V7H14.5ZM9.5 5V2.12132L12.3787 5H9.5Z",fill:"currentColor"})]})}function eP(e){let{className:t,...l}=e;return(0,i.jsxs)("svg",{className:(0,f.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...l,children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.39997 10.7499C9.39997 10.1148 8.8851 9.5999 8.24997 9.5999C7.61485 9.5999 7.09997 10.1148 7.09997 10.7499V11.1428H5.89997V10.7499C5.89997 9.45203 6.95211 8.3999 8.24997 8.3999C9.54784 8.3999 10.6 9.45203 10.6 10.7499V11.2H15V14.8C15 15.4627 14.4627 16 13.8 16H9.8C9.13725 16 8.59999 15.4627 8.59999 14.8V11.2H9.39997V10.7499Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 10V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H7V14.5H4C3.44772 14.5 3 14.0523 3 13.5V1.5H8V5V6.5H9.5H13V10H14.5ZM9.5 5V2.12132L12.3787 5H9.5Z",fill:"currentColor"})]})}var eE=l(59766),eT=l(12),eC=l(74260);function eS(e){let{className:t,...l}=e;return(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l,className:(0,f.cn)("h-4 w-4",t),children:[(0,i.jsx)("path",{d:"M6.74884 6.75L2.24884 2.25M5.99884 1.5H1.75C1.61193 1.5 1.5 1.61193 1.5 1.75V6",stroke:"#717179",strokeWidth:"1.5",strokeLinecap:"square",strokeLinejoin:"round"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.0001 9.4V10.2H10.6001V9.4C10.6001 8.73726 11.1374 8.2 11.8001 8.2C12.4628 8.2 13.0001 8.73726 13.0001 9.4ZM9.4001 10.2V9.4C9.4001 8.07452 10.4746 7 11.8001 7C13.1256 7 14.2001 8.07452 14.2001 9.4V10.2H15.0001V13.8C15.0001 14.4627 14.4628 15 13.8001 15H9.8001C9.13736 15 8.6001 14.4627 8.6001 13.8V10.2H9.4001Z",fill:"#717179"})]})}let eR="file-tree-panel-right",eI="file-tree-panel-left";function eU(e){let{showDiffInfo:t,activeFilePath:l,initialFileTreeSize:s,setActiveFile:a,children:r,files:o,loadingPath:d,blockId:u,source:m,onChange:p}=e,[h,x]=(0,n.useState)(!!((null==o?void 0:o.length)&&o.length>1)),{defaultSizeRef:v,isFallbackSize:g}=(0,el.Zf)({initialSize:s,fallbackSize:15}),j=(0,n.useRef)(!1),{setDeleteFileDialogData:y,setShowDeleteFileDialog:w}=(0,ex.F)(),{setDeleteFolderDialogData:k,setShowDeleteFolderDialog:P}=(0,ev.lF)(),{setRenameFileDialogData:E,setShowRenameFileDialog:T}=(0,ek.kP)(),{newFileDialogData:C,setNewFileDialogData:S,setShowNewFileDialog:R}=(0,eh.ak)(),{setNewFolderDialogData:I,setShowNewFolderDialog:U}=ey(),{tempFolders:A,setTempFolders:L}=function(e){let{blockId:t}=e,{data:l,mutate:i}=(0,c.Ay)(["tempFolders",t],null,{fallbackData:[]});return{tempFolders:l,setTempFolders:i}}({blockId:u}),_=(0,eT.W)(u);(0,n.useEffect)(()=>{!j.current&&(null==o?void 0:o.length)&&o.length>1&&x(!!o.length)},[o]);let O=(0,n.useMemo)(()=>{let e=o?o.map(e=>["file"in e.meta?e.meta.file:"",e]):[];for(let t of A||[])e.push([t,null]);let l=[];for(let[i,n]of e){let e=i.split("/"),s=l;for(let[l,i]of e.entries()){let a=l===e.length-1&&null!==n,r=e.slice(0,l+1).join("/"),o=s.find(e=>e.title===i);if(!o){let e={title:i,value:r,isLocked:(null==n?void 0:n.isLocked)||!1,type:a?n.meta.url?"binary":"text":"directory"},l=null==n?void 0:n.originalCode,c=null==n?void 0:n.source;if(a)if(t&&l&&l!==c&&c){let{addedCount:t,removedCount:i}=eu(l,c);e.addedCount=t,e.removedCount=i}else t&&c&&!l&&(e.addedCount=c.split("\n").length,e.removedCount=0);else e.items=[];s.push(e),o=e}a||(s=o.items||[])}}return l},[o,t,A]),M=(0,n.useMemo)(()=>(0,X.A2)({source:m,blockType:"code-project",blockId:u}),[m,u]),{handleToggleFileLock:D,lockingStatus:z}=(0,eE.D)({sourceFiles:M,blockId:u,onChange:p}),V=(0,n.useCallback)(e=>{let{item:t}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ec.kt,{onSelect:()=>D({fileNameToEdit:t.value,variant:"single-file"}),children:[t.isLocked?(0,i.jsx)(er.e,{}):(0,i.jsx)(ea.C,{}),(0,i.jsx)("span",{children:t.isLocked?"Unlock":"Lock"})]}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({mode:"lock",variant:"all-files"}),children:[(0,i.jsx)(eN,{}),"Lock All"]}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({mode:"unlock",variant:"all-files"}),children:[(0,i.jsx)(eP,{}),"Unlock All"]}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({mode:"lock",variant:"other-files",fileNameToNotLock:t.value}),children:[(0,i.jsx)(eS,{}),"Lock Other Files"]}),(0,i.jsx)(ec.K5,{}),(0,i.jsxs)(ec.kt,{onSelect:()=>{T(!0),E({fileName:t.value})},children:[(0,i.jsx)(em.A,{}),"Rename"]}),(0,i.jsxs)(ec.kt,{onSelect:async()=>{try{let e,l=M.find(e=>e.meta.file===t.value);if(!l)throw Error("File not found");let i=l.meta.file.split("/"),n=i[i.length-1],s=i.length>1?i.slice(0,-1).join("/"):"",a=n.split("."),r=a.reverse().pop()||"",o=a.reverse().join("."),c=r.match(/-copy(-(\d+))?$/),d=r,m=c?c[2]?parseInt(c[2])+1:2:1;do d=c?r.replace(/-copy(-\d+)?$/,"-copy-".concat(m)):"".concat(r,"-copy").concat(m>1?"-".concat(m):""),e="".concat(s?"".concat(s,"/"):"").concat(d).concat(o?".".concat(o):""),m++;while(M.some(t=>t.meta.file===e));let f={source:l.source,meta:{file:e},blockId:u,lang:(0,eC.SR)(o),isDeleted:!1,isEdit:!1,isMerged:!1,isMoved:!1,isRecovered:!1,isFixed:!1,isQuickEdit:!1,isTerminated:!1,isAttachmentQuickEdit:!1,isLocked:!1,isUserEdit:!0};if((await _([...M,f])).success)p();else throw Error("Failed")}catch(e){throw Error("Failed")}},children:[(0,i.jsx)(es.z,{}),(0,i.jsx)("span",{children:"Duplicate"})]}),(0,i.jsxs)(ec.kt,{variant:"destructive",onSelect:()=>{w(!0),y({fileName:t.value})},children:[(0,i.jsx)(eo.l,{}),"Delete"]})]})},[u,p,y,E,w,T,D,M,_]),F=(0,n.useCallback)(e=>{let{item:t}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ec.kt,{onSelect:()=>{S({folderName:t.value}),R(!0)},children:[(0,i.jsx)(ef,{}),"New File"]}),(0,i.jsxs)(ec.kt,{onSelect:()=>{I({folderName:t.value}),U(!0)},children:[(0,i.jsx)(en.J,{}),"New Folder"]}),(0,i.jsx)(ec.K5,{}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({variant:"folder",mode:"lock",folderName:t.value}),children:[(0,i.jsx)(eN,{}),"Lock Folder"]}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({variant:"folder",mode:"unlock",folderName:t.value}),children:[(0,i.jsx)(eP,{}),"Unlock Folder"]}),(0,i.jsx)(ec.K5,{}),(0,i.jsxs)(ec.kt,{variant:"destructive",onSelect:()=>{L(e=>(e||[]).filter(e=>e!==t.value)),P(!0),k({folderName:t.value,source:m})},children:[(0,i.jsx)(eo.l,{}),"Delete"]})]})},[k,S,I,P,L,U,D,R,m]),H=(0,n.useCallback)(()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ec.kt,{onSelect:()=>{R(!0),S({folderName:""})},children:[(0,i.jsx)(ef,{}),"New File"]}),(0,i.jsxs)(ec.kt,{onSelect:()=>{U(!0),I({folderName:""})},children:[(0,i.jsx)(en.J,{}),"New Folder"]}),(0,i.jsx)(ec.K5,{}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({mode:"lock",variant:"all-files"}),children:[(0,i.jsx)(eN,{}),"Lock All"]}),(0,i.jsxs)(ec.kt,{onSelect:()=>D({mode:"unlock",variant:"all-files"}),children:[(0,i.jsx)(eP,{}),"Unlock All"]})]}),[R,D,S,U,I]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(el.YZ,{isFallbackSize:g,collapseSide:"left",cookie:N.ao,id:"file-tree-panel-group",className:"h-screen w-screen",direction:"horizontal",leftId:eI,rightId:eR,defaultSizeRef:v,children:[(0,i.jsx)(el.je,{className:"z-10 h-full min-w-[160px]",collapseSide:"left",isOpen:h,order:1,defaultSize:v.current,collapseId:eI,children:(0,i.jsx)(n.Suspense,{fallback:null,children:(0,i.jsx)("div",{className:"bg-muted flex h-full flex-col",children:(0,i.jsx)(et.h,{loading:d,active:l,onSelect:a,lockingStatus:z,className:"w-full flex-1 overflow-y-auto p-1.5 pb-12",items:O,FileActions:V,FolderActions:F,TreeActions:H})})})}),(0,i.jsx)(ei.Zk,{id:eR,order:2,defaultSize:h?100-v.current:100,className:"h-full min-w-[200px]",children:r}),(0,i.jsx)(b.$,{tooltip:"".concat(h?"Close":"Open"," File Tree"),className:(0,f.cn)("absolute bottom-2 left-2 z-20 size-7 transition-all",h?"-scale-x-100":""),variant:"secondary",size:"sm",onClick:()=>{j.current=!0,x(!h)},children:(0,i.jsx)(ep.V,{},"arrow")},"button")]}),(0,i.jsx)(ex.qM,{blockId:u,sourceFiles:M,onSuccess:()=>{w(!1),p()}}),(0,i.jsx)(ev.QQ,{blockId:u,sourceFiles:M,onSuccess:()=>{P(!1),p()}}),(0,i.jsx)(eh.jO,{blockId:u,sourceFiles:M,onSuccess:()=>{R(!1),p()}}),(0,i.jsx)(ew,{onSuccess:e=>{L(t=>Array.from(new Set([...t||[],e]))),U(!1),p()}}),(0,i.jsx)(ek.Rm,{blockId:u,sourceFiles:M,onSuccess:e=>{e&&l===C.fileName&&a(e),T(!1),p()}})]})}var eA=l(68547),eL=l(72131),e_=l(36863),eO=l(3974);function eM(e){let{data:t,mutate:l}=(0,c.Ay)(["block:file-editing-status",e],{fallbackData:!1});return[t,(0,n.useCallback)(e=>{l(e)},[l])]}var eD=l(32136),ez=l(66683),eV=l(71543),eF=l(71935),eH=l(3121),eB=l(83823),eW=l(618),eG=l(86184),eZ=l(36323),eK=l(41956),eQ=l(1222),e$=l(73057),eq=l(6447);function eX(e){let{event:t,canWriteToChat:l,onAskV0:n}=e;return(0,i.jsxs)("div",{className:"flex items-start gap-4 px-2 py-1 font-mono text-sm",children:[(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("time",{className:"text-[13px]",children:[(0,eB.GP)(new Date(t.timestamp),"HH:mm:ss.SSS"),"Z"]}),t.isServer&&(0,i.jsx)("span",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600",children:"[SERVER]"})]}),(0,i.jsx)("div",{className:"w-full flex-1 whitespace-pre-wrap text-[13px]",children:t.message}),l&&"error"===t.method&&(0,i.jsx)("div",{className:"absolute right-3 top-0.5 opacity-0 transition-opacity group-hover:opacity-100",children:(0,i.jsxs)(b.$,{onClick:()=>n(t),size:"sm",variant:"secondary",className:"h-[24px] gap-0.5 rounded-md border-none px-1.5 py-0.5 font-sans text-[13px] font-medium shadow-sm",children:["Ask ",(0,i.jsx)(eW.o,{className:"ml-0.5 h-3 w-3"})]})})]})}function eY(e){let{event:t,activeFilePath:l,setActiveFilePath:s}=e,r=n.useMemo(()=>{try{let e=JSON.parse(t.content);return"string"==typeof e?e:t.content}catch(e){return t.content}},[t.content]),{isCopied:c,copyToClipboard:d}=(0,g.j)({timeout:2e3}),u=async e=>{if(c)return;let t=(0,eq.z)(e);return await d(t),(0,o.u)("CopyOutputExecutable",{output:t})},m=()=>({stdout:"stdout"===t.method?[[r]]:[],stderr:"stderr"===t.method?[[r]]:[]});return(0,i.jsx)(a.ie,{fileName:t.fileName,isCopied:c,handleCopy:()=>void u(m()),handleDownload:()=>void(0,eq.X)(m()),handleFileOpen:()=>{l!==t.fileName&&(null==s||s(t.fileName))},children:"string"==typeof r?(0,i.jsx)("pre",{className:"whitespace-pre-wrap break-words",children:r}):(0,i.jsx)(a.Ip,{src:r,className:"[&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",style:"stderr"===t.method?{color:"rgb(192,27,93)"}:void 0})})}function eJ(e){let{consoleEvents:t,clearLogs:l,canWriteToChat:n,hideHeader:s,className:r,activeFilePath:o,setActiveFilePath:c}=e,{setPromptFormInput:d}=(0,eG.Q1)(),u=(0,eZ.oQ)(),{containerRef:m,vlistRef:p,handleScroll:h,scrollDownButton:x}=(0,e$.I)({count:t.length,pushToBottom:!0}),v=e=>{d("The code has the following ".concat(e.method,":\n```\n").concat("console"===e.type?e.message:e.content,"\n```\nRevise the code to address this issue.")),(0,eK.Ny)()&&u(!1)};return(0,i.jsxs)("div",{className:(0,f.cn)("bg-muted flex size-full flex-col items-stretch overflow-hidden",r),children:[!s&&(0,i.jsxs)(eO.o,{className:"justify-between gap-1",bottomBorder:!0,children:[(0,i.jsx)("h3",{className:"text-[13px] font-medium",children:"Console"}),(0,i.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,i.jsxs)("div",{className:"text-xs",children:[(0,i.jsxs)("span",{children:[t.length," "]}),(0,i.jsx)("span",{children:1===t.length?"event":"events"})]}),(0,i.jsx)("div",{className:"ml-1 h-[16px] w-[1px] bg-gray-200","aria-hidden":!0}),(0,i.jsx)(b.$,{variant:"ghost",size:"xs",className:"text-gray-500",tooltip:"Clear console output",onClick:l,disabled:0===t.length,children:(0,i.jsx)(C,{})})]})]}),(0,i.jsxs)("div",{className:"relative size-full",style:{contain:"strict"},children:[(0,i.jsx)("div",{className:"h-full w-full overflow-y-auto",ref:m,style:{overflowAnchor:"none"},children:(0,i.jsx)("div",{className:"mx-auto w-full",children:0===t.length?(0,i.jsx)("div",{className:"flex h-full items-center justify-center p-8",children:(0,i.jsx)("div",{className:"text-center text-sm text-gray-500",children:"No logs available to display"})}):(0,i.jsx)(eQ.YV,{scrollRef:m,ref:p,onScroll:h,children:t.map((e,t)=>(0,i.jsx)("div",{className:(0,f.cn)("group relative flex min-h-[24px] items-center",(0,a.eD)(e.method)),children:"console"===e.type?(0,i.jsx)(eX,{event:e,canWriteToChat:n,onAskV0:v}):(0,i.jsx)(eY,{event:e,activeFilePath:o,setActiveFilePath:c})},"".concat(e.timestamp,"-").concat(t)))})})}),t.length>0?(0,i.jsx)("div",{className:"sticky inset-x-0 bottom-2 z-50 flex justify-center",children:x}):null]})]})}var e0=l(36380),e1=l(16370);let e5=e=>{let{className:t,dotColor:l}=e;return(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 5.64582V12.5C16 13.8807 14.8807 15 13.5 15H2.5C1.11929 15 0 13.8807 0 12.5V2.5V1H1.5H9.53513C9.27389 1.45161 9.0984 1.95903 9.03095 2.5H1.5V12.5C1.5 13.0523 1.94772 13.5 2.5 13.5H13.5C14.0523 13.5 14.5 13.0523 14.5 12.5V6.70924C15.08 6.47444 15.5925 6.10753 16 5.64582ZM4.44194 10.6919L4 11.1339L3.11612 10.25L3.55806 9.80806L5.36612 8L3.55806 6.19194L3.11612 5.75L4 4.86612L4.44194 5.30806L6.51517 7.38128C6.85687 7.72299 6.85687 8.27701 6.51516 8.61872L4.44194 10.6919ZM8.6225 9.75494H8V10.9999H8.6225H11.75H12.3725V9.75494H11.75H8.6225Z",className:"fill-current"}),(0,i.jsx)("circle",{cx:"13",cy:"3",r:"3",fill:l})]})};function e2(e){let{status:t,isExpanded:l}=e;return!t||l?(0,i.jsx)(e1.b,{}):(0,i.jsx)(e5,{className:"text-gray-500 transition-colors group-hover/log-panel-header:text-gray-900",dotColor:"error"===t?"#DC2626":"#2563EB"})}let e3=(e,t)=>e/t*100,e9=(e,t)=>e/100*t,e4=e=>e>N.Tq;function e6(e){let{children:t,blockId:l,consoleEvents:s=[],clearLogs:a,canWriteToChat:r,activeFilePath:o,setActiveFilePath:c,initialSize:d,initialExpanded:m,onShouldExpand:p,hide:h}=e,[v,g]=(0,n.useState)(""),{blockStatus:j,clearEvents:y}=(0,e0.a)(l),w=j[l],k=(0,n.useRef)(null),[P,E]=(0,n.useState)(s.length>0&&(null!=m?m:N.XK)),T=(0,n.useRef)(null),S=(0,n.useMemo)(()=>{if(!v)return s;let e=v.toLowerCase();return s.filter(t=>"console"===t.type?t.message.toLowerCase().includes(e):t.content.toLowerCase().includes(e))},[s,v]),R=(0,n.useCallback)(()=>{var e,t,l,i,n,s,a;let r=null==(e=k.current)?void 0:e.getContainer(),o=null==r||null==(t=r.parentElement)?void 0:t.clientHeight;if(!o)return;let c=e3(N.as,o),d=null!=(i=null==(l=k.current)?void 0:l.getSize())?i:0;if(P)d>c&&(T.current=d),null==(n=k.current)||n.setSize(c),u.A.set(N.Mo,String(c),{expires:7}),u.A.set(N.jL,String(!1),{expires:7});else{let e=null!=(a=T.current)?a:N.uq;null==(s=k.current)||s.setSize(e),u.A.set(N.Mo,String(e),{expires:7}),u.A.set(N.jL,String(!0),{expires:7})}E(!P),y()},[P,y]);(0,n.useEffect)(()=>{p&&!P&&p(R)},[p,R,P]);let I=(0,n.useCallback)(e=>{var t,l,i;let n=null==(t=k.current)?void 0:t.getContainer(),s=e4(e9(e,null!=(i=null==n||null==(l=n.parentElement)?void 0:l.clientHeight)?i:0));s&&(T.current=null),P!==s&&(E(s),u.A.set(N.jL,String(s),{expires:7}),y())},[y,P]),U=(0,M.k)();return(0,i.jsxs)("div",{className:"relative flex size-full min-h-0 flex-1 flex-col",children:[t,h?null:(0,i.jsx)(x,{animated:!1,axis:"y",cookieName:N.Mo,dotsHandle:!1,initialSize:P?null!=d?d:N.H2:0,minSizePx:N.as,minNegativeSpace:144,show:!0,forceInitialSize:!P,side:"start",snapTo:{threshold:N.Tq,size:N.as},onResize:I,className:"z-20",ref:k,children:(0,i.jsxs)("div",{className:"bg-muted group/log-panel-header relative flex size-full flex-col border-t",children:[(0,i.jsxs)("div",{className:"flex h-9 w-full shrink-0 cursor-pointer items-center justify-between hover:text-gray-900",onClick:R,children:[(0,i.jsxs)("div",{className:(0,f.cn)("flex items-center gap-1.5 px-3 text-sm text-gray-500 transition-all group-hover/log-panel-header:text-gray-900",P&&"text-gray-900"),children:[(0,i.jsx)(e2,{status:w,isExpanded:P}),(0,i.jsx)("span",{children:U("logPanel.console")})]}),(0,i.jsxs)("div",{className:"flex gap-0.5 pr-2",children:[P?(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(ej.p,{placeholder:"Filter...",size:"xs",className:"w-44 rounded-md px-2 text-[13px]",value:v,onChange:e=>g(e.target.value),onClick:e=>e.stopPropagation()}),(0,i.jsx)(b.$,{variant:"ghost",size:"xs",className:"text-gray-500",tooltip:{side:"bottom",content:"Clear logs"},onClick:e=>{e.stopPropagation(),null==a||a()},disabled:0===s.length,children:(0,i.jsx)(C,{})})]}):null,(0,i.jsx)(b.$,{tooltip:{side:"bottom",content:P?"Collapse panel":"Expand panel"},variant:"ghost",className:"text-gray-500",size:"xs",onClick:e=>{e.stopPropagation(),R()},children:P?(0,i.jsx)(eF.r,{}):(0,i.jsx)(eH.U,{})})]})]}),(0,i.jsx)(eJ,{hideHeader:!0,consoleEvents:S,clearLogs:a||(()=>{}),canWriteToChat:r,className:"bg-transparent",activeFilePath:o,setActiveFilePath:c})]})})]})}var e7=l(19434),e8=l(40711),te=l(37707),tt=l(95995),tl=l(54545),ti=l(44825),tn=l(20717),ts=l(45586);function ta(e){let{projectBlocks:t,projectBlockIndex:l}=(0,ts.P6)({blockId:e.blockId}),i=(0,n.useMemo)(()=>{if("code-project"===e.meta.type)return(0,X.A2)({source:e.source,blockType:"code-project",blockId:e.blockId})},[e.source,e.blockId,e.meta.type]),s=(0,n.useMemo)(()=>{if(e.closed||!i||!i.length)return;let t=i[i.length-1];if("file"in t.meta&&!t.isDeleted)return t.meta.file},[i,e.closed]);return{files:(0,n.useMemo)(()=>{if(!i)return;let n=[],s=new Map,a=t.slice(0,l),r=new Map;for(let e of a){let t=(0,X.A2)({source:e.source,blockType:"code-project",blockId:e.id});n.push(...t)}n.push(...i);let o=new Set(e.closed?i.map(e=>e.meta.file):n.map(e=>e.meta.file));for(let e of n){let t=s.get(e.meta.file);t?s.set(e.meta.file,{...e,originalCode:t.source}):s.set(e.meta.file,{...e,originalCode:e.isQuickEdit&&!e.source?"// ".concat(e.isAttachmentQuickEdit?"Reading from":"Generating"," ").concat(e.meta.file):void 0}),r.has(e.meta.file)||r.set(e.meta.file,r.size)}return Array.from(s.values()).filter(e=>!e.isDeleted&&o.has(e.meta.file))},[l,t,i,e.closed]),loadingPath:s}}var tr=l(83368),to=l.n(tr),tc=l(27831),td=l(73450),tu=l.n(td),tm=l(80791),tf=l.n(tm),tp=l(53849),th=l(93660);let tx=[...Array(200)].map(()=>"".concat(Math.floor(80*Math.random())+20,"%"));function tv(){return(0,i.jsxs)("div",{className:"flex w-full",children:[(0,i.jsx)("div",{className:"flex flex-col gap-2 px-[11px]",children:[...Array(200)].map((e,t)=>(0,i.jsx)(th.E,{className:"size-4"},t))}),(0,i.jsx)("div",{className:"flex flex-1 flex-col gap-2",children:[...Array(200)].map((e,t)=>(0,i.jsx)(th.E,{className:"h-4",style:{width:tx[t]}},t))})]})}function tg(e){var t;let{blockId:l,closed:a,source:r,meta:o,switchToCode:c}=e,{files:d,loadingPath:u}=ta({blockId:l,closed:a,source:r,meta:o}),{activeFilePath:f}=(0,eA.m)({blockId:l,files:d,loadingPath:u}),p=(null==d?void 0:d.length)?d.find(e=>e.meta.file===f)||d[0]:void 0,[h,x]=(0,n.useState)((null==p?void 0:p.source)||""),v=(0,n.useRef)(tf()(e=>{x(e)},500)),g="Generating".concat((null==p?void 0:p.meta.file)?" ".concat((t=p.meta.file)?t.length>25?"...".concat(t.slice(-22)):t:""):"");(0,n.useEffect)(()=>{v.current((null==p?void 0:p.source)||"")},[null==p?void 0:p.source]);let b=p&&h.split("\n").length>=9,y=(0,n.useMemo)(()=>h?h.split("\n").map(e=>{var t;let l=Math.floor(((null==(t=e.match(/^\s*/))?void 0:t[0])||"").length/2);return e.slice(l)}).join("\n"):"",[h]);return(0,i.jsx)(m.P.div,{className:"relative m-auto",initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},children:(0,i.jsx)(tp._r,{renderKey:g,duration:.4,exit:{scale:.98},delay:.1,enter:{scale:1.02},children:(0,i.jsxs)("button",{className:"relative flex flex-1 flex-col items-start justify-center gap-3 overflow-hidden",onClick:c,children:[(0,i.jsxs)("div",{className:"text-heading-16 flex h-5 items-center gap-2 px-[11px]",children:[(0,i.jsx)(j.y,{size:16}),g]}),(0,i.jsx)(tp._r,{renderKey:b?"showSource":"hideSource",duration:.4,exit:{scale:.98},delay:.1,enter:{scale:1.02},children:(0,i.jsx)("div",{className:(0,e7.cn)(to().content,"relative h-[200px] w-[400px] overflow-hidden"),children:(0,i.jsx)(tb,{height:200,children:b?(0,i.jsx)(s.c,{isTabbed:!1,minLineNumberChars:3,language:p.lang,showLineNumbers:!0,value:y,wrapLongLines:!0,style:{padding:0}}):(0,i.jsx)(tv,{})},"".concat(b,"-").concat(null==p?void 0:p.meta.file))})})]})})})}function tb(e){let{children:t,baseScrollIncrementPx:l=20,minScrollAmount:s=2,maxScrollAmount:a=8,height:r=0}=e,o=(0,n.useRef)(null),[c,d]=(0,n.useState)(0);return(0,n.useEffect)(()=>{let e=setInterval(()=>{var e;let t=(Math.floor(Math.random()*(a-s+1))+s)*l,i=null==(e=o.current)?void 0:e.getBoundingClientRect().height;i&&d(e=>tu()(e+t,0,i-r))},700);return()=>clearInterval(e)},[l,r,a,s]),(0,i.jsx)("div",{ref:o,className:"pointer-events-none relative flex-1 overflow-auto text-sm",style:{transform:"translateY(-".concat(c,"px)"),...(0,tc.iA)(["transform"],{duration:600})},children:t})}let tj=(0,Z.default)(()=>Promise.all([l.e(34837),l.e(89879)]).then(l.bind(l,89879)).then(e=>e.MultiFileLocalCodeBlock),{loadableGenerated:{webpack:()=>[89879]}}),ty=(e,t,l,i)=>{if(e){var n;null==(n=e.contentWindow)||n.postMessage({type:"preview_code_delta",file:t,source:l,version:i},"*")}},tw=(e,t,l)=>{if(e){var i;null==(i=e.contentWindow)||i.postMessage({type:"preview_code",code:t,version:l},"*")}},tk=G()(tw,300);function tN(e){let{children:t,activeTab:l,setActiveTab:s,allowRefresh:a,allowFullScreen:r=!0,initialFileTreeSize:o,resultId:d,language:u,remoteInfo:m,meta:f,source:h,hasBlockPreview:x,blockId:v,blockType:g,closed:b,hasSourceBeenEdited:y,onEdit:w,files:k,loadingPath:N,originalCode:E,isV3:T,initialConsoleSize:C,initialConsoleExpanded:O}=e,{activeFilePath:D,setActiveFilePath:V,setAutoSwitch:F}=(0,eA.m)({blockId:v,files:k,loadingPath:N}),{setHref:W,latestHref:Z}=(0,e8.Z)(v),{ve:K,bl:Q}=(0,te.D)(),{editValueMap:$,setEditValueMap:q}=(0,eL.V)({blockId:v}),{consoleEvents:Y,appendConsoleEvent:et,appendCodeOutputEvents:el,clearConsoleEvents:ei,expandConsole:en,setExpandConsole:es}=(0,tn.t)(v),ea=(0,p.aq)(),{isPublished:er}=(0,P.usePublishedPage)(),{canWriteToChat:eo}=(0,eD.tZ)(),ec=(0,M.k)(),{data:ed,mutate:eu}=(0,c.Ay)(v?["remote:accepted",v]:null,null,{fallbackData:null==m?void 0:m.accepted}),em=(0,e_.F)($),ef=(0,e_.F)(k),ep=(0,n.useMemo)(()=>Q&&!b||x,[Q,x,b]),eh=(0,n.useMemo)(()=>!Q||b||x?t:(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,i.jsx)(tg,{switchToCode:()=>s("code"),blockId:v,closed:b,source:h,meta:f})}),[Q,t,b,x,v,h,f,s]),ex=(0,n.useCallback)((e,t,l,i)=>{if(!b)return;let n={...em.current,[t]:e};q(n),null==w||w(e);let s=(0,U.j)(null!=d?d:v),a=document.getElementById(s);if(a)if("code-project"===g)i?ty(a,t,e,l):tw(a,(0,X.F7)((0,X.GP)(n,ef.current||[])),l);else if("v0"===g)tk(a,e);else{var r;null==(r=a.contentWindow)||r.postMessage({type:u.toUpperCase()+"_RENDER",source:e},a.dataset.origin||"")}},[b,em,q,w,d,v,g,ef,u]),ev=(0,n.useCallback)((e,t,l,i,n,s,a,r)=>{var o;if(!ef.current)return;let c=ef.current.findIndex(t=>t.meta.file===e);if(-1===c)return;let d=null!=(o=null!=a?a:em.current[e])?o:ef.current[c].source;if(r){let[e,t]=r;d=d.substring(0,e)+n+d.substring(t)}else{let e=d.split("\n"),s=0;for(let l=0;l<t-1;l++)s+=e[l].length+1;d=d.substring(0,s+l-1)+n+d.substring(s+l-1+i)}ex(d,e,s,!0)},[ef,em,ex]);(0,n.useEffect)(()=>{tl.u.current={inlineEdit:G()(ev,100,{leading:!0,trailing:!0}),getContent(e){var t;if(!ef.current)return;let l=ef.current.findIndex(t=>t.meta.file===e);if(-1!==l)return null!=(t=em.current[e])?t:ef.current[l].source}}},[ev]),(0,n.useEffect)(()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);if(!t)return;let l=e=>{if(e.data&&"object"==typeof e.data&&e.data.__v0_remote__)switch(e.data.type){case"frame_ready":if("code-project"===g){var l;if(!(null==(l=ef.current)?void 0:l.length))return;Object.keys(em.current).length>0&&tw(t,(0,X.F7)((0,X.GP)(em.current,ef.current)))}break;case"inline_edit":ev(e.data.file,e.data.line,e.data.column,e.data.len,e.data.replace,e.data.version);break;case"console":et(e.data)}};return window.addEventListener("message",l),()=>{window.removeEventListener("message",l)}},[v,g,d,ef,ex,em,et,ev]),(0,n.useEffect)(()=>{let e=(0,U.j)(null!=d?d:v);if(!document.getElementById(e))return;let t=e=>{e.data&&"object"==typeof e.data&&e.data.__v0_remote__&&"location_change"===e.data.type&&W(e.data.href)};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[v,d,W]);let eg=k||[{source:h,meta:f,originalCode:E,lang:u,isQuickEdit:!!f.isQuickEdit,blockId:v}],eb=(0,n.useCallback)(()=>{q({})},[q]),{user:ej}=(0,eV.J)(),ey=(0,eK.al)(),ew=(0,n.useCallback)(()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);t&&(t.contentDocument?t.contentDocument.location.reload():Z.current?t.src=Z.current:t.src=t.src)},[d,v,Z]),ek=(0,ee.z)({blockId:v,editValueMap:$,isAdminSaving:!eo&&!!(null==ej?void 0:ej.isAdminMode),source:h,meta:f,files:eg,clearEditValueMap:eb}),[,eN]=eM(v),eP=ek.hasUnsavedChanges;(0,n.useEffect)(()=>{eN(eP)},[eP,eN]);let eE=b&&(!!eo||!!(null==ej?void 0:ej.isAdminMode));if(er)return(0,i.jsx)("div",{className:(0,I.A)("bg-muted h-full min-h-0 overflow-hidden","preview"===l&&"border-alpha-200",!ea&&"opacity-0"),children:eh});if("code-project"===g){if(!o)throw Error("code-project block is missing initialFileTreeSize");let e=eg.length?eg.find(e=>e.meta.file===D)||eg[0]:void 0,t=e?[{key:"preview",content:!0===ep?(0,i.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(r||a)&&(0,i.jsxs)(eO.o,{className:"bg-muted justify-end gap-1",bottomBorder:!0,children:[r?(0,i.jsx)(H,{}):null,a?(0,i.jsx)(z,{blockId:d||v}):null]}),(0,i.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,i.jsx)(B.FullscreenContainer,{children:eh})})]}):"object"==typeof ep&&"warning"in ep?(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center gap-2",children:ep.warning}):null},T?null:{key:"code",content:K&&!1===ey?(0,i.jsx)(tt.h,{blockId:v,source:h,reloadIframe:ew,onEdit:(e,t)=>{ex(t,e)},files:k||[],activeFilePath:D,editValueMap:$}):(0,i.jsx)(eU,{showDiffInfo:b,loadingPath:N,activeFilePath:D,setActiveFile:e=>{F&&F(!1),V(e)},initialFileTreeSize:o,files:k,source:h,blockId:v,onChange:ew,children:(0,i.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(0,i.jsxs)(eO.o,{className:"justify-between gap-2",onePixelShorter:!0,children:[(0,i.jsx)("div",{className:"flex min-w-0 items-center gap-1 overflow-x-auto",children:D&&D.split("/").map((e,t)=>(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("div",{className:"whitespace-nowrap font-medium [&:nth-last-child(2)]:text-gray-900",children:e},"part-".concat(e,"-").concat(t)),(0,i.jsx)("div",{className:"last:hidden",children:(0,i.jsx)(A.b,{})},"chevron-".concat(e,"-").concat(t))]},"part-".concat(e,"-").concat(t)))}),(0,i.jsx)("div",{className:"flex items-center gap-1",children:(0,i.jsx)(R.C,{closed:b,additionalHeaderActions:void 0,allowClose:!1,blockId:v,allowCopyCode:!0,allowDownloadCode:!0,originalCode:e.originalCode,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:$[f.file||""]||e.source,isExecutable:"script"===e.meta.type&&"code"===l,transactionMeta:e.meta.transaction,language:e.lang,onExecutionComplete:e=>{el(e),null==en||en()}})})]}),(0,i.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,i.jsx)(tP,{blockType:g,remoteInfo:m,isMultiFile:!0,closed:b,blockId:v,setEditValueMap:q,language:e.lang,editValueMap:$,hasSourceBeenEdited:y,handleEdit:ex,file:e,editable:eE,appendCodeOutputEvents:el})})]})})}].filter(e7.R):[];return(0,i.jsx)(e6,{hide:!!Q&&!b,blockId:v,consoleEvents:Y,clearLogs:ei,canWriteToChat:eo,activeFilePath:D,setActiveFilePath:V,initialSize:C,initialExpanded:O,onShouldExpand:e=>es(()=>e),children:(0,i.jsxs)("div",{className:"relative min-h-0 w-full flex-1 grow",children:[(0,i.jsx)(S.JS,{className:(0,I.A)(T?"":"border-alpha-200 border-t"),tabFiles:t,activeTabKey:l}),eE?(0,i.jsx)(ee.o,{...ek,resetValue:()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);t&&tw(t,(0,X.F7)((0,X.GP)({},ef.current||[])))},mergedFromBlockId:v,isV3:T}):null]})})}let eT=eg.map(e=>({key:void 0!==k?f.file+"code":"code",display:f.file||"Untitled",content:(0,i.jsx)(tP,{blockType:g,remoteInfo:m,closed:b,blockId:v,setEditValueMap:q,language:u,editValueMap:$,hasSourceBeenEdited:y,handleEdit:ex,file:e,editable:eE,appendCodeOutputEvents:el}),actions:(0,i.jsx)(R.C,{closed:b,additionalHeaderActions:void 0,allowClose:!1,blockId:v,allowCopyCode:!0,allowDownloadCode:!0,originalCode:e.originalCode,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:$[f.file||""]||e.source})})),eC={key:"preview",disabled:Q?b&&!(0,ez.O)(ep):!(0,ez.O)(ep),tooltip:"object"==typeof ep&&"error"in ep?ep.error:Q||b?void 0:ec("previewBlock.previewIsStreaming"),display:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(_.p,{className:"group-disabled:hidden"}),(0,i.jsx)("div",{className:"hidden group-disabled:block",children:b?(0,i.jsx)(L.X,{}):(0,i.jsx)(j.y,{size:16})}),ec("previewBlock.preview")]}),content:(0,i.jsx)(B.FullscreenContainer,{children:eh}),actions:(0,i.jsxs)(i.Fragment,{children:[r?(0,i.jsx)(H,{}):null,a?(0,i.jsx)(z,{blockId:d||v}):null]})};return(0,i.jsxs)(i.Fragment,{children:["local"!==g||"@remote"===v||k?null:(0,i.jsx)(J,{blockId:v,hasUnappliedChanges:!!(!0!==ed||$[f.file||""]&&$[f.file||""]!==h),source:$[f.file||""]||h,onApply:()=>{eu(!0)},showFadeOut:"code"===l}),eE?(0,i.jsx)(ee.o,{...ek,resetValue:()=>{let e=(0,U.j)(null!=d?d:v),t=document.getElementById(e);if(t)if("v0"===g)tw(t,eg[0].source);else{var l;null==(l=t.contentWindow)||l.postMessage({type:u.toUpperCase()+"_RENDER",source:eg[0].source},t.dataset.origin||"")}},mergedFromBlockId:v,isV3:T}):null,(0,i.jsx)(S.Yv,{activeTabKey:l||"code",isLoading:!b,setActiveTabKey:s,tabFiles:[eC,...eT]})]})}function tP(e){let{blockType:t,remoteInfo:l,closed:a,blockId:r,setEditValueMap:o,isMultiFile:c,language:d,editValueMap:u,hasSourceBeenEdited:m,handleEdit:f,file:p,editable:h,className:x,appendCodeOutputEvents:v}=e,{source:g,meta:b,originalCode:j,isQuickEdit:y}=p;return"local"===t?(0,i.jsx)(n.Suspense,{fallback:null,children:(0,i.jsx)(tj,{remoteInfo:l,blockId:r,source:g,onEdit:e=>{a&&o(t=>({...t||{},[b.file||""]:e}))},closed:a})}):p.meta.url&&!p.source.trim().length?(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)(tT,{url:p.meta.url,file:p.meta.file,isTempFile:p.isTempFile})}):(0,i.jsx)(s.N,{isMultiFile:c,allowQuoting:!0,closed:a,caller:"v0",originalCode:j,showQuickEditAnimation:!a&&y,className:(0,I.A)("not-prose flex-1 grow",x),editable:h,fixingBadLines:p.fixingBadLines,fileName:b.file,language:d,blockId:r,editValue:u[b.file||""],hasSourceBeenEdited:m,onEdit:e=>f(e,b.file||""),runnable:!0,showLineNumbers:!0,value:g,type:b.type,onExecutionComplete:v})}let tE=(e,t)=>{var l;if(t)return t;let i=(null==(l=e.split(".").pop())?void 0:l.toLowerCase())||"";return["jpg","jpeg","png","gif","svg","webp","avif","ico"].includes(i)?"image":["glb","gltf"].includes(i)?"3d":["mp3","wav","ogg","flac"].includes(i)?"audio":["mp4","webm","ogv"].includes(i)?"video":"pdf"===i?"pdf":"unknown"};function tT(e){let{url:t,mimeType:l,file:s,isTempFile:a}=e,[r,o]=(0,n.useState)(null),c=tE(t,l);(0,n.useEffect)(()=>{o(null)},[t]);let d=()=>{o("Failed to load ".concat(c," from ").concat(t))};if(r)return(0,i.jsx)("div",{className:"rounded border border-red-300 bg-red-50 p-4 text-red-500",children:r});switch(c){case"image":if(a)return(0,i.jsx)(ti.Q,{});return(0,i.jsx)("img",{src:t||"/placeholder.svg",className:"h-auto max-w-full",onError:d,alt:"Preview of ".concat(s)});case"3d":return(0,i.jsx)("div",{className:"h-[400px] w-full",children:"Previewing 3D models is not currently supported."});case"audio":return(0,i.jsxs)("audio",{controls:!0,className:"w-full",onError:d,children:[(0,i.jsx)("source",{src:t}),"Your browser does not support the audio element."]});case"video":return(0,i.jsxs)("video",{controls:!0,className:"h-auto max-w-full",onError:d,children:[(0,i.jsx)("source",{src:t}),"Your browser does not support the video element."]});case"pdf":return(0,i.jsxs)("div",{className:"rounded border bg-gray-50 p-4",children:[(0,i.jsxs)("p",{className:"mb-2",children:["PDF document:"," ",(0,i.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Open PDF"})]}),(0,i.jsx)("iframe",{src:"".concat(t,"#view=FitH"),className:"h-[500px] w-full",onError:d})]});default:return(0,i.jsx)("div",{className:"rounded border bg-gray-50 p-4",children:(0,i.jsxs)("p",{children:["Unknown file type."," ",(0,i.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Download file"})]})})}}var tC=l(74118),tS=l(70731);async function tR(e){let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch outdated env vars");return t.json()}async function tI(e){if(!(await fetch(e,{method:"POST"})).ok)throw Error("Failed to sync env vars")}var tU=l(8599);function tA(){let[e,t]=(0,n.useState)(!0),{isAuthor:l}=(0,tC.Pk)(),{project:s}=(0,eD.tZ)(),a=(0,eZ.eu)(),{outdatedEnvVars:r,sync:o,syncError:d}=function(e,t){let{data:l,error:i,isLoading:n,mutate:s}=(0,c.Ay)(e&&t?"/chat/api/chat/env-vars/outdated?bid=".concat(e):null,tR,{refreshInterval:18e4}),{trigger:a,error:r}=(0,tS.A)(e&&t?"/chat/api/chat/env-vars/outdated?bid=".concat(e):null,tI),o=async()=>{await a(),await s()};return{outdatedEnvVars:l,isLoading:n,error:i,refresh:s,sync:o,syncError:r}}(null==a?void 0:a.id,null==s?void 0:s.vercelProjectId),[u,m]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{d&&(console.error("Failed to sync environment variables",d),K.o.error("Failed to sync environment variables",{position:"bottom-right"}))},[d]),e&&(null==r?void 0:r.length))?(0,i.jsx)("div",{className:"shadow-modal bg-background absolute bottom-2 right-2 z-10 max-w-[350px] rounded p-2",children:(0,i.jsxs)("div",{className:" flex min-w-[300px] flex-col items-center gap-3 rounded-[8px]   p-2 text-sm",role:"alert",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,i.jsxs)("div",{className:"flex w-full items-center font-semibold",children:[(0,i.jsx)("span",{children:"Outdated Environment Variables"})," "]}),(0,i.jsx)("div",{className:"flex w-full",children:(0,i.jsx)("span",{className:"font-small line-clamp-3 overflow-hidden text-xs",children:"The connected v0 Project has environment variables not in sync with the current block. Sync them to ensure your block works as expected."})})]}),l&&(0,i.jsxs)("div",{className:"flex w-full justify-end gap-2 align-middle",children:[(0,i.jsx)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",size:"sm",variant:"ghost",onClick:()=>{t(!1)},children:"Dismiss"}),(0,i.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",size:"sm",variant:"secondary",onClick:async()=>{m(!0),await o(),m(!1),t(!1),K.o.success("Environment variables synced",{position:"bottom-right"})},disabled:u,children:[(0,i.jsx)(tU.j,{height:13,width:13})," Sync"]})]})]})}):null}class tL{static Render(e){var t;let{isPublished:l}=(0,P.usePublishedPage)(),u=(0,p.aq)(),{isCopied:m,copyToClipboard:h}=(0,g.j)({timeout:2e3}),{editValueMap:b,setEditValueMap:j}=(0,eL.V)({blockId:e.blockId}),{isAuthor:y}=(0,tC.Pk)(),{data:I,mutate:U}=(0,c.Ay)(["block:output",e.blockId]),{data:A}=(0,c.Ay)("block:output:initial");(0,n.useEffect)(()=>{(null==A?void 0:A.id)===e.blockId&&A.result.then(e=>{e&&U(t=>t||e.value)})},[A,e.blockId,U]);let L=I;if(void 0===L&&(null==A?void 0:A.id)===e.blockId&&A){let e=(0,n.use)(A.result);e&&(L=e.value)}let _=async()=>{if(m)return;let e=(0,eq.z)(L);return await h(e),(0,o.u)("CopyOutputExecutable",{output:e})},O=(0,n.useMemo)(()=>k.DS.includes(e.language)&&k._b.some(t=>{var l;return null==(l=e.meta.file)?void 0:l.endsWith(t)}),[e.language,e.meta.file]),M=(0,ee.z)({blockId:e.blockId,editValueMap:b,source:e.source,meta:e.meta,files:[{source:e.source,meta:e.meta}],clearEditValueMap:()=>j({})}),D=l?N.Lk:N.K4,z=[{key:"code",display:e.meta.file,content:(0,i.jsxs)(i.Fragment,{children:[e.closed&&y?(0,i.jsx)(ee.o,{...M,resetValue:()=>{},mergedFromBlockId:e.blockId}):null,(0,i.jsx)(tP,{blockType:e.meta.type,remoteInfo:void 0,isMultiFile:!0,closed:e.closed,blockId:e.blockId,className:M.hasUnsavedChanges?"pb-14":"",setEditValueMap:j,language:e.language,editValueMap:b,hasSourceBeenEdited:e.hasSourceBeenEdited,handleEdit:t=>{t&&e.closed&&j(l=>({...l,[e.meta.file||""]:t}))},file:{source:e.source,meta:e.meta,lang:e.language,blockId:e.blockId,isQuickEdit:!!e.meta.isQuickEdit},editable:e.closed&&y},e.blockId)]}),actions:(0,i.jsx)(R.C,{additionalHeaderActions:void 0,allowClose:!1,allowCopyCode:!0,allowDownloadCode:!0,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:b[e.meta.file||""]||e.source,originalCode:e.originalCode,blockId:e.blockId,closed:e.closed,language:e.language})}],V=l?(0,i.jsx)(s.N,{originalCode:e.originalCode,showQuickEditAnimation:!e.closed&&!!e.meta.isQuickEdit,closed:e.closed,blockId:e.blockId,allowQuoting:!0,caller:"executable",className:"min-h-52 flex-1 rounded-md",editable:!1,fileName:e.meta.file,language:e.language,runnable:O,showLineNumbers:!0,value:e.source}):(0,i.jsx)(S.Yv,{isLoading:!e.closed,activeTabKey:"code",className:"min-h-52 w-full flex-1",setActiveTabKey:()=>{},tabFiles:z});return(0,i.jsxs)("div",{className:(0,f.cn)("not-prose flex h-full w-full flex-col",l&&"bg-muted overflow-hidden rounded-md border",!u&&"opacity-0"),children:[V,O&&(0,i.jsx)(x,{animated:!1,axis:"y",cookieName:D,dotsHandle:!1,initialSize:null!=(t=e.initialOutputSize)?t:33,minSizePx:200,show:!0,side:"start",children:(0,i.jsx)("div",{className:"border-alpha-400 flex size-full min-h-0 flex-1 flex-col items-center justify-center border-t",children:L?(0,i.jsxs)("div",{className:"flex size-full flex-col items-stretch",children:[(0,i.jsxs)("div",{className:(0,f.cn)("flex items-center justify-between border-b px-2 py-1"),children:[(0,i.jsx)("h3",{className:"select-none text-sm font-medium text-gray-500",children:"Output"}),(0,i.jsxs)("div",{className:"flex select-none items-center gap-1",children:[(0,i.jsx)(w,{buttonText:"Run",codeExecutionBlockProps:e,editedValue:b[e.meta.file||""]||void 0,execute:r.M,setOutput:U,variant:"ghost"}),(0,i.jsx)("div",{className:"bg-alpha-400 h-4 w-px"}),(0,i.jsx)(v.Z,{"aria-label":"Clear",onClick:()=>U(void 0),tooltip:"Clear",children:(0,i.jsx)("span",{"aria-hidden":!0,children:(0,i.jsx)(C,{})})}),(0,i.jsx)(v.Z,{"aria-label":"Download",disabled:"error"in L,onClick:()=>(0,eq.X)(L),tooltip:"Download",children:(0,i.jsx)("span",{"aria-hidden":!0,children:(0,i.jsx)(E.q,{})})}),(0,i.jsx)(v.Z,{disabled:"error"in L,onClick:_,tooltip:"Copy",children:(0,i.jsx)("span",{"aria-hidden":!0,children:m?(0,i.jsx)(d.J,{}):(0,i.jsx)(T.T,{})})})]})]}),(0,i.jsx)(a.X3,{className:"h-full",value:L})]}):(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("p",{className:"mb-2 text-base font-medium text-gray-900",children:"No Output"}),(0,i.jsx)("p",{className:"mb-6 text-sm text-gray-500",children:e.closed?"Run the code to generate an output.":"You can execute the code after it has finished streaming."}),(0,i.jsx)(w,{codeExecutionBlockProps:e,disabled:!e.closed,editedValue:b[e.meta.file||""]||void 0,execute:r.M,setOutput:U})]})})}),O&&y&&!l&&(0,i.jsx)(tA,{})]})}static Actions(e){return null}}tL.getIsPreviewable=()=>!1,tL.TitleActions=null;let t_=new WeakMap,tO=new WeakSet,tM=new WeakMap;function tD(e){let t=e.replace(/_/g,"--").replace(/[^a-zA-Z0-9-]/g,"").replace(/-+$/,"");if("generated.vusercontent.net".endsWith(".vercel.sh")){let e="generated.vusercontent.net".split(".")[0].replace(/^v0-frame-/g,"");return tz("".concat(e,"--").concat(t,".dev.vusercontent.net"))}return tz("g-".concat(t,".vusercontent.net"))}function tz(e){let t=new URL("https://example.com");return t.hostname=e,t.origin}function tV(e,t){if(!e)return;let l=t_.get(e);l?l.push(t):t_.set(e,[t]),tF(e)}function tF(e){if(!tO.has(e))return;let t=t_.get(e);if(t){for(let i of t){var l;null==(l=e.contentWindow)||l.postMessage(i,e.dataset.origin||"")}t.length=0}}let tH=[];window.addEventListener("message",e=>{if(!(e.origin===tD("any")||e.origin.endsWith(".vusercontent.net"))||!e.source)return;let t=Array.from(document.querySelectorAll("iframe[data-v0]")).find(t=>t instanceof HTMLIFrameElement&&t.contentWindow===e.source);if(!t)return;tO.add(t),tF(t),window.debug&&console.log("child event handler",e.data);let l=tM.get(t);for(let t of tH)l===t.id&&t.listener(e.data)});var tB=l(66152);let tW={LIGHTNING_WEB_COMPONENTS_UNSUPPORTED:"v0 does not currently support previewing LWC",LAYOUT_UNSUPPORTED:"v0 cannot currently preview Next.js layouts",SERVER_ACTION_UNSUPPORTED:"Server Actions cannot be previewed",RSC_UNSUPPORTED:"v0 cannot currently preview React Server Components",API_KEY_UNSUPPORTED:"v0 cannot currently preview components with API keys",REACT_NATIVE_UNSUPPORTED:"v0 cannot currently preview React Native components",ELECTRON_UNSUPPORTED:"v0 cannot currently preview Electron apps",EXPO_UNSUPPORTED:"v0 cannot currently preview Expo components",CLERK_UNSUPPORTED:"v0 does not currently support previewing Clerk",PRISMA_UNSUPPORTED:"v0 does not currently support previewing @prisma/client",BETTER_SQLITE_3_UNSUPPORTED:"v0 does not currently support previewing better-sqlite3",NEXT_INTL_UNSUPPORTED:"v0 does not currently support previewing next-intl",NODEMAILER_UNSUPPORTED:"v0 does not currently support previewing nodemailer",INERTIA_UNSUPPORTED:"v0 does not currently support previewing Inertia.js",EXPRESS_UNSUPPORTED:"v0 does not currently support previewing Express.js",FS_NOT_SUPPORTED:"v0 does not currently support previews with file system access",REMIX_UNSUPPORTED:"v0 does not currently support previewing Remix",REACT_ROUTER_UNSUPPORTED:"v0 does not currently support previewing react-router",MONGODB_UNSUPPORTED:"v0 does not currently support previewing MongoDB",ROUTE_HANDLER_UNSUPPORTED:"v0 cannot preview Route Handlers",REACT_HOOKS:"React hooks cannot be previewed",NON_JS_TS_FILE_UNSUPPORTED:"v0 can not preview this file",TEST_FILES_UNSUPPORTED:"v0 does not currently support previewing tests",NODE_APIS:"v0 does not currently support previewing Node.js APIs",CHAKRA_UNSUPPORTED:"v0 does not currently support previewing Chakra UI",REACT_PDF_UNSUPPORTED:"v0 does not currently support previewing @react-pdf/renderer",SWIPER_UNSUPPORTED:"v0 does not currently support previewing swiper/css",SENDGRID_UNSUPPORTED:"v0 does not currently support previewing @sendgrid/mail",GOOGLEAPIS_UNSUPPORTED:"v0 does not currently support previewing code using googleapis",ANGULAR_UNSUPPORTED:"v0 does not currently support previewing Angular",MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED:"v0 does not currently support previewing @mui/x-date-pickers/AdapterDateFns",PLAYWRIGHT_UNSUPPORTED:"v0 does not currently support previewing Playwright",INSTRUMENTATION_UNSUPPORTED:"v0 does not support previewing instrumentation.ts",LARAVEL_UNSUPPORTED:"v0 does not currently support previewing Laravel",MONGOOSE_UNSUPPORTED:"v0 does not currently support previewing Mongoose"},tG=[["@clerk/nextjs",tW.CLERK_UNSUPPORTED],["@clerk/clerk-react",tW.CLERK_UNSUPPORTED],["next-intl",tW.NEXT_INTL_UNSUPPORTED],["react-native",tW.REACT_NATIVE_UNSUPPORTED],["@prisma/client",tW.PRISMA_UNSUPPORTED],["better-sqlite3",tW.BETTER_SQLITE_3_UNSUPPORTED],["nodemailer",tW.NODEMAILER_UNSUPPORTED],["@sendgrid/mail",tW.SENDGRID_UNSUPPORTED],["@inertiajs/react",tW.INERTIA_UNSUPPORTED],["@chakra-ui/react",tW.CHAKRA_UNSUPPORTED],["@react-pdf/renderer",tW.REACT_PDF_UNSUPPORTED],["swiper/css",tW.SWIPER_UNSUPPORTED],["swiper/css/navigation",tW.SWIPER_UNSUPPORTED],["@playwright/test",tW.PLAYWRIGHT_UNSUPPORTED],["angular/router",tW.ANGULAR_UNSUPPORTED],["angular/core",tW.ANGULAR_UNSUPPORTED],["@angular/router",tW.ANGULAR_UNSUPPORTED],["@angular/core",tW.ANGULAR_UNSUPPORTED],["@angular/common",tW.ANGULAR_UNSUPPORTED],["@mui/x-date-pickers/AdapterDateFns",tW.MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED],["@react-navigation/native",tW.EXPO_UNSUPPORTED],["@react-navigation/stack",tW.EXPO_UNSUPPORTED],["expo-router",tW.EXPO_UNSUPPORTED],["express",tW.EXPRESS_UNSUPPORTED],["expo-file-system",tW.EXPO_UNSUPPORTED],["googleapis",tW.GOOGLEAPIS_UNSUPPORTED],["fs",tW.FS_NOT_SUPPORTED],["fs/promises",tW.FS_NOT_SUPPORTED],["bcrypt",tW.NODE_APIS],["@remix-run/node",tW.REMIX_UNSUPPORTED],["mongodb",tW.MONGODB_UNSUPPORTED],["react-router-dom",tW.REACT_ROUTER_UNSUPPORTED],["lwc",tW.LIGHTNING_WEB_COMPONENTS_UNSUPPORTED]],tZ=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],tK=["tsx","html","jsx","js","ts"],tQ={NON_SUPPORTED_FILES:"v0 can not detect a page to preview",NO_EXPORTED_COMPONENT:"No exported component found"};function t$(e){return"v0 does not currently support ".concat(e)}let tq={"@clerk/nextjs/server":tW.CLERK_UNSUPPORTED,"@clerk/clerk-react":tW.CLERK_UNSUPPORTED,"next-intl":tW.NEXT_INTL_UNSUPPORTED,"react-native":tW.REACT_NATIVE_UNSUPPORTED,electron:tW.ELECTRON_UNSUPPORTED,"@sendgrid/mail":tW.NODEMAILER_UNSUPPORTED,"@chakra-ui/react":tW.CHAKRA_UNSUPPORTED,"better-sqlite3":tW.BETTER_SQLITE_3_UNSUPPORTED,lwc:tW.LIGHTNING_WEB_COMPONENTS_UNSUPPORTED,"@playwright/test":tW.PLAYWRIGHT_UNSUPPORTED,"angular/router":tW.ANGULAR_UNSUPPORTED,"angular/core":tW.ANGULAR_UNSUPPORTED,"@angular/router":tW.ANGULAR_UNSUPPORTED,"@angular/core":tW.ANGULAR_UNSUPPORTED,"@angular/common":tW.ANGULAR_UNSUPPORTED,"@mui/x-date-pickers/AdapterDateFns":tW.MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED,"@react-navigation/native":tW.EXPO_UNSUPPORTED,"@react-navigation/stack":tW.EXPO_UNSUPPORTED,"expo-router":tW.EXPO_UNSUPPORTED,express:tW.EXPRESS_UNSUPPORTED,"expo-file-system":tW.EXPO_UNSUPPORTED,googleapis:tW.GOOGLEAPIS_UNSUPPORTED,"@remix-run/node":tW.REMIX_UNSUPPORTED,mongodb:tW.MONGODB_UNSUPPORTED,"react-router-dom":tW.REACT_ROUTER_UNSUPPORTED,"laravel-mix":tW.LARAVEL_UNSUPPORTED,mongoose:tW.MONGOOSE_UNSUPPORTED,"discord-player":t$("discord-player"),"fluent-ffmpeg":t$("fluent-ffmpeg"),"@prisma/client":t$("@prisma/client"),hono:t$("hono"),undici:t$("undici"),http2:t$("http2"),payload:t$("payload"),"@nestjs/mongoose":t$("@nestjs/mongoose"),"@nestjs/core":t$("@nestjs/core"),"@ionic/angular":t$("@ionic/angular"),"firebase-admin/database":t$("firebase-admin/database"),"firebase-admin":t$("firebase-admin"),"firebase-functions":t$("firebase-functions"),"puppeteer-core":t$("puppeteer-core"),"coffee-script":t$("coffee-script"),msw:t$("msw"),"msw/node":t$("msw/node"),mysql2:t$("mysql2"),"mysql2/promise":t$("mysql2"),"@worldcoin/idkit":t$("@worldcoin/idkit"),"discord.js":t$("discord.js"),nativewind:t$("nativewind"),commander:t$("commander"),cosmiconfig:t$("cosmiconfig"),"react-native-svg":t$("react-native-svg"),"google-auth-library":t$("google-auth-library"),nextra:t$("nextra")},tX=Object.keys(tq).join("|"),tY=new RegExp("from ['\"](".concat(tX,")['\"]")),tJ=new RegExp("import ['\"](".concat(tX,")['\"]")),t0=new RegExp("import\\(['\"](".concat(tX,")['\"]\\)")),t1=new RegExp("require\\(['\"](".concat(tX,")['\"]\\)")),t5={"@mui/utils":"v0 is currently investigating an issue with @mui/utils. We appreciate your patience."},t2=Object.keys(t5).join("|"),t3=new RegExp("from ['\"](".concat(t2,")['\"]")),t9=new RegExp("import ['\"](".concat(t2,")['\"]")),t4=new RegExp("import\\(['\"](".concat(t2,")['\"]\\)")),t6=new RegExp("require\\(['\"](".concat(t2,")['\"]\\)"));var t7=l(93187);function t8(e){let{iframeId:t,iframeRef:l,activeTab:n,isPublished:s,src:a,origin:r,onLoad:o}=e;return(0,i.jsx)("iframe",{allow:"fullscreen; camera; microphone; gyroscope; accelerometer; geolocation; clipboard-write; autoplay",title:"v0 block",className:(0,I.A)("h-full w-full select-none","preview"!==n&&(s?"hidden":"sr-only invisible")),"data-origin":r,"data-v0":!0,id:t,loading:"eager",onLoad:o,ref:l,sandbox:"allow-scripts allow-same-origin allow-forms allow-downloads allow-popups-to-escape-sandbox allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-presentation",src:"".concat(r).concat(a),fetchPriority:"high"})}var le=l(95251),lt=l(13263),ll=l(99066);function li(e){let{error:t,onDismiss:l}=e,{submit:s}=(0,ll.yI)(),{isAuthor:a}=(0,tC.Pk)(),r=(0,eZ.oQ)(),{isCopied:o,copyToClipboard:c}=(0,g.j)({timeout:2e3}),[d,u]=(0,n.useState)(!1);return t?(0,i.jsx)("div",{className:"light absolute bottom-0 left-0 z-10 max-w-[400px] p-4",children:(0,i.jsxs)("div",{className:"text-background flex min-w-[300px] flex-col items-center gap-3 rounded-[8px] bg-red-600 p-2 text-sm",role:"alert",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,i.jsxs)("div",{className:"flex w-full items-center justify-between font-semibold",children:[(0,i.jsx)("span",{children:"Error"})," ",(0,i.jsxs)(b.$,{className:"text text-background m-[-4px] hover:text-gray-200",onClick:l,size:"xs",variant:"ghost",children:[(0,i.jsx)(le.a,{}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,i.jsx)("div",{className:"flex w-full",children:(0,i.jsx)("span",{className:(0,f.cn)("font-small text-background cursor-pointer overflow-hidden whitespace-pre-wrap font-mono text-[11px]",{"line-clamp-2":!d}),onClick:()=>u(!d),children:t})})]}),a&&(0,i.jsxs)("div",{className:"flex w-full justify-end gap-2 align-middle",children:[(0,i.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:()=>{c(t)},size:"sm",variant:"link",children:(0,i.jsx)(lt.U,{isCopied:o})}),(0,i.jsx)("div",{className:"border-alpha-400 border-l"}),(0,i.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:()=>{(0,eK.Ny)()&&r(!1),s({type:"fix-with-v0",action:"fix-with-v0",input:"The code returns the following error:\n```\n".concat(t,"\n```\nRevise the code to address the error.")})},size:"sm",variant:"secondary",children:["Fix with ",(0,i.jsx)(eW.o,{className:"mt-[1px]"})]})]})]})}):null}function ln(e,t){let l=isNaN(parseInt(e))?e:"An unexpected error occurred (".concat(e,")");return t?"".concat(l,"\n\n").concat(t):l.replace("FatalRendererError: ","")}var ls=l(80464);class la{}la.getIsPreviewable=e=>{let{source:t,closed:l,meta:i}=e,n=function(e,t){if(t){if(t.startsWith("use-"))return tW.REACT_HOOKS;if("instrumentation.ts"===t)return tW.INSTRUMENTATION_UNSUPPORTED;let e=t.split("."),l=e[e.length-1],i=e.length>2?e[e.length-2]:void 0;if(l&&!tK.some(e=>l===e))return tW.NON_JS_TS_FILE_UNSUPPORTED;if(i&&("test"===i||"spec"===i))return tW.TEST_FILES_UNSUPPORTED}for(let[t,l]of tG)if(new RegExp("from ['\"]".concat(t.replace("/","/"),"['\"]")).test(e))return l;return/\<ClerkProvider/.test(e)?tW.CLERK_UNSUPPORTED:/export default function (Root)?Layout/.test(e)?tW.LAYOUT_UNSUPPORTED:/(^|\n)['"]use server['"]/.test(e)?tW.SERVER_ACTION_UNSUPPORTED:/export default async function/.test(e)?tW.RSC_UNSUPPORTED:/(API_KEY|_SECRET) =/.test(e)||/YOUR_API_KEY/.test(e)?tW.API_KEY_UNSUPPORTED:!tZ.some(t=>new RegExp("export (default )?async function ".concat(t,"\\(")).test(e)||new RegExp("export const ".concat(t," =")).test(e))||tW.ROUTE_HANDLER_UNSUPPORTED}(t,i.file);return"string"==typeof n?{error:n}:!!n&&l},la.Render=n.memo(e=>{let t=(0,tC.jo)(),{isPublished:l}=(0,P.usePublishedPage)(),{chatId:s}=(0,tC.xz)(),{getBlockForked:a}=(0,ls.t)(),{activeTab:r,setActiveTab:c,hasBlockPreview:d}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),{projectBlocks:u,projectBlockIndex:m,allBlocks:f}=(0,ts.P6)({blockId:e.blockId}),p=(0,n.useMemo)(()=>{var e;let t={},l=(null==(e=u[m])?void 0:e.meta.file)||".";for(let e of f)e.resultId&&e.meta.file&&(t[e.meta.file]=e.resultId);for(let e=0;e<=m;e++){let l=u[e],i=l.meta.file;i&&l.resultId&&(t[i]=l.resultId)}return{mapping:t,rootFileName:l}},[f,u,m]),h=(0,n.useRef)(null),[x,v]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(h.current)return function(e,t){let l=tM.get(e)||Math.random().toString();return tM.set(e,l),tH.push({id:l,listener:t}),()=>{let e=tH.findIndex(e=>e.listener===t);e>=0&&tH.splice(e,1)}}(h.current,t=>{switch(t.type){case"set_loading":h.current&&(tV(h.current,{type:"parent_ready"}),tV(h.current,{type:"sync_file_mapping",data:p}));break;case"error":case"runtime-error":{let l=ln(t.error);t.resultId===e.resultId&&v(i=>(i!==l&&e.isPreviewable&&(0,o.u)("V0BlockPreviewError",{messageId:e.messageId,blockId:e.blockId,resultId:t.resultId,from:e.meta.isQuickEdit?"quick-edit":void 0,forkedFromBlockId:a(e.blockId)},{errorMsg:l,errorCode:t7.rU}),l));break}case"started_visible_render":e.setIsPreviewable(!0)}})},[a,e,e.blockId,e.meta.from,e.resultId,e.setIsPreviewable,p,t]),(0,n.useEffect)(()=>{v(null)},[e.blockId]),(0,i.jsxs)(tN,{activeTab:r,allowRefresh:!0,hasBlockPreview:d,setActiveTab:c,...e,blockType:"v0",language:"typescriptreact",children:[x?(0,i.jsx)(li,{error:x,onDismiss:()=>{v(null)}}):null,e.resultId&&"boolean"==typeof e.isPreviewable?(0,i.jsx)(t8,{activeTab:r,iframeId:(0,U.j)(e.resultId),iframeRef:h,isPublished:l,onLoad:()=>{h.current&&tV(h.current,{type:"sync_file_mapping",data:p})},origin:tD(s||e.blockId),src:"/p/".concat(e.resultId,"?c=1&flags=1&bid=").concat(e.blockId)}):null]})}),la.Actions=n.memo(e=>{let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,i.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}),la.TitleActions=()=>null;var lr=l(2066),lo=l(35591);let lc=e=>{let t=(0,lo.Q)(),l=t.globalSessionTokenCache||(t.globalSessionTokenCache=new Map),{data:i,error:n}=(0,lr.A)(e?"frame-token:".concat(e):null,async()=>{let t=await fetch("/chat/api/chat/frame-token?bid=".concat(e));if(!t.ok)throw Error("Failed to fetch session token");return t.text()});return"string"!=typeof i||"string"!=typeof e||l.has(e)||l.set(e,i),{token:void 0===e?void 0:l.get(e),error:n}};var ld=l(48476),lu=l(38035),lm=l(73641),lf=l(62045);function lp(e){let{status:t="log"}=e;return(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",className:"absolute -translate-y-0.5 translate-x-0.5",children:(0,i.jsx)("circle",{cx:"12.5",cy:"5.5",r:"3.5",strokeWidth:"1.5",stroke:"hsl(var(--background))",className:"error"===t?"fill-red-500":"log"===t?"fill-blue-600":"fill-yellow-500"})})}function lh(e){let{blockId:t,isPreviewable:l,closed:n}=e,{hasBlockPreview:s,activeTab:a,setActiveTab:r}=(0,tB.P5)({blockId:t,isPreviewable:l}),o=(0,M.k)(),[c]=eM(t),{isStreaming:d}=(0,tC.Pk)(),{bl:u}=(0,te.D)(),m=e=>({key:"preview",disabled:u?n&&!(0,ez.O)(s):!(0,ez.O)(s),tooltip:"object"==typeof s&&"error"in s?s.error:n||!d||u?e?o("previewBlock.preview"):void 0:o("previewBlock.previewIsStreaming"),display:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(_.p,{className:"group-disabled:hidden"}),(0,i.jsx)("div",{className:"hidden group-disabled:block",children:!n&&d?(0,i.jsx)(j.y,{size:16}):(0,i.jsx)(L.X,{})}),e?null:(0,i.jsx)("span",{children:o("previewBlock.preview")})]})}),f=e=>({key:"code",tooltip:e?o("previewBlock.code"):void 0,display:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[c?(0,i.jsx)(lp,{status:"warn"}):null,(0,i.jsx)(lf.Y,{}),e?null:(0,i.jsx)("span",{children:o("previewBlock.code")})]})});return(0,i.jsxs)("div",{className:"@container/tabs flex-1",children:[(0,i.jsx)("div",{className:"@[11rem]/tabs:hidden flex items-center gap-2",children:(0,i.jsx)(S.wb,{disableOverflow:!0,tabs:[m(!0),f(!0)],activeTabKey:a,setActiveTabKey:r,isLoading:!1})}),(0,i.jsx)("div",{className:"@[11rem]/tabs:flex hidden items-center gap-2",children:(0,i.jsx)(S.wb,{disableOverflow:!0,tabs:[m(!1),f(!1)],activeTabKey:a,setActiveTabKey:r,isLoading:!1})})]})}var lx=l(97468),lv=l(39849);function lg(e){let{errors:t,onDismiss:l}=e,{submit:s}=(0,ll.yI)(),{isAuthor:a}=(0,tC.Pk)(),r=(0,eZ.oQ)(),[o,c]=(0,n.useState)(!1),{isCopied:d,copyToClipboard:u}=(0,g.j)({timeout:2e3}),[m,p]=(0,n.useState)(0),[h,x]=(0,n.useState)(!1),v=(0,n.useMemo)(()=>t.find(e=>e.isFatal),[t]),j=(0,n.useCallback)(()=>{m<=0?p(t.length-1):p(m-1)},[t,m]),y=(0,n.useCallback)(()=>{m>=t.length-1?p(0):p(m+1)},[t,m]);if(!t.length)return null;let w=()=>{var e;u(null!=(e=null==v?void 0:v.text)?e:t[m].text)},k=()=>{var e;c(!0),v||l();let i=v?v.currentURL:t[m].currentURL,n="The code returns the following error:\n```\n".concat(null!=(e=null==v?void 0:v.text)?e:t[m].text,"\n```\nRevise the code to address the error. ").concat(i?"\n\nI was previewing: ".concat(i):"");(0,eK.Ny)()&&r(!1),s({type:"fix-with-v0",action:"fix-with-v0",input:n})};return v?(0,i.jsx)("div",{className:"flex w-full justify-center",children:(0,i.jsx)("div",{className:"text-foreground absolute top-9 z-10 flex min-h-full max-w-4xl flex-col items-center justify-center px-10",children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("h1",{className:"text-nowrap text-2xl font-semibold",children:"Runtime Error"}),(0,i.jsxs)("div",{className:"border-l-alpha-600 ml-5 flex flex-col gap-2 border-l pl-5",children:[(0,i.jsx)("h2",{className:"text-sm",children:v.text}),a&&(0,i.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,i.jsx)(b.$,{className:"border-background text-foreground bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:w,size:"sm",variant:"link",children:(0,i.jsx)(lt.U,{isCopied:d})}),(0,i.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:k,size:"sm",variant:"secondary",disabled:o,children:["Fix with ",(0,i.jsx)(eW.o,{className:"mt-[1px]"})]})]})]})]})})}):(0,i.jsx)("div",{className:"light absolute bottom-0 left-0 z-10 max-w-[400px] p-4",children:(0,i.jsxs)("div",{className:"text-background flex min-w-[300px] flex-col items-center gap-3 rounded-[8px] bg-red-600 p-2 text-sm",role:"alert",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,i.jsxs)("div",{className:"flex w-full items-center justify-between font-semibold",children:[(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{children:t[m].isServer?"Server":null})," Error"]})," ",(0,i.jsxs)(b.$,{className:"text text-background m-[-4px] hover:text-gray-200",onClick:l,size:"xs",variant:"ghost",children:[(0,i.jsx)(le.a,{}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,i.jsx)("div",{className:"flex w-full",children:(0,i.jsx)("span",{className:(0,f.cn)("font-small text-background cursor-pointer overflow-hidden whitespace-pre-wrap font-mono text-[11px]",{"line-clamp-2":!h}),onClick:()=>x(!h),children:t[m].text})})]}),(0,i.jsxs)("div",{className:"flex w-full justify-between gap-2 align-middle",children:[(0,i.jsx)("div",{className:"flex items-center gap-2 align-middle",children:t.length>1&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:j,variant:"link",children:(0,i.jsx)(lx.J,{})}),(0,i.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:y,variant:"link",children:(0,i.jsx)(lv.c,{})}),(0,i.jsxs)("span",{className:"text-xs",children:[m+1," of ",t.length]})]})}),(0,i.jsx)("div",{className:"flex items-center gap-2 align-middle",children:a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:w,size:"sm",variant:"link",children:(0,i.jsx)(lt.U,{isCopied:d})}),(0,i.jsx)("div",{className:"border-alpha-400 border-l"}),(0,i.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:k,size:"sm",variant:"secondary",children:["Fix with ",(0,i.jsx)(eW.o,{className:"mt-[1px]"})]})]})})]})]})})}var lb=l(27037),lj=l(33541),ly=l(70676);let lw=(0,ly.createServerReference)("60b68b47cd5db4d7859a7bd979b5df75d86b406f89",ly.callServer,void 0,ly.findSourceMapURL,"updateBlockError");class lk{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{token:l,error:s}=lc(e.blockId),{activeForkKey:a}=(0,tC.Pk)(),{canWriteToChat:r}=(0,eD.tZ)(),[c,d]=(0,n.useState)([]),u=(0,e_.F)(e.isPreviewable),{getBlockForked:m}=(0,ls.t)(),f=(0,lm.x)(),{afre:p}=(0,te.D)();(0,n.useEffect)(()=>{d([])},[e.blockId,d]);let{activeTab:h,setActiveTab:x,hasBlockPreview:v}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),{files:g,loadingPath:b}=ta({blockId:e.blockId,closed:e.closed,source:e.source,meta:e.meta}),j=(0,e_.F)(g),y=(0,U.j)(e.blockId),{submit:w}=(0,ll.yI)();(0,n.useEffect)(()=>{let t=t=>{if(t.data&&"object"==typeof t.data&&t.data.__v0_remote__){if("error"===t.data.type){let l=ln(t.data.error,t.data.stack);d(i=>i.some(e=>e.text===l)||!u.current?i:(0===i.length&&p&&lw(e.blockId,l),(0,o.u)(t.data.isFatal?"V0BlockPreviewError":"V0BlockPreviewSoftError",{messageId:e.messageId,blockId:e.blockId,from:void 0!==e.meta.isQuickEdit?"quick-edit":void 0,forkedFromBlockId:m(e.blockId),resultId:e.resultId||""},{errorMsg:l,errorCode:t7.rU}),i.concat({isFatal:t.data.isFatal,isServer:t.data.isServer,text:l,currentURL:t.data.currentURL})))}if("frame_onload"===t.data.type&&d([]),("refine"===t.data.type||"add-refinement-element"===t.data.type)&&j.current){var l;let i=j.current.find(e=>e.meta.file===t.data.file);if(!i)return void alert("File not found");let n=i.source.split("\n"),s=t.data.line,r=t.data.column;for(;n[s-1].length<r;)r-=n[s-1].length,s++;for(;r-1<n[s-1].length&&/\s/.test(n[s-1][r-1]);)r++;let o=n.slice(Math.max(0,s-4),s-1),c=n[s-1],d=n.slice(s,s+3),u=null==(l=c.substring(r).match(/^[\w.]+/))?void 0:l[0],m=u?(s>4?"...\n":"")+o.join("\n")+"\n"+c+"\n"+(" ".repeat(r)+"^".repeat(u.length))+"\n"+d.join("\n")+"\n"+(s+3<n.length?"...\n":""):c;if("add-refinement-element"===t.data.type&&f){let{addRefinementElementToContext:e}=(0,lb.yQ)(f),{setComposerLayoutState:l}=(0,lj.w3)(f);e({id:t.data.id,componentName:u||"Component",sourceContext:m,file:i.meta.file}),requestAnimationFrame(()=>{l("compact")})}else if("refine"===t.data.type){let l=(0,lu.ru)({refinementElements:[{file:i.meta.file,componentName:u||"",sourceContext:m}],prompt:t.data.prompt}),n=(null==a?void 0:a.indexOf(e.messageId))||-1;a&&n>0&&n<a.length-1?w({action:"edit",input:l,userMessageId:a[n+1],type:"refinement"}):w({action:"new",input:l,attachments:[],type:"refinement"})}}}};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[y,w,a,d,e.messageId,j,p,f,e.blockId,u,e.meta.isQuickEdit,m,e.resultId]);let k=null;if(e.blockId&&e.isPreviewable&&(l||s)){let n=new URLSearchParams;t&&n.set("mql","true"),s||!l?n.set("__v0",""):l&&n.set("__v0_token",l),e.isV3&&n.set("isV3","true"),k=(0,i.jsx)(t8,{activeTab:h,iframeId:y,isPublished:t,origin:function(e){let{disableLocalhost:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=function(e){let t="";for(let l=0;l<e.length;l++){let i=e.charCodeAt(l).toString(16);i.length<2&&(i="0"+i),t+=i}return BigInt("0x"+t).toString(36)}(e);if("generated.vusercontent.net".endsWith(".vercel.sh")){let e="generated.vusercontent.net".split(".")[0].replace(/^v0-frame-/g,"");return tz("".concat(l,"--").concat(e,".dev-lite.vusercontent.net"))}return tz("".concat(l,".lite.vusercontent.net"))}(e.blockId),src:"/?".concat(n.toString())}),"code-project"===e.meta.type&&(k=e.isV3?(0,i.jsx)("div",{className:"size-full","data-slot":"browser-content",children:k}):(0,i.jsx)(ld.A,{allowMobileFullscreen:e.allowMobileFullscreen,blockId:e.blockId,iframeId:y,devTools:r,isV3:e.isV3,children:(0,i.jsx)("div",{className:"flex-1 shrink-0","data-slot":"browser-content",children:k})}))}return(0,i.jsxs)(tN,{activeTab:h,hasBlockPreview:v,setActiveTab:x,initialFileTreeSize:e.initialFileTreeSize,...e,loadingPath:b,files:g,blockType:"code-project"===e.meta.type?"code-project":"v0",language:"typescriptreact",allowRefresh:"code-project"!==e.meta.type,allowFullScreen:"code-project"!==e.meta.type,isV3:e.isV3,initialConsoleSize:e.initialConsoleSize,initialConsoleExpanded:e.initialConsoleExpanded,children:[c.length?(0,i.jsx)(lg,{errors:c,onDismiss:()=>{d([])}}):null,k]})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,i.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}lk.getIsPreviewable=e=>{let{closed:t,source:l,meta:i}=e;if(!t)return!1;let n=function(e,t){let l=/\.(ts|tsx|js|jsx|mjs|mts|cjs)$/i,i=!1,n="code-project"===t.type?(0,X.A2)({source:e,blockType:"code-project",blockId:"fake-block-id"}):[{source:e,meta:t,isDeleted:!1}];if(!(n=n.filter(e=>!e.isDeleted))||0===n.length||!n.some(e=>e.meta.file&&(e.meta.file.endsWith(".tsx")||e.meta.file.endsWith(".jsx"))))return tQ.NON_SUPPORTED_FILES;let s=n.filter(e=>e.meta.file&&l.test(e.meta.file));if(!s.length)return tQ.NON_SUPPORTED_FILES;for(let{source:e}of s){let t=e.split("\n").filter(e=>e.trim().startsWith("import")).join("\n"),l=t.match(tY)||t.match(tJ)||e.match(t0)||e.match(t1);if(l)return tq[l[1]];let n=t.match(t3)||t.match(t9)||e.match(t4)||e.match(t6);if(n)return{warning:t5[n[1]]};e.includes("export")&&(i=!0)}return!!i||tQ.NO_EXPORTED_COMPONENT}(l,i);return"string"==typeof n?{error:n}:n},lk.TitleActions=n.memo(e=>{let{blockId:t,isPreviewable:l,closed:n}=e;return(0,i.jsx)(lh,{blockId:t,isPreviewable:l,closed:n})});class lN{static Actions(){return null}}function lP(e,t,l){let[i,s]=(0,n.useState)(!1),a=(0,e_.F)(i),r=(0,e_.F)(t);(0,n.useEffect)(()=>{let t=document.getElementById(l),i=l=>{if(l.origin===t.dataset.origin&&l.data.type===e+"_READY"&&(s(!0),r.current)){var i;null==(i=t.contentWindow)||i.postMessage({type:e+"_RENDER",source:r.current},t.dataset.origin||"")}};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[e,l,r]),(0,n.useEffect)(()=>{let i=document.getElementById(l);if(i){var n,s;a.current?null==(n=i.contentWindow)||n.postMessage({type:e+"_RENDER",source:t},i.dataset.origin||""):null==(s=i.contentWindow)||s.postMessage({type:e+"_PING"},i.dataset.origin||"")}},[t,e,l,a])}lN.getIsPreviewable=()=>!1,lN.Render=n.memo(e=>(0,i.jsx)(tN,{activeTab:"code",hasBlockPreview:!1,hidePreviewPane:!0,setActiveTab:()=>{},...e,blockType:"code"})),lN.TitleActions=null;let lE=RegExp("<!DOCTYPE html>.*?<\\/html>","s");class lT{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{chatId:l}=(0,tC.xz)(),{activeTab:n,setActiveTab:s,hasBlockPreview:a}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,U.j)(e.blockId);return lP("HTML",e.source,r),(0,i.jsx)(tN,{activeTab:n,hasBlockPreview:a,setActiveTab:s,...e,blockType:"html",language:"html",children:(0,i.jsx)(t8,{activeTab:n,iframeId:r,isPublished:t,origin:tD(l||e.blockId),src:"/render/html"})})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,i.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}lT.getIsPreviewable=e=>{let{source:t,closed:l}=e;return l||lE.test(t)},lT.TitleActions=null;var lC=l(72092),lS=l(49019),lR=l(18926),lI=l(97303),lU=l(67184);class lA{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{activeTab:l,setActiveTab:s,hasBlockPreview:a}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),[r,o]=(0,n.useState)(void 0),c=e.source.replaceAll(/\\+`/g,"`");return(0,i.jsx)(tN,{activeTab:l,hasBlockPreview:a,setActiveTab:s,...e,blockType:"markdown",language:"markdown",source:c,onEdit:o,children:(0,i.jsx)("div",{className:(0,f.cn)("flex h-full w-full justify-center overflow-y-auto p-4 md:py-6","preview"!==l&&(t?"hidden":"sr-only invisible")),children:(0,i.jsx)(lC.s,{children:(0,i.jsx)(lS.c,{remarkPlugins:[lR.A,lI.A],rehypePlugins:[lU.A],children:void 0===r?c:r})})})})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,i.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}lA.getIsPreviewable=()=>!0,lA.TitleActions=null;class lL{static Render(e){let{chatId:t}=(0,tC.xz)(),{isPublished:l}=(0,P.usePublishedPage)(),{activeTab:n,setActiveTab:s,hasBlockPreview:a}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,U.j)(e.blockId);return lP("VUE",e.source,r),(0,i.jsx)(tN,{activeTab:n,allowRefresh:!0,hasBlockPreview:a,setActiveTab:s,...e,blockType:"vue",language:"vue",resultId:e.blockId,children:(0,i.jsx)(t8,{activeTab:n,iframeId:r,isPublished:l,origin:tD(t||e.blockId),src:"/render/vue"},r)})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,i.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}lL.getIsPreviewable=e=>{let{closed:t}=e;return t},lL.TitleActions=null;class l_{static Render(e){let{chatId:t}=(0,tC.xz)(),{isPublished:l}=(0,P.usePublishedPage)(),{activeTab:n,setActiveTab:s,hasBlockPreview:a}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,U.j)(e.blockId);return lP("SVELTE",e.source,r),(0,i.jsx)(tN,{activeTab:n,hasBlockPreview:a,setActiveTab:s,...e,blockType:"svelte",language:"svelte",children:(0,i.jsx)(t8,{activeTab:n,iframeId:r,isPublished:l,origin:tD(t||e.blockId),src:"/render/svelte"},r)})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:n}=(0,tB.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,i.jsx)(U.r,{hasBlockPreview:t,activeTab:l,setActiveTab:n})}}l_.getIsPreviewable=e=>{let{closed:t}=e;return t},l_.TitleActions=null;class lO{static Render(e){let{source:t,blockId:l,remoteInfo:s,closed:a}=e,{chatId:r}=(0,tC.xz)(),o=(0,U.j)("remote-preview"),{data:d}=(0,c.Ay)(l?["remote:preview",l]:null,null,{fallbackData:(null==s?void 0:s.accepted)||!1}),{activeTab:u,setActiveTab:m}=(0,tB.P5)({blockId:e.blockId,isPreviewable:a});return(0,n.useEffect)(()=>{if(!a||!(l||r))return;let e=new AbortController,t=async()=>{try{await fetch("/chat/api/chat/remote/preview?".concat("@remote"===l?"cid=".concat(r):"bid=".concat(l)),{signal:e.signal})}catch(e){}};return setTimeout(()=>{t()},0),()=>{e.abort()}},[a,r,l]),(0,i.jsx)(tN,{activeTab:"@remote"===l?"preview":u,setActiveTab:m,...e,meta:"@remote"===l?{...e.meta}:{...e.meta,file:"Files"},allowFullScreen:!1,language:"plaintext",blockType:"local",remoteInfo:s,source:t,hasBlockPreview:!!d||e.closed,children:a||"@remote"===l?(0,i.jsx)(ld.A,{iframeId:o,children:(0,i.jsx)(t8,{activeTab:"@remote"===l?"preview":u,iframeId:o,isPublished:!1,origin:"",src:"/chat/api/chat/remote/proxy?cid=".concat(r)},o)}):null})}static Actions(e){let{blockId:t,isPreviewable:l}=e,{hasBlockPreview:n,activeTab:s,setActiveTab:a}=(0,tB.P5)({blockId:t,isPreviewable:l});return"@remote"===t?null:(0,i.jsx)(U.r,{hasBlockPreview:n,activeTab:s,setActiveTab:a})}}function lM(e){switch(e){case"node.js":case"nodejs":case"python":return tL;case"markdown":return lA;case"html":return lT;case"v0":case"react":case"tsx":return la;case"vue":return lL;case"svelte":return l_;case"code":return lN;case"local":return lO;case"code-project":return lk;case"inline-sql":return null}}function lD(e){var t;let{block:l,initialSize:s,initialConsoleSize:a,initialConsoleExpanded:r,initialFileTreeSize:o,allowMobileFullscreen:c,location:d="header",isAuthor:u}=e,{isPublished:m}=(0,P.usePublishedPage)(),{history:f,currentBlockIndex:p}=(0,ts.P6)({blockId:(null==l?void 0:l.id)||""}),h=l?lM(l.type):null,x=!!h&&!!l&&h.getIsPreviewable({source:l.source,closed:l.closed,meta:l.meta,id:l.id}),[v,g]=(0,n.useState)(),b=v||x;return((0,n.useEffect)(()=>{g(void 0)},[null==l?void 0:l.id]),l&&h)?{action:m&&"footer"!==d?null:(0,i.jsx)(h.Actions,{blockId:l.id,isPreviewable:b,closed:l.closed}),titleActions:"code-project"===l.meta.type&&h.TitleActions?(0,i.jsx)(h.TitleActions,{blockId:l.id,isPreviewable:b,closed:l.closed}):null,content:(0,i.jsx)(h.Render,{allowMobileFullscreen:c,initialFileTreeSize:o,blockId:l.id,resultId:l.resultId,closed:l.closed,initialOutputSize:s,messageId:l.messageId,language:l.language,meta:l.meta,source:l.source,remoteInfo:l.remoteInfo,isPreviewable:b,isAuthor:u,setIsPreviewable:g,hasSourceBeenEdited:l.hasSourceBeenEdited,originalCode:p>0?null==(t=f[p-1])?void 0:t.source:void 0,latestDeploymentInfo:l.latestDeploymentInfo,initialConsoleSize:null!=a?a:void 0,initialConsoleExpanded:null!=r?r:void 0})}:{action:null,content:null}}function lz(e){let{block:t,allowMobileFullscreen:l,initialSize:i}=e,{content:n}=lD({block:t,initialSize:i,allowMobileFullscreen:l,location:void 0});return n}lO.getIsPreviewable=e=>{let{closed:t}=e;return t},lO.TitleActions=null},54026:(e,t,l)=>{"use strict";l.d(t,{YZ:()=>v,Zf:()=>b,je:()=>g});var i=l(97667),n=l(33571),s=l(88109),a=l(95393),r=l(75334),o=l(55274),c=l(28819),d=l(79168);let u=(0,n.createContext)(void 0),m=()=>{let e=(0,n.useContext)(u);if(void 0===e)throw Error("useResizableContext must be used within a FileTreeProvider");return e};function f(e){let{className:t,...l}=e,{leftId:n,rightId:a,groupId:r,panelGroupRef:o}=m();return(0,i.jsxs)(s.TW,{onDragging:()=>{var e,t,l,i;let c=null==(e=s.PV(n))?void 0:e.offsetWidth,d=null==(t=s.PV(a))?void 0:t.offsetWidth,u=null==(l=s.Gx(r))?void 0:l.offsetWidth;c&&d&&u&&(null==(i=o.current)||i.setLayout([c/u*100,d/u*100]))},className:(0,c.cn)("group relative z-20 w-0 !overflow-visible !outline-none !ring-0",t),...l,children:[(0,i.jsx)("div",{className:"absolute inset-0 h-full w-3 translate-x-[-50%] !outline-0 !ring-0"}),(0,i.jsx)("div",{className:"absolute inset-0 h-full w-0 translate-x-[-50%] !outline-0 !ring-0 transition-all duration-200 group-data-[resize-handle-active=keyboard]:w-[3px] group-data-[resize-handle-state=drag]:w-[3px] group-data-[resize-handle-state=hover]:w-[3px] group-data-[resize-handle-active=keyboard]:bg-gray-400 group-data-[resize-handle-state=drag]:bg-gray-400 group-data-[resize-handle-state=hover]:bg-gray-300 group-data-[resize-handle-active=keyboard]:outline-none"})]})}let p=(0,n.forwardRef)((e,t)=>((0,n.useEffect)(()=>{let l=document.getElementById(e.id);l&&t&&("function"==typeof t?t(l):t.current=l)},[e.id,t]),(0,i.jsx)(s.Zk,{...e})));p.displayName="ForwardPanel";let h=a.P.create(p);function x(e){let t=s.PV(e);if(!t)return 100;let l=parseFloat(getComputedStyle(t).minWidth);return isNaN(l)?100:l}function v(e){let{isFallbackSize:t,collapseSide:l,leftId:a,rightId:r,defaultSizeRef:o,cookie:c,id:m,...f}=e,p=(0,n.useRef)(null),h=(0,n.useRef)(!1);return(0,i.jsx)(u.Provider,{value:{leftId:a,rightId:r,panelGroupRef:p,groupId:m},children:(0,i.jsx)(s.YZ,{id:m,ref:p,onLayout:e=>{var i,n;if(e.length<2)return;let[u,f]=e;if(h.current)return h.current=!1;if(!f||!u)return;let v="right"===l?f:u;o.current=v,t||d.A.set(c,v.toString(),{expires:30});let g=s.PV(a),b=s.PV(r),j=s.Gx(m);if(!g||!b||!j)return;let y=x("right"===l?r:a),w=x("right"===l?a:r);if(v/100*j.offsetWidth<y){let e=y/j.offsetWidth*100;h.current=!0,null==(i=p.current)||i.setLayout("right"===l?[100-e,e]:[e,100-e])}else if(("right"===l?u:f)/100*j.offsetWidth<w){let e=w/j.offsetWidth*100;h.current=!0,null==(n=p.current)||n.setLayout("right"===l?[e,100-e]:[100-e,e])}},...f})})}function g(e){let{collapseSide:t,isOpen:l,order:n,defaultSize:d,className:u,innerContainerClassname:m,handleTestId:p,handleClassName:x,collapseId:v,children:g}=e,b=(0,r.d)(0),j=(0,r.d)(1);return(0,i.jsx)(o.N,{initial:!1,mode:"wait",children:l?(0,i.jsxs)(i.Fragment,{children:["right"===t?(0,i.jsx)(f,{"data-testid":p,className:(0,c.cn)("sticky top-0",x)},"resize-handle"):null,(0,i.jsx)(h,{transition:{duration:0},variants:{hidden:{flex:"0 1 0px",minWidth:0,overflow:"visible",transition:{when:"beforeChildren",duration:0}}},exit:"hidden",id:v,order:n,defaultSize:d,style:{overflow:"clip"},className:(0,c.cn)("relative",u),children:(0,i.jsx)(a.P.div,{style:{x:b,opacity:j,willChange:"auto"},variants:{initial:{width:"100%",display:"absolute",opacity:0,x:"right"===t?"100%":"-100%"},visible:()=>({width:["100%","100%"],opacity:[j.get(),1],display:["absolute","block"],x:[b.get(),0],transition:{type:"spring",damping:60,stiffness:1100}}),hidden:()=>{var e,l;return{width:null!=(l=null==(e=s.PV(v))?void 0:e.offsetWidth)?l:0,display:"absolute",opacity:0,x:"right"===t?"100%":"-100%",transition:{type:"spring",damping:60,stiffness:800}}}},initial:"initial",animate:"visible",exit:"hidden",className:(0,c.cn)("border-alpha-200 absolute inset-y-0 right-0 h-full w-full","right"===t?"right-0 border-l":"left-0 border-r",m),children:g})},"right-panel"),"left"===t?(0,i.jsx)(f,{"data-testid":p,className:"sticky top-0"},"resize-handle"):null]}):(0,i.jsx)(s.Zk,{order:n,defaultSize:0},"zero-panel")})}function b(e){let{initialSize:t,fallbackSize:l=50}=e,[i,s]=(0,n.useState)("number"==typeof t?t:l),a=(0,n.useRef)(i),r=(0,n.useRef)(!0),[o,c]=(0,n.useState)("number"!=typeof t);return(0,n.useEffect)(()=>{"number"!=typeof t&&t.then(e=>{s(e),c(!1),r.current&&(a.current=e,r.current=!1)})},[t]),{initialSize:i,defaultSizeRef:a,isFallbackSize:o}}},59766:(e,t,l)=>{"use strict";l.d(t,{D:()=>o});var i=l(13729),n=l(12),s=l(27693),a=l(33571),r=l(19243);let o=e=>{let{blockId:t,sourceFiles:l,onChange:o}=e,c=(0,n.W)(t),d=(0,s.k)(),[u,m]=(0,a.useState)(null);return{handleToggleFileLock:(0,a.useCallback)(async e=>{let n,s,a=[...l],u="locking";for(let t of a)if(("single-file"!==e.variant||t.meta.file===e.fileNameToEdit)&&("folder"!==e.variant||t.meta.file.startsWith(e.folderName+"/"))){if(("single-file"===e.variant&&t.isLocked||"all-files"===e.variant&&"unlock"===e.mode||"folder"===e.variant&&"unlock"===e.mode)&&(u="unlocking"),"single-file"===e.variant?t.isLocked=!t.isLocked:t.isLocked="lock"===e.mode,"single-file"===e.variant)break;"other-files"===e.variant&&(t.meta.file===e.fileNameToNotLock?t.isLocked=!1:t.isLocked=!0)}"all-files"===e.variant?m({type:"locking"===u?"locking-all":"unlocking-all"}):"folder"===e.variant?m({type:"locking"===u?"locking-folder":"unlocking-folder",folderName:e.folderName}):m({type:u,fileName:"single-file"===e.variant?e.fileNameToEdit:e.fileNameToNotLock});try{n=await c(a)}catch(e){n={success:!1}}s="single-file"===e.variant?"locking"===u?"fileTreeActions.fileLockedNotification":"fileTreeActions.fileUnlockNotification":"locking"===u?"fileTreeActions.filesLockedNotification":"fileTreeActions.filesUnlockedNotification",m(null),n.success?((0,r.u)("LockFiles",{variant:e.variant,state:u,blockId:t}),i.o.success(d(s),{position:"bottom-right"}),o()):((0,r.u)("LockFilesError",{variant:e.variant,state:u,blockId:t}),console.error(n),i.o.error(d("fileTreeActions.fileLockNotificationError"),{position:"bottom-right"}))},[l,c,d,o,t]),lockingStatus:u}}},72131:(e,t,l)=>{"use strict";l.d(t,{V:()=>n});var i=l(25603);function n(e){let{blockId:t}=e,{data:l,mutate:n}=(0,i.Ay)(["block:editValueMap",t],{fallbackData:{}});return{editValueMap:l||{},setEditValueMap:n}}},73311:(e,t,l)=>{"use strict";l.d(t,{o:()=>k,z:()=>N});var i=l(97667),n=l(15941),s=l(66692),a=l(33571),r=l(36323),o=l(27693),c=l(19243),d=l(13729),u=l(12507),m=l(55274),f=l(95393),p=l(80574),h=l(45586),x=l(61872),v=l(28265),g=l(65744),b=l(94475),j=l(21443),y=l(28819),w=l(74118);function k(e){var t;let{mergedFromBlockId:l,hasUnsavedChanges:u,overrideBlockId:h,resetValue:x,onSave:j,clearEditValueMap:w,isV3:k}=e,[N,P]=(0,a.useState)(!1),[E,T]=(0,a.useState)(!1),C=(0,r.eu)(),S=(0,o.k)(),R=(0,b.r)();(0,g.ML)("code-editor-saved",async()=>{u&&await j({setSaving:P,setForceHide:T})}),t=u,(0,a.useEffect)(()=>{let e=e=>{t&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[t]);let I=null!=l?l:(null==C?void 0:C.id)||h;return I?(0,i.jsx)(m.N,{children:u&&!E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"from-muted pointer-events-none absolute inset-x-0 bottom-0 z-10 flex h-36 items-end justify-center bg-gradient-to-t to-transparent"},"unsaved-changes-bg"),(0,i.jsx)(f.P.div,{initial:{opacity:0,y:20,scale:.95,width:320},animate:{opacity:1,y:0,scale:1,width:N?96:320},exit:{opacity:0},transition:{duration:.15,ease:"easeOut",width:{type:"spring",stiffness:300,damping:30}},className:(0,y.cn)("shadow-modal bg-background absolute inset-x-0 z-50 mx-auto flex h-11 items-center justify-between rounded-full p-2 pl-3 text-sm font-medium",k?"bottom-16":"bottom-3"),children:N?(0,i.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,i.jsx)(p.y,{size:16}),"Saving"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.N,{className:"!text-gray-500"}),"Unsaved Changes"]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.$,{size:"sm",className:"h-7",rounded:!0,variant:"secondary",disabled:N,onClick:()=>{(0,c.u)("ResetUnsavedEditCode",{blockId:I}),P(!0);try{x(),d.o.success(S("codeBlockActions.resetChanges"),{position:"bottom-right"}),setTimeout(()=>T(!1),2e3),w()}catch(e){d.o.error(S("codeBlockActions.failedToResetChanges"),{position:"bottom-right"})}P(!1)},children:S("codeBlockActions.reset")}),(0,i.jsx)(s.$,{tooltip:{content:(0,i.jsxs)(v.r,{children:[(0,i.jsx)(v.u,{children:R?"":"Ctrl"}),(0,i.jsx)(v.u,{children:"S"})]})},size:"sm",className:"h-7",rounded:!0,disabled:N,onClick:()=>{j({setSaving:P,setForceHide:T})},children:S("codeBlockActions.save")})]})]})},"unsaved-changes-island")]}):null}):null}function N(e){let{blockId:t,editValueMap:l,source:i,meta:n,files:s,clearEditValueMap:m,isAdminSaving:f}=e,p=(0,o.k)(),v=(0,r.eu)(),g=(0,r.y6)(),{updateBlockData:b}=(0,h.P6)({blockId:t}),{chatId:y}=(0,w.xz)();return{onSave:async e=>{let{setSaving:s,setForceHide:a}=e;if((0,c.u)("SaveEditCode",{blockId:t,chatId:y||""}),f&&!window.confirm("[V0 ADMIN] Are you sure you want to save these changes to the user's block?"))return;let r=Object.entries(l||{});if(!l||r.length<1||!r.some(e=>{let[t,l]=e;return!!l}))return(0,c.u)("SaveEditCodeError",{blockId:t,chatId:y||"",error:"no-edits"}),d.o.error(p("codeBlockActions.failedToSaveChanges"),{position:"bottom-right"});let o=r[0][1]||i;if("code-project"===n.type){let e=(0,x.A2)({source:i,blockType:"code-project",blockId:t});for(let t of e){let e=l[t.meta.file||""];e&&(t.source=e)}o=(0,x.L5)({files:e,blockType:"code-project"})}s(!0);let m=await (0,j.Z)({blockId:t,source:o});s(!1),m.success?(v&&t===v.id&&g({...v,hasSourceBeenEdited:!0,source:o,lastEditedAt:new Date().toISOString()}),b({blockId:t,data:{hasSourceBeenEdited:!0,source:o,lastEditedAt:new Date().toISOString()}}),a(!0),setTimeout(()=>a(!1),2e3),d.o.success(p("codeBlockActions.savedChanges"),{position:"bottom-right"})):((0,c.u)("SaveEditCodeError",{blockId:t,chatId:y||"",error:"failed-to-save"}),(0,u.z)(m)||d.o.error(p("codeBlockActions.failedToSaveChanges")))},hasUnsavedChanges:(0,a.useMemo)(()=>{if(!l)return!1;for(let e of s){let t=l[e.meta.file||""];if(t&&t.trimEnd()!==e.source.trimEnd())return!0}return!1},[l,s]),clearEditValueMap:m}}},78799:(e,t,l)=>{"use strict";l.d(t,{FullscreenContainer:()=>c});var i=l(97667),n=l(67572),s=l(28819),a=l(65744),r=l(95393),o=l(74905);function c(e){let{children:t,allowOnMobile:l}=e,{fullScreenResult:c,setFullscreenResult:d,source:u}=(0,n.S)(),m=(0,o.s)(),f=c&&(l||!m);(0,a.ML)("keydown",e=>{"Escape"===e.key&&d(!1)});let p=e=>{if(!e)return void d(!1);e.target===e.currentTarget&&d(!1)},h=(0,i.jsx)("div",{className:(0,s.cn)(f?"fixed inset-3":"size-full",f&&"ssr"!==u&&"animate-in zoom-in-90"),children:(0,i.jsx)("div",{className:(0,s.cn)("bg-background size-full !overflow-clip",f&&"rounded-lg"),children:t})}),x=(0,s.cn)(f?"bg-alpha-700 dark:bg-alpha-900 fixed inset-0 z-[60]":"h-full w-full",f&&"ssr"!==u&&"animate-in fade-in duration-300");return"ssr"===u?(0,i.jsx)("div",{"data-testid":"fullscreen-overlay-ssr",className:x,onClick:p,children:h}):(0,i.jsx)(r.P.div,{"data-testid":"fullscreen-overlay",className:x,onClick:p,children:h})}},81008:(e,t,l)=>{"use strict";l.d(t,{EE:()=>g,l1:()=>x});var i=l(57560),n=l(18150),s=l(40391),a=l(141),r=l(94282),o=l(33541),c=l(97809),d=l(70073);let u=new Map,m=(0,a.G)(u,()=>({resizingId:(0,i.eU)(null),isReordering:(0,i.eU)(!1),disableLayoutAnimations:(0,i.eU)(!1)}));function f(e){return Object.freeze(e.map(e=>e.id))}function p(e){return Object.freeze(e.filter(e=>e.visible).map(e=>e.id))}let h=new Map,x=(0,a.G)(h,e=>{let t=m(e),{panelsLayout:l,mobilePanel:a}=(0,s.Op)(e),r=(0,d.jP)(e),o=(0,n.mg)(l,f,(e,t)=>e.length===t.length&&e.every((e,l)=>e===t[l])),u=(0,n.mg)(l,p,(e,t)=>e.length===t.length&&e.every((e,l)=>e===t[l])),h=(0,i.eU)(e=>{let t=e(l),i=e(a);return(0,c.LS)({panelsLayout:t,mobilePanel:i})}),x=(0,i.eU)(e=>null!==e(r.data)&&!!e(r.activeBlock));return{...t,panelsLayout:l,mobilePanel:a,gridProperties:h,isResizing:(0,i.eU)(e=>null!==e(t.resizingId)),panelOrder:o,visiblePanels:u,controlsEnabled:x,isEmptyStateVisible:(0,i.eU)(e=>0===e(u).length)}}),v=new Map,g=(0,a.G)(v,e=>{let t=m(e),{panelsLayout:l,mobilePanel:i}=(0,s.Op)(e),n=(0,o.w3)(e),a=e=>{let n=r.M.get(l),s=r.M.get(i),a=n.some(e=>"chat"===e.id&&e.visible),o=n.some(e=>"editor"===e.id&&e.visible),d=n.some(e=>"block"===e.id&&e.visible),u={panelsLayout:n,mobilePanel:s};if(a&&["block","editor"].includes(e)){let l="block";"block"===e&&(l="editor");let i=u.panelsLayout.find(e=>e.id===l&&e.visible),n=u.panelsLayout.find(t=>t.id===e&&!t.visible);i&&n&&(r.M.set(t.disableLayoutAnimations,!0),n.savedRatio=i.ratio,u=(0,c.AF)(u,i.id)),requestAnimationFrame(()=>{r.M.set(t.disableLayoutAnimations,!1)})}"chat"===e&&o&&d&&(u=(0,c.AF)(u,"editor")),u=(0,c.XJ)(u,e),r.M.set(l,u.panelsLayout),r.M.set(i,u.mobilePanel)},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r.M.get(l),s=r.M.get(i),a=(0,c.AF)({panelsLayout:n,mobilePanel:s},e,t);r.M.set(l,a.panelsLayout),r.M.set(i,a.mobilePanel)};return{setIsResizing:e=>{null!==e&&n.setComposerLayoutState("collapsed"),r.M.set(t.resizingId,e)},resizePanel:e=>{let{index:t,delta:n}=e,s=r.M.get(l),a=r.M.get(i),o=s[t],d=s.slice(t+1).find(e=>e.visible);if(!o||!d||!o.visible||!d.visible)return!1;let u={panelsLayout:s,mobilePanel:a},m=(0,c.R8)(u,o.id,d.id,n);return m!==u&&(r.M.set(l,m.panelsLayout),!0)},movePanel:e=>{let{id:i,direction:n}=e,s=r.M.get(l),a=s.findIndex(e=>e.id===i),o=((e,t)=>{let l="left"===t?-1:1,i=e+l;for(;i>=0&&i<s.length;){if(s[i].visible)return i;i+=l}return -1})(a,n);if(-1===a||-1===o||!s[a].visible)return;r.M.set(t.isReordering,!0);let c=[...s],d=c[a];c[a]=c[o],c[o]=d,r.M.set(l,c),requestAnimationFrame(()=>{r.M.set(t.isReordering,!1)})},togglePanel:e=>{let t=r.M.get(l).find(t=>t.id===e);t&&(t.visible?d(e):a(e))},openPanel:a,closePanel:d,fullscreenPanel:e=>{let t=r.M.get(l),n=r.M.get(i),s=(0,c.O$)({panelsLayout:t,mobilePanel:n},e);r.M.set(l,s.panelsLayout),r.M.set(i,s.mobilePanel)},restoreSavedVisibility:()=>{let e=r.M.get(l),t=r.M.get(i),n=(0,c.gT)({panelsLayout:e,mobilePanel:t});r.M.set(l,n.panelsLayout),r.M.set(i,n.mobilePanel)},setMobilePanel:e=>{r.M.set(i,e)},setPanelsLayout:e=>{r.M.set(l,e)},isPanelFullscreen:e=>{let t=r.M.get(l);return t.some(t=>t.id===e&&t.visible)&&t.every(t=>t.id===e||!t.visible)}}})},83368:e=>{e.exports={content:"block-view-loader_content__0PEP4",blur:"block-view-loader_blur__dloZD"}},97128:(e,t,l)=>{"use strict";l.d(t,{V:()=>n});var i=l(97667);function n(){return(0,i.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{d:"M11.3333 8H2",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M7.33325 12L11.3333 8L7.33325 4",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M14 3.33203V12.6654",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}},97809:(e,t,l)=>{"use strict";l.d(t,{AF:()=>a,LS:()=>u,O$:()=>o,R8:()=>c,XJ:()=>r,gT:()=>m,xp:()=>i});let i=10;function n(e){return Math.round(1e4*e)/1e4}function s(e){let t=e.filter(e=>e.visible);if(0===t.length)return e;if(1===t.length)return e.map(e=>e.visible?{...e,ratio:1}:e);let l=t.reduce((e,t)=>e+t.ratio,0);if(.001>=Math.abs(l-1))return e;let i=1/l;return e.map(e=>e.visible?{...e,ratio:n(e.ratio*i)}:e)}function a(e,t){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.panelsLayout.findIndex(e=>e.id===t);if(-1===i||!e.panelsLayout[i].visible)return e;let a=e.panelsLayout.filter(e=>e.visible);if(a.length<=1)return{panelsLayout:e.panelsLayout.map(e=>e.id===t?{...e,visible:!1,savedRatio:e.ratio,ratio:0,savedVisibility:l?e.visible:e.savedVisibility}:e),mobilePanel:e.mobilePanel};let r=a.filter(e=>e.id!==t).reduce((e,t)=>e+t.ratio,0),o=r>0?1/r:0,c=e.panelsLayout.map(e=>e.id===t?{...e,visible:!1,savedRatio:e.ratio,ratio:0,savedVisibility:l?e.visible:e.savedVisibility}:e.visible?{...e,ratio:n(e.ratio*o)}:e),d=e.mobilePanel;if(e.mobilePanel===t){let e=c.find(e=>e.visible);e&&(d=e.id)}return{panelsLayout:s(c),mobilePanel:d}}function r(e,t){let l=e.panelsLayout.findIndex(e=>e.id===t);if(-1===l||e.panelsLayout[l].visible)return e;let i=e.panelsLayout[l],a=e.panelsLayout.filter(e=>e.visible);if(0===a.length)return{panelsLayout:e.panelsLayout.map(e=>e.id===t?{...e,visible:!0,ratio:1}:e),mobilePanel:e.mobilePanel};let r=Math.max(.2,i.savedRatio||.2),o=a.reduce((e,t)=>e+t.ratio,0),c=Math.min(r,.8),d=n(1-c)/o;return{panelsLayout:s(e.panelsLayout.map(e=>e.id===t?{...e,visible:!0,ratio:c}:e.visible?{...e,ratio:n(e.ratio*d)}:e)),mobilePanel:e.mobilePanel}}function o(e,t){return -1===e.panelsLayout.findIndex(e=>e.id===t)?e:{panelsLayout:e.panelsLayout.map(e=>({...e,savedRatio:e.visible?e.ratio:e.savedRatio,savedVisibility:e.visible,visible:e.id===t,ratio:+(e.id===t)})),mobilePanel:t}}function c(e,t,l,i){let a=e.panelsLayout.findIndex(e=>e.id===t),r=e.panelsLayout.findIndex(e=>e.id===l);if(-1===a||-1===r||!e.panelsLayout[a].visible||!e.panelsLayout[r].visible)return e;let o=e.panelsLayout[a],c=e.panelsLayout[r],d=n(o.ratio+i),u=n(c.ratio-i);if(d<.2||u<.2)return e;let m=e.panelsLayout.map(e=>e.id===t?{...e,ratio:d}:e.id===l?{...e,ratio:u}:e);return{...e,panelsLayout:s(m)}}function d(e,t){let l=[];return e.panelsLayout.forEach((i,n)=>{if(l.push(i.visible?"".concat(i.ratio,"fr"):"0fr"),n<e.panelsLayout.length-1){let s=e.panelsLayout.slice(n+1).find(e=>e.visible),a=i.visible&&s?"".concat(t,"px"):"0px";l.push(a)}}),l.join(" ")}function u(e){return{gridTemplateAreas:function(e){let t=[];return e.panelsLayout.forEach((l,i)=>{t.push(l.id),i<e.panelsLayout.length-1&&t.push("resize-".concat(i))}),'"'.concat(t.join(" "),'"')}(e),desktopGridTemplateColumns:d(e,i),desktopGridTemplateColumnsUsingCqw:d(e,i),mobileGridTemplateColumns:e.panelsLayout.map(t=>t.id===e.mobilePanel?"1fr":"0px").join(" ")}}function m(e){return 1!==e.panelsLayout.filter(e=>e.visible).length?e:{panelsLayout:s(e.panelsLayout.map(e=>!0===e.savedVisibility?{...e,visible:!0,ratio:e.savedRatio||.2}:e)),mobilePanel:e.mobilePanel}}},98135:(e,t,l)=>{"use strict";l.d(t,{Ip:()=>m,K5:()=>p,Q2:()=>u,Rc:()=>d,kt:()=>f,tz:()=>c});var i=l(97667),n=l(33571),s=l(67633),a=l(28819),r=l(27962),o=l(17773);let c=e=>{let{...t}=e;return(0,i.jsx)(s.bL,{modal:!1,...t})};c.displayName=s.bL.displayName;let d=s.l9,u=n.forwardRef((e,t)=>{let{className:l,...n}=e;return(0,i.jsx)(s.YJ,{className:(0,a.cn)("p-1.5",l),ref:t,...n})});u.displayName=s.YJ.displayName,s.ZL,s.Pb,s.z6,n.forwardRef((e,t)=>{let{className:l,inset:n,variant:r="default",...o}=e;return(0,i.jsx)(s.ZP,{className:(0,a.cn)("[_>svg]:!text-gray-500 relative flex h-8 w-full select-none items-center gap-3 rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[state=open]:bg-gray-100 data-[disabled]:opacity-50 [&_svg]:size-4 [&_svg]:transition-colors",n&&"pl-8","destructive"===r?"text-red-700 focus:bg-[#FF666618] [&_svg]:!text-red-700":"text-gray-900 focus:bg-gray-100 [&_svg]:!text-gray-500",l),ref:t,...o})}).displayName=s.ZP.displayName,n.forwardRef((e,t)=>{let{className:l,sideOffset:n=12,...r}=e;return(0,i.jsx)(s.G5,{className:(0,a.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),ref:t,sideOffset:n,...r})}).displayName=s.G5.displayName;let m=n.forwardRef((e,t)=>{let{className:l,...n}=e;return(0,i.jsx)(s.ZL,{children:(0,i.jsx)(s.UC,{className:(0,a.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),ref:t,...n})})});m.displayName=s.UC.displayName;let f=n.forwardRef((e,t)=>{let{className:l,inset:n,variant:r="default",svgStyling:o=!0,...c}=e;return(0,i.jsx)(s.q7,{className:(0,a.cn)("relative flex h-8 w-full select-none items-center gap-3 whitespace-nowrap rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_span]:truncate",n&&"pl-8",o&&"[&_svg]:size-4 [&_svg]:transition-colors",o&&{"[&_svg]:!text-gray-500 [&[data-highlighted]_svg]:!text-gray-900":"default"===r,"[&_svg]:!text-red-700":"destructive"===r,"[&_svg]:!text-blue-700":"blue"===r,"[&_svg]:!text-amber-600":"gold"===r},"destructive"===r?"text-red-700 focus:bg-[#FF666618]":"text-gray-900 focus:bg-gray-100 ",l),ref:t,...c})});f.displayName=s.q7.displayName,n.forwardRef((e,t)=>{let{className:l,inset:n,...r}=e;return(0,i.jsx)(s.JU,{className:(0,a.cn)("h-8 content-center px-1.5 text-[13px] text-gray-500",n&&"pl-8",l),ref:t,...r})}).displayName=s.JU.displayName;let p=n.forwardRef((e,t)=>{let{className:l,...n}=e;return(0,i.jsx)(s.wv,{className:(0,a.cn)("h-px bg-gray-200",l),ref:t,...n})});p.displayName=s.wv.displayName,n.forwardRef((e,t)=>{let{className:l,children:n,checked:r,...c}=e;return(0,i.jsxs)(s.H_,{checked:r,className:(0,a.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),ref:t,...c,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(s.VF,{children:(0,i.jsx)(o.J,{className:"h-4 w-4"})})}),n]})}).displayName=s.H_.displayName,n.forwardRef((e,t)=>{let{className:l,children:n,...o}=e;return(0,i.jsxs)(s.hN,{className:(0,a.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),ref:t,...o,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center rounded-full border",children:(0,i.jsx)(s.VF,{children:(0,i.jsx)(r.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=s.hN.displayName}}]);